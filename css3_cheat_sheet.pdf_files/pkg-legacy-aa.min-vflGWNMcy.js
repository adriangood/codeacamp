(function(){define("modules/clean/avatar/stacked_avatars",["external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/css","modules/core/user_i18n"],function(e,t,n,o,i,r){var s,a,l,c;return s=o.VALID_AVATAR_DIMENSIONS,l=e.DOM,c=e.PropTypes,a=e.createElement,e.createClass({displayName:"StackedAvatars",propTypes:{user_front:c.object.isRequired,user_back:c.object.isRequired,dimension:c.oneOf(s).isRequired,optionalClass:c.string,shape:c.oneOf(["CIRCLE","SQUARE"]).isRequired},getDefaultProps:function(){return{shape:"CIRCLE"}},componentDidMount:function(){return i.require_css("/static/css/scooter/scooter-scoped-vflm9UP03.css")},render:function(){var e,o;return e="stacked-avatar-bottom",o="stacked-avatar-top",this.props.optionalClass&&(e+=" "+this.props.optionalClass,o+=" "+this.props.optionalClass),l.div({className:"stacked-avatars-section u-l-ib"},a(t,{dimension:this.props.dimension,photoUrl:this.props.user_back.avatar_url,optionalClass:e,defaultAvatar:a(n,{dimension:this.props.dimension,name:this.props.user_back.display_name||this.props.user_back.email,initials:r.getInitials(this.props.user_back.display_name||this.props.user_back.email),shape:this.props.shape,optionalClass:e})}),a(t,{dimension:this.props.dimension,photoUrl:this.props.user_front.avatar_url,optionalClass:o,defaultAvatar:a(n,{dimension:this.props.dimension,name:this.props.user_front.display_name||this.props.user_front.email,initials:r.getInitials(this.props.user_front.display_name||this.props.user_front.email),shape:this.props.shape,optionalClass:o})}))}})})}).call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function o(){this.constructor=e}for(var i in t)n.call(t,i)&&(e[i]=t[i]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},n={}.hasOwnProperty;define("modules/clean/contacts/facebook_modal",["modules/clean/dbmodal"],function(n){var o;return o=n.DBUserModal,(function(n){function o(t,n,i){this.show_hidden_modal=n,this.link_with_facebook=i,this.on_confirm_button_click=e(this.on_confirm_button_click,this),this.on_hide=e(this.on_hide,this),o.__super__.constructor.call(this,t,{element_id:"facebook-confirm-modal-user-"+t.id})}return t(o,n),o.prototype.on_hide=function(){return"function"==typeof this.show_hidden_modal?this.show_hidden_modal():void 0},o.prototype.on_confirm_button_click=function(e){return this.hide(),this.link_with_facebook()},o})(o)})}.call(this),function(){define("modules/clean/contacts/facebook_oauth",["jquery","modules/core/exception","modules/core/uri","modules/clean/ajax","modules/clean/viewer"],function(e,t,n,o,i){var r,assert;return assert=t.assert,r={do_auth:function(e,t){if(assert(null!=t,"user_id must be specified"),window.open(n({path:"/fb/access_token"}).updateQuery("_subject_uid",t).toString(),"fb_auth","width=600,height=450"),e)return r.onLoginSuccessCallback=e},post:function(e,t,s,a,l,c,u){return assert(null!=u,"user_id must be specified!"),i.get_viewer().is_signed_in?("function"==typeof r.custom_show_posting&&r.custom_show_posting(),new o.WebRequest({url:"/fb/post",data:{message:e,link:t,link_name:s,description:a,from_referrals:r.from_referrals,from_getspace:r.from_getspace,picture:l?l:""},success:function(n,o,i){var d;return d=i.responseText,0===d.indexOf("ok")?"function"==typeof r.custom_show_complete?r.custom_show_complete():void 0:0===d.indexOf("auth")?r.do_auth(function(){return r.post(e,t,s,a,l,c,u)},u):void 0},error:function(){return"function"==typeof c?c():void 0},subject_user:u})):void window.open(n.parse("http://www.facebook.com/sharer.php").setQuery({u:t,t:s}).toString())}}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/frame_messenger",[],function(){return(function(){function n(){this.handleUntrustedMessage=e(this.handleUntrustedMessage,this),Object.defineProperty(this,"trustedParentOriginForPosting",{get:function(){return this._trustedParentOriginForPosting}}),Object.defineProperty(this,"trustedChildOriginForPosting",{get:function(){var e,t,n,o,i;if(null!=this._trustedChildOriginForPosting)return this._trustedChildOriginForPosting;for(e=document.querySelectorAll(this._childIframeQuery),t=0,i=e.length;t<i&&(n=e[t],o=n.getAttribute("src"),!this._validateChildOriginForPosting(o));t++);return this._trustedChildOriginForPosting}})}return n._ALLOWED_CHILD_ORIGINS=["https://www.dropboxstatic.com","https://www.dropboxstatic.com:443","https://cf.dropboxstatic.com","https://cf.dropboxstatic.com:443","https://cfl.dropboxstatic.com","https://cfl.dropboxstatic.com:443","https://www.dropbox.com","https://www.dropbox.com:443","https://dl-doc.dropbox.com","https://dl-doc.dropbox.com:443","https://dl-web.dropbox.com","https://dl-web.dropbox.com:443","https://dl.dropboxusercontent.com","https://dl.dropboxusercontent.com:443","null"],n._ALLOWED_PARENT_ORIGINS=["https://www.dropbox.com","https://www.dropbox.com:443"],n._REQUEST_PARENT_ORIGIN_POLL_DELAY=100,n.prototype._childIframeQuery=null,n.prototype._trustedChildOriginForPosting=null,n.prototype._trustedParentOriginForPosting=null,n.prototype._validActionsFromChild=[],n.prototype._validActionsFromParent=[],n.prototype._trustedMessageFromChildHandler=null,n.prototype._trustedMessageFromParentHandler=null,n.prototype._parentMessageQueue=[],n.prototype._requestParentOriginPollRetry=null,n.prototype._onParentReady=null,n.prototype.resetOriginsForPosting=function(){return this._trustedChildOriginForPosting=null,this._trustedParentOriginForPosting=null},n.prototype.configureChildMessaging=function(e,t,n){return this._childIframeQuery=e,this._trustedChildOriginForPosting=null,this._validActionsFromChild=n,this._trustedMessageFromChildHandler=t},n.prototype.configureParentMessaging=function(e,t,n){return null==n&&(n=null),this._trustedParentOriginForPosting=null,this._validActionsFromParent=t,this._trustedMessageFromParentHandler=e,this._onParentReady=n},n.prototype.startListening=function(){if(window.addEventListener("message",this.handleUntrustedMessage),null!=this._validActionsFromParent&&this._validActionsFromParent.length>0&&null!=this._trustedMessageFromParentHandler&&this._requestParentOrigin(),null!=this._validActionsFromChild&&this._validActionsFromChild.length>0&&null!=this._trustedMessageFromChildHandler)return this.postMessageToChildren("parent-ready")},n.prototype.stopListening=function(){return window.removeEventListener("message",this.handleUntrustedMessage)},n.prototype._isNumber=function(e){return!isNaN(parseInt(e))},n.prototype._getOriginFromUrl=function(e){var t,n;return n=document.createElement("a"),n.href=e,t=this._isNumber(n.port)?":"+n.port:"","https://"+n.hostname+t},n.prototype._isChildOriginAllowed=function(e){return t.call(this.constructor._ALLOWED_CHILD_ORIGINS,e)>=0||this._isDevVmOrigin(e)},n.prototype._isParentOriginAllowed=function(e){return t.call(this.constructor._ALLOWED_PARENT_ORIGINS,e)>=0||this._isDevVmOrigin(e)},n.prototype._isDevVmOrigin=function(e){var t;return t=e.match(/\.dev\.corp\.dropbox(static|usercontent)?\.com($|:)/),(null!=t?t.length:void 0)>=1},n.prototype._validateChildOriginForPosting=function(e){var t;return t="null"===e?"*":this._getOriginFromUrl(e),"null"===e||this._isChildOriginAllowed(t)?(this._trustedChildOriginForPosting=t,!0):(console.warn("Untrusted message from child blocked: "+e),!1)},n.prototype.childIsValidated=function(){return null!=this._trustedChildOriginForPosting},n.prototype._validateParentOriginForPosting=function(e){var t,n,o,i,r,s,a;if(s=this._trustedParentOriginForPosting,r=this._getOriginFromUrl(e),!this._isParentOriginAllowed(r))return console.warn("Untrusted message from parent blocked: "+e),!1;if(this._trustedParentOriginForPosting=r,this._parentMessageQueue.length>0){for(a=this._parentMessageQueue,t=0,n=a.length;t<n;t++)o=a[t],i=JSON.parse(o),this.postMessageToParent(i.action,i.parameters);this._parentMessageQueue=[]}return null!=this._trustedParentOriginForPosting&&null==s&&null!=this._onParentReady&&this._onParentReady(),!0},n.prototype.handleUntrustedMessage=function(e){var n,o,i;if(!this._isChildOriginAllowed(e.origin)&&!this._isParentOriginAllowed(e.origin))return void console.warn("Message received not in parent or child origin whitelist: "+e.origin);try{n=JSON.parse(e.data)}catch(e){return void e}if(null!=n.action)return"child-requesting-parent-origin"===n.action?void(this._validateChildOriginForPosting(e.origin)&&this.postMessageToChildren("parent-ready")):"parent-ready"===n.action?void this._validateParentOriginForPosting(e.origin):(o=n.action,t.call(this._validActionsFromChild,o)>=0&&this._validateChildOriginForPosting(e.origin)&&null!=this._trustedMessageFromChildHandler?void this._trustedMessageFromChildHandler(n):(i=n.action,void(t.call(this._validActionsFromParent,i)>=0&&this._validateParentOriginForPosting(e.origin)&&null!=this._trustedMessageFromParentHandler&&this._trustedMessageFromParentHandler(n))))},n.prototype._packagePostMessage=function(e,t){var n;return this.trustedChildOriginForPosting,n={action:e,parameters:t},JSON.stringify(n)},n.prototype.postMessageToChildElements=function(e,t,n){var o,i,r,s,a;if(null==n&&(n={}),null!=this.trustedChildOriginForPosting){for(s=this._packagePostMessage(t,n),a=[],o=0,r=e.length;o<r;o++)i=e[o],a.push(i.contentWindow.postMessage(s,this.trustedChildOriginForPosting));return a}},n.prototype.postMessageToChildren=function(e,t,n){var o;return null==t&&(t={}),null==n&&(n=null),null==n&&(n=this._childIframeQuery),o=document.querySelectorAll(n),this.postMessageToChildElements(o,e,t)},n.prototype.postMessageToParent=function(e,t){var n;return null==t&&(t={}),n=this._packagePostMessage(e,t),null==this.trustedParentOriginForPosting?void this._parentMessageQueue.push(n):window.parent.postMessage(n,this.trustedParentOriginForPosting)},n.prototype._requestParentOrigin=function(){var e;return window.parent.postMessage('{"action": "child-requesting-parent-origin"}',"*"),e=function(){if(this._requestParentOriginPollRetry=null,null==this._trustedParentOriginForPosting)return this._requestParentOrigin()},setTimeout(e.bind(this),this._REQUEST_PARENT_ORIGIN_POLL_DELAY)},n})()})}.call(this),function(){define("modules/clean/groups/api",["jquery","modules/clean/ajax","modules/clean/contacts/cache_store","modules/clean/viewer"],function(e,t,n,o){var i,r,s;return i=n.DefaultContactsCacheStore,s={},r="/groups_ajax",s.ready=function(){},s.get_groups_for_user=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_groups_for_user",data:e,success:t})},s.get_group_info=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_group_info",data:e,success:t})},s.get_groups_for_team=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_groups_for_team",data:{},success:t})},s.get_users_for_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_users_in_group",data:e,success:t})},s.create_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_new_group",data:e,success:t,reload_contacts:!0})},s.create_group_with_users=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_new_group_with_users",data:e,success:t,reload_contacts:!0})},s.remove_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"remove_group",data:e,success:t,reload_contacts:!0})},s.rename_group=function(e,t,n){return null==n&&(n=function(){return{}}),s.metaserver_ajax({method:"rename_group",data:e,success:t,error:n,reload_contacts:!0})},s.add_users_to_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"add_users_to_group",data:e,success:t,reload_contacts:!0})},s.remove_user_from_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"remove_user_from_group",data:e,success:t,reload_contacts:!0})},s.change_group_member_type=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"change_group_member_type",data:e,success:t})},s.remove_namespace_from_group=function(e,t){return s.metaserver_ajax({method:"remove_namespace_from_group",data:e,success:t})},s.change_group_access_type=function(e,n){var i;return i=function(e,t,o){return n(o)},t.WebRequest({url:r+"/change_group_access_type",type:"post",data:e,subject_user:o.get_viewer().work_user,success:i})},s.make_group_join_request=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_group_join_request",data:e,success:t})},s.metaserver_ajax=function(n){var s,a,l,c;return c=r+"/"+n.method,a=n.reload_contacts||!1,l=function(t){var o,r;r=JSON.parse(t),r.ok&&(n.success(r.data),e(".error_msg").hide()),a&&(o=i.getOrCreateForViewer(),o.load_contacts(!0))},s=function(t){var o;o=t.responseText,n.error&&(n.error(o.slice(4)),e(".error_msg").hide())},t.WebRequest({url:c,type:"post",data:n.data,subject_user:o.get_viewer().work_user,success:l,error:s})},s})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/legacy_pyxl_controllers/bubble_picker",["jquery","modules/clean/keycode"],function(t,n){var o;return o=n.KeyCode,(function(){function n(t){this.$bubble_picker=t,this._on_button_keydown=e(this._on_button_keydown,this),this._on_option_keydown=e(this._on_option_keydown,this),this._on_option_mouseenter=e(this._on_option_mouseenter,this),this.enable_option=e(this.enable_option,this),this.disable_option=e(this.disable_option,this),this.show_dropdown=e(this.show_dropdown,this),this.hide_dropdown=e(this.hide_dropdown,this),this.set_value=e(this.set_value,this),this._listen=e(this._listen,this),this.$label_wrapper=this.$bubble_picker.find(".bubble-picker-label-wrapper"),this.$label_wrapper.on("keydown",this._on_button_keydown),this.$label=this.$bubble_picker.find(".bubble-picker-label"),this.$dropdown=this.$bubble_picker.find(".bubble-picker-dropdown"),this.$options=this.$bubble_picker.find("*[role='option']"),this.$options.on("mouseenter",this._on_option_mouseenter),this.$options.on("keydown",this._on_option_keydown),this._dropdown_shown=!1,this._listen()}return n.CHANGED="db:bubblepicker:changed",n.prototype._listen=function(){return t(document).click((function(e){return function(n){var o,i;return i=t(n.target).closest(e.$label_wrapper).length>0,o=t(n.target).closest(e.$dropdown).length>0,e._dropdown_shown&&!o?e.hide_dropdown():i?e.show_dropdown():void 0}})(this)),this.$dropdown.find(".bubble-picker-option:not('.disabled')").click((function(e){return function(o){var i,r;if(o.preventDefault(),i=t(o.currentTarget),!i.hasClass("disabled"))return r=e.get_value(),e.set_value(i.data("value")),e.$bubble_picker.trigger(n.CHANGED,{clicked_val:i.data("value"),old_val:r}),e.hide_dropdown(),e.$label_wrapper.focus()}})(this))},n.prototype.get_value=function(){return this.$bubble_picker.attr("data-selected-value")},n.prototype.set_value=function(e){var t;return this.$bubble_picker.attr("data-selected-value",e),this.$label.empty(),this.$bubble_picker.find(".bubble-picker-option--selected").removeClass("bubble-picker-option--selected"),t=this.$bubble_picker.find("[data-value='"+e+"']").addClass("bubble-picker-option--selected"),this.$label.html(t.clone().html())},n.prototype.hide_dropdown=function(){return this.$dropdown.hide(),this.$label_wrapper.attr("aria-expanded",!1),this._dropdown_shown=!1},n.prototype.show_dropdown=function(){var e,n;return this.$dropdown.show(),this.$label_wrapper.attr("aria-expanded",!0),this._dropdown_shown=!0,this.$options.attr({tabindex:-1,"aria-selected":!1}),n=this.$bubble_picker.attr("data-selected-value"),e=n?this.$bubble_picker.find(".bubble-picker-option[data-value='"+n+"']")[0]:this.$bubble_picker.find(".bubble-picker-option")[0],t(e).attr({tabindex:0,"aria-selected":!0}).focus()},n.prototype.disable_option=function(e,n){var o,i;return i=this.$bubble_picker.find(".bubble-picker-option[data-value="+e+"]:not('.disabled')"),i.length>0&&(o=t(i.find(".role-option")),o.attr("saved-title",o.attr("title")),o.attr("title",n),o.attr("aria-disabled",!0)),i.addClass("disabled")},n.prototype.enable_option=function(e){var n,o;return o=this.$bubble_picker.find(".bubble-picker-option.disabled[data-value="+e+"]"),n=t(o.find(".role-option")),n.attr("saved-title")&&(n.attr("title",n.attr("saved-title")),n.removeAttr("saved-title")),n.attr("aria-disabled",!1),o.removeClass("disabled")},n.prototype._change_focus=function(e,n){return t(e).attr({tabindex:-1,"aria-selected":!1}),t(n).attr({tabindex:0,"aria-selected":!0}).focus()},n.prototype._focus_previous=function(e){var t;if(t=this.$options.index(e),t>0)return this._change_focus(e,this.$options.get(t-1))},n.prototype._focus_next=function(e){var t;if(t=this.$options.index(e),t<this.$options.length-1)return this._change_focus(e,this.$options.get(t+1))},n.prototype._on_option_mouseenter=function(e){return this.$dropdown.removeClass("bubble-picker-dropdown--keyboard")},n.prototype._on_option_keydown=function(e){this.$dropdown.addClass("bubble-picker-dropdown--keyboard"),e.keyCode===o.ESC?(this.hide_dropdown(),this.$label_wrapper.focus()):e.keyCode===o.DOWN?(this._focus_next(e.target),e.preventDefault()):e.keyCode===o.UP?(this._focus_previous(e.target),e.preventDefault()):e.keyCode!==o.TAB||e.shiftKey||this.hide_dropdown()},n.prototype._on_button_keydown=function(e){e.keyCode===o.ENTER?this.$dropdown.addClass("bubble-picker-dropdown--keyboard"):e.keyCode===o.TAB&&e.shiftKey&&this.hide_dropdown()},n})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},n=function(e,t){function n(){this.constructor=e}for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},o={}.hasOwnProperty;define("modules/clean/legacy_pyxl_controllers/role_picker",["external/underscore","modules/core/controller_helpers","modules/core/exception","modules/clean/multiaccount_login","modules/clean/page_role_observer","modules/clean/viewer"],function(o,i,r,s,a,l){var c,u,d,p,assert;return assert=r.assert,d={ALL:"all",PERSONAL:"personal",WORK:"work"},u=(function(){function n(n){var i,r,s,a,c,u;null==n&&(n={}),this._actually_set_state=e(this._actually_set_state,this),this._do_login=e(this._do_login,this),this.is_user_visible=e(this.is_user_visible,this),this.is_role_visible=e(this.is_role_visible,this),this.ensure_role_is_visible=e(this.ensure_role_is_visible,this),this.set_state=e(this.set_state,this),this.get_state=e(this.get_state,this),this._allow_merged_state=null==n.allow_merged_state||n.allow_merged_state,this._limit_to_role=null!=n.limit_to_role?n.limit_to_role:null,u=l.get_viewer(),r=u.is_role_signed_in(d.PERSONAL)&&u.is_role_signed_in(d.WORK),n.initial_state?(a=o.values(d),assert((s=n.initial_state,t.call(a,s)>=0),"RolePicker requires initial_state to be one of: "+a),this.set_state(n.initial_state)):this._allow_merged_state&&r?this.set_state(d.ALL):(i=u.get_users(),assert(i.length,"tried to use RolePicker on a page with no users"),c=i[0],this.set_state(c.role))}return n.prototype.get_state=function(){return this._state},n.prototype.set_state=function(e){var t,n,o,i;if(assert(this._allow_merged_state||e!==d.ALL,"tried to set merged state in non-merged picker"),null!=this._limit_to_role&&assert(e===d.ALL||e===this._limit_to_role),e===d.ALL){for(o=["personal","work","photos"],t=0,n=o.length;t<n;t++)if(i=o[t],!l.get_viewer().is_role_signed_in(i))return void this._do_login(i,e)}else if(i=e,!l.get_viewer().is_role_signed_in(i))return void this._do_login(i,e);return this._actually_set_state(e)},n.prototype.update_picker_ui=function(){},n.prototype.ensure_role_is_visible=function(e){if(!this.is_role_visible(e))return this._allow_merged_state?this.set_state(d.ALL):this.set_state(e)},n.prototype.is_role_visible=function(e){return this._state===d.ALL||this._state===e},n.prototype.is_user_visible=function(e){return this.is_role_visible(e.role)},n.prototype._do_login=function(e,t){return s.show_modal({role:e,on_success:(function(e){return function(){return e._actually_set_state(t)}})(this)})},n.prototype._actually_set_state=function(e){if(e!==this._state)return this._state=e,this.update_picker_ui(),"function"==typeof this.on_state_change?this.on_state_change(e):void 0},n})(),p=(function(t){function o(t,n){this.$container=t,null==n&&(n={}),this.limit_to_role=e(this.limit_to_role,this),this.update_picker_ui=e(this.update_picker_ui,this),this.on_ui_change=e(this.on_ui_change,this),this.$bubble_picker=this.$container.find(".bubble-picker"),this.$bubble_picker.on("db:bubblepicker:changed",this.on_ui_change),o.__super__.constructor.call(this,n)}return n(o,t),o.prototype.on_ui_change=function(e,t){var n;if(n=t.clicked_val,n!==this._state)return i.get_controller(this.$bubble_picker).set_value(this._state),this.set_state(n)},o.prototype.update_picker_ui=function(){return i.get_controller(this.$bubble_picker).set_value(this._state)},o.prototype.limit_to_role=function(e,t){var n,o;if(null!=e){this.ensure_role_is_visible(e);for(n in d)o=d[n],o!==e&&o!==d.ALL&&i.get_controller(this.$bubble_picker).disable_option(o,t)}else for(n in d)o=d[n],i.get_controller(this.$bubble_picker).enable_option(o);return this._limit_to_role=e},o})(u),c=(function(e){function t(e,n){null==n&&(n={}),n.allow_merged_state=!1,t.__super__.constructor.call(this,e,n)}return n(t,e),t.prototype.on_state_change=function(e){var t;return t=(function(){switch(e){case d.PERSONAL:return"personal";case d.WORK:return"work"}})(),a.emit(t)},t})(p),{RolePickerState:d,RolePicker:u,RoleSelect:p,PageRoleSelect:c}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/payments/dfb_util",["external/underscore","modules/clean/ajax","modules/clean/payments/cash","modules/clean/payments/validation","modules/core/exception"],function(t,n,o,i,r){var s,a,l,c,assert;return s=o.Cash,assert=r.assert,c=(function(){function e(e,t,n,o,i,r,s){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=n,this.currencies=o,this.country_code=i,this.zip_code=r,this.vat_id=s,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}return e.prototype.set_only_license_count=function(e){var t;return t=Object.keys(this.license_ids_and_counts)[0],this.license_ids_and_counts[t]=e},e.prototype.get_only_license_count=function(){var e;return e=Object.keys(this.license_ids_and_counts)[0],this.license_ids_and_counts[e]},e.prototype.set_country_code=function(e){this.country_code=e},e.prototype.set_zip_code=function(e){this.zip_code=e},e.prototype.set_currencies=function(e){this.currencies=e},e.prototype.set_renew=function(e){this.renew=e},e.prototype.set_discount_ratio=function(e){this.discount_ratio=e},e.prototype.set_discount_allow_monthly=function(e){this.discount_allow_monthly=e},e.prototype.set_vat_id=function(e){return""!==e&&i.validateVat(this.country_code,e)?this.vat_id=e:this.vat_id=""},e.prototype.cache_key=function(e){var t;return null==e&&(e=!1),this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")},e.prototype.to_json=function(){var e;return e=this.renew?{renew:1}:{},e=t.extend(e,{plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly})},e.from_transition_view_models=function(n){var o,i,r,s,a,l,c,u,d,p,_,h,m,f,g,v,b,y,w,k,C,S,T,x;for(_=[],C=[],r=[],p=!1,i=!1,T=!1,x=!1,s=0,c=n.length;s<c;s++)if(S=n[s],_.push(S.state.plan.id),C.push(S.state.schedule.id),r.push(S.state.currency),p===!1){for(p={},h=S.state.allocated_licenses,a=0,u=h.length;a<u;a++)o=h[a],p[o.license_id]=o.license_count;i=null!=(m=S.read_only_invoice)?m.tax_country_code:void 0,T=null!=(f=null!=(g=S.read_only_invoice)?g.tax_exclusion_id:void 0)?f:null,x=null!=(v=S.read_only_invoice)?v.tax_zip_code:void 0}else{for(assert(S.state.allocated_licenses.length===Object.keys(p).length,"License sets differ"),b=S.state.allocated_licenses,l=0,d=b.length;l<d;l++)o=b[l],assert(o.license_id in p,"License sets differ"),assert(p[o.license_id]===o.license_count,"License count must match");assert(i===(null!=(y=S.read_only_invoice)?y.tax_country_code:void 0),"country codes must match"),assert(x===(null!=(w=S.read_only_invoice)?w.tax_zip_code:void 0),"zip codes must match"),assert(T===(null!=(k=S.read_only_invoice)?k.tax_exclusion_id:void 0),"VAT IDs must match")}return new e(t.uniq(_),t.uniq(C),p,t.uniq(r),i,x,T)},e})(),a=(function(){function e(e){var t,n;this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=s.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new s(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=s.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new s(0,this.transition_view_model.state.currency),this.recurring_total=s.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=s.fromObject(this.transition_view_model.prices.tax):this.tax=new s(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=s.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new s(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice&&(n=this.transition_view_model.read_only_invoice.line_items,t=n.length>0?n[0]:void 0,(null!=t?t.country_tax_percentage:void 0)?this.tax_percentage=t.country_tax_percentage:(null!=t?t.state_tax_percentage:void 0)&&(this.tax_percentage=t.state_tax_percentage))}return e})(),l=(function(){function t(t){this.default_transition_view_models=t,this._get_transition_info_for=e(this._get_transition_info_for,this),this._add_to_cache=e(this._add_to_cache,this),this.has_inflight_request=e(this.has_inflight_request,this),this.transition_view_model_requests={},this.transition_info_cache={},this._add_to_cache(this.default_transition_view_models)}return t.prototype.get=function(e,t,o){var i,r,s;return s=c.from_transition_view_models(this.default_transition_view_models),t.total_users&&s.set_only_license_count(t.total_users),t.country_code&&s.set_country_code(t.country_code),t.currency&&s.set_currencies([t.currency]),t.remove_currency&&s.set_currencies(),t.zip_code&&s.set_zip_code(t.zip_code),t.renew&&s.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&s.set_vat_id(t.vat_id),t.discount_ratio&&s.set_discount_ratio(t.discount_ratio),null!=t.discount_allow_monthly&&s.set_discount_allow_monthly(t.discount_allow_monthly),i=s.cache_key(),(r=this._get_transition_info_for(i))?void e(r):this.transition_view_model_requests[i]?void 0:(this.transition_view_model_requests[i]=!0,n.SilentBackgroundRequest({url:"/business/transition-model",type:"GET",dataType:"json",data:s.to_json(),success:(function(n){return function(o){var r;return delete n.transition_view_model_requests[i],r=n._add_to_cache(o,t.remove_currency),e(r)}})(this),error:(function(e){return function(t){return"function"==typeof o&&o(t),delete e.transition_view_model_requests[i]}})(this)}))},t.prototype.has_inflight_request=function(){return Object.keys(this.transition_view_model_requests).length},t.prototype._add_to_cache=function(e,t){var n,o,i;return null==t&&(t=!1),n=c.from_transition_view_models(e).cache_key(t),o=(function(){var t,n,o;for(o=[],t=0,n=e.length;t<n;t++)i=e[t],o.push(new a(i));return o})(),this.transition_info_cache[n]=o,o},t.prototype._get_transition_info_for=function(e){return e in this.transition_info_cache?this.transition_info_cache[e]:null},t})(),{DfBTransitionInfo:a,DfBTransitionInfoFetcher:l}})}.call(this),function(){define("modules/clean/photos/thumb_loading/batching_thumb_loader",["modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],function(e,t){var n;return n=t.load_individual_image,(function(){function t(){this.batch_thumb_loader=new e({})}return t.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},t.prototype.load_image=function(e,t,n,o,i,r){return this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:t,success:o,error:i,should_retry:r}),{onrequest:n,request_id:t}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},t.prototype._thumb_loaded=function(e,t){var o,i,r,s;return s=e.url,e.request_id,r=e.success,o=e.error,i=e.should_retry,0===t.indexOf("data:")?r(t):n(s,0,r,o,i)},t.prototype.cancel_thumb=function(e){return this.batch_thumb_loader.cancel_thumb(e)},t})()})}.call(this),function(){define("modules/clean/photos/thumb_store",["modules/constants/request","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store"],function(e,t,n){var o;return o=n.GenericThumbStore,function(n){var i,r,s,a;return i=null!=(r=(null!=n?n:{}).allow_http2)&&r,s=void 0,a=e.IS_HTTP2&&i,a||(s=new t),new o(s,!a)}})}.call(this),define("modules/clean/react/file_sidebar/comments_wrapper_component",["require","exports","tslib","external/react","modules/clean/activity/constants","modules/clean/comments/action_creators","modules/clean/comments/demo_action_creators","modules/clean/comments/store","modules/clean/react/css"],function(e,t,n,o,i,r,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(t){function l(n){var o=t.call(this,n)||this;return o.state={commentsLoaded:e.defined("modules/clean/comments/components/file_comments_pane_container")},o}return n.__extends(l,t),l.prototype.componentDidMount=function(){var t=this,n=this.state.commentsLoaded,o=this.props,i=o.hidePageChrome,r=o.isCommentsDemo;n||i&&!r||e(["modules/clean/comments/components/file_comments_pane_container"],function(){t.setState({commentsLoaded:!0})})},l.prototype.render=function(){var t=this.state.commentsLoaded,n=this.props,l=n.activityContext,c=n.currentFile,u=n.hideComments,d=n.hidePageChrome,p=n.isCommentsDemo,_=n.sharedLinkInfo,h=n.shouldInitiallyFocusInput,m=n.user,f=n.showToggleButton;if(u||d&&!p)return null;if(!t)return c.feedback_off||a.areCommentsHidden()?o.createElement("div",null):o.createElement("div",{id:"file-comments",className:"file-feedback"},o.createElement("div",{className:"comment-holder"}));var g=e("modules/clean/comments/components/file_comments_pane_container"),v=p?s:r,b=p?-1:m?m.id:void 0,y=null;switch(l){case i.ActivityContext.BROWSE_FILE_VIEWER:y=c.fq_path;break;case i.ActivityContext.SHARED_CONTENT_LINK_VIEW:case i.ActivityContext.SHARED_LINK_VIEW:_&&(y=_.url)}return o.createElement("div",{className:"react-file-viewer__activity"},o.createElement(g,{actionCreators:v,actorId:b,context:l,contextData:y,currentFile:c,isDemoMode:p,previewSelector:".react-file-viewer__preview .flex-preview-container",shouldInitiallyFocusInput:h,showToggleButton:f}))},l})(o.Component),u=["/static/css/comments-vflvX3CBI.css","/static/css/comments_annotations-vfl0leYfT.css","/static/css/file_comments_pane-vflFWelLX.css"]
;t.CommentsWrapperComponent=l(c,u)}),define("modules/clean/react/file_sidebar/file_sidebar",["require","exports","tslib","external/react","modules/clean/react/css","modules/constants/file_viewer","modules/clean/react/file_sidebar/comments_wrapper_component","modules/clean/react_logger","modules/clean/react/file_sidebar/store/file_activity/api"],function(e,t,n,o,i,r,s,a,l){"use strict";function c(e){return{activityContext:e.activityContext,hideComments:e.hideComments,hidePageChrome:e.hidePageChrome,isCommentsDemo:e.isCommentsDemo,shouldInitiallyFocusInput:e.shouldInitiallyFocusInput,currentFile:e.currentFile,sharedLinkInfo:e.sharedLinkInfo,user:e.user,showToggleButton:r.MAESTRO_ENABLED}}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){function i(n){var o=t.call(this,n)||this;return o._isMounted=!1,o.state={fileSidebarLoaded:e.defined("modules/clean/react/file_sidebar/file_sidebar_component")},o}return n.__extends(i,t),i.prototype.componentDidMount=function(){var t=this;this._isMounted=!0,this.state.fileSidebarLoaded||e(["modules/clean/react/file_sidebar/file_sidebar_component"],function(){t._isMounted&&t.setState({fileSidebarLoaded:!0})})},i.prototype.componentWillUnmount=function(){this._isMounted=!1},i.prototype.render=function(){if(this.state.fileSidebarLoaded){var t=e("modules/clean/react/file_sidebar/file_sidebar_component").FileSidebarComponent;return o.createElement(t,n.__assign({},this.props))}return o.createElement("div",{className:"file-sidebar"})},i})(o.Component);t.StormcrowedInFileSidebar=i(u,["/static/css/file-sidebar-vflZ15gef.css"]);var d=(function(e){function i(t){return e.call(this,"FileSidebar",t)||this}return n.__extends(i,e),i.prototype.componentDidMount=function(){!r.FILE_ACTIVITY_STREAM&&r.FILE_ACTIVITY_STREAM_DARK_LAUNCH&&this.props.user&&new l.FileActivityStreamApi(this.props.user.id).getActivityStream(this.props.currentFile.file_id)},i.prototype.render=function(){return r.FILE_ACTIVITY_STREAM&&r.MAESTRO_ENABLED?o.createElement(t.StormcrowedInFileSidebar,n.__assign({},this.props)):o.createElement(s.CommentsWrapperComponent,n.__assign({},c(this.props)))},i})(a.ReactLogger);t.FileSidebar=d}),define("modules/clean/react/file_viewer/container",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/clean/react/file_viewer/actions","modules/clean/react/file_viewer/file_viewer","modules/clean/react/open_in_app/actions","modules/clean/react_logger","modules/clean/sharing/async_share_modal_util"],function(e,t,n,o,i,r,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var n=e.call(this,"FileViewerContainer",t)||this;return n.onCloseViewer=function(){return window.open(n.props.onCloseUrl,"_self")},n}return n.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this);var t=this.props.sharedLinkInfo?[this.props.sharedLinkInfo]:[],n=this.props.shareToken?[this.props.shareToken]:[],o=this.props.sharePermissions?[this.props.sharePermissions]:[],i={sharedLinkInfos:t,shareTokens:n,sharePermissions:o,disableFlipping:!1};r.setup(this.props.files,this.props.currentIndex,this.props.user,i)},t.prototype.componentWillUnmount=function(){r.cleanup()},t.prototype.componentDidMount=function(){var t=this.props.shareEmail;if(t&&c.asyncShowPrefilledShareModal({user:this.props.user,sharePrefillEmail:t,content:new i.File(this.props.files[this.props.currentIndex])}),this.props.openImmediatelyInApp){var n=this.props.files[this.props.currentIndex];a.openImmediately(n.open_in_app_data)}e.prototype.componentDidMount.call(this)},t.prototype.render=function(){var e=this.props,t=e.fileViewerProps;return null!=e.onCloseUrl&&(t.onCloseViewer=this.onCloseViewer),o.createElement(s.FileViewer,n.__assign({},t))},t})(l.ReactLogger);t.FileViewerContainer=u}),function(){define("modules/clean/react/icon",["external/classnames","external/react","external/underscore","modules/clean/filepath","modules/clean/react/sprite"],function(e,t,n,o,i){var r,s,a,l,c,u,d;return u=o.file_icon,d=o.folder_icon,a=o.ICON_SIZES,c=t.createElement,l=t.createClass({displayName:"IconSprite",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,name:t.PropTypes.string.isRequired},getDefaultProps:function(){return{alt:"",className:""}},render:function(){return c(i,{alt:this.props.alt,className:e(["icon",this.props.className]),group:"web",name:this.props.name})}}),r=t.createClass({displayName:"FileIcon",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,file:t.PropTypes.shape({filename:t.PropTypes.string.isRequired}).isRequired,size:t.PropTypes.oneOf(n.values(a))},getDefaultProps:function(){return{className:"",size:a.LARGE}},render:function(){return c(l,{alt:this.props.alt,className:this.props.className,name:u(this.props.file.filename,{size:this.props.size})})}}),s=t.createClass({displayName:"FolderIcon",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,size:t.PropTypes.oneOf(n.values(a))},getDefaultProps:function(){return{className:"",size:a.LARGE}},render:function(){return c(l,{alt:this.props.alt,className:this.props.className,name:d({size:this.props.size})})}}),{FileIcon:r,FolderIcon:s,ICON_SIZES:a}})}.call(this),define("modules/clean/react/share_sync/actions",["require","exports","modules/clean/multiaccount_login","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/viewer"],function(e,t,n,o,i){"use strict";function r(e,t,r){new Promise(function(e,o){i.get_viewer().is_role_signed_in(t)?e():n.show_modal({role:t,on_success:function(){e()}})}).then(function(){o.mountSharedFolder(e,t,r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.syncToDropbox=r}),define("modules/clean/react/share_sync/button",["require","exports","tslib","external/react","modules/clean/react/bubble_menu","modules/clean/react/share_sync/models","modules/clean/sharing/constants","modules/clean/sharing/views/sync_coachmark","modules/clean/react/sprite_div","modules/clean/viewer","modules/core/i18n","modules/constants/payments"],function(e,t,n,o,i,r,s,a,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.options.map(function(e){return o.createElement(i.BubbleMenuItem,{onClick:function(){return e.handler()},disabled:e.isDisabled},o.createElement(l,{group:"web",name:e.spriteName,text:e.text}))});return o.createElement(i.BubbleMenu,{targetButton:this.props.targetButton,position:i.BubbleMenu.POSITIONS.BOTTOM,verticalDisplacement:4,items:e})},t})(o.Component),_=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler()},t.prototype.getSyncOptions=function(){var e=this,t=this.props.sharePermission.canSyncToDropboxRoles,n=c.get_viewer();return t.map(function(t){return r.ShareSyncActionOption.buildOption(e.props.folder,n,t,s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE)})},t.prototype.renderSyncCoachmark=function(){var e=this.props.sharePermission.canSyncToDropboxRoles.length>0;return this.props.showSyncCoachmark&&e?o.createElement("div",{className:"sync-button__coachmark-container"},o.createElement(a.SharingSyncCoachmark,null)):null},t.prototype.renderSyncButton=function(){var e=this;if(""!==this.props.shareToken.subPath)return null;if(0===this.props.sharePermission.canSyncToDropboxRoles.length)return null;var t="button-primary control__button sync-button";if(this.props.outOfQuota){var n=d.BUY_URL;return o.createElement("a",{className:t,href:n},u._("Upgrade to Add Folder"))}var i=u._("Add to Dropbox"),r=this.getSyncOptions();if(1===r.length)return o.createElement("button",{className:t,onClick:function(t){return e.onClickedOption(t,r[0])}},i);var s=o.createElement("button",{className:t},i);return o.createElement(p,{targetButton:s,folder:this.props.folder,shareToken:this.props.shareToken,options:r})},t.prototype.render=function(){return o.createElement("div",null,this.renderSyncCoachmark(),this.renderSyncButton())},t})(o.Component);t.ShareSyncButton=_}),define("modules/clean/react/share_sync/models",["require","exports","tslib","external/immutable","modules/clean/react/share_sync/actions","modules/core/i18n"],function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={text:void 0,handler:void 0,isDisabled:!1,spriteName:void 0},a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.buildOption=function(e,n,o,s){var a=r._("Save to my Dropbox"),l="dropbox";if(n.is_paired)switch(o){case"personal":a=r._("Save to personal Dropbox"),l="s_house";break;case"work":a=r._("Save to %(team_name)s Dropbox").format({team_name:n.team_name}),l="s_briefcase"}return new t({text:a,handler:function(){i.syncToDropbox(e.shared_folder_id,o,s)},spriteName:l})},t})(o.Record(s));t.ShareSyncActionOption=a}),define("modules/clean/react/shared_link/actions",["require","exports","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/core/browser"],function(e,t,n,o,i){"use strict";function r(e,t,i){return new Promise(function(r,s){return o.deleteLinkWithConfirmLegacy({client:new n.ShareApiClient({userId:e}),contentName:i,onCancel:s,onDeleteLink:r,tkey:t})})}function s(e,t,n){return r(e,t,n).then(function(){return i.redirect("/home")})}Object.defineProperty(t,"__esModule",{value:!0}),t.removeLink=r,t.removeLinkAsNonOwner=s}),define("modules/clean/react/shared_link_folder/actions",["require","exports","modules/clean/history","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/constants","modules/clean/react/shared_link_folder/dispatcher","modules/core/browser","modules/core/uri"],function(e,t,n,o,i,r,s,a){"use strict";function l(e){g("preview",e.filename)}function c(){v("preview")}function u(e){var t=a.parse(e.href);"lst"in m().getQuery()&&t.updateQuery({lst:""}),s.redirect(t.toString())}function d(){g("lst","")}function p(){v("lst")}function _(e,t,n,o,s,a){r.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.InitializeFolder,data:{files:e,fileSharePermissions:t,fileShareTokens:n,fileSharedLinkInfos:o,folders:s,takedownRequestType:a}})}function h(e){function t(n){r.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.FetchPageSuccess,data:n}),n.hasMoreEntries?o.fetchNextPage(e,n.nextRequestVoucher).then(t):r.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.LoadEnd})}r.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.LoadStart}),o.fetchFirstPage(e).then(t)}function m(){var e=a.parse(n.get_url());return e.setPath(a.encode_parts(e.getPath())),e}function f(e){n.push_state(e.getPath(),e.getQuery())}function g(e,t){var n={};n[e]=t;var o=m();o.updateQuery(n),f(o)}function v(e){var t=m();t.removeQuery(e),f(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.openFile=l,t.closeFile=c,t.openFolder=u,t.enableListMode=d,t.disableListMode=p,t.initializeFolder=_,t.loadFolder=h}),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","external/react","external/underscore","modules/clean/history","modules/clean/react/file_viewer/actions","modules/clean/react/file_viewer/file_viewer","modules/clean/react/open_in_app/actions","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/page","modules/clean/react/shared_link_folder/store","modules/clean/react_logger","modules/constants/python","modules/core/browser","modules/core/exception","modules/core/uri"],function(e,t,n,o,i,r,s,a,l,c,u,d,p,_,h,m,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){function t(t){var n=e.call(this,"SharedLinkFolderApp",t)||this;n.onUpdateFromStore=function(){if(n.setState(n.getStateFromStore()),n.state.isViewingFile){var e=g.parse(m.get_href()),t=e.getQuery(),o=t.preview;setTimeout(function(){n.setupFileViewer(o)},0)}},n.onLocationChange=function(e,t){var o=t.preview,r={isViewingFile:!!o,shouldForceListMode:"lst"in t};r.isViewingFile&&!n.state.isViewingFile&&n.setupFileViewer(o),i.isMatch(n.state,r)||n.setState(r)};var o=[],r=[],s=[],a=[],l=[];return n.props.contents&&(o=n.props.contents.files,r=n.props.contents.fileSharePermissions,s=n.props.contents.fileShareTokens,a=n.props.contents.fileSharedLinkInfos,l=n.props.contents.folders),n.state={isViewingFile:!1,shouldForceListMode:!1,files:o,fileSharePermissions:r,fileShareTokens:s,fileSharedLinkInfos:a,folders:l,isLoading:!1,takedownRequestType:n.props.takedownRequestType},n.hasAlreadyRendered=!1,n}return n.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this);var t=g.parse(m.get_href());if(this.onLocationChange(t.getPath(),t.getQuery()),this.props.openImmediatelyInApp&&this.openImmediatelyInApp(),this.unsubscribe=p.sharedLinkFolderStore.addListener(this.onUpdateFromStore),this.props.contents){var n=this.props.contents,o=n.files,i=n.fileSharePermissions,r=n.fileShareTokens,s=n.fileSharedLinkInfos,a=n.folders;u.initializeFolder(o,i,r,s,a,this.props.takedownRequestType)}else u.loadFolder(this.props.folderShareToken)},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.getStateFromStore=function(){return{files:p.sharedLinkFolderStore.getFiles(),fileSharedLinkInfos:p.sharedLinkFolderStore.getFileSharedLinkInfos(),fileShareTokens:p.sharedLinkFolderStore.getFileShareTokens(),fileSharePermissions:p.sharedLinkFolderStore.getFileSharePermissions(),folders:p.sharedLinkFolderStore.getFolders(),isLoading:p.sharedLinkFolderStore.getIsLoading(),takedownRequestType:p.sharedLinkFolderStore.getTakedownRequestType()}},t.prototype.openImmediatelyInApp=function(){try{this.props.folder.open_in_app_data&&l.openImmediately(this.props.folder.open_in_app_data)}catch(e){}},t.prototype.componentDidMount=function(){r.add_callback("/sh",this.onLocationChange,!0),r.add_callback("/scl",this.onLocationChange,!0),this.hasAlreadyRendered=!0,e.prototype.componentDidMount.call(this)},t.prototype.setupFileViewer=function(e){var t,n,o,r,a,l;if(a=i.find(this.state.files,function(t){return t.filename===e}))t=this.state.files,n=this.state.fileSharePermissions,o=this.state.fileShareTokens,r=this.state.fileSharedLinkInfos,l=t.indexOf(a);else{f.assert(!!this.props.preview,"no preview data available");var c=this.props.preview;a=c.file,f.assert(a.filename===e,"preview data does not match desired file"),t=[a],n=[c.sharePermission],o=[c.shareToken],r=[c.sharedLinkInfo],l=0}s.setup(t,l,this.props.user,{sharedLinkInfos:r,shareTokens:o,sharePermissions:n})},t.prototype.render=function(){if(this.state.isViewingFile){var e=this.hasAlreadyRendered?c.PreviewSourceAction.CLICK:c.PreviewSourceAction.VISIT;return o.createElement(a.FileViewer,{accountMenuOptions:this.props.accountMenuOptions,activityContext:this.props.activityContext,fileViewOrigin:this.props.fileViewOrigin,fileViewTarget:this.props.fileViewTarget,fileViewAction:h.FileViewActionType.CLICK,initialPreviewSourceContext:c.PreviewSourceContext.SHARED_LINK_FOLDER,initialPreviewSourceAction:e,skipOuterRouting:!0,canClose:!0,onCloseViewer:u.closeFile})}var t={files:this.state.files,folders:this.state.folders};return o.createElement(d.SharedLinkFolderPage,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,folderSharedLinkInfo:this.props.folderSharedLinkInfo,folderShareToken:this.props.folderShareToken,folderSharePermission:this.props.folderSharePermission,isLoading:this.state.isLoading,contents:t,user:this.props.user,outOfQuota:this.props.outOfQuota,shouldForceListMode:this.state.shouldForceListMode,showSyncCoachmark:this.props.showSyncCoachmark,takedownRequestType:this.state.takedownRequestType,membershipRequestOptions:this.props.membershipRequestOptions})},t})(_.ReactLogger);t.SharedLinkFolderApp=v}),define("modules/clean/react/shared_link_folder/controls",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/react/account_menu/account_menu","modules/clean/react/file_action_button","modules/clean/react/deprecated/copyright_flag","modules/clean/react/open_in_app/button","modules/clean/react/share_download/button","modules/clean/react/share_sync/button","modules/clean/react/shared_link/actions","modules/clean/react/shared_link_folder/more_dropdown","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/dropdown","modules/clean/react/user_notifications/constants","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,o,i,r,s,a,l,c,u,d,p,_,h,m,f,g,v,b,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.removeShareLink=function(e){e.preventDefault();var n=t.props.sharePermission.canRemoveLinkUids[0],o=t.props.shareToken.linkKey,i=t.props.shareToken.displayName;p.removeLinkAsNonOwner(n,o,i)},t}return n.__extends(t,e),Object.defineProperty(t.prototype,"canRemoveLink",{get:function(){return this.props.sharePermission.canRemoveLinkUids.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canSyncToDropbox",{get:function(){return this.props.sharePermission.canSyncToDropboxRoles.length>0},enumerable:!0,configurable:!0}),t.prototype.renderSyncButton=function(){if(this.canSyncToDropbox)return i.createElement(d.ShareSyncButton,{folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.sharedLinkInfo,sharePermission:this.props.sharePermission,shareToken:this.props.shareToken,showSyncCoachmark:this.props.showSyncCoachmark})},t.prototype.renderDownloadButton=function(){return i.createElement(u.ShareDownloadButton,{fileOrFolder:this.props.folder,sharedLinkInfo:this.props.sharedLinkInfo,shareToken:this.props.shareToken,sharePermissions:this.props.sharePermission})},t.prototype.renderDivider=function(){if(this.props.user)return i.createElement("div",{className:"react-title-bar__divider"})},t.prototype.renderUserNotificationsDropdown=function(){if(this.props.user)return i.createElement(m.UserNotificationsDropdown,{isPagelet:!1,bellDesign:f.BellDesignTypes.GRAY_ICON})},t.prototype.shouldShowOpenInAppButton=function(){return!!this.props.folder.open_in_app_data},t.prototype.renderOpenInAppButton=function(){return this.shouldShowOpenInAppButton()?i.createElement(c.OpenInAppButton,{urls:this.props.folder.open_in_app_data}):null},t.prototype.renderReportFlag=function(){return this.props.sharedLinkInfo.hasPublicAudienceOrVisibility!==!1?i.createElement(l.CopyrightFlag,{shareToken:this.props.shareToken}):null},t.prototype.renderUserControls=function(){return this.props.user?this.renderAccountMenu():this.renderSignIn()},t.prototype.renderAccountMenu=function(){var e=r.extend({},this.props.accountMenuOptions,{isAccountPhotoEnabled:!0,isToolbarAccountPhotoEnabled:!0,user:this.props.user,viewer:g.get_viewer()});return i.createElement(s.AccountMenu,n.__assign({},e))},t.prototype.renderSignIn=function(){var e=new y({path:"/login",query:{cont:v.get_href()}}),t=o({"button-primary":!this.shouldShowOpenInAppButton(),"button-secondary":this.shouldShowOpenInAppButton()},"sign-in-link","control__button");return i.createElement("a",{className:t,href:e.toString()},b._("Sign in"))},t.prototype.renderMoreButton=function(){if(this.canRemoveLink)return i.createElement(_.MoreDropdown,null,i.createElement(a.FileActionButton,{className:"more-button__remove",type:a.FileActionButtonType.REMOVE_LINK,callback:this.removeShareLink}))},t.prototype.render=function(){return i.createElement(h.TitleBarControlsContainer,null,this.renderReportFlag(),this.renderOpenInAppButton(),this.renderUserControls(),this.renderSyncButton(),this.renderDownloadButton(),this.renderMoreButton(),this.renderDivider(),this.renderUserNotificationsDropdown())},t})(i.Component);w.displayName="SharedLinkFolderControls",t.SharedLinkFolderControls=w}),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","external/react","modules/clean/datetime","modules/clean/em_string","modules/clean/react/css","modules/clean/react/icon","modules/clean/react/shared_link_folder/actions","modules/clean/react/thumbnail","modules/clean/react_logger","modules/core/i18n","modules/core/uri"],function(e,t,n,o,i,r,s,a,l,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.entries.map(function(e){return e.is_dir?o.createElement(v,{key:e.filename,folder:e}):o.createElement(b,{key:e.filename,file:e})});return o.createElement(h,null,o.createElement(m,null),o.createElement(f,null,e))},t})(u.ReactLogger);_.displayName="SharedLinkFolderList",t.SharedLinkFolderList=s(_,["/static/css/scooter/scooter-scoped-vflm9UP03.css"]);var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-list-container"},this.props.children)},t})(o.Component);h.displayName="ListContainer";var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-list-header"},o.createElement("div",{className:"sl-list-row clearfix"},o.createElement("div",{className:"sl-list-column sl-list-column--filename"},d._("Name")),o.createElement("div",{className:"sl-list-column sl-list-column--modified"},d._("Modified",{comment:"label for last modified time"}))))},t})(o.Component);m.displayName="ListHeader";var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("ol",{className:"sl-list-body o-list-ui o-list-ui--dividers"},this.props.children)},t})(o.Component);f.displayName="ListBody";var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),t.props.onClick()},t}return n.__extends(t,e),t.prototype.getName=function(){return r.em_snippet(this.props.name,40)},t.prototype.getLastModified=function(){var e=this.props.lastModified;return e?i.format_date(e,i.localized_datetime_format):"--"},t.prototype.render=function(){return o.createElement("li",{className:"sl-list-row clearfix"},o.createElement("div",{className:"sl-list-column sl-list-column--filename"},o.createElement("a",{href:this.props.href,onClick:this.onClick,className:"sl-file-link"},o.createElement("div",{className:"o-flag"},o.createElement("div",{className:"o-flag__fix"},this.props.icon),o.createElement("div",{className:"o-flag__flex"},this.getName())))),o.createElement("div",{className:"sl-list-column sl-list-column--modified"},this.getLastModified()))},t})(o.Component);g.displayName="ListItem";var v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return o.createElement(a.FolderIcon,null)},t.prototype.render=function(){var e=this,t=p.parse(this.props.folder.href).updateQuery({lst:""}),n=t.toString();return o.createElement(g,{icon:this.renderIcon(),name:this.props.folder.filename,href:n,onClick:function(){return l.openFolder(e.props.folder)}})},t})(o.Component);v.displayName="FolderListItem";var b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return o.createElement(c.ThumbnailIcon,{alt:this.props.file.filename,file:this.props.file})},t.prototype.render=function(){var e=this;return o.createElement(g,{icon:this.renderIcon(),name:this.props.file.filename,bytes:this.props.file.bytes,lastModified:new Date(1e3*this.props.file.ts),href:this.props.file.href,onClick:function(){return l.openFile(e.props.file)}})},t})(o.Component);b.displayName="FileListItem"}),define("modules/clean/react/shared_link_folder/more_dropdown",["require","exports","tslib","external/react","modules/clean/react/bubble_menu","modules/clean/react/file_viewer/more_dropdown/icon","modules/clean/react/title_bubble","modules/core/i18n"],function(e,t,n,o,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMenuItems=function(){var e;return e=this.props.children instanceof Array?this.props.children:[this.props.children],e.filter(function(e){return!!e})},t.prototype.renderButton=function(e){var t=(void 0===e?{}:e).isDisabled,n=void 0!==t&&t;return o.createElement("button",{className:"more-button sprite-button",disabled:n,"aria-label":a._("More actions")},o.createElement(r.MoreDropdownIcon,null))},t.prototype.renderDisabledMenu=function(){return this.renderButton({isDisabled:!0})},t.prototype.renderMenu=function(e){return o.createElement(s,{content:a._("More"),distanceFromTarget:this.props.tooltipOffset,isTargetPositionFixed:!0,position:this.props.tooltipPosition},o.createElement(i.BubbleMenu,{className:"react-file-viewer-dropdown react-file-viewer-more-dropdown",items:e,position:this.props.menuPosition,targetButton:this.renderButton(),targetFixed:!0,verticalDisplacement:this.props.menuOffset}))},t.prototype.render=function(){var e=this.getMenuItems();return o.createElement("div",{className:"u-mar-left-xs"},e.length>0?this.renderMenu(e):this.renderDisabledMenu())},t})(o.Component);l.displayName="MoreDropdown",l.defaultProps={menuOffset:4,menuPosition:i.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,tooltipOffset:10,tooltipPosition:s.POSITIONS.BOTTOM},t.MoreDropdown=l}),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","external/react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/css","modules/clean/em_string","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/shared_link_folder/title_bar","modules/clean/react/takedown_warning","modules/clean/react_logger","modules/clean/sharing/constants","modules/clean/static_urls","modules/clean/teams/membership_request_block","modules/clean/web_timing_logger","modules/constants/python","modules/core/i18n","modules/core/uri"],function(e,t,n,o,i,r,s,a,l,c,u,d,p,_,h,m,f,g,v,b,y,w,k){"use strict";function C(e,t){return s.compare(e.sort_key,t.sort_key,1)}Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){function t(n){var o=e.call(this,t.displayName,n)||this;return o.state={viewMode:o.getViewMode(n.shouldForceListMode)},o}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming(),e.prototype.componentDidMount.call(this)},t.prototype.componentWillReceiveProps=function(e){this.setState({viewMode:this.getViewMode(e.shouldForceListMode)})},t.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},t.prototype.ensureWebTimingMarked=function(){var e=this.props.contents,t=e.files,n=e.folders,o=!this.props.isLoading,i=t.length>0||n.length>0;(o||i)&&(b.mark_time_to_view(),b.mark_time_to_interactive())},t.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===f.TOKEN_LINK_TYPE.SHARED_CONTENT_LINK){var e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-b.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",f.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}},t.prototype.getViewMode=function(e){return e?p.ViewMode.List:p.ViewMode.Grid},t.prototype.getTakedownWarning=function(){if(this.props.takedownRequestType)return o.createElement("div",{className:"sl-takedown-warning"},o.createElement(h,{type:this.props.takedownRequestType}))},t.prototype.getTitle=function(){return l.em_snippet(this.props.folderShareToken.displayName,35)},t.prototype.getContentOwner=function(){var e=this.props.folderSharedLinkInfo,t=e.ownerName,n=e.ownerTeamName,i=e.ownerTeamLogo;if(n){var r;if(i){var s=new k({scheme:"https",authority:"www.dropbox.com",path:"/business",query:{src:"schmodel"}});r=o.createElement("span",null," via ",o.createElement("a",{href:s.toString()},y.TRADEMARK_BUSINESS))}var a="";return a=t?w._("from %(owner)s (%(team)s)").format({owner:t,team:n}):w._("from %(team)s").format({team:n}),o.createElement("span",{className:"sl-title-owner"}," ",a,r)}},t.prototype.getEntries=function(){return(new Array).concat(this.props.contents.folders).concat(this.props.contents.files).sort(C)},t.prototype.getContentsCount=function(){return this.props.contents.folders.length+this.props.contents.files.length},t.prototype.getViewToggleOption=function(){return this.state.viewMode===p.ViewMode.Grid?o.createElement(p.FolderViewToggleOption,{isSelected:!1,icon:"list_light",iconSelected:"list_dark",label:w._("View as list"),onClick:c.enableListMode}):o.createElement(p.FolderViewToggleOption,{isSelected:!1,icon:"grid_light",iconSelected:"grid_dark",label:w._("View as grid"),onClick:c.disableListMode})},t.prototype.getBody=function(){if(0===this.getContentsCount()&&!this.props.isLoading)return o.createElement(L,null);var e,t,n=this.getEntries();return this.state.viewMode===p.ViewMode.Grid?e=o.createElement(u.SharedLinkFolderGrid,{entries:n}):t=o.createElement(d.SharedLinkFolderList,{entries:n}),o.createElement(P,null,e,t,this.getViewToggleOption())},t.prototype.getLoadingIndicator=function(){var e;return this.props.isLoading&&(e=o.createElement("div",{className:"sl-loading-indicator"},o.createElement(r,{style:r.LoadingIndicatorStyle.BLUE_SPINNER}))),e},t.prototype.render=function(){return o.createElement(T,null,o.createElement(x,null,o.createElement(_.SharedLinkFolderTitleBar,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.folderSharedLinkInfo,shareToken:this.props.folderShareToken,sharePermission:this.props.folderSharePermission,showSyncCoachmark:this.props.showSyncCoachmark,user:this.props.user})),o.createElement(O,null,o.createElement(I,null,o.createElement(E,null,this.getTakedownWarning(),this.getTitle(),this.getContentOwner())),this.getBody(),this.getLoadingIndicator()),o.createElement(v.MembershipRequestBlock,{membershipRequestOptions:this.props.membershipRequestOptions}))},t})(m.ReactLogger);S.displayName="SharedLinkFolderPage",S.defaultProps={shouldForceListMode:!1},t.SharedLinkFolderPageWithoutCss=S,t.SharedLinkFolderPage=a(S,["/static/css/react_title_bar-vflaxQoBf.css","/static/css/react_file_viewer-vflr58C-t.css"]);var T=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-page-container"},this.props.children)},t})(o.Component);T.displayName="PageContainer";var x=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-page-header"},this.props.children)},t})(o.Component);x.displayName="PageHeader";var O=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-page-body"},this.props.children)},t})(o.Component);O.displayName="PageBody";var I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-header clearfix"},this.props.children)},t})(o.Component);I.displayName="FolderHeader";var E=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}
return n.__extends(t,e),t.prototype.render=function(){return o.createElement("h3",{className:"sl-title"},this.props.children)},t})(o.Component);E.displayName="FolderTitle";var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-body"},this.props.children)},t})(o.Component);P.displayName="FolderBody";var L=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:"sl-body sl-body--empty-folder"},o.createElement("img",{className:"sl-empty-folder-icon",src:g.static_url("/static/images/icons128/folder-vfl8tOYL3.png"),alt:""}),o.createElement("h3",{className:"sl-empty-folder-message"},w._("This folder is empty")))},t})(m.ReactLogger);L.displayName="EmptyFolderBody"}),define("modules/clean/react/shared_link_folder/title_bar",["require","exports","tslib","external/react","modules/clean/react/file_viewer/size_class_constants","modules/clean/react/shared_link_folder/controls","modules/clean/react/title_bar/base","modules/clean/react_logger"],function(e,t,n,o,i,r,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(t){return e.call(this,"SharedLinkFolderTitleBar",t)||this}return n.__extends(t,e),t.prototype.renderControls=function(){return o.createElement(r.SharedLinkFolderControls,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.sharedLinkInfo,shareToken:this.props.shareToken,sharePermission:this.props.sharePermission,showSyncCoachmark:this.props.showSyncCoachmark,user:this.props.user})},t.prototype.render=function(){var e=this.props.sharedLinkInfo&&this.props.sharedLinkInfo.ownerTeamLogo;return o.createElement(s.TitleBarBase,{controls:this.renderControls(),customLogoUrl:e,sizeClass:i.SizeClass.Large})},t})(a.ReactLogger);t.SharedLinkFolderTitleBar=l}),function(){define("modules/clean/react/takedown_warning",["external/react","modules/clean/react_format","modules/clean/react_logger","modules/constants/python","modules/core/i18n"],function(e,t,n,o,i){var r,s,a,l,c,u,d;return u=t.reactFormat,r=n.ReactLogger,s=o.TakedownRequestTypes,a=i._,d=e.DOM,l=d.a,c=d.div,e.createClass({displayName:"TakedownWarning",propTypes:{type:e.PropTypes.number},componentWillMount:function(){return r.start(this.constructor.displayName)},componentDidMount:function(){return r.end(this.constructor.displayName)},_getWarningMessage:function(){switch(this.props.type){case s.DMCA:return u(a("Certain files in this folder can’t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"),{a:l({target:"_top",href:"/help/210"})});default:return u(a("Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."),{a:l({target:"_top",href:"/ticket"})})}},render:function(){return c({className:"notify server-success"},this._getWarningMessage())}})})}.call(this),function(){define("modules/clean/react/thumbnail",["external/classnames","external/react","external/underscore","modules/clean/photos/thumb_store","modules/clean/react/icon","modules/clean/react/sprite","modules/clean/static_urls","modules/constants/python","modules/core/uri"],function(e,t,n,o,i,r,s,a,l){var c,u,d,p,_,h,m,f,g,v,b,y,w,k;return u=i.FileIcon,i.ICON_SIZES,y=s.static_url,_=a.THUMBNAIL_SIZE_MODE,c=y("/static/images/preview_fail-vflc3IDxf.png"),d=y("/static/images/icons/ajax-loading-small-blue-vflm7vRcz.gif"),p="178x178",b=t.DOM.img,g=t.createElement,w=new o,f=t.PropTypes.shape({isLoading:t.PropTypes.bool.isRequired,src:t.PropTypes.string}),h=t.createClass({displayName:"Thumbnail",propTypes:{alt:t.PropTypes.string.isRequired,className:t.PropTypes.string,thumbnail:f.isRequired,onClick:t.PropTypes.func,shouldFadeIn:t.PropTypes.bool},_getSrc:function(){return this.props.thumbnail.src?this.props.thumbnail.src:this.props.thumbnail.isLoading?this.props.shouldFadeIn?void 0:d:c},_getAlt:function(){return this.props.shouldFadeIn?this.props.thumbnail.isLoading?"":this.props.alt:this.props.alt},render:function(){var t,n,o;return o={},o[""+this.props.className]=null!=this.props.className,t=o,this.props.shouldFadeIn&&(t["thumbnail-image"]=!0,t["thumbnail-image--loaded"]=!this.props.thumbnail.isLoading),t["thumbnail-image--failed"]=!this.props.thumbnail.src&&!this.props.thumbnail.isLoading,n={onClick:this.props.onClick,src:this._getSrc(),alt:this._getAlt(),className:e(t)},b(n)}}),m=t.createClass({displayName:"ThumbnailIcon",propTypes:{alt:t.PropTypes.string.isRequired,className:t.PropTypes.string,file:t.PropTypes.object.isRequired,thumbnail:f.isRequired,iconSize:t.PropTypes.string},render:function(){var t;return this.props.thumbnail.src?(t=["icon","thumbnail-image--loaded",this.props.className],b({alt:this.props.alt,className:e(t),src:this.props.thumbnail.src})):(t=["icon","thumbnail-image--failed",this.props.className],g(u,{alt:this.props.alt,className:e(t),file:this.props.file,size:this.props.iconSize}))}}),v=function(e){var t;if(e)return t=l.parse(e),t.updateQuery("size",p),t.updateQuery("size_mode",_.EXACT),t.toString()},k=function(e){var o,i,r;return o=null!=(i=e.displayName)?i:"UnnamedComponent",r="ThumbnailLoader("+o+")",t.createClass({displayName:r,propTypes:{file:t.PropTypes.shape({thumbnail_url_tmpl:t.PropTypes.string}).isRequired},getInitialState:function(){return this._getStateForTemplateUrl(this.props.file.thumbnail_url_tmpl)},componentDidMount:function(){return this._bindThumbStore()},componentWillReceiveProps:function(e){var t;if(t=e.file.thumbnail_url_tmpl,t!==this.props.file.thumbnail_url_tmpl)return this.setState(this._getStateForTemplateUrl(t))},componentWillUpdate:function(){return this._unbindThumbStore()},componentDidUpdate:function(){return this._bindThumbStore()},componentWillUnmount:function(){return this._unbindThumbStore()},_getStateForTemplateUrl:function(e){var t,n,o;return o=v(e),o&&(n=w.get_thumb(o)),t=Boolean(o)&&!Boolean(n),{isLoading:t,src:n,url:o}},_bindThumbStore:function(){var e;if(this.state.isLoading&&!this._bindingId)return e=this.state.url,this._bindingId=w.bind_url(e,{onSuccess:(function(t){return function(){return t.setState({isLoading:!1,src:w.get_thumb(e)})}})(this),onError:(function(e){return function(){return e.setState({isLoading:!1})}})(this)})},_unbindThumbStore:function(){if(this._bindingId)return w.unbind_url(this._bindingId),delete this._bindingId},render:function(){return g(e,n.extend(n.clone(this.props),{thumbnail:{isLoading:this.state.isLoading,src:this.state.src}}))}})},{Thumbnail:k(h),ThumbnailIcon:k(m)}})}.call(this),function(){define("modules/clean/sharing/notifications",["jquery","modules/clean/browse_interface","modules/clean/sharing/api/client","modules/clean/viewer","modules/constants/payments","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,o,i,r,s,a,l){var c,u,d,p,_,h;return u=n.ShareApiClient,c=n.FolderShareApiClient,d=s._,p=function(t){var n,o;return n=e(t).closest("form"),null!=(o=n.closest(".sc-invite-action"))&&o.addClass("loading"),n.length&&new u({userId:n[0]._subject_uid.value}).dismissInviteNotification({contentId:n[0].content_id.value}).finally(function(){return n.closest(".sc-invite-action").removeClass("loading"),n.closest(".feed-row").remove()}),!1},_=function(n){var i,s;return i=e(n),i.closest(".sc-invite-action").addClass("loading"),s=o.get_viewer().get_user_by_id(n._subject_uid.value),new c({userId:s.id}).mount({contentId:n.sf_id.value,origin:"NOTIFICATION_WEB"}).then(function(e){var n,o,c;return n=i.closest(".sc-invite-action"),n.addClass("sf-mounted"),o=e.path_lower,c=l({path:t.get_browse_root(s)+o}).toString(),r.redirect(c),a.success(d("Added the shared folder %(folder_name)s.").format({folder_name:e.name}))}).finally(function(){return i.closest(".sc-invite-action").removeClass("loading")}),!1},h=function(){var e,t;return a.info(d("Continue upgrading to add the shared folder to your Dropbox.")),e=i.BUY_URL,t=l({scheme:"https",authority:"www.dropbox.com",path:e}),t.updateQuery({cont:"sf",oqa:"sf_aoq_b_n"}),r.redirect(t.toString()),!1},{register_dismiss:p,register_mount:_,upgrade_to_mount:h}})}.call(this),function(){define("modules/clean/sharing/views/sync_coachmark",["external/react","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/button","modules/clean/react/css","modules/clean/react/image","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,o,i,r,s,a){var l,c,u,d,p,_;return o.button,o.link_button,_=s.static_url,p=e.DOM,d=e.createElement,c=a.i18n_default_project("sharing")._,u=e.createClass({displayName:"SharingSyncCoachmark",getInitialState:function(){return{show:!0}},componentWillMount:function(){return t.BackgroundRequest({url:"/sharing/seen_sync_coachmark"})},render:function(){return this.state.show?d(n,{arrow:n.ARROW.TOP_RIGHT,className:"sync-coachmark u-pad-s"},d(r,{className:"u-l-ib",src:_("/static/images/sharing/sync_coachmark-vflyzarQZ.png"),srcHiRes:_("/static/images/sharing/sync_coachmark@2x-vflMrQ12G.png")}),p.div({className:"u-l-ib u-pad-left-s sync-coachmark__content"},p.h2({},c("Stay in sync")),p.p({},c("For easy access to this folder in the future, add it to your Dropbox.")),p.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(){return e.setState({show:!1})}})(this)},c("Got it")))):p.div({})}}),l=i(u,["/static/css/sharing/sync_coachmark-vfl_8vkAL.css"]),{SharingSyncCoachmark:l}})}.call(this),define("modules/clean/teams/limited_team_invite_form",["require","exports","tslib","external/classnames","external/react","modules/core/uri","modules/core/i18n","modules/clean/react_format","modules/clean/ajax","modules/clean/css","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input"],function(e,t,n,o,i,r,s,a,l,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=i.DOM,h=p.textarea,m=(function(){function e(){this.inFlight=!0,this.canInvite=!1,this.reason="checking",this.callbacks=[]}return e.prototype.whenReady=function(e){this.inFlight?this.callbacks.push(e):e()},e.prototype.resultArrived=function(e,t){if(this.inFlight){this.inFlight=!1,this.canInvite=e,this.reason=t;for(var n=0,o=this.callbacks;n<o.length;n++){(0,o[n])()}this.callbacks=[]}},e})(),f=(function(){function e(e){var t=this;this.checkEmails=function(e,n){var o={},i=e.length;if(0===i)return n(o);for(var r=[],s=function(e){var s=t.checkedEmails[e];s||(s=t.checkedEmails[e]=new m,r.push(e)),s.whenReady(function(){o[e]=s,0===--i&&n(o)})},a=0,c=e;a<c.length;a++){s(c[a])}(function(e){l.WebRequest({url:t.checkUrl,data:{emails:e.join(",")},success:function(e){var n=JSON.parse(e);for(var o in n)if(n[o]){var i=n[o],r=i.can_invite,s=i.reason;t.checkedEmails[o]&&t.checkedEmails[o].resultArrived(r,s)}},error:function(){for(var n=0,o=e;n<o.length;n++){var i=o[n];delete t.checkedEmails[i]}}})})(r)},this.getEmailCheckResult=function(e){return t.checkedEmails[e]},this.checkUrl=e,this.checkedEmails={}}return e})();t.InvitationContexts={existingTeam:{id:"existingTeam",checkUrl:"/team/manage/check_can_invite"},createLimitedTeam:{id:"createLimitedTeam",checkUrl:"/team/create_limited/check_can_invite"}};var g={};for(var v in t.InvitationContexts)if(t.InvitationContexts[v]){var b=t.InvitationContexts[v],y=b.id,w=b.checkUrl;g[y]=new f(w)}var k=(function(e){function t(t){var n=e.call(this,t)||this;return n._isUnMounted=!1,n.getContacts=function(){return n.refs.tokenizer.getContacts()},n.getFinalData=function(e){var t;n.refs.tokenizer.tokenizeAll();var o=n.getContacts();n.props.includeCustomMessage&&(t=n.refs.customMessage.getValue()),n._ensureContactsStateUpdated(o,function(){var i=o.filter(function(e){return e.type===d.EMAIL}),r=i.map(function(e){return e.email});n._updateErrorMessage(),e({emails:r,custom_message:t})})},n.areAllContactsValid=function(){if(n._overInviteLimit())return!1;var e=n.refs.tokenizer.serializeInputData().tokens;return 0===e.length||e.every(function(e){return n._validateContact(e).state===u.ContactTokenState.ok})},n.isEmpty=function(){var e=n.refs.tokenizer.serializeInputData(),t=e.tokens,o=e.value;return 0===t.length&&0===o.length},n._ensureContactsStateUpdated=function(e,t){e=e.filter(function(e){return e.type===d.EMAIL&&!e.invalid&&!e.on_team});var o=e.map(function(e){return e.email});n.state.emailCheckerStore.checkEmails(o,function(){n._isUnMounted||t()})},n._validateContact=function(e){var t;if(e.invalid)t={state:u.ContactTokenState.invalid,msg:s._("Invalid email.")};else if(e.on_team)t={state:u.ContactTokenState.invalid,msg:s._("User is already a member of this team.")};else{var o=n.state.emailCheckerStore.getEmailCheckResult(e.email),i=null;o?o.inFlight?t={state:u.ContactTokenState.pending,msg:i}:o.canInvite?t={state:u.ContactTokenState.ok,msg:i}:("team_member"===o.reason?i=s._("This person is already on another team."):"already_on_this_team"===o.reason?i=s._("User is already invited to this team."):"error"===o.reason&&(i=s._("User isn’t eligible to join this team.")),t={state:u.ContactTokenState.invalid,msg:i}):t={state:u.ContactTokenState.invalid,msg:i}}return t},n._overInviteLimit=function(){var e=n.refs.tokenizer.serializeInputData().tokens;return void 0!==n.props.memberInviteLimit&&e.length>n.props.memberInviteLimit},n._updateErrorMessage=function(){for(var e=0,t=n.refs.tokenizer.serializeInputData().tokens;e<t.length;e++){var o=t[e],i=n._validateContact(o),l=i.state,c=i.msg;if(l!==u.ContactTokenState.ok)return void n.setState({errorMessage:c})}if(n._overInviteLimit()){var d={tk:String(n.props.maxTeamSize),_camp:"invite"},p=new r({path:"/team/upgrade",query:d});return void n.setState({errorMessage:a.reactFormat(s.ungettext("You have %(num_rem)s invite remaining. <upgradeLink>Upgrade</upgradeLink> now to add as   many members as you like to your team.","You have %(num_rem)s invites remaining. <upgradeLink>Upgrade</upgradeLink> now to add as   many members as you like to your team.",n.props.memberInviteLimit),{num_rem:n.props.memberInviteLimit,upgradeLink:_.a({href:p.toString()})})})}n.setState({errorMessage:null})},n.onContentsChange=function(e,t){n._ensureContactsStateUpdated(e,function(){n._updateErrorMessage(),n.props.onChange&&n.props.onChange()})},n._customContactFilter=function(e){return!(e.type!==d.EMAIL||e.team||!e.name||e.email===n.props.user.email)},n.state={errorMessage:null,emailCheckerStore:n.props.emailCheckerStore||g[n.props.invitationContext.id]},n}return n.__extends(t,e),t.prototype.componentWillMount=function(){var e=this;c.require_css("/static/css/teams/limited_team_invite_form-vflcSjpys.css"),c.require_css("/static/css/react/contacts_tokenizer-vflry-iG9.css"),this.props.populatedContacts&&this.props.populatedContacts.length>0&&this._ensureContactsStateUpdated(this.props.populatedContacts,function(){e._updateErrorMessage(),e.props.onChange&&e.props.onChange()})},t.prototype.componentDidUnMount=function(){this._isUnMounted=!0},t.prototype.render=function(){var e,t={"limited-team-invite-form":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage};return this.props.includeCustomMessage&&(e=i.createElement(h,{ref:"customMessage",className:"custom-message","disable-errors":!0,placeholder:this.props.messagePlaceholder,value:this.props.populatedCustomMessage})),i.createElement("div",{className:o(t,this.props.customClass)},i.createElement("div",{className:"error-message u-mar-bottom-xss"},this.props.customErrorMessage||this.state.errorMessage),i.createElement(u.ContactsTokenizer,{ref:"tokenizer",user:this.props.user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:this.props.autofocusTokenizer,populatedInputData:{tokens:this.props.populatedContacts,value:""},tokenSpacing:this.props.tokenSpacing,customContactValidator:this._validateContact,customContactFilter:this._customContactFilter}),e)},t})(i.Component);k.displayName="LimitedTeamInviteForm",k.defaultProps={customClass:"",invitationContext:t.InvitationContexts.existingTeam,populatedContacts:[],emailPlaceholder:s._("Name or email"),messagePlaceholder:s._("Add a message (optional)"),includeCustomMessage:!0,autofocusTokenizer:!0},t.LimitedTeamInviteForm=k}),function(){define("modules/clean/teams/membership_request_block",["external/react","jquery","modules/clean/analytics","modules/clean/avatar/triple_avatars","modules/clean/loggers/growth_features_events_logger","modules/clean/react/button","modules/clean/react/css","modules/clean/react_logger","modules/clean/teams/membership_discovery_util","modules/clean/viewer","modules/constants/python","modules/constants/teams","modules/core/browser","modules/core/cookies","modules/core/i18n","modules/core/notify","modules/core/user_i18n"],function(e,t,n,o,i,r,s,a,l,c,u,d,p,_,h,m,f){var g,v,b,y,w,k,C,S,T,x;return n.TeamsWebActionsLogger,y=o.TripleAvatars,r.button,b=a.ReactLogger,T=l.sendTeamRequest,u.TRADEMARK_BUSINESS,C=e.createElement,S=e.DOM,x=c.get_viewer(),g="_MRBD",w=h.i18n_default_project("sharing")._,k=e.createClass({displayName:"MembershipRequestBlock",propTypes:{membershipRequestOptions:e.PropTypes.shape({canRequestToJoin:e.PropTypes.bool,contacts:e.PropTypes.arrayOf(e.PropTypes.object),limited:e.PropTypes.bool,id:e.PropTypes.int,name:e.PropTypes.string,nsId:e.PropTypes.int,size:e.PropTypes.int})},getDefaultProps:function(){return{membershipRequestOptions:{canRequestToJoin:!1}}},getInitialState:function(){return{isUnloaded:"true"===_.read(g)}},componentWillMount:function(){return b.start(this.constructor.displayName)},componentDidMount:function(){var e,t,n,o,r,s,a,l,c,u,d;return d=this.state.isUnloaded,(null!=(n=this.props.membershipRequestOptions)?n.canRequestToJoin:void 0)&&!d&&(t=(null!=(o=x.personal_user)?o.paid:void 0)?"plus":"basic",e={is_limited:null!=(r=this.props.membershipRequestOptions)?r.limited:void 0,ns_id:null!=(s=this.props.membershipRequestOptions)?s.nsId:void 0,receiver_email_domain:null!=(a=x.personal_user)&&null!=(l=a.email)?l.split("@")[1]:void 0,receiver_plan_type:t,requested_team_id:null!=(c=this.props.membershipRequestOptions)?c.id:void 0,sender_team_name:this.props.membershipRequestOptions.name,size:null!=(u=this.props.membershipRequestOptions)?u.size:void 0},i.logMagnetEvent("request_banner_shown",e)),b.end(this.constructor.displayName)},render:function(){var e,t;return(null!=(e=this.props.membershipRequestOptions)?e.canRequestToJoin:void 0)?this.state.isUnloaded?S.div({}):S.div({className:"membership-request-block u-pad-top-m"},S.div({className:"membership-request-block__close",onClick:this.onCloseClick}),S.div({className:"u-mar-top-m"},S.div({className:"membership-request-block__avatars"},C(y,{contacts:this.props.membershipRequestOptions.contacts,count:this.props.membershipRequestOptions.size})),S.div({},S.div({className:"membership-request-block__header u-mar-top-m"},w("Join %(name)s and your coworkers on the %(team_name)s Dropbox team").format({name:null!=(t=this.props.membershipRequestOptions.contacts[0])?t.display_name:void 0,team_name:this.props.membershipRequestOptions.name})),this.props.membershipRequestOptions.limited?S.div({className:"membership-request-block__subheader u-mar-top-xs"}):S.div({className:"membership-request-block__subheader u-mar-top-xs"},w("Unlock business tools and get more space for sharing and collaboration—ask your admin to add you to the %(team_name)s team.").format({team_name:this.props.membershipRequestOptions.name}))),S.button({className:"c-btn c-btn--primary c-btn--big u-mar-top-l",onClick:this.onRequestClick},w(this.props.membershipRequestOptions.limited?"Join the team":"Request to join")))):S.div({})},requestMembership:function(){return T(this.props.membershipRequestOptions.id)},onRequestClick:function(){var e,t,n,o,r,s,a,l,c;return t=(null!=(n=x.personal_user)?n.paid:void 0)?"plus":"basic",e={is_limited:null!=(o=this.props.membershipRequestOptions)?o.limited:void 0,ns_id:null!=(r=this.props.membershipRequestOptions)?r.nsId:void 0,receiver_email_domain:null!=(s=x.personal_user)&&null!=(a=s.email)?a.split("@")[1]:void 0,receiver_plan_type:t,requested_team_id:null!=(l=this.props.membershipRequestOptions)?l.id:void 0,size:null!=(c=this.props.membershipRequestOptions)?c.size:void 0},i.logMagnetEvent("request_banner_CTA_clicked",e),this.requestMembership(),this.setState({isUnloaded:!0})},onCloseClick:function(){var e,t,n,o,r,s,a,l,c;return t=(null!=(n=x.personal_user)?n.paid:void 0)?"plus":"basic",e={is_limited:null!=(o=this.props.membershipRequestOptions)?o.limited:void 0,ns_id:null!=(r=this.props.membershipRequestOptions)?r.nsId:void 0,receiver_email_domain:null!=(s=x.personal_user)&&null!=(a=s.email)?a.split("@")[1]:void 0,receiver_plan_type:t,requested_team_id:null!=(l=this.props.membershipRequestOptions)?l.id:void 0,size:null!=(c=this.props.membershipRequestOptions)?c.size:void 0},i.logMagnetEvent("request_banner_removed",e),_.create(g,"true"),this.setState({isUnloaded:!0})}}),v=s(k,["/static/css/scooter/scooter-scoped-vflm9UP03.css","/static/css/teams/membership_request_block-vfly7tYHH.css"]),{MembershipRequestBlock:v}})}.call(this),function(){define("modules/clean/teams/modals/suggest_team_invite_modal",["external/react","external/underscore","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/analytics","modules/clean/ajax","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/teams/limited_team_invite_form","modules/clean/react/modal","modules/clean/react/input","modules/clean/viewer"],function(e,t,n,o,i,r,s,a,l,c,u,d,p){var _,h,m,f,g,v,b,y,w;return b=o._,v=r.TeamsWebActionsLogger,_=a.Contact,m=c.LimitedTeamInviteForm,h=c.InvitationContexts,f=u.Modal,e.DOM,y=e.PropTypes,w=p.get_viewer(),g=e.createClass({displayName:"SuggestTeamInviteModal",statics:{showIfNeeded:function(n,o){return g.showInviteModal(function(i){return i?g.validateSuggestions(n,function(i){var r;return i.length>0?("function"==typeof o.onCheckCompleted&&o.onCheckCompleted(!0),o=t.extend({},o,{usersSharedOnFolder:n.emails,suggestedUsersToInviteToTeam:i}),r=e.createElement(g,o),f.showInstance(r)):"function"==typeof o.onCheckCompleted?o.onCheckCompleted(!1):void 0}):"function"==typeof o.onCheckCompleted?o.onCheckCompleted(!1):void 0})},validateSuggestions:function(e,t){return s.WebRequest({url:"/team/validate_emails_to_suggest_inviting",data:{emails_to_verify:JSON.stringify(e.emails)},success:function(e){return e=JSON.parse(e),t(e)}})},showInviteModal:function(e){var t;return(null!=(t=w.work_user)?t.is_team:void 0)?g._getShouldShowInviteModalData(function(t){return e(t.isOnLimitedTeam&&!t.hasSeenSuggestTeamInviteModal)}):e(!1)},_getShouldShowInviteModalData:function(e){return s.WebRequest({url:"/team/should_show_invite_modal",success:function(t){return t=JSON.parse(t),e(t)}})}},propTypes:{sharingType:y.string.isRequired,suggestedUsersToInviteToTeam:y.arrayOf(y.string).isRequired,usersSharedOnFolder:y.arrayOf(y.string),teamName:y.string,onDidAccept:y.func,onDidDismiss:y.func,onDidClose:y.func},getDefaultProps:function(){return{onDidAccept:function(){},onDidDismiss:function(){},teamName:w.team_name}},getInitialState:function(){return{canAccept:this.props.suggestedUsersToInviteToTeam.length>0,submitting:!1,errors:null}},_canAccept:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onAccept:function(e){return this.refs.members.getFinalData((function(e){return function(o){var r,a,l;if(l=o.emails,a=o.custom_message,r=e._canAccept(),e.setState({canAccept:r}),r)return e.setState({submitting:!0}),s.WebRequest({url:"/account/team/add_users",subject_user:w.work_user,data:{emails:l,custom_message:a,team_id:w.team_id},complete:function(){if(null!=e.refs.modal)return e.setState({submitting:!1})},success:function(n){var o,r,s,a;return n=JSON.parse(n),s=t.values(n.users),a=void 0,1===s.length?a=b("Member invited."):s.length>1&&(a=b("Members invited.")),a?(i.success(a),v.log("team_member_invited_to_team_while_sharing",{sharing_type:e.props.sharingType,num_users_invited_to_team:null!=l?l.length:void 0}),"function"==typeof(o=e.props).onDidAccept&&o.onDidAccept(),e.refs.modal.close(),"function"==typeof(r=e.props).onDidClose?r.onDidClose():void 0):i.error(b("There was a problem completing this request."))},error:function(e){return"rate-limit"===e.getResponseHeader("x-dropbox-app-error")?i.error(new n(b('%(team_name)s has reached the maximum number of team members allowed on Dropbox Basic. Please <a href="/business/contact">contact sales</a> to add more members to your team.').format({team_name:w.team_name}))):i.error(b("There was a problem completing this request."))}})}})(this))},onDidDismiss:function(){var e,t;return"function"==typeof(e=this.props).onDidDismiss&&e.onDidDismiss(),"function"==typeof(t=this.props).onDidClose?t.onDidClose():void 0},onMembersFormChange:function(){return this.setState({canAccept:this._canAccept()})},componentDidMount:function(){var e,t;return v.log("team_member_saw_suggestions_while_sharing",{sharing_type:this.props.sharingType,num_users_shared:null!=(e=this.props.usersSharedOnFolder)?e.length:void 0,num_users_suggested_to_team:null!=(t=this.props.suggestedUsersToInviteToTeam)?t.length:void 0}),s.WebRequest({url:"/team/saw_suggest_team_invite_modal"})},render:function(){var t,n;return n=function(){var e,n,o,i;for(o=this.props.suggestedUsersToInviteToTeam,i=[],e=0,n=o.length;e<n;e++)t=o[e],i.push(new _({email:t,type:l.EMAIL}));return i}.call(this),e.createElement(f,{className:"suggest-team-invite-modal",title:b("Do you want to invite these people to join your “%(team_name)s” team?").format({team_name:this.props.teamName}),acceptButtonText:b("Invite"),dismissButtonText:b("No thanks"),acceptButtonDisabled:!this.state.canAccept,submitting:this.state.submitting,onAccept:this.onAccept,onDismissCompleted:this.onDidDismiss,autoClose:!1,ref:"modal"},e.createElement(m,{ref:"members",errorMessageSpaceFixed:!0,invitationContext:h.existingTeam,onChange:this.onMembersFormChange,user:w.work_user,populatedContacts:n,autofocusTokenizer:!0}))}})})}.call(this),function(){define("modules/clean/top_notif",["jquery","modules/clean/ajax"],function(e,t){var n,o,i,r,s,a,l,c;return l={HIDE_EVENT:"db:topnotificationbar:hide",hide:function(t){var n,o;if(n=null==(o=(null!=t?t:{clearPageletCache:!0}).clearPageletCache)||o,e("#top-notification-bar-container").remove(),e(".top-notification-bar-silo").remove(),e("body").removeClass("top-notification-bar"),e(".maestro .has-top-notification").removeClass("has-top-notification"),e(".maestro #notify-wrapper.with-top-notification").removeClass("with-top-notification"),e(document).trigger(this.HIDE_EVENT),n&&window.ensemble&&window.ensemble.clearPageletCache)return window.ensemble.clearPageletCache()}},o={init:function(){return e(".eu-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_eu_cookie_notification"})})}},r={init:function(){return e(".expired-ios-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_expired_ios_notification"})})}},s={init:function(){return e("#locale-switch-banner-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_locale_switch_banner"})})}},a={init:function(){return e("#super-inactive-recover-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_super_inactive_recover_bar"})})}},c={init:function(){return e("#unsupported-browser-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_browser_msg"})})}},i={init:function(n){return e(".expired-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_expired_cc_notification",data:{source:n}})})}},n={init:function(n){return e(".beta-locale-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_beta_locale_notification",data:{source:n}})})}},{TopNotificationBar:l,EUCookieNotificationBar:o,ExpiredIOSNotificationBar:r,LocaleSwitchBar:s,SuperInactiveRecoverBar:a,UnsupportedBrowser:c,ExpiredCCNotificationBar:i,BetaLocaleNotificationBar:n}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/dirty/growth/shared_link_signup_modals",["dropbox","jquery","modules/clean/ajax","modules/clean/sharing/signup_modal_proxy","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/login_form","modules/clean/dbmodal","modules/clean/growth/experiments/logger","modules/clean/register_form"],function(t,n,o,i,r,s,a,l,c,u,d,p,_){var h,m,f,g,v;return f=t.SharingModel,v=s._,g=c.WebMiscActivityLogger,h=d.DBModal,m=_.RegisterForm,(function(){function t(t){this.kind=t,this.register_success=e(this.register_success,this),this.show_login_form=e(this.show_login_form,this),this.save_to_dropbox=e(this.save_to_dropbox,this),this.direct_download=e(this.direct_download,this),this.handle_default_modal_cancel=e(this.handle_default_modal_cancel,this),this.handle_default_modal_authenticate=e(this.handle_default_modal_authenticate,this),this.handle_direct_download_cancel=e(this.handle_direct_download_cancel,this),this.handle_direct_download=e(this.handle_direct_download,this),this.on_request_default_signup=e(this.on_request_default_signup,this),this.on_request_direct_download=e(this.on_request_direct_download,this),this.show_create_password_modal=e(this.show_create_password_modal,this),this.show_welcome_modal=e(this.show_welcome_modal,this),this.before_create_password_modal=e(this.before_create_password_modal,this),this.before_download_signup_modal=e(this.before_download_signup_modal,this),this.before_default_signup_modal=e(this.before_default_signup_modal,this),this.before_signup_modal=e(this.before_signup_modal,this),this.init_modals=e(this.init_modals,this),this.init_modals(),i.connectModal(this),"immediate"===this.kind&&(g.log("signup_modal-show-upfront",{auth_google:null!=n.find(".auth-google")}),this.default_signup_modal.show()),"download"!==this.kind?(n("#download_button_link, #default_content_download_button").click(this.direct_download),this.has_seen_modal=!0):n("#download_button_link, #default_content_download_button").click((function(e){return function(){return e.has_seen_modal?e.direct_download():(e.has_seen_modal=!0,g.log("signup_modal-show-download",{auth_google:null!=n.find(".auth-google")}),e.download_type="direct_download",e.download_signup_modal.show())}})(this)),n(".add_to_my_dropbox_link, #default_content_a2md").click((function(e){return function(){return e.download_type="add_to_dropbox",e.download_signup_modal.show()}})(this))}return t.prototype.init_modals=function(){return this.default_signup_modal=new h({element_id:"shared-link-immediate-signup-modal"}),this.default_signup_modal.before_show=this.before_default_signup_modal,this.default_signup_modal.on_hide=(function(e){return function(){if(!e._has_authenticated)return"function"==typeof e._on_default_modal_cancel?e._on_default_modal_cancel():void 0}})(this),this.download_signup_modal=new h({element_id:"shared-link-download-signup-modal"}),this.download_signup_modal.before_show=this.before_download_signup_modal,this.download_signup_modal.on_hide=(function(e){return function(){if(!e._direct_download_started)return"function"==typeof e._on_direct_download_cancel?e._on_direct_download_cancel():void 0}})(this),this.welcome_modal=new h({element_id:"shared-link-welcome-modal"}),this.welcome_modal.before_show=this.before_welcome_modal,this.create_password_modal=new h({element_id:"shared-link-create-password-modal"}),this.create_password_modal.before_show=this.before_create_password_modal},
t.prototype.before_signup_modal=function(e){var t,n;if(e.find(".toggle-form-link").click((function(t){return function(){return t.toggle_form(e)}})(this)),n=e.find(".register-form"),n.length&&(n.on(m.NEW_ACCOUNT_FROM_3RD_PARTY,(function(t){return function(n,o){return t.profile_info=o,t.show_create_password_modal(e,t.profile_info)}})(this)),n.on(m.USER_EXISTS,(function(t){return function(n){return t.show_login_form(e,n)}})(this)),n.on(m.REGISTER_SUCCESS,(function(e){return function(t,n){return e.user_info=n,e.register_success(e.user_info)}})(this))),t=e.find(".login-form"),t.length)return t.on(u.LOGIN_SUCCESS,(function(e){return function(t,n){return e.user_info=n,a.success(v("Successfully signed in to Dropbox")),e.download_type?"direct_download"===e.download_type?(e.direct_download(),e.reload()):"add_to_dropbox"===e.download_type?e.save_to_dropbox(!1):void 0:e.reload()}})(this))},t.prototype.before_default_signup_modal=function(e){return this.before_signup_modal(e),e.find(".close-link").click((function(e){return function(){return e.default_signup_modal.hide()}})(this))},t.prototype.before_download_signup_modal=function(e){return this.before_signup_modal(e),this._direct_download_started=!1,"add_to_dropbox"===this.download_type&&(e.find(".login-form-component").is(":visible")||this.toggle_form(e)),e.find(".close-link").click((function(e){return function(){return e.direct_download(),e.download_signup_modal.hide()}})(this))},t.prototype.before_create_password_modal=function(e){var t,n;return e.find(".close-link").click((function(e){return function(){return e.create_password_modal.hide()}})(this)),t=e.find(".create-password-form-component"),n=t.find(".register-form"),n.on(m.REGISTER_SUCCESS,(function(e){return function(t,n){return e.user_info=n,e.register_success(e.user_info)}})(this))},t.prototype.before_welcome_modal=function(e){return p.log("sharing","shared_link_welcome_modal_view"),e.find(".go-to-dropbox-button").click(function(){return p.log("sharing","shared_link_welcome_modal_button_click")}),e.find(".welcome-modal-no-thanks a").click(function(){return r.reload()})},t.prototype.show_welcome_modal=function(){return this.default_signup_modal.hide(),this.download_signup_modal.hide(),this.welcome_modal.show()},t.prototype.show_create_password_modal=function(e,t){var n;return this.default_signup_modal.hide(),this.download_signup_modal.hide(),n={".input-fname":this.profile_info.fname,".input-lname":this.profile_info.lname,".input-email":this.profile_info.email,"input[name=email_sig]":this.profile_info.email_sig,"input[name=refresh_token]":this.profile_info.refresh_token},this.create_password_modal.show("input[name=password]",n)},t.prototype.on_request_direct_download=function(){return this.has_seen_modal?this.direct_download():(this.has_seen_modal=!0,g.log("signup_modal-show-download",{auth_google:null!=n.find(".auth-google")}),this.download_type="direct_download",this.download_signup_modal.show())},t.prototype.on_request_default_signup=function(){return this.download_type="add_to_dropbox",this._has_authenticated=!1,this.default_signup_modal.show()},t.prototype.handle_direct_download=function(e){return this._direct_download_override_callback=e},t.prototype.handle_direct_download_cancel=function(e){return this._on_direct_download_cancel=e},t.prototype.handle_default_modal_authenticate=function(e){return this._on_default_modal_authenticate=e},t.prototype.handle_default_modal_cancel=function(e){return this._on_default_modal_cancel=e},t.prototype.direct_download=function(){var e;return this._direct_download_started=!0,null!=this._direct_download_override_callback?void this._direct_download_override_callback():(e=r.get_uri().updateQuery({dl:1}),r.redirect(e))},t.prototype.reload=function(){return r.reload()},t.prototype.save_to_dropbox=function(e){var t;return null!=this._on_default_modal_authenticate?(this._on_default_modal_authenticate(this.user_info.id),this._has_authenticated=!0,void this.default_signup_modal.hide()):(e||a.success(v("Saving to your Dropbox ...")),t=f.c2d_vars,t.job=f.is_folder,o.WebRequest({url:f.c2d_url,data:t,subject_user:this.user_info.id,success:function(t){if(!e)return a.success(v("Successfully saved to your Dropbox.")),r.redirect(t)}}))},t.prototype.show_login_form=function(e,t){var n,o,i,r,s;o=e.find(".login-form-component"),i=o.find(".login-form"),r=t.prefill;for(n in r)s=r[n],i.find(n).val(s);if(i.find(t.focus).focus(),!o.is(":visible"))return this.toggle_form(e,!0)},t.prototype.toggle_form=function(e,t){var o,i;return i=e.find(".register-form-component"),o=e.find(".login-form-component"),i.is(":visible")?i.fadeOut({complete:function(){if(o.show(),null!=t)return setTimeout(function(){return n(o.find(".login-form .login-password input[name='login_password']")[0]).focus()},0)}}):o.fadeOut({complete:function(){return i.show()}})},t.prototype.register_success=function(e){return a.success(v("Successfully signed up for Dropbox.")),this.download_type?"direct_download"===this.download_type?(this.direct_download(),this.show_welcome_modal()):"add_to_dropbox"===this.download_type?this.save_to_dropbox(!1):void 0:this.show_welcome_modal()},t})()})}.call(this);
//# sourceMappingURL=pkg-legacy-aa.min.js-vflE5jM9X.map