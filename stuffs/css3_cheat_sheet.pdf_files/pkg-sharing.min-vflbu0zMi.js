(function(){define("modules/clean/avatar/faceholder",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/clean/react/image","modules/clean/static_urls"],function(e,t,n,r,s,o){var a,i,l,d,c;return i=t.VALID_AVATAR_DIMENSIONS,d=n.getClassName,c=o.static_url,l=e.DOM,a=e.createClass({displayName:"Faceholder",propTypes:{alt:e.PropTypes.string,dimension:e.PropTypes.oneOf(i).isRequired,onClick:e.PropTypes.func,optionalClass:e.PropTypes.string},statics:{SRC_MAP:{16:c("/static/images/avatar/faceholder-16-vflzvFMED.png"),24:c("/static/images/avatar/faceholder-24-vflpqFBTK.png"),32:c("/static/images/avatar/faceholder-32-vflKWtuU5.png"),48:c("/static/images/avatar/faceholder-48-vfll8Voom.png"),64:c("/static/images/avatar/faceholder-64-vflHTEplh.png")},SRC_HI_RES_MAP:{16:c("/static/images/avatar/faceholder-16@2x-vflBZ7FgU.png"),24:c("/static/images/avatar/faceholder-24@2x-vflVegRLu.png"),32:c("/static/images/avatar/faceholder-32@2x-vflYmh947.png"),48:c("/static/images/avatar/faceholder-48@2x-vflUglZDR.png"),64:c("/static/images/avatar/faceholder-64@2x-vfl8eFSM8.png")}},componentDidMount:function(){return r.require_css("/static/css/scooter/scooter-scoped-vflm9UP03.css")},render:function(){var t,n;return t=["c-avatar--circle"],this.props.optionalClass&&t.push(this.props.optionalClass),n=e.createElement(s,{alt:this.props.alt||"",src:a.SRC_MAP[this.props.dimension],srcHiRes:a.SRC_HI_RES_MAP[this.props.dimension]}),null!=this.props.onClick&&this.props.alt?(t.push("u-unbutton"),l.button({className:d(this.props.dimension,t),onClick:this.props.onClick},n)):l.div({className:d(this.props.dimension,t),onClick:this.props.onClick},n)}})})}).call(this),function(){define("modules/clean/avatar/inherited_count_avatar",["external/classnames","external/react","modules/clean/react/css"],function(e,t,n){var r,s;return s=t.DOM,r=t.createClass({displayName:"InheritedMemberCountAvatar",propTypes:{inheritedMemberCount:t.PropTypes.number.isRequired,onClick:t.PropTypes.func},render:function(){var t;return t=e({"inherited-count-avatar u-pad-horizontal-xxs":!0}),null!=this.props.onClick?s.button({className:t,onClick:this.props.onClick},this.props.inheritedMemberCount):s.div({className:t},this.props.inheritedMemberCount)}}),r=n(r,["/static/css/avatar_list-vflqJbKZr.css","/static/css/scooter/scooter-scoped-vflm9UP03.css"])})}.call(this),function(){define("modules/clean/avatar/list",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css"],function(e,t,n,r,s,o){var a,i,l,d;return i=s.VALID_AVATAR_DIMENSIONS,l=t.createElement,d=t.DOM,a=t.createClass({displayName:"HorizontalAvatarList",propTypes:{avatars:t.PropTypes.array.isRequired,avatarDimension:t.PropTypes.oneOf(i).isRequired,maxVisible:t.PropTypes.number.isRequired,undisplayableCount:t.PropTypes.number.isRequired,onOverflowCountClick:t.PropTypes.func,overflowCountRenderer:t.PropTypes.func,animation:t.PropTypes.bool,inheritedCountAvatar:t.PropTypes.node,className:t.PropTypes.string,reverseAvatars:t.PropTypes.bool},getDefaultProps:function(){return{className:"",inheritedCountAvatar:null}},_defaultRenderOverflowCount:function(e){return l(r,{count:e,dimension:this.props.avatarDimension,key:"overflow_pill:"+e,onClick:this.props.onOverflowCountClick})},render:function(){var t,n,r,s,o;return t=this.props.avatars,n=this.props.maxVisible,r=0,this.props.undisplayableCount&&(r+=this.props.undisplayableCount),(this.props.undisplayableCount||t.length>n)&&(n--,r+=t.length-n,t=t.slice(0,n)),r&&(o=null!=(s=this.props.overflowCountRenderer)?s:this._defaultRenderOverflowCount,t.push(o(r))),this.props.reverseAvatars&&t.reverse(),d.div({className:e({"c-facepile":!0})},[this.props.inheritedCountAvatar?d.div({className:"u-l-ib u-mar-right-xxs",key:"inherited_count"},this.props.inheritedCountAvatar):void 0,d.div({className:this.getClassName(),key:"facepile"},t)])},getClassName:function(){return e(["horizontal-avatar-list",this.props.className,this.props.animation?["animation","is-animated"]:null])}}),a=o(a,["/static/css/avatar_list-vflqJbKZr.css"])})}.call(this),function(){define("modules/clean/avatar/overflow_count_pill",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/core/i18n"],function(e,t,n,r,s){var o,a,i,l;return o=t.VALID_AVATAR_DIMENSIONS,i=n.getClassName,l=s.ungettext,a=e.DOM,e.createClass({displayName:"OverflowCountPill",propTypes:{dimension:e.PropTypes.oneOf(o).isRequired,count:e.PropTypes.number.isRequired,onClick:e.PropTypes.func},componentDidMount:function(){return r.require_css("/static/css/scooter/scooter-scoped-vflm9UP03.css")},render:function(){var e,t;return t=" +"+this.props.count+" ",e=l("%(count)s more member","%(count)s more members",this.props.count).format({count:this.props.count}),null!=this.props.onClick?a.button({className:i(this.props.dimension,["overflow-pill c-avatar--meta u-unbutton"]),onClick:this.props.onClick},a.span({"aria-hidden":!0},t),a.span({className:"ax-visually-hidden"},e)):a.div({className:i(this.props.dimension,["overflow-pill c-avatar--meta"])},a.span({"aria-hidden":!0},t),a.span({className:"ax-visually-hidden"},e))}})})}.call(this),function(){define("modules/clean/avatar/shared_link_avatar",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,r,s,o){var a,i,l,d,c;return a=t.VALID_AVATAR_DIMENSIONS,d=n.getClassName,c=s.static_url,i=o._,l=e.DOM,e.createClass({displayName:"SharedLinkAvatar",propTypes:{alt:e.PropTypes.string,dimension:e.PropTypes.oneOf(a).isRequired,isMaestroDesign:e.PropTypes.bool,onClick:e.PropTypes.func,optionalClass:e.PropTypes.string},componentDidMount:function(){return r.require_css("/static/css/scooter/scooter-scoped-vflm9UP03.css")},render:function(){var e,t,n;return n=l.img({src:c("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||i("Shared link"),width:12,className:this.props.isMaestroDesign?"u-mar-horizontal-xs":void 0}),e=["c-avatar--meta"],null!=this.props.optionalClass&&e.push(this.props.optionalClass),null!=this.props.onClick&&e.push("u-unbutton"),t=d(this.props.dimension,e),null!=this.props.onClick?l.button({className:t,onClick:this.props.onClick},n):l.div({className:t,onClick:this.props.onClick},n)}})})}.call(this),function(){define("modules/clean/avatar/triple_avatars",["external/react","modules/clean/ajax","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,r,s,o,a,i,l){var d,c,p,u,m;return d=o.AVATAR_DIMENSION_BY_SIZE,u=e.createElement,m=e.DOM,p=e.createClass({displayName:"TripleAvatars",getPropTypes:function(){return{contacts:e.PropTypes.arrayOf(e.PropTypes.shape({email:e.PropTypes.string,display_name:e.PropTypes.string,photo_url:e.PropTypes.string})),count:e.PropTypes.integer}},getAvatar:function(e){return u(n,{dimension:d.XLARGE,photoUrl:e.photo_url,defaultAvatar:u(r,{dimension:d.XLARGE,shape:"CIRCLE",initials:l.getInitials(e.display_name),name:e.display_name})})},render:function(){var e;return this.props.contacts&&0!==this.props.contacts.length?(e=this.props.contacts.length,this.props.count&&this.props.count>this.props.contacts.length&&(e=this.props.count),m.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,3===e?this.getAvatar(this.props.contacts[2]):e>3?u(s,{dimension:d.XLARGE,count:e-2}):void 0)):m.div({})}}),c=a(p,["/static/css/scooter/scooter-scoped-vflm9UP03.css"]),{TripleAvatars:c}})}.call(this),function(){define("modules/clean/clipboard",["jquery","modules/clean/static_urls","modules/core/dom","external/swfobject"],function(e,t,n,r){var s,o,a,i,l;return l=t.static_url,o=function(){var e,t;return e=(new Date).getTime(),t=("00000"+Math.floor(1e6*Math.random())).slice(-6),"swf_"+e+"_"+t},a=function(e,t){return e.on("mouseover",function(){return t.addClass("hovered")}),e.on("mousedown",function(){return t.addClass("pressed")}),e.on("mouseout",function(){return t.removeClass("hovered pressed")}),e.on("mouseup",function(){return t.removeClass("pressed")})},i=function(e,t){return window.ClipboardSWFRegister=window.ClipboardSWFRegister||{},window.ClipboardSWFRegister[e]=function(){return t()},"ClipboardSWFRegister."+e},s=function(t,s,d,c){var p,u,m;return null==d&&(d=null),null==c&&(c=null),c=c||e(document.body),m=o(),p=e("<div />",{id:"flash_copy_container"}).append(e("<div />",{id:m})).css({position:"absolute",zIndex:1}),a(p,s),c.append(p),n.clone_position(p,s,{}),u=i(m,d),window.copyLoaded=(function(n){return function(){var n;return n=e("#"+m)[0],n.setCopyText(t),n.setCallbackFunction(u)}})(this),r.embedSWF(l("/static/swf/copy_clipboard-vflvMcZTC.swf"),m,"100%","100%","6.0.65",!1,!1,{wmode:"transparent",scale:"exactfit",allowScriptAccess:"always"}),p},{clipboard_overlay:s}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/clipboard_v2",["jquery","external/flash_detect","external/react","modules/core/browser","modules/core/exception","modules/clean/clipboard"],function(t,n,r,s,o,a){return o.assert,(function(){function r(t,n,r,s){this.copyText=t,this.onSuccess=n,this.onError=r,this.clickHandler=s,this.do_copy=e(this.do_copy,this)}return r.prototype.setupCopy=function(e,n){var s,o,i;if(s=t(n),o=t(e),!r.is_flashless_clipboard_supported())return i=(function(e){return function(){return"function"==typeof e.onSuccess&&e.onSuccess(),"function"==typeof e.clickHandler?e.clickHandler():void 0}})(this),a.clipboard_overlay(this.copyText,o,i,s)},r.prototype.do_copy=function(){var e;if(r.is_supported())return r.is_flashless_clipboard_supported()?(e=document.execCommand("copy",!1),e?"function"==typeof this.onSuccess?this.onSuccess():void 0:"function"==typeof this.onError?this.onError():void 0):void 0},r.is_supported=function(){return r.is_flashless_clipboard_supported()||n.installed},r.is_flashless_clipboard_supported=function(){var e;return e=parseInt(s.version),s.chrome?e>=42:s.mozilla?e>=41:s.opera?e>=29:s.msie?e>=9:!!s.edge||!!s.safari&&e>=10},r})()})}.call(this),function(){define("modules/clean/components/title_bubble",["jquery","external/classnames","external/react","external/react-dom","modules/clean/react/css"],function(e,t,n,r,s){var o,a;return a=n.DOM,o=n.createClass({displayName:"TitleBubble",propTypes:{text:n.PropTypes.string.isRequired,direction:n.PropTypes.oneOf(["north","south","east","west"]).isRequired,onMouseEnter:n.PropTypes.func,respectLineBreaks:n.PropTypes.bool,className:n.PropTypes.string},getInitialState:function(){return{isChildFocused:!1}},componentDidMount:function(){return e(r.findDOMNode(this)).on("focusin.title-bubble",(function(e){return function(t){return e.setState({isChildFocused:!0})}})(this)).on("focusout.title-bubble",(function(e){return function(t){return e.setState({isChildFocused:!1})}})(this)).on("mouseenter.title-bubble",(function(e){return function(){var t;return"function"==typeof(t=e.props).onMouseEnter?t.onMouseEnter():void 0}})(this))},componentWillUnmount:function(){return e(r.findDOMNode(this)).off("focusin.title-bubble").off("focusout.title-bubble").off("mouseenter.title-bubble")},render:function(){var e;return e={"c-title-bubble":!0,"is-child-focused":this.state.isChildFocused,"c-title-bubble--respect-line-break":this.props.respectLineBreaks},e["c-title-bubble--"+this.props.direction.slice(0,1)]=!0,a.div({className:t([e,this.props.className]),"data-title":this.props.text,onClick:(function(e){return function(t){if(t.detail>0)return e.setState({isChildFocused:!1})}})(this)},this.props.children)}}),o=s(o,["/static/css/scooter/scooter-scoped-vflm9UP03.css"])})}.call(this),function(){define("modules/clean/file_events",[],function(){return{DELETE:"db:bulk_delete",COPY:"db:bulk_copy",MOVE:"db:bulk_move",RENAME:"db:bulk_rename",PURGE:"db:bulk_purge",RESTORE:"db:bulk_restore",UPLOAD:"db:upload",COMPRESS:"db:compress",SF_NEW:"db:sf_new",SF_LEAVE:"db:sf_leave",SF_UNSHARE:"db:sf_unshare",SF_ADD_TO_DROPBOX:"db:sf_add_to_dropbox",SF_INVITE:"db:sf_invite",SF_IGNORE:"db:sf_ignore",LINKS_REMOVE:"db:link_remove",LINKS_ADD:"db:link_add",FILE_ACTIVITY_UPDATE:"db:file_activity_update"}})}.call(this),function(){var e={}.hasOwnProperty;define("modules/clean/flux/store_listener",["external/react"],function(t){var n;return n=function(n,r,s){var o;return t.createClass({displayName:"StoreListener("+(null!=(o=n.displayName)?o:"Unknown")+")",getInitialState:function(){return{childProps:s(this.props,r)}},componentDidMount:function(){var t,n;for(n in r)e.call(r,n)&&(t=r[n],t.add_change_listener(this._handleStoreChanged));return this.setState({childProps:s(this.props,r)})},componentWillUnmount:function(){var t,n,s;t=[];for(s in r)e.call(r,s)&&(n=r[s],t.push(n.remove_change_listener(this._handleStoreChanged)));return t},render:function(){var r,s,o,a;r={ref:"wrapped"},o=this.state.childProps;for(s in o)e.call(o,s)&&(a=o[s],r[s]=a);return t.createElement(n,r,this.props.children)},getWrappedComponent:function(){return this.refs.wrapped},getStores:function(){return r},_handleStoreChanged:function(){var e;if(this.isMounted()&&(e=s(this.props,r),null!=e))return this.setState({childProps:e})}})},{listenToStores:n}})}.call(this),function(){"use strict";var e=[].slice;define("modules/clean/flux/store_mixin",[],function(){return function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],{getInitialState:function(){return this._get_state_from_stores(this.props)},componentDidMount:function(){var e,n,r;for(e=0,n=t.length;e<n;e++)r=t[e],r.add_change_listener(this._handle_store_changed);return this.setState(this._get_state_from_stores(this.props))},componentWillUnmount:function(){var e,n,r,s;for(r=[],e=0,n=t.length;e<n;e++)s=t[e],r.push(s.remove_change_listener(this._handle_store_changed));return r},_handle_store_changed:function(){var e;if(this.isMounted()&&(e=this._get_state_from_stores(this.props),null!=e))return this.setState(e)}}}})}.call(this),function(){define("modules/clean/growth/experiments/logger",["modules/clean/ajax"],function(e){return(function(){function t(){}var n,r;return t.start_times={},t.DEFAULT_TIMER_NAME="view_time",t.get_timer_name=function(e){return null==e||"boolean"==typeof e?t.DEFAULT_TIMER_NAME:e},t.set_start_time=function(e){var n;return n=t.get_timer_name(e),t.start_times[n]=Date.now()},t.do_log_view_time=function(e,n){var r;return r=t.get_timer_name(n),e[r]=Math.round((Date.now()-t.start_times[r])/1e3)},r={},n=[5,15,60,120,300],t.start_counter=function(e,t){var s,o,a,i;for(a=[],s=0,o=n.length;s<o;s++)i=n[s],a.push((function(n){return r[e+n]=setTimeout(function(){return t(e,{time_since_first_view:n})},1e3*n)})(i));return a},t.stop_counter=function(e){var t,s,o,a;for(o=[],t=0,s=n.length;t<s;t++)a=n[t],o.push(clearTimeout(r[e+a]));return o},t.log=function(n,r,s,o){switch(null==o&&(o=!1),s=s||{},n){case"paywall_device_limit":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/growth_paywall_device_limit_log",data:{evt:r,extra:JSON.stringify(s)}});case"paywall_shared_folder":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/growth_paywall_shared_folder_log",data:{evt:r,extra:JSON.stringify(s)}});case"onboarding":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/growth_onboarding_log",data:{evt:r,extra:JSON.stringify(s)}});case"sharing":return t.do_log_view_time(s),e.SilentBackgroundRequest({url:"/growth_sharing_log",data:{evt:r,extra:JSON.stringify(s)}});case"post_client_install_tab":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/growth_post_client_install_tab_log",data:{evt:r,extra:JSON.stringify(s)}});case"secondary_client_link":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/secondary_client_link_upsell_log",data:{evt:r,extra:JSON.stringify(s)}});case"biz_trial_onboarding":return o&&t.do_log_view_time(s,o),e.SilentBackgroundRequest({url:"/biz_trial_onboarding_log",data:{evt:r,extra:JSON.stringify(s)}});default:throw new Error("Invalid series name")}},t})()})}.call(this),function(){define("modules/clean/growth/experiments/manage_shared_folders_modal",["external/classnames","external/react","external/underscore","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/list","modules/clean/avatar/size","modules/clean/datetime","modules/clean/flux/store_mixin","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/title_bubble","modules/clean/sharing/member_avatars","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g){var y,v,b,w,S,E,I,C,N,M,P,T,k;return y=a.AVATAR_DIMENSION_BY_SIZE,w=d.ManageSharedFoldersStore,v=d.ManageSharedFoldersActionHandler,E=d.PAGES,P=p.reactFormat,S=u.Modal,T=f.i18n_default_project("growth-exps"),I=T._,k=T.ungettext,N=t.createElement,M=t.DOM,C=t.createClass({displayName:"ManageSharedFoldersModal",propTypes:{maxOwned:t.PropTypes.number.isRequired,numOwned:t.PropTypes.number.isRequired,user:t.PropTypes.object.isRequired,onUnshare:t.PropTypes.func.isRequired},mixins:[l(w)],_get_state_from_stores:function(){return{areFoldersLoaded:w.areFoldersLoaded(),currentPage:w.currentPage(),keepACopy:w.keepACopy(),ownedFolders:w.ownedFolders(),selectedFolderIds:w.selectedFolderIds(),isMembershipLoaded:w.membershipLoaded(),membershipInfoById:w.membershipInfo()}},componentWillMount:function(){return v.initFromProps(this.props),v.fetchOwnedSharedFolders(),v.fetchMembershipData(this.props.user),v.changePage(E.MANAGE_SHARED_FOLDERS)},_handleSelectFolder:function(e){if(this.state.currentPage===E.MANAGE_SHARED_FOLDERS)return this.state.selectedFolderIds.contains(e)?v.unselectFolder(e):v.selectFolder(e)},_handleContinueClick:function(){return v.changePage(E.CONFIRM_UNSHARE)},_handleKeepACopyClick:function(){var e;return e=Boolean(!this.state.keepACopy),v.keepACopy(e)},_handleCancelClick:function(){return v.resetAndCloseModal()},_handleUnshareClick:function(){return v.unshareFoldersSelected(this.state.selectedFolderIds),this.props.onUnshare(this.state.selectedFolderIds,this.state.keepACopy)},_handleUpgradeClick:function(){return v.clickUpgrade()},_renderKeepACopy:function(){var n,r;return r=this.state.keepACopy,n=e({manage_shared_folders_modal__table_checkbox:!0,checked:r}),t.createElement("tr",null,t.createElement("td",{className:"manage_shared_folders_modal__table_keep",colSpan:"2"},t.createElement("button",{role:"checkbox",className:n,onClick:this._handleKeepACopyClick,"aria-checked":r}),t.createElement("div",null,I("Let members keep a copy"))))},_renderFolderTable:function(){var e,r,s;return this.state.areFoldersLoaded?(this.state.currentPage===E.MANAGE_SHARED_FOLDERS?e=this.state.ownedFolders:(e=n.filter(this.state.ownedFolders,(function(e){return function(t){return e.state.selectedFolderIds.contains(t.id)}})(this)),s=this._renderKeepACopy()),e.sort((function(e){return function(e,t){return e.last_active<t.last_active}})(this)),r=e.map((function(e){return function(t){return e._renderFolderRow(t)}})(this))):r=t.createElement("tr",{className:"manage_shared_folders_modal__table_row"},t.createElement("th",{className:"manage_shared_folders_modal__table_loader"},t.createElement("div",{className:"c-loader"},"Loading..."))),t.createElement("table",{className:"manage_shared_folders_modal__table"},t.createElement("tbody",null,t.createElement("thead",null,t.createElement("tr",{className:"manage_shared_folders_modal__table_header"},t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},I("Shared folders you own")),t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},I("Shared with")))),t.createElement("tbody",{className:"manage_shared_folders_modal__table_rows"},r),t.createElement("tfoot",null,s)))},_renderFolderRow:function(n){var r,s,a,l,d,c,p,u,h,_,f;return r=null,u=null,f=e({manage_shared_folders_modal__table_row:!0}),this.state.currentPage===E.MANAGE_SHARED_FOLDERS&&(c=this.state.selectedFolderIds.contains(n.id),f=e({manage_shared_folders_modal__table_row:!0,"manage_shared_folders_modal__table_row--selected":c}),s=e({manage_shared_folders_modal__table_checkbox:!0,"manage_shared_folders_modal__folders_row--selected":c,checked:c}),r=t.createElement("button",{role:"checkbox",className:s,"aria-checked":c}),u=i.ago(new Date(n.last_active))),_=e({remove_icon:!0,hidden:!c&&this.state.currentPage!==E.CONFIRM_UNSHARE}),l=t.createElement("div",{className:"manage_shared_folders_modal__table_info"},t.createElement("div",{className:"manage_shared_folders_modal__table_name"},n.name),t.createElement("div",{className:"manage_shared_folders_modal__table_date"},u)),a="--",this.state.isMembershipLoaded&&this.state.membershipInfoById[n.id]&&(h=this.state.membershipInfoById[n.id],p=h.joinedMembers.map((function(e){return function(t){return e._renderAvatar(t.display_name,t.initials,t.photo_url)}})(this)),d=h.invitations.map((function(e){return function(t){return e._renderAvatar(t.email_or_fbname,g.getInitials(t.email_or_fbname))}})(this)),a=N(o,{avatars:p.concat(d),avatarDimension:y.SMALL,maxVisible:7,undisplayableCount:h.numUndisplayableUsersAndInvites})),t.createElement("tr",{className:f,onClick:(function(e){return function(){return e._handleSelectFolder(n.id)}})(this)},t.createElement("td",{className:"manage_shared_folders_modal__table_options"},r,t.createElement("div",{className:"manage_shared_folders_modal__table_icon"},t.createElement(m,{alt:"",group:"web",name:"folder_user_32"}),t.createElement("img",{className:_,width:"16",height:"16",src:"/static/images/growth/experiments/icon-remove-lrg-vflSBVc6s.svg"})),l),t.createElement("td",{className:"manage_shared_folders_modal__table_shared"},a))},_renderAvatar:function(e,t,n){var o,a;return o=I("Shared with %(name)s").format({name:e}),a={alt:o,dimension:y.SMALL,photoUrl:n,defaultAvatar:N(s,{dimension:y.SMALL,alt:o,name:e,initials:t,shape:"CIRCLE"})},this._renderTitleBubble(N(r,a),o)},_renderTitleBubble:function(e,t){return N(h,{content:t,position:h.POSITIONS.BOTTOM,isTargetPositionFixed:!0},e)},_renderUpgradeText:function(){return t.createElement("div",{className:"manage_shared_folders_modal__footer"},P(I("To keep sharing all these folders, <button>upgrade your plan</button>."),{button:t.createElement("button",{className:"button-as-link",onClick:this._handleUpgradeClick})}))},render:function(){var e,t,n,r,s;switch(this.state.currentPage){case E.MANAGE_SHARED_FOLDERS:r=this.props.numOwned-this.props.maxOwned+1,s=k("Unshare at least %(num)s folder","Unshare at least %(num)s folders",r).format({num:r}),n="Next",e=this._handleContinueClick,t=Boolean(r-this.state.selectedFolderIds.size>0);break;case E.CONFIRM_UNSHARE:r=this.state.selectedFolderIds.size,s=k("Unshare this folder?","Unshare these %(num)s folders?",r).format({num:r}),n="Unshare",e=this._handleUnshareClick,t=!1}return N(S,{autoClose:!1,className:"manage_shared_folders_modal",title:s,acceptButtonText:n,onAccept:e,acceptButtonDisabled:t,dismissButtonText:"Cancel",onDismiss:this._handleCancelClick,clickOutToClose:!1,showX:!0},M.div({className:"manage_shared_folders_modal__header"},I("Unshared folders will stay in your Dropbox, but all members will be removed.")),M.div({className:"manage_shared_folders_modal__content"},this._renderFolderTable(),this._renderUpgradeText()))}}),b=c(C,["/static/css/growth/experiments/sharing_paywall_modals-vflg4unLq.css"]),{ManageSharedFoldersModal:b}})}.call(this),function(){define("modules/clean/growth/experiments/shared_folder_paywall_view",["external/react","modules/clean/react_format","modules/clean/react/image","modules/clean/sharing/actions/share_modal","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,r,s,o){var a,i,l,d;return l=t.reactFormat,a=r.ShareModalActionHandler,d=s.static_url,i=o.i18n_default_project("growth-exps")._,e.createElement,e.DOM,e.createClass({displayName:"SharedFolderPaywall",propTypes:{actionHandler:e.PropTypes.instanceOf(a).isRequired,maxOwned:e.PropTypes.number.isRequired,numOwned:e.PropTypes.number.isRequired,onLearnMoreClick:e.PropTypes.func.isRequired,onUpgradeClick:e.PropTypes.func.isRequired,onManageClick:e.PropTypes.func.isRequired},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_paywall"),this.props.onManageClick()},_handleAndLogUpgradeClick:function(){return this.props.actionHandler.logPaywallEvent("click_upgrade_from_paywall"),this.props.onUpgradeClick()},render:function(){return e.createElement("div",{className:"paywall-blocker unified-share-modal__no-permission u-pad-l u-pad-bottom-l"},e.createElement(n,{className:"paywall-blocker__image u-mar-bottom-s",src:d("/static/images/sharing/db_shared_folder-vflK0RLgD.png"),srcHiRes:d("/static/images/sharing/db_shared_folder@2x-vflEd6s7Z.png")}),e.createElement("div",{className:"paywall-blocker__infotext"},i("You own %(folder_count)s shared folders (max is %(max)s).").format({folder_count:this.props.numOwned,max:this.props.maxOwned})),e.createElement("button",{className:"c-btn c-btn--primary u-mar-bottom-s",onClick:this._handleAndLogUpgradeClick},i("Upgrade for unlimited sharing")),e.createElement("div",null,l(i("<manage>Manage your shared folders</manage> or <learn>learn more</learn>"),{manage:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this._handleAndLogManageSharedFoldersClick}),learn:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this.props.onLearnMoreClick})})))}})})}.call(this),function(){var e=function(e,n){function r(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/growth/experiments/sharing_paywall_actions_store",["external/immutable","external/react","external/underscore","modules/clean/api_v2/root_aware_client","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/sharing/api/client","modules/clean/ajax","modules/core/browser"],function(t,r,s,o,a,i,l,d,c,p){var u,m,h,_,f,g,y,v,b;return t.OrderedSet,b=t.Set,u=o.ApiV2RootAwareClient,m=d.FolderShareApiClient,y={MANAGE_SHARED_FOLDERS:"MANAGE_SHARED_FOLDERS",CONFIRM_UNSHARE:"CONFIRM_UNSHARE"},h=7,f={FETCH_OWNED_SF_REQUEST:"FETCH_OWNED_SF_REQUEST",FETCH_OWNED_SF_SUCCESS:"FETCH_OWNED_SF_SUCCESS",CHANGE_PAGE:"CHANGE_PAGE",SELECT_FOLDER:"SELECT_FOLDER",FETCH_MEMBERSHIP_REQUEST:"FETCH_MEMBERSHIP_REQUEST",FETCH_MEMBERSHIP_SUCCESS:"FETCH_MEMBERSHIP_SUCCESS",UNSELECT_FOLDER:"UNSELECT_FOLDER",UNSHARE_FOLDERS:"UNSHARE_FOLDERS",CLICK_UPGRADE:"CLICK_UPGRADE",TOGGLE_KEEP_A_COPY:"TOGGLE_KEEP_A_COPY",CLOSE_MODAL:"CLOSE_MODAL"},v="paywall_shared_folder",_=(function(){function e(){}return e.initFromProps=function(e){return this._client=new m({userId:e.user.id,client:new u})},e.fetchOwnedSharedFolders=function(){return i.dispatch({type:f.FETCH_OWNED_SF_REQUEST}),this._client.getOwnedSharedFolders().then(function(e){return i.dispatch({type:f.FETCH_OWNED_SF_SUCCESS,data:e})})},e.fetchMembershipData=function(e){return i.dispatch({type:f.FETCH_MEMBERSHIP_REQUEST}),c.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:e,data:{max_results:h,fq_path_prefix:"",include_inherited:!1},success:function(e){return i.dispatch({type:f.FETCH_MEMBERSHIP_SUCCESS,data:e})}})},e.changePage=function(e){return i.dispatch({type:f.CHANGE_PAGE,data:e})},e.selectFolder=function(e){return i.dispatch({type:f.SELECT_FOLDER,data:e})},e.unselectFolder=function(e){return i.dispatch({type:f.UNSELECT_FOLDER,data:e})},e.unshareFoldersSelected=function(e){return i.dispatch({type:f.UNSHARE_FOLDERS,data:e})},e.clickUpgrade=function(){return i.dispatch({type:f.CLICK_UPGRADE})},e.keepACopy=function(e){return i.dispatch({type:f.TOGGLE_KEEP_A_COPY,data:e})},e.resetAndCloseModal=function(){return i.dispatch({type:f.CLOSE_MODAL})},e})(),g=(function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype._init=function(){return this._selectedFolderIds=b(),this._keepACopy=!0,this._currentPage=y.MANAGE_SHARED_FOLDERS},r.prototype._clear=function(){return this._selectedFolderIds=b(),this._keepACopy=!0,this._currentPage=y.MANAGE_SHARED_FOLDERS},r.prototype._setOwnedSharedFolders=function(e){return this._ownedFolders=e,this.emit_change()},r.prototype._setFoldersLoaded=function(e){return this._areFoldersLoaded=e,this.emit_change()},r.prototype._setCurrentPage=function(e){return this._currentPage=e,this.emit_change()},r.prototype._setMembershipList=function(e){var t,r,s,o,a,i,l;for(s=this._ownedFolders.map(function(e){return e.id}),l={},t=0,r=e.length;t<r;t++)i=e[t],a=i.ns_id,n.call(s,a)>=0&&(o={numUndisplayableUsersAndInvites:i.num_avatars_not_shown,groups:i.groups,invitations:i.invitations,joinedMembers:i.joined_members,audienceDescription:i.audience_description},l[i.ns_id]=o);return this._membershipInfoById=l,this.emit_change()},r.prototype._setMembershipLoaded=function(e){return this._membershipLoaded=e,this.emit_change()},r.prototype._selectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.add(e),this.emit_change()},r.prototype._unselectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.delete(e),this.emit_change()},r.prototype._setKeepACopy=function(e){return this._keepACopy=e,this.emit_change()},r.prototype._logPaywallEvent=function(e,t){return t=t||{},t.num_folders_owned=this._ownedFolders.length,l.log(v,e,t)},r.prototype._logUnshareAction=function(){return this._logPaywallEvent("click_unshare",{num_folders_to_unshare:this._selectedFolderIds.size})},r.prototype._logUpgradeClick=function(){this._currentPage===y.MANAGE_SHARED_FOLDERS?this._logPaywallEvent("click_upgrade_from_manage_folders"):this._logPaywallEvent("click_upgrade_from_confirm_unshare")},r.prototype.ownedFolders=function(){return this._ownedFolders},r.prototype.areFoldersLoaded=function(){return this._areFoldersLoaded},r.prototype.currentPage=function(){return this._currentPage},r.prototype.membershipInfo=function(){return this._membershipInfoById},r.prototype.membershipLoaded=function(){return this._membershipLoaded},r.prototype.selectedFolderIds=function(){return this._selectedFolderIds},r.prototype.keepACopy=function(){return this._keepACopy},r.prototype._new_payload=function(e){var t;switch(t=e.action.data,e.action.type){case f.CHANGE_PAGE:return t===y.CONFIRM_UNSHARE&&this._logPaywallEvent("view_confirm_unshare_modal"),this._setCurrentPage(t);case f.CLICK_UPGRADE:return this._logUpgradeClick(),p.redirect("/upgrade?oqa=spw");case f.CLOSE_MODAL:return this._clear();case f.FETCH_MEMBERSHIP_REQUEST:return this._setMembershipLoaded(!1);case f.FETCH_MEMBERSHIP_SUCCESS:return this._setMembershipList(t),this._setMembershipLoaded(!0);case f.FETCH_OWNED_SF_REQUEST:return this._setFoldersLoaded(!1);case f.FETCH_OWNED_SF_SUCCESS:return this._setOwnedSharedFolders(t.entries),this._setFoldersLoaded(!0);case f.SELECT_FOLDER:return this._selectFolderId(t);case f.TOGGLE_KEEP_A_COPY:return this._setKeepACopy(t);case f.UNSELECT_FOLDER:return this._unselectFolderId(t);case f.UNSHARE_FOLDERS:return this._logUnshareAction(),this._clear()}},r})(a),{ManageSharedFoldersStore:new g,ManageSharedFoldersActionHandler:_,PAGES:y,PAYWALL_SERIES_LOGGING_NAME:v}})}.call(this),function(){
define("modules/clean/growth/experiments/sharing_paywall_info_modal",["external/classnames","external/react","modules/clean/react_format","modules/clean/react/button","modules/clean/react/css","modules/clean/react/modal","modules/clean/sharing/actions/share_modal","modules/clean/viewer","modules/core/browser","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d){var c,p,u,m,h,_,f,g,y;return y=n.reactFormat,c=r.Button,p=o.Modal,u=a.ShareModalActionHandler,h=d._,f=t.createElement,g=t.DOM,i.get_viewer(),_=t.createClass({displayName:"SharingPaywallInfoModal",propTypes:function(){return{actionHandler:t.PropTypes.instanceOf(u).isRequired,sharedFolderCount:t.PropTypes.number,grandfather:t.PropTypes.boolean,onDismiss:t.PropTypes.func,onManage:t.PropTypes.func}},_handleAndLogLearnMoreClick:function(){return this.props.actionHandler.logPaywallEvent("click_learn_more_from_grandfathered_notice"),this.navigateToHelpCenterArticle()},_handleAndLogNotNowClick:function(){return this.props.actionHandler.logPaywallEvent("click_not_now_from_grandfathered_notice"),this.props.onDismiss()},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_grandfathered_notice"),this.props.onManage()},_handleAndLogUpgradeClick:function(){return this.props.grandfather?this.props.actionHandler.logPaywallEvent("click_upgrade_from_grandfathered_notice"):this.props.actionHandler.logPaywallEvent("click_upgrade_from_learn_more"),this.navigateToUpgradePage()},render:function(){var n;return n=e({"sharing-paywall-info-modal":!0,"sharing-paywall-grandfather":this.props.grandfather}),t.createElement(p,{className:n,buttonComponent:this.renderButtons(),style:"clean"},g.div({className:"sharing-paywall-info-modal__content"},g.img({src:"/static/images/sharing/db_shared_folder-vflK0RLgD.png",className:"sharing-paywall-info-modal__content_image"}),g.div({className:"sharing-paywall-info-modal__content_header"},this.getHeader()),g.div({className:"sharing-paywall-info-modal__content_subheader"},this.getSubheader())))},renderButtons:function(){return this.props.grandfather?g.div({className:"db-modal-buttons"},g.div({},f(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade your Dropbox")),f(c,{key:"tertiary",className:"dbmodal-button",importance:"tertiary",disabled:!1,onClick:this._handleAndLogNotNowClick},h("Not now"))),g.div({},g.button({className:"button-as-link",onClick:this._handleAndLogManageSharedFoldersClick},h("Manage your shared folders")))):g.div({className:"db-modal-buttons"},f(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade for unlimited sharing")))},getHeader:function(){return h(this.props.grandfather?"Shared folder limits have changed":"You can own 5 shared folders at a time")},getSubheader:function(){return this.props.grandfather?g.span({},g.div({},h("Now you can only own 5 shared folders with Dropbox Basic. Since you have  %(count)s, you’ll need to unshare some folders or upgrade.").format({count:this.props.sharedFolderCount}),y(h(" <learn>Learn more</learn>"),{learn:g.button({className:"button-as-link inline-link",onClick:this._handleAndLogLearnMoreClick})}))):g.span({},g.div({},h("Creating and sharing a folder makes you the owner, which gives you more  control over who can access it. Folders people have shared with you don’t  count towards your 5-folder limit.")))},navigateToHelpCenterArticle:function(){return l.open_tab("/help/9264")},navigateToUpgradePage:function(){return l.redirect("/upgrade?oqa=spw")}}),m=s(_,["/static/css/scooter/scooter-scoped-vflm9UP03.css","/static/css/growth/experiments/sharing_paywall_info_modal-vflke5gnX.css"]),{SharingPaywallInfoModal:m}})}.call(this),define("modules/clean/loggers/growth_features_events_logger",["require","exports","modules/clean/ajax"],function(e,t,n){"use strict";function r(e,t){a({feature:"ransomware_recovery",event:e,extra:t})}function s(e,t){a({feature:"project_magnet",event:e,extra:t})}function o(e,t){a({feature:"project_lasso",event:e,extra:t})}function a(e){n.SilentBackgroundRequest({url:"/log/growth_feature",data:{event_params:JSON.stringify(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.logRansomwareEvent=r,t.logMagnetEvent=s,t.logLassoEvent=o}),function(){var e=function(e,n){function r(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/shared_with",["jquery","external/react","external/react-dom","external/underscore","modules/core/i18n","modules/core/user_i18n","modules/clean/ajax","modules/clean/avatar/size","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/flux/store_mixin","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/sharing/shared_with_view","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/ui_util","modules/clean/file_events","modules/clean/web_timing_logger","modules/core/browser","modules/core/dom"],function(t,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M,P,T){var k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z,j,Q,Z,J,X;return a._,k=d.AVATAR_DIMENSION_BY_SIZE,A=h.BrowseActionTypes,D=h.LoadingStates,B=h.SharedWithActionTypes,x=_.BrowseContext,F=_.File,j=f.browseStore,W=g.SharedWithView,K=y.SharingApi,L=v.FileShareApiClient,z=b.TRUELINK,J=w.shouldUsePublicFolderSharing,X=S.showShareModal,Z=E.sharingInfoStore,Y=I.SharingActions,Q=r.createElement,R=5,O=100,U=100,"file_row_sharing_menu",G=(function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initializeWith=function(e){var t,n;return n=e.path,t=e.files,this._browseInitializeEverything({path:n,files:t})},n.prototype._init=function(){return this._sharedFolderDataByTargetNs={},this._sharedLinkDataMapsByFolderFQPath={},this._filesWeHaveSharedLinkDataFor={},this._sharedFileDataByFileId={},this._hasSharedDataLoadedByContainingPath={}},n.prototype.hasLinkDataForFile=function(e){return e.fq_path in this._filesWeHaveSharedLinkDataFor},n.prototype.clearSharedLinkDataCache=function(){return this._filesWeHaveSharedLinkDataFor={}},n.prototype.getDataForFile=function(e){var t,n,r,s,a,i,l,d,c,p,u,m;return e&&!e.target_ns&&this._canBeSharedFile(e)?(t=this._sharedFileDataByFileId[null!=(a=e.file_id)?a:e.fq_path]||{},r=this._sharedFolderDataByTargetNs[j.context().currentNSID]||{},s={},(null!=(i=t.joinedMembers)?i.length:void 0)||(null!=(l=t.groups)?l.length:void 0)||(null!=(d=t.invitations)?d.length:void 0)||(s.audienceDescription=r.audienceDescription),s.groups=o.uniq(o.union(t.groups,r.groups),!1,function(e){return e.gid}),s.invitations=o.uniq(o.union(t.invitations,r.invitations),!1,function(e){return e.invitation_id}),s.joinedMembers=o.uniq(o.union(t.joinedMembers,r.joinedMembers),!1,function(e){return e.user_id}),s.numUndisplayableUsersAndInvites=(t.numUndisplayableUsersAndInvites||0)+(r.numUndisplayableUsersAndInvites||0),n=r.memberCount||0,n+=((null!=(c=t.joinedMembers)?c.length:void 0)||0)+((null!=(p=t.invitations)?p.length:void 0)||0)+(t.numUndisplayableUsersAndInvites||0),n+=(null!=(u=t.groups)?u.map(function(e){return e.num_users||1}).reduce(function(e,t){return e+t},0):void 0)||0,s.memberCount=n):s=e&&e.target_ns?this._sharedFolderDataByTargetNs[e.target_ns]:this._sharedFolderDataByTargetNs[j.context().currentNSID],m=this._getSharedLinkInfoByFile(e),m?(s||(s={}),s.sharedLinkInfo=m):null!=s&&delete s.sharedLinkInfo,s||(s={}),s.hasSharedDataLoaded=this._getHasSharedDataLoaded(),s},n.prototype._getSharedLinkInfoByFile=function(e){var t,n,r;return t=j.path(),r=this._sharedLinkDataMapsByFolderFQPath[t],r&&e&&(n=r[this._sharedLinkKey(e)]),n},n.prototype._sharedLinkKey=function(e){return e.fq_path+"_"+e.ns_id+"_"+e.sjid},n.prototype._new_payload=function(e){switch(e.action.type){case A.LOAD_PATH:return this._pathLoaded(e.action.data);case A.ADD_FILES:return this._filesAdded(e.action.data);case A.INITIALIZE_EVERYTHING:return this._browseInitializeEverything(e.action.data);case A.CHANGE_FILES:return this._filesChanged(e.action.data);case B.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:return this._signalSharedFileDataOutOfDate(e.action.data);case B.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:return this._signalSharedFolderDataOutOfDate(e.action.data);case B.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:return this._signalSharedLinkDataOutOfDate(e.action.data);case B.SET_SHARED_FOLDER_DATA:return this._setNSSharedWithData(e.action.data);case B.SET_SHARED_LINK_DATA:return this._setSharedLinkData(e.action.data);case B.SET_SHARED_FILE_DATA:return this._setSharedFileData(e.action.data);case B.CLEAR_SHARED_FOLDER_DATA_FOR_NS:return this._clearSharedFolderDataForNs(e.action.data);case B.REMOVE_SHARED_LINK_DATA:return this._removeSharedLinkData(e.action.data)}},n.prototype._fillInMissingSharedLinkData=function(e){var t,n,r,s,o,a,i;for(i=e.parentPath,r=e.files,s=[],o=0,a=r.length;o<a;o++)n=r[o],this.hasLinkDataForFile(n)||(this._filesWeHaveSharedLinkDataFor[n.fq_path]=!0,s.push(n));return q.loadLinkDataForFiles({parentPath:i,fileFqPaths:(function(){var e,n,r;for(r=[],e=0,n=s.length;e<n;e++)t=s[e],r.push(t.fq_path);return r})()}),q.loadLinkMetadata(s)},n.prototype._getHasSharedDataLoaded=function(){var e;return e=j.path(),e in this._hasSharedDataLoadedByContainingPath&&this._hasSharedDataLoadedByContainingPath[e]},n.prototype._setHasSharedDataLoaded=function(e){var t;return t=j.path(),this._hasSharedDataLoadedByContainingPath[t]=e},n.prototype._canBeSharedFile=function(e){return!(e.is_dir||e.isDeleted)},n.prototype._loadSharedFileData=function(e){var t,n,r,s,o,a;for(r=(null!=e?e:{invalidateCache:!1}).invalidateCache,r&&(this._sharedFileDataByFileId={}),n=[],a=j.files().toArray(),s=0,o=a.length;s<o;s++)t=a[s],!this._canBeSharedFile(t)||t.file_id in this._sharedFileDataByFileId||n.push(t.file_id);return q.loadSharedFileDataForFiles({fileIds:n})},n.prototype._pathLoaded=function(e){var t,n;return t=e.files,n=e.path,this._setHasSharedDataLoaded(!1),q.loadSFDataForPath({parentPath:n,abortCurrentRequest:!0}),this._loadSharedFileData({invalidateCache:!0}),this._filesAdded({files:t,path:n})},n.prototype._filesAdded=function(e){var t,n;return t=e.files,n=e.path,this._fillInMissingSharedLinkData({parentPath:n,files:t}),this._loadSharedFileData()},n.prototype._filesChanged=function(e){var t,n,r;if(r=e.path,n=e.fileDeltas,r===j.path()&&null!=n&&n.length)return u.waitFor([j.dispatchToken]),q.loadSFDataForPath({parentPath:r}),this.clearSharedLinkDataCache(),t=j.files().toArray(),this._fillInMissingSharedLinkData({parentPath:r,files:t}),this._loadSharedFileData({invalidateCache:!0})},n.prototype._signalSharedFileDataOutOfDate=function(e){var t;return t=e.fileIds,q.loadSharedFileDataForFiles({fileIds:t})},n.prototype._signalSharedFolderDataOutOfDate=function(e){var t;return t=e.parentPath,null==t&&(t=j.path()),q.loadSFDataForPath({parentPath:t})},n.prototype._signalSharedLinkDataOutOfDate=function(e){var t,n;return n=e.parentPath,t=e.fileFqPaths,null==n&&(n=j.path()),q.loadLinkDataForFiles({parentPath:n,fileFqPaths:t})},n.prototype._setNSSharedWithData=function(e){var t,n;return n=e.sharedFolderData,t=e.containingPath,this._sharedFolderDataByTargetNs=n,this._hasSharedDataLoadedByContainingPath[t]=!0,this.emit_change()},n.prototype._setSharedLinkData=function(e){var t,n,r,s,o,a,i,l;for(s=e.parentPath,a=e.sharedLinkData,l=this._sharedLinkDataMapsByFolderFQPath[s]||{},n=0,r=a.length;n<r;n++)o=a[n],t=o.file,i=o.sharedLinkToken,l[this._sharedLinkKey(t)]=i;return this._sharedLinkDataMapsByFolderFQPath[s]=l,this.emit_change()},n.prototype._setSharedFileData=function(e){var t;return t=e.sharedFileData,o.extend(this._sharedFileDataByFileId,t),this.emit_change()},n.prototype._clearSharedFolderDataForNs=function(e){var t;return t=e.targetNs,this._sharedFolderDataByTargetNs[t]=void 0,this.emit_change()},n.prototype._browseInitializeEverything=function(e){var t,n;return n=e.path,t=e.files,q.loadSFDataForPath({parentPath:n}),this._filesAdded({path:n,files:t})},n.prototype._removeSharedLinkData=function(e){var t,n,r,s,o,a;for(o=e.parentPath,n=e.files,a=this._sharedLinkDataMapsByFolderFQPath[o]||{},r=0,s=n.length;r<s;r++)t=n[r],a[this._sharedLinkKey(t)]=void 0;return this._sharedLinkDataMapsByFolderFQPath[o]=a,this.emit_change()},n})(p),V=new G,t(document).on(K.REQUEST_SUCCEEDED_EVENT,function(e,t){var n;return n=t.request_url,n.indexOf("/share_ajax/leave")>-1?u.dispatch({type:B.CLEAR_SHARED_FOLDER_DATA_FOR_NS,data:{targetNs:t.ns_id}}):u.dispatch({type:B.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{parentPath:j.path()}})}),q=(function(){function e(){}return e.loadLinkMetadata=function(e){var t,n,r,s,o,a;if(a=j.user(),z.TRUELINK_BROWSE_LINK_ICON[a.id]&&z.TRUELINK_UI[a.id])return t=5,r=e.filter(function(e){return e.is_dir}).map(function(e){return"ns:"+e.ns_id+e.ns_path}),o=function(){var e;if(0!==r.length)return e=r.slice(0,t),r=r.slice(t),Y.loadFolderLinkMetadataBatch(a,e).then(o)},n=e.filter(function(e){return!e.is_dir}).map(function(e){return e.file_id||e.fq_path}),s=function(){var e;if(0!==n.length)return e=n.slice(0,t),n=n.slice(t),Y.loadFileMetadataBatch(a,e).then(s)},o(),s()},e.loadSFDataForPath=function(e){var t,n,r,s,o,a;return r=e.parentPath,t=null!=(s=e.abortCurrentRequest)&&s,a=j.user(),n=j.context().isNonUserRelativeContext,t&&null!=(o=this._currentSFDataRequest)&&o.abort(),this._currentSFDataRequest=l.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:a,data:{max_results:R,fq_path_prefix:r,include_inherited:!0,admin_console:n?"true":void 0,sort_by_name:!0},success:function(e){var t,n,s,o,a;for(a={},t=0,n=e.length;t<n;t++)o=e[t],s={numUndisplayableUsersAndInvites:o.num_avatars_not_shown,groups:o.groups,invitations:o.invitations,joinedMembers:o.joined_members,audienceDescription:o.audience_description,memberCount:o.num_users_and_invites},a[o.ns_id]=s;return u.dispatch({type:B.SET_SHARED_FOLDER_DATA,data:{sharedFolderData:a,containingPath:r}})},complete:(function(e){return function(){return e._currentSFDataRequest=null}})(this)})},e.loadSharedFileDataForFiles=function(e){var t,n,r,s;if(n=e.fileIds,s=j.user(),null!==s&&(null!=s?s.is_email_verified:void 0))return t=new L({userId:s.id}),(r=function(e){var n,s,o;if(0!==e.length)return o=e.slice(0,U),n=e.slice(U),s=t.listMembersBatch({contentIds:o,limit:R}),s.then(function(e){var t;if(t={},e.forEach(function(e,n){return t[n]={numUndisplayableUsersAndInvites:0,groups:e.groups.valueSeq().map(C.apiGroupMemberToAvatarInfo).toArray(),invitations:e.invitees.valueSeq().map(C.apiInviteeMemberToAvatarInfo).toArray(),joinedMembers:e.users.valueSeq().map(C.apiUserMemberToAvatarInfo).toArray()}}),u.dispatch({type:B.SET_SHARED_FILE_DATA,data:{sharedFileData:t}}),n)return r(n)})})(n)},e.loadLinkDataForFiles=function(e){var t,r,s,o;if(r=e.parentPath,t=e.fileFqPaths,!z.TRUELINK_UI[j.user().id])return o=j.user(),(s=function(e){var t,a;if(0!==e.length)return a=e.slice(0,O),t=e.slice(O),l.SilentBackgroundRequest({url:"/sm/get_token_info",dataType:"json",data:{paths:JSON.stringify(a)},subject_user:o,success:function(e){var o,i,l,d,c,p,m,h,_,f,g;for(l=j.filesMap(),_=[],m=e.shmodels,d=0,c=m.length;d<c;d++)g=m[d],g.disabled||(o=l.get(g.path),o&&_.push({file:o,sharedLinkToken:g}));if(_.length&&u.dispatch({type:B.SET_SHARED_LINK_DATA,data:{parentPath:r,sharedLinkData:_}}),f=(function(){var t,n,r,s;for(r=e.shmodels,s=[],t=0,n=r.length;t<n;t++)h=r[t],s.push(h.path);return s})(),i=(function(){var e,t,r;for(r=[],e=0,t=a.length;e<t;e++)p=a[e],n.call(f,p)>=0||r.push(l.get(p));return r})().filter(function(e){return null!=e}),i.length&&u.dispatch({type:B.REMOVE_SHARED_LINK_DATA,data:{parentPath:r,files:i}}),t)return s(t)}})})(t)},e})(),H=r.createClass({displayName:"SharedWithController",mixins:[m(V,Z,j)],propTypes:{browseContext:r.PropTypes.instanceOf(x).isRequired,file:r.PropTypes.instanceOf(F),isInAudienceBox:r.PropTypes.bool,isMaestroDesign:r.PropTypes.bool,inSelectMode:r.PropTypes.bool,tabIndex:r.PropTypes.oneOf([0,-1]),actionHandlers:r.PropTypes.object},getDefaultProps:function(){return{isMaestroDesign:!0}},_get_state_from_stores:function(e){var t,n,r,s,o,a,i,l,d,c,p;return p=j.user().id,t=V.getDataForFile(e.file),c=Z.getSharingInfo(p,null!=(r=e.file)?r.fq_path:void 0),n=j.loadingState()===D.LOADING_FIRST_PAGE,{audienceDescription:null!=t?t.audienceDescription:void 0,numUndisplayableUsersAndInvites:null!=(s=null!=t?t.numUndisplayableUsersAndInvites:void 0)?s:0,groups:null!=(o=null!=t?t.groups:void 0)?o:[],hasSharedDataLoaded:(null!=t?t.hasSharedDataLoaded:void 0)&&!n,invitations:null!=(a=null!=t?t.invitations:void 0)?a:[],joinedMembers:null!=(i=null!=t?t.joinedMembers:void 0)?i:[],memberCount:null!=(l=null!=t?t.memberCount:void 0)?l:0,sharedLinkInfo:null!=(d=null!=t?t.sharedLinkInfo:void 0)?d:null,linkMetadata:null!=c?c.linkMetadata():void 0}},componentDidUpdate:function(){var e,t,n,r,o;if(null!=this.props.tabIndex){for(t=T.getFocusableElementsIn(s.findDOMNode(this),!1),o=[],n=0,r=t.length;n<r;n++)e=t[n],o.push(e.tabIndex=this.props.tabIndex);return o}},componentWillReceiveProps:function(e){return this.setState(this._get_state_from_stores(e))},_handleMembershipClick:function(){var e,t,n,r,s;if(null==this.props.file&&j.context().isCurrentlyInRoot)return void P.open_tab("/team#members");if((null==this.props.file||!F.isTeamMemberFolder(this.props.file))&&(null==this.props.file||F.canViewFileMembers(this.props.file,j.context())))return t=[j.user(),this.props.file?this.props.file:j.context()],s=t[0],e=t[1],this.props.browseContext.isNonUserRelativeContext&&null!=(null!=(n=this.props.actionHandlers)?n.onManage:void 0)?null!=(r=this.props.actionHandlers)?r.onManage(this.props.file):void 0:X(s,e,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},handleOverflowCountClick:function(){return this._handleMembershipClick()},handleAvatarClick:function(){return this._handleMembershipClick()},handleSharedLinkClick:function(){return X(j.user(),this.props.file,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},render:function(){var e,t,n,r,s;return t=j.context(),s=j.user(),t.isCurrentlyInRoot&&null==this.props.file&&!s.is_cdm_member?null:(e=this.props.file?F.canViewFileMembers(this.props.file,t):t.canViewContainingNSMembers,Q(W,{user:j.user(),file:this.props.file,onOverflowCountClick:this.handleOverflowCountClick,onAvatarClick:this.handleAvatarClick,groups:this.state.groups,invitations:this.state.invitations,joinedMembers:this.state.joinedMembers,numUndisplayableUsersAndInvites:this.state.numUndisplayableUsersAndInvites,memberCount:this.state.memberCount,parentFolderName:t.getNameOfTargetFolder(),animation:!1,avatarDimension:k.MEDIUM,maxVisibleAvatars:R,sharedLinkInfo:this.state.sharedLinkInfo,onSharedLinkClick:this.handleSharedLinkClick,publicFolderSharing:this.props.file&&J(null!=(n=null!=(r=this.props.browseContext)?r.config:void 0)?n:{},this.props.file.fq_path),isMaestroDesign:this.props.isMaestroDesign,inSelectMode:this.props.inSelectMode,isInAudienceBox:this.props.isInAudienceBox,audienceDescription:this.state.audienceDescription,hasSharedDataLoaded:this.state.hasSharedDataLoaded,canViewMembers:e&&!t.isInsideDeletedFolder,inContentManagerCdmRoot:!1,linkMetadata:this.state.linkMetadata}))}}),{SharedWithActions:q,SharedWithController:H,SharedWithStore:V}})}.call(this),function(){define("modules/clean/react/bubble",["external/react","external/underscore","modules/clean/css"],function(e,t,n){var r,s;return s=e.DOM,r={TOP:"top",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",RIGHT:"right",RIGHT_TOP:"right-top",RIGHT_BOTTOM:"right-bottom",LEFT:"left",LEFT_TOP:"left-top",LEFT_BOTTOM:"left-bottom"},e.createClass({displayName:"Bubble",statics:{ARROW:r},propTypes:{arrow:e.PropTypes.oneOf(t.values(r)),className:e.PropTypes.string},getDefaultProps:function(){return{arrow:null,className:""}},componentWillMount:function(){if("undefined"!=typeof window&&null!==window)return n.require_css("/static/css/react/bubble_box-vflpfsqHZ.css")},render:function(){var e,n;return e=["react-bubble-box","react-bubble-box--arrow-"+this.props.arrow,this.props.className],n=t.extend({},t.omit(this.props,["arrow","className"]),{className:e.join(" ")}),s.div(n,this._renderArrow(),this.props.children)},_renderArrow:function(){return null!=this.props.arrow?[s.div({className:"react-bubble-box__arrow-border",key:"arrow-border"}),s.div({className:"react-bubble-box__arrow",key:"arrow"})]:[]}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/content_manager/api",["jquery","external/underscore","modules/clean/analytics","modules/clean/ajax","modules/clean/react/browse/constants","modules/clean/filepath","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/browse/store","modules/clean/sharing/api/util/types","modules/clean/sharing/ui_util","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/constants/browse","modules/constants/viewer","require"],function(t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I){var C,N,M,P,T,k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z,j,Q,Z,J,X,$,ee,te,ne,re,se,oe;return M=r.ContentManagerActionsLogger,o.LoadingStates,l.PaginationManager,P=c.FileTypes,p.Config,p.BrowseContext,V=u.compare,H=m.browseStore,K=h.folderMetadataApiToRecord,T=_.GoldenGate,N=f.AdminConsoleApiClient,O=v._,ne=v.ungettext,D=function(e){return{fq_path:"/"+e.name,href:"/work/"+e.name,is_dir:!0,bytes:0,target_ns:e.team_folder_id,icon:B[e.status[".tag"]],team_folder_status:e.status[".tag"],type:P.TEAM_SHARED_FOLDER}},C="undefined"!=typeof window&&null!==window?t(window):null,L=180,x=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|<|>|\\"|\\|)'),k=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|\\"|\\|)'),F=new RegExp("[\\ufffe-\\uffff\\ud800-\\udfff]"),A=[".",".."],se=function(t,n){return null==n&&(n=!1),""===t?"":t.length>255?O("The folder name should be under 255 characters"):n&&t.startsWith(".")?O("The folder name can’t start with a dot (.)"):t.endsWith(".")?O("The folder name can’t end with a dot (.)"):e.call(A,t)>=0?O("The names dot (.) and dot dot (..) are’t allowed"):x.test(t)?O("The following characters aren’t allowed: \\ / : ? * < > ” |"):F.test(t)?O("The folder name contains invalid characters"):null},re=function(e){return""===e?"":e.length>255?O("The file name should be under 255 characters"):k.test(e)?O("The following characters aren’t allowed: \\ / : ? * ” |"):F.test(e)?O("The file name contains invalid characters"):null},R=function(e,t){var n,r,s,o;for(o=[],n=0,s=e.length;n<s;n++)r=e[n],o.push(r.fq_path="/"+t+r.fq_path);return o},U=function(){var e;return e=T.hasContentManagerCdm(H.user().id),new N(isCMforCDM=e,flashError=!1)},Q=function(e){var t,r,o,a,i,l,d,c,p,u,m,h,_;return d=e.path,_=e.userId,m=e.sortFoldersFirst,o=e.includeDeletedFiles,a=e.nsId,l=e.onSuccess,i=e.onError,t=T.hasContentManagerCdm(_),r=U(),"/"!==d||t?(c=d.split("/"),p=c[1],u=t?1:2,h="/"+c.slice(u).join("/"),s.WebRequest({data:{show_deleted:o||"",admin_console:!0,ns_id:a,sort_folders_first:m},url:w({path:"/browse"+h}),subject_user:_,success:function(e){try{n.isString(e)&&(e=JSON.parse(e)),t||(e.paginated?R(e.first_page.items,p):R(e.file_info,p)),C.scrollTop(0),l({path:d,data:e})}catch(e){}},error:function(e,t,n){return"function"==typeof i?i(e,t,n):void 0}})):r.teamFoldersList().then(function(e){var t,n,r;return e.team_folders=e.team_folders.sort(function(e,t){return V(e.name.toUpperCase(),t.name.toUpperCase(),1)}),n=(function(){var t,n,s,o;for(s=e.team_folders,o=[],t=0,n=s.length;t<n;t++)r=s[t],o.push(D(r));return o})(),t={file_info:n,paginated:!1,inside_team_folder_root:!0,is_non_user_relative_context:!0},l({path:d,data:t})}).catch(function(e){if(!e.headers)throw e;return"function"==typeof i?i(e.headers,e.raw.status,e.raw.responseBody):void 0})},G=function(e){var t,n,r,s,o,a;return s=e.files,o=e.newPath,e.userId,e.onSuccess,t=I("modules/clean/react/browse/actions").browseActions,n=U(),r=H.context(),a=r.rootNSID,b.info(O("Copying files...",L)),n.bulkFileCopy(a,s,o).then(function(e){var n;return b.success(O("Copy completed.")),t.setPath({path:H.path(),nsId:r.rootNSID}),n=1===s.length?"copy":"copyBatch",q(n)}).catch(function(e){var t;return"cant_copy_shared_folder"===(null!=(t=e.error)?t[".tag"]:void 0)?b.error(O("Copying a shared folder isn’t supported for beta.")):b.error(O("There was a problem completing this request."))})},Y=function(e){var t,n,r,s;return s=e.files,r=e.context,t=I("modules/clean/react/browse/actions").browseActions,n=U(),b.info(O("Deleting files...",L)),n.bulkFileDelete(s).then(function(e){var n;return n=ne("Deleted %d item.","Deleted %d items.",s.length).format(s.length),b.success(n),t.setPath({path:H.path(),nsId:r.rootNSID}),q(1===s.length?s[0].is_dir?"deleteFolder":"deleteFile":"deleteBatch")}).catch(function(e){return b.error(O("There was a problem completing this request."))})},X=function(e){var t,n,r,s,o,a,i;return o=e.file,e.userId,e.onSuccess,i=e.onError,a=e.newName,t=I("modules/clean/react/browse/actions").browseActions,r=H.context(),(s=o.is_dir?se(a):re(a))?(b.error(s),void i()):(n=U(),n.fileRename(o.ns_id,o.ns_path,a).then(function(e){return o.is_dir?b.success(O("Folder renamed.")):b.success(O("File renamed.")),t.setPath({path:H.path(),nsId:r.rootNSID}),q("rename")}).catch(function(e){return b.error(O("There was a problem completing this request."))}))},Z=function(e){var t,n,r,s,o,a;return e.path,s=e.files,o=e.newPath,e.userId,e.onSuccess,t=I("modules/clean/react/browse/actions").browseActions,n=U(),r=H.context(),a=r.rootNSID,b.info(O("Moving files...",L)),n.bulkFileMove(a,s,o).then(function(e){var n;return b.success(O("Move completed.")),t.setPath({path:H.path(),nsId:r.rootNSID}),n=1===s.length?"move":"moveBatch",q(n)}).catch(function(e){var t;return"cant_move_folder_into_itself"===(null!=(t=e.error)?t[".tag"]:void 0)?b.error(O("Moving a folder into itself isn’t allowed.")):b.error(O("There was a problem completing this request."))})},z=function(e){throw e.path,e.userId,e.namespaceToJournalIdMap,e.includeDeletedFiles,e.onSuccess,new Error("Not Implemented")},W=function(e){var t,n,r,s,o,a,i,l;return l=e.pathName,s=e.folderName,o=e.nsId,e.userId,i=e.onSuccess,a=e.onError,t=I("modules/clean/react/browse/actions").browseActions,(r=se(s))?(b.error(r),void a()):(n=U(),n.folderCreate(o,l,s).then(function(e){var n;return b.success(O("Folder created.")),n={fq_path:"/"+s},i({changesets:null,createdFolder:n}),t.setPath({path:H.path(),nsId:o}),q("createFolder")}).catch(function(e){var t,n,r,s;return a(),"path"===(null!=(t=e.error)?t[".tag"]:void 0)&&"disallowed_name"===(null!=(n=e.error.path)?n[".tag"]:void 0)?b.error(O("The folder name is invalid.")):"path"===(null!=(r=e.error)?r[".tag"]:void 0)&&"conflict"===(null!=(s=e.error.path)?s[".tag"]:void 0)?b.error(O("A folder with the same name exists.")):b.error(O("Failed to create the folder."))}))},te=function(e){var t,n,r,s,o;return n=e.nsId,r=e.nsPath,o=e.policyUpdate,s=e.onSuccess,e.onError,t=new U,t.shareFolder(n,r,o).then(K).then(s)},oe=function(e){var t,n,r,s,o;return s=e.nsId,o=e.nsPath,t=e.actions,r=e.listMembersArg,q("validateFolderPath"),n=U(),n.validateFolderPath(s,o,t,r)},$=function(e,t,n,r){var s;return s=U(),s.restoreFile(e,t,n).then(r)},J=function(e,t,n){var r;return r=U(),r.permanentDeleteFile(e,t).then(n)},q=function(e){return M.log(H.context().rootNSID,e)},B={},ee=function(e){return B=e},j=function(e){return"/"===e.path&&!T.hasContentManagerCdm(e.user.id)},{validateFolderName:se,loadPath:Q,renameFile:X,copyFiles:G,deleteFiles:Y,moveFiles:Z,getChangesForDirectory:z,setIcons:ee,createNewFolder:W,shareFolder:te,validateFolderPath:oe,restoreFile:$,permanentDeleteFile:J,isInCMGoldenGateRoot:j}})}.call(this),define("modules/clean/react/file_modal_controller",["require","exports","external/react","modules/clean/filepath","modules/clean/react/overquota_modal","modules/clean/react/file_modals","modules/clean/react/modal","modules/clean/sharing/browse_exports"],function(e,t,n,r,s,o,a,i){"use strict";function l(e,t,r){var s=n.createElement(o.FileTransferModal,{files:t,operation:o.Operations.COPY,user:e,onSuccess:r.onSuccess,onUndo:r.onUndo,onRequestNotSent:r.onRequestNotSent});a.Modal.showInstance(s)}function d(e,t,r,s){var i=n.createElement(o.FileTransferModal,{files:t,path:r,operation:o.Operations.MOVE,user:e,onSuccess:s.onSuccess,onUndo:s.onUndo,onRequestNotSent:s.onRequestNotSent});a.Modal.showInstance(i)}function c(){var e=n.createElement(s.OverquotaModal,null);a.Modal.showInstance(e)}function p(e,t,r){var s=n.createElement(o.RestoreFilesModal,{files:t,userId:e.id,onSuccess:r});a.Modal.showInstance(s)}function u(e,t,r){var s=n.createElement(o.PermanentlyDeleteModal,{files:t,userId:e.id,onSuccess:r});a.Modal.showInstance(s)}function m(e,t,s,i,l,d){void 0===l&&(l=!1),void 0===d&&(d=null);var c,p=r.filename(s.currentFQPath),u=s.isInsideSharedFolder;c=l?n.createElement(o.ExpOQDeleteFileModal,{files:t,user:e,parentSharedFolderName:u?p:null,onUndo:i,expSubgrowthBizWebClientOQDelete:l}):n.createElement(o.DeleteFileModal,{files:t,user:e,parentSharedFolderName:u?p:null,onUndo:i,onSuccess:d}),a.Modal.showInstance(c)}function h(e,t,r){var s=n.createElement(o.ContentManagerBridgeModal,{files:e,type:t,isLimitedTeam:r});a.Modal.showInstance(s)}function _(e,t,s){var l=n.createElement(o.NoAccessFolderModal,{folderName:r.filename(t.fq_path),folderPath:t.fq_path,userIsSameTeam:!!(e&&e.team_dbtid&&s.teamFolderOwnerTeamApiId&&e.team_dbtid===s.teamFolderOwnerTeamApiId),userIsSuperAdmin:!!e&&i.GoldenGate.hasContentManagerAndSuperAdmin(e.id)});a.Modal.showInstance(l)}function f(e){var t=n.createElement(o.ConfirmOwnershipTransferModal,{onAccept:e});a.Modal.showInstance(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=l,t.showMove=d,t.showOverquota=c,t.showRestore=p,t.showPermanentlyDelete=u,t.showDelete=m,t.showContentManagerBridge=h,t.showNoAccess=_,t.showConfirmOwnershipTransferModal=f}),define("modules/clean/react/file_modals",["require","exports","tslib","external/react","external/react-dom","external/underscore","modules/clean/browse_interface","modules/clean/em_string","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/render_partials","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/react_format","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E){"use strict";function I(){return m.browseStore.context().isNonUserRelativeContext?h:c}function C(e,t){if(m.browseStore.context().isNonUserRelativeContext&&!v.GoldenGate.hasContentManagerCdm(t.id))return e[0].fq_path.split("/")[1]}Object.defineProperty(t,"__esModule",{value:!0});var N;(function(e){e[e.COPY=0]="COPY",e[e.MOVE=1]="MOVE"
})(N=t.Operations||(t.Operations={}));var M=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePurged=function(){l.notifyPurgeSuccess(t.props.files.length),t.props.onSuccess()},t.handleAccept=function(){if(m.browseStore.context().isNonUserRelativeContext){var e=t.props.files[0];h.permanentDeleteFile(e.ns_id,e.ns_path,t.handlePurged)}else c.purgeFiles({files:t.props.files,userId:t.props.userId,onSuccess:t.handlePurged})},t}return n.__extends(t,e),t.prototype.isSingleSharedFolder=function(e){return 1===e.length&&e[0].type===p.FileTypes.SHARED_FOLDER},t.prototype.getTitle=function(e){var t=e.length;return this.isSingleSharedFolder(e)?S._("Remove access to folder?"):S.ungettext("Permanently delete %(num)s file?","Delete %(num)s items permanently?",t).format({num:t})},t.prototype.renderContent=function(e){var t=e.length;if(1===t){var n=d.filename(e[0].fq_path);return this.isSingleSharedFolder(e)?y.reactFormat(S._("Are you sure you want to remove your access to <strong>%(filename)s</strong>? It will no longer be viewable in your list of shared folders, and you won’t be able to re-add it to your Dropbox unless you’re re-invited."),{strong:r.createElement("strong",null),filename:n}):y.reactFormat(S._("Are you sure you want to delete <strong>%(filename)s</strong> from your Dropbox permanently?"),{strong:r.createElement("strong",null),filename:n})}return r.createElement("span",null,S.ungettext("Are you sure you want to permanently delete %(num)s item from your Dropbox?","Are you sure you want to permanently delete %(num)s items from your Dropbox?",t).format({num:t}))},t.prototype.render=function(){return r.createElement(f.Modal,{ref:"modal",title:this.getTitle(this.props.files),acceptButtonText:this.isSingleSharedFolder(this.props.files)?S._("Remove my access"):S._("Delete permanently"),dismissButtonText:S._("Cancel"),onAccept:this.handleAccept},this.renderContent(this.props.files))},t})(r.Component);M.defaultProps={onSuccess:o.noop},t.PermanentlyDeleteModal=M;var P=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleRestoreSuccess=function(){l.notifyRestoreSuccess(t.props.files),t.props.onSuccess()},t.handleRestoreClick=function(e){if(e.preventDefault(),m.browseStore.context().isNonUserRelativeContext){var n=t.props.files[0];h.restoreFile(n.ns_id,n.ns_path,n.latest_rev,t.handleRestoreSuccess)}else c.restoreFiles({files:t.props.files,userId:t.props.userId,onSuccess:t.handleRestoreSuccess});t.refs.modal.close()},t.handleCancelClick=function(e){e.preventDefault(),t.refs.modal.close()},t}return n.__extends(t,e),t.prototype.getTitle=function(e){return S.ungettext("Restore %(num)s file?","Restore %(num)s items…",e).format({num:e})},t.prototype.renderSingleFileContent=function(e,t){var n=d.filename(e.fq_path);return[y.reactFormat(S._("The most recent version of <strong>%(filename)s</strong> will be restored."),{strong:r.createElement("strong",null),filename:n}),r.createElement("div",{className:"file-modal__single-file-row"},r.createElement(u.FileIcon,{file:e,className:"file-modal__single-file-row-icon"}),!m.browseStore.context().isNonUserRelativeContext&&t?r.createElement("a",{href:t,className:"file-modal__single-file-row-link"},n):n)]},t.prototype.renderMultiFileContent=function(e){return r.createElement("span",null,S.ungettext("Are you sure you want to restore %(num)s item?","Are you sure you want to restore %(num)s items?",e.length).format({num:e.length}))},t.prototype.renderButtons=function(e){return r.createElement("div",{className:"file-modal__buttons"},e?r.createElement("div",{className:"file-modal__buttons__alt",ref:"revisionButton"},r.createElement("a",{href:e},S._("View other versions"))):void 0,r.createElement("div",{className:"file-modal__buttons__main"},r.createElement("button",{className:"button-primary db-modal-button",onClick:this.handleRestoreClick,ref:"primaryButton"},S._("Restore")),r.createElement("button",{className:"button-tertiary db-modal-button",onClick:this.handleCancelClick,ref:"tertiaryButton"},S._("Cancel"))))},t.prototype.render=function(){var e,t=this.props.files.length,n=null;return 1!==t||m.browseStore.context().isNonUserRelativeContext||(n=a.getFileHistoryUrl({fqPath:this.props.files[0].fq_path,userId:this.props.userId})),e=1===t?this.renderSingleFileContent(this.props.files[0],n):this.renderMultiFileContent(this.props.files),r.createElement(f.Modal,{ref:"modal",title:this.getTitle(t),buttonComponent:this.renderButtons(n)},e)},t})(r.Component);P.defaultProps={onSuccess:o.noop},t.RestoreFilesModal=_(P,["/static/css/react/file_modal-vfl5O9OmZ.css"]);var T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedPath:null},t.handleMoveSuccess=function(e){var n=e.changesets,r=e.rollbackHints,s=t.props.files.length,o=t.props.user;l.notifyMoveSuccess(s,o,n,t.state.selectedPath,r,t.props.onUndo),t.props.onSuccess(e)},t.handleCopySuccess=function(e){var n=e.changesets,r=e.rollbackHints,s=t.props.files.length,o=t.props.user;l.notifyCopySuccess(s,o,n,t.state.selectedPath,r,t.props.onUndo),t.props.onSuccess(e)},t.handleAccept=function(){var e,n=I();t.props.operation===N.MOVE?(e=n.moveFiles({path:t.props.path,files:t.props.files,newPath:t.state.selectedPath,userId:t.props.user.id,onSuccess:t.handleMoveSuccess}),e||t.props.onRequestNotSent&&t.props.onRequestNotSent()):t.props.operation===N.COPY&&(e=n.copyFiles({files:t.props.files,newPath:t.state.selectedPath,userId:t.props.user.id,onSuccess:t.handleCopySuccess}),e||t.props.onRequestNotSent&&t.props.onRequestNotSent())},t.handleFolderSelected=function(e){t.setState({selectedPath:e})},t.handleModalShown=function(){var e=s.findDOMNode(t.refs.treeView);if(e)return e.focus()},t}return n.__extends(t,e),t.prototype.getTitle=function(){var e,t=this.props.files.length;return this.props.operation===N.MOVE?e=this.props.files[0].is_dir?S.ungettext("Move %(num)s folder to…","Move %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):S.ungettext("Move %(num)s file to…","Move %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):this.props.operation===N.COPY&&(e=this.props.files[0].is_dir?S.ungettext("Copy %(num)s folder to…","Copy %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):S.ungettext("Copy %(num)s file to…","Copy %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'})),e.format({num:t})},t.prototype.getActionButtonText=function(){return this.props.operation===N.COPY?S._("Copy"):this.props.operation===N.MOVE?S._("Move"):void 0},t.prototype.render=function(){return r.createElement(f.Modal,{ref:"modal",title:this.getTitle(),acceptButtonText:this.getActionButtonText(),onAccept:this.handleAccept,acceptButtonDisabled:!this.state.selectedPath,autoFocusPrimaryInput:!1,onShow:this.handleModalShown,dismissButtonText:S._("Cancel")},r.createElement(g.FolderTreeView,{ref:"treeView",rootPath:"/",user:this.props.user,onFolderSelected:this.handleFolderSelected,isRootSelectable:!0,treeRootName:C(this.props.files,this.props.user)}))},t})(r.Component);T.defaultProps={onSuccess:o.noop},t.FileTransferModal=T;var k=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSuccess=function(e){var n=e.changesets,r=e.rollbackHints;return l.notifyDeleteSuccess(t.props.files.length,t.props.user,n,r,t.props.onUndo),t.props.onSuccess(e)},t.handleAccept=function(){var e=m.browseStore.context();return e.isNonUserRelativeContext?h.deleteFiles({files:t.props.files,context:e}):c.deleteFiles({files:t.props.files,userId:t.props.user.id,onSuccess:t.handleSuccess})},t.isRemovingSharedFolder=function(){return 1===t.props.files.length&&t.props.files[0].target_ns},t.getTitle=function(){var e=t.props.files;return e.length<1?"":1===e.length?e[0].is_dir?S._("Delete folder?"):S._("Delete file?"):S.ungettext("Delete %(item_count)s item?","Delete %(item_count)s items?",e.length).format({item_count:e.length})},t.getContents=function(){var e=t.props.files;if(e.length<1)return"";var n=d.filename(e[0].fq_path),s=e[0].target_ns;if(null!=t.props.parentSharedFolderName){var o=t.props.parentSharedFolderName;return 1===e.length?y.reactFormat(S._("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’?"),{filename:n,shared_folder_name:o,b:r.createElement("b",null)}):S.ungettext("Are you sure you want to delete %(item_count)s item from the shared folder ‘%(shared_folder_name)s’?","Are you sure you want to delete %(item_count)s items from the shared folder ‘%(shared_folder_name)s’?",e.length).format({item_count:e.length,shared_folder_name:o})}return 1===e.length&&s&&!m.browseStore.context().isNonUserRelativeContext?y.reactFormat(S._("Are you sure you want to remove the shared folder <b>%(filename)s</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."),{filename:n,b:r.createElement("b",null)}):1===e.length?y.reactFormat(S._("Are you sure you want to delete <b>%(filename)s</b> from your Dropbox?"),{filename:n,b:r.createElement("b",null)}):S.ungettext("Are you sure you want to delete %(item_count)s item from your Dropbox?","Are you sure you want to delete %(item_count)s items from your Dropbox?",e.length).format({item_count:e.length})},t}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(f.Modal,{ref:"modal",title:this.getTitle(),onAccept:this.handleAccept,acceptButtonText:this.isRemovingSharedFolder()&&!m.browseStore.context().isNonUserRelativeContext?S._("Remove"):S._("Delete"),dismissButtonText:S._("Cancel")},this.getContents())},t})(r.Component);k.defaultProps={onSuccess:o.noop,parentSharedFolderName:null},t.DeleteFileModal=k;var A=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptAndCloseModal=function(){t.handleAccept(),f.Modal.close()},t.upgradeRedirect=function(){var e=new E({path:"/plans",query:{trigger:"nr",tk:"oq_delete_modal"}});w.redirect(e.toString())},t}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(f.Modal,{ref:"modal",title:this.getTitle(),onAccept:this.handleAccept,buttonComponent:this.renderButtons(),acceptButtonText:this.isRemovingSharedFolder()?S._("Remove"):S._("Delete"),dismissButtonText:S._("Cancel")},this.getContents(),this.renderAdditionalContent())},t.prototype.renderAdditionalContent=function(){var e=this.props.files;return null==(null!=e?e.length:void 0)||e.length<1?"":e[0].target_ns&&1===e.length&&!m.browseStore.context().isNonUserRelativeContext?r.createElement("div",{className:"u-mar-top-s"},S._("Or, get more space for your files when you upgrade your account.")):!e[0].target_ns||e.length>1?r.createElement("span",{className:"oq-delete-file-modal-upsell__additional-text"},S._("Instead, get more space for your files when you upgrade your account.")):void 0},t.prototype.renderButtons=function(){return r.createElement("div",{className:"oq-delete-file-modal-upsell__buttons"},r.createElement("button",{className:"button-primary db-modal-button",onClick:this.upgradeRedirect,ref:"primaryButton"},S._("Upgrade")),r.createElement("button",{className:"button-tertiary db-modal-button u-mar-left-s",onClick:this.handleAcceptAndCloseModal,ref:"secondaryButton"},this.isRemovingSharedFolder()?S._("Remove"):S._("Delete")))},t})(k);t.ExpOQDeleteFileModal=A;var x=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){var e=t.props.files[0].fq_path;v.asyncGoToContentManagerForPath({isLimitedTeam:t.props.isLimitedTeam,containingFolder:d.parent_dir(e),filenameToSelect:d.filename(e),isCDM:!1})},t}return n.__extends(t,e),t.prototype.getModalMessage=function(){return"archive"===this.props.type?S._("You can archive team folders in the Admin Console."):"rename"===this.props.type?S._("You can rename team folders in the Admin Console."):void 0},t.prototype.render=function(){return r.createElement(f.Modal,{ref:"modal",style:"clean",onAccept:this.handleAccept,acceptButtonText:S._("Go to Admin Console"),altAction:r.createElement("a",{onClick:function(){return f.Modal.close()}},S._("Cancel")),width:350,showX:!1,className:"content-manager-bridge-modal"},this.getModalMessage())},t})(r.Component);t.ContentManagerBridgeModal=x;var F=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptClick=function(){t.props.userIsSuperAdmin&&t.props.userIsSameTeam&&v.asyncGoToContentManagerForPath({isLimitedTeam:!1,containingFolder:t.props.folderPath,isCDM:!0})},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.userIsSuperAdmin&&this.props.userIsSameTeam,t="";return t=e?S._("You aren’t a member of this folder. However, as an admin, you can access it via the content tab in the Admin Console."):this.props.userIsSameTeam?S._("You don’t have permission to open the folder “%(folder_name)s”. Contact your <admin_link>team admins</admin_link> to gain access."):S._("You don’t have permission to open the folder “%(folder_name)s”."),r.createElement(f.Modal,{ref:"modal",style:"default",acceptButtonText:e?S._("Go to the content tab"):S._("Done"),dismissButtonText:e?S._("Cancel"):null,onAccept:this.handleAcceptClick,title:S._("No access to the folder “%(folder_name)s”").format({folder_name:i.em_snippet(this.props.folderName,b.SNIPPET_SIZES.FILENAME)})},r.createElement("div",null,y.reactFormat(t,{folder_name:i.em_snippet(this.props.folderName,b.SNIPPET_SIZES.FILENAME),admin_link:r.createElement("a",{href:"/team?_tk=left_nav_team",target:"_blank",key:"admin_link",rel:"noopener noreferrer"})})))},t})(r.Component);t.NoAccessFolderModal=F;var L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptAndCloseModal=function(){t.props.onAccept(),f.Modal.close()},t}return n.__extends(t,e),t.prototype.render=function(){var e=S._("If you make this move, you'll no longer be the owner of some of the folders.");return r.createElement(f.Modal,{ref:"modal",style:"default",onAccept:this.handleAcceptAndCloseModal,acceptButtonText:S._("Move items anyways"),dismissButtonText:S._("Cancel"),title:S._("Move items?")},r.createElement("div",null,e))},t})(r.Component);t.ConfirmOwnershipTransferModal=L}),define("modules/clean/react/overquota_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/static_urls","modules/clean/react/modal","modules/constants/payments"],function(e,t,n,r,s,o,a,i,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype._renderButtons=function(){var e=d.OUT_OF_SPACE_URL+"?oqa=upl_f";return r.createElement(l.ModalButtons,{className:"oq-modal__buttons"},r.createElement("a",{href:e,id:"oq-cta-button",className:"mc-button mc-button-primary"},a._("Get more space")))},t.prototype._renderContentTitle=function(){return r.createElement("p",{className:"oq-modal__content--title"},a._("Your Dropbox is full"))},t.prototype._renderImage=function(){return r.createElement(o,{src:i.static_url("/static/images/pro/overquota/overquota-folder-vflgFxxXj.png"),srcHiRes:i.static_url("/static/images/pro/overquota/overquota-folder@2x-vfloUmya6.png")})},t.prototype.render=function(){return r.createElement(l.Modal,{className:"overquota_modal",title:a._("Your Dropbox is full"),buttonComponent:this._renderButtons(),showX:!0},r.createElement("div",{className:"oq-modal__content"},this._renderImage(),this._renderContentTitle(),r.createElement("p",null,a._("Before you can update or move your files, you need more space."))))},t})(r.Component);t.OverquotaModalElement=c,t.OverquotaModal=s(c,["/static/css/react/overquota_modal-vfl5xwYAN.css"])}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/radio",["external/classnames","external/react","external/react-dom"],function(t,n,r){var s,o,a,i,l,d;return n.DOM,d=n.PropTypes,a={Normal:"normal",Large:"large"},l=Object.keys(a).map(function(e){return a[e]}),i=d.oneOfType([d.string,d.number,d.bool]),o=n.createClass({displayName:"RadioItem",propTypes:{className:d.string,value:i,_radioGroupData:d.shape({variant:d.oneOf(l),name:d.string.isRequired,radioGroupValue:i,onSelect:d.func})},_handleClick:function(){var e;this._isSelected()||(r.findDOMNode(this.refs.input).focus(),"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value))},_handleChange:function(){var e;"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value)},_getId:function(){return this.props._radioGroupData.name+"_"+this.props.value},_isSelected:function(){return this.props._radioGroupData.radioGroupValue===this.props.value},render:function(){var r,s,o,i;return s=this.props._radioGroupData,i=["c-radio-wrapper",this.props.className],r={"c-radio":!0,"c-radio--selected":this._isSelected()},o=s.variant,e.call(l,o)>=0&&s.variant!==a.Normal&&(r["c-radio--"+s.variant]=!0),n.createElement("div",{className:t(i),onClick:this._handleClick},n.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:s.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),n.createElement("div",{className:t(r)},n.createElement("div",{className:"c-radio__inner"})),n.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))}}),s=n.createClass({displayName:"RadioGroup",propTypes:{className:d.string,variant:d.oneOf(l),name:d.string,legend:d.string.isRequired,align:d.oneOf(["top","bottom","middle","baseline"]),displayLegend:d.bool,valueLink:d.object},getDefaultProps:function(){return{className:null,type:a.Normal,align:"middle",displayLegend:!1}},_onRadioItemSelect:function(e){var t;null!=(t=this.props.valueLink)&&t.requestChange(e)},render:function(){var e,r,s,a;return r=this.props.name||"radio-"+Math.floor(1e9*Math.random()),e=n.Children.map(this.props.children,(function(e){return function(t){return t.type===o?n.cloneElement(t,{_radioGroupData:{variant:e.props.variant,name:r,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):t}})(this)),s={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},a=["c-radio-group","align-"+this.props.align,this.props.className],n.createElement("fieldset",{className:t(a)},n.createElement("legend",{className:t(s)},this.props.legend),e)}}),{RadioGroup:s,RadioItem:o,RadioItemVariant:a}})}.call(this),function(){define("modules/clean/react/sharing/shared_with_view",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/size","modules/clean/components/loading_indicator","modules/clean/components/title_bubble","modules/clean/sharing/constants","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/sharing/api/types/metadata","modules/clean/sharing/member_avatars","modules/clean/static_urls","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/viewer","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_){var f,g,y,v,b,w,S,E,I,C,N,M,P,T,k,A,x,F;return g=r.AVATAR_DIMENSION_BY_SIZE,I=a.SNIPPET_SIZES,M=a.TRUELINK,v=l.File,b=d.LinkAudience,C=d.SharedContentLinkMetadata,x=p.static_url,P=u.UserEducationEffect,T=_._,F=_.ungettext,A=t.DOM,k=t.createElement,w=5,f=g.SMALL,y=12,S="--",E="--",N=t.createClass({displayName:"SharedWithView",mixins:[c],propTypes:{user:t.PropTypes.object.isRequired,file:t.PropTypes.instanceOf(v),onOverflowCountClick:t.PropTypes.func,onAvatarClick:t.PropTypes.func,groups:t.PropTypes.array,invitations:t.PropTypes.array,joinedMembers:t.PropTypes.array,numUndisplayableUsersAndInvites:t.PropTypes.number,memberCount:t.PropTypes.number,numInheritedMembers:t.PropTypes.number,parentFolderName:t.PropTypes.string,animation:t.PropTypes.bool,titleButtonDirection:t.PropTypes.string,avatarDimension:t.PropTypes.number,maxVisibleAvatars:t.PropTypes.number,sharedLinkInfo:t.PropTypes.object,onSharedLinkClick:t.PropTypes.func,isMaestroDesign:t.PropTypes.bool,inSelectMode:t.PropTypes.bool,isInAudienceBox:t.PropTypes.bool,audienceDescription:t.PropTypes.string,hasSharedDataLoaded:t.PropTypes.bool,canViewMembers:t.PropTypes.bool,inContentManagerCdmRoot:t.PropTypes.bool,linkMetadata:t.PropTypes.instanceOf(C),publicFolderSharing:t.PropTypes.bool},getDefaultProps:function(){return{titleButtonDirection:"south",avatarDimension:f,maxVisibleAvatars:w,file:null,canViewMembers:!0,inContentManagerCdmRoot:!1,inSelectMode:!1,memberCount:0}},render:function(){var e,t;return this.props.inContentManagerCdmRoot?0===this.props.groups.length?A.div({}):(e=this.props.groups[0].num_users,A.div({className:"audience-description",onClick:function(e){return e.stopPropagation()}},F("%(num)s member","%(num)s members",e).format({num:e}))):this.props.isInAudienceBox?this.props.canViewMembers?(null!=(t=this.props.file)?t.isDeleted:void 0)?null:A.div({className:this.getClassName()},this.props.hasSharedDataLoaded?k(P,{containerName:this.constructor.displayName,name:"AudienceBoxAvatars"},this.renderAudienceBoxAvatars()):k(s,{style:s.LoadingIndicatorStyle.DOTS})):null:this.props.isMaestroDesign?A.div({className:this.getClassName()},this._hasSharedLink()?this.renderSharedLinkInColumn():void 0,this.renderAudienceDescription()):A.div({className:this.getClassName()},this.renderAvatars())},getClassName:function(){return e({"shared-with-members":!0,"shared-with-members--golden-gate":!this.props.isMaestroDesign,clearfix:!0,"audience-box u-pad-top-xs u-pad-bottom-s u-mar-bottom-xs":this.props.isInAudienceBox})},renderSharedLinkInColumn:function(){var e,t;return t=this.props.onSharedLinkClick,e=this.props.inSelectMode,k(o,{key:"shared_link",text:this.getDescriptionForSharedLinkInfo(this.props.sharedLinkInfo,this.props.linkMetadata),direction:this.props.titleButtonDirection,className:"audience-description__link-avatar"},A.img({src:x("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||T("Shared link"),width:y,height:y,onClick:function(n){if(!e)return t(),n.stopPropagation()}}))},renderAudienceDescription:function(){var e,t,n,r,s,a,l,d,c,p,u,m,h,_,f,g,y;return this.props.hasSharedDataLoaded?((null!=(_=this.props.file)?_.isDeleted:void 0)?n=T("Deleted"):this.props.canViewMembers?this.props.audienceDescription&&(n=this.props.audienceDescription):n=E,r=(this.props.groups||[]).concat(this.props.joinedMembers||[]).concat(this.props.invitations||[]),p=r.length+(this.props.numUndisplayableUsersAndInvites||0),f=this.findOwnerAndMeInJoinedMembers(this.props.joinedMembers||[]),f[0],c=f[1],p>=0&&(1!==p||null==c)&&(n||(n=F("%(num)s member","%(num)s members",this.props.memberCount).format({num:this.props.memberCount})),y=r.slice(0,this.props.maxVisibleAvatars),m=(function(){var e,t,n;for(n=[],e=0,t=y.length;e<t;e++)d=y[e],n.push(i.em_snippet(d.display_name||d.email||d.name||d.email_or_fbname,I.DISPLAY_NAME));return n})(),p>this.props.maxVisibleAvatars&&(m.pop(),e=p-(this.props.maxVisibleAvatars-1),u=F("and %(num)s more...","and %(num)s more...",e,{comment:"Number of additional members in the file. Expected to be >= 2."}).format({num:e}),m.push(u)),s=m.join("\n")),this.props.publicFolderSharing&&this.props.file&&!this.props.file.is_dir?n||(n=T("Anyone")):n||(n=T("Only you")),h=this.props.onAvatarClick,a=this.props.inSelectMode,l=null!=(g=this.props.file)?g.isDeleted:void 0,t=A.div({className:"audience-description",onClick:function(e){if(!a&&!l)return h(),e.stopPropagation()}},n),s?k(o,{key:"membership_column_bubble",respectLineBreaks:!0,text:s,direction:this.props.titleButtonDirection},t):t):null},renderAudienceBoxAvatars:function(){var e,t,n,r,s,o,a;return e=[],r=this.props.joinedMembers?this.props.joinedMembers:[],t=this.props.groups?this.props.groups.slice():[],n=this.props.invitations?this.props.invitations.slice():[],this._addSharedLinkIfExists(e),a=[],o=this.findOwnerAndMeInJoinedMembers(r),o[0],s=o[1],null!=s&&(a.push(s.user_id),e.push(this.renderJoinedMember(s))),this.addGroupsMembersInvitations(e,t,r,n,a),1===e.length&&null!=s?A.div({className:"audience-box--text-only"},T("Only you have access")):this.renderAvatarList(e)},renderAvatars:function(){var e,t,n,r,s,o,a,i,l;return(null!=(a=this.props.file)?a.isDeleted:void 0)?A.span({"aria-hidden":!0},T("deleted")):(s=this.props.joinedMembers?this.props.joinedMembers:[],n=this.props.groups?this.props.groups.slice():[],r=this.props.invitations?this.props.invitations.slice():[],e=[],this._addSharedLinkIfExists(e),l=[],i=this.findOwnerAndMeInJoinedMembers(s),i[0],o=i[1],null!=o&&l.push(o.user_id),this.addGroupsMembersInvitations(e,n,s,r,l),t=0===e.length&&0===this.props.numInheritedMembers,t?this.props.hasSharedDataLoaded?A.span({"aria-hidden":!0},S):void 0:this.renderAvatarList(e))},_addSharedLinkIfExists:function(e){if(this._hasSharedLink())return M.TRUELINK_UI[this.props.user.id]?e.push(this.renderSharedLink(null,this.props.linkMetadata)):e.push(this.renderSharedLink(this.props.sharedLinkInfo))},_hasSharedLink:function(){return M.TRUELINK_UI[this.props.user.id]?this.props.linkMetadata&&this.props.linkMetadata.current_audience!==b.members:Boolean(this.props.sharedLinkInfo)}}),{SharedWithView:N}})}.call(this),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/starred/store","modules/clean/react/starred/browse_update","modules/clean/react/starred/star","modules/clean/react/starred/actions"],function(e,t,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=n.StarredStore,t.checkForMissingBrowseStarredData=r.checkForMissingBrowseStarredData,t.Star=s.Star,t.StarredActions=o.StarredActions}),define("modules/clean/react/starred/browse_update",["require","exports","modules/clean/react/home/home_access/home_access_util","modules/clean/react/browse/store","modules/clean/react/starred/actions","modules/constants/starred","modules/clean/react/starred/store"],function(e,t,n,r,s,o,a){"use strict";function i(e){if(n.isHomeEnabled()&&!r.browseStore.context().isNonUserRelativeContext){var t=e.map(function(e){return{type:o.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,id:e.file_id}}).filter(function(e){return!(!e.id||a.StarredStore.hasIdTypePair(e))});t.length&&s.StarredActions.fetchStatuses(r.browseStore.user().role,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingBrowseStarredData=i}),function(){define("modules/clean/react/tabs/tab_bar",["jquery","external/classnames","external/underscore","external/react","external/react-dom","modules/clean/css","modules/clean/keycode","modules/clean/react/tabs/tab_util"],function(e,t,n,r,s,o,a,i){var l,d;return l=a.KeyCode,d=r.PropTypes,r.createClass({displayName:"TabBar",propTypes:{tabs:d.arrayOf(d.oneOfType([d.string,d.number,d.shape({value:d.oneOfType([d.string,d.number]),label:d.string,rightAlign:d.bool})])).isRequired,selectedIndex:d.number,onChange:d.func,idPrefix:d.string},getDefaultProps:function(){return{selectedIndex:0,onChange:function(){}}},componentDidMount:function(){return this._fixTabWidth()},componentDidUpdate:function(){return this._fixTabWidth()},_cleanUpTabWidth:function(){return e("a",s.findDOMNode(this)).css("width","")},_fixTabWidth:function(){return this._cleanUpTabWidth(),e("a",s.findDOMNode(this)).width(function(){return e(this).width()})},_normalizedTabs:function(){return this.props.tabs.map(function(e){return"string"!=typeof e&&"number"!=typeof e||(e={value:e,label:e}),e})},_onKeydown:function(e){var t,n,r,s;if(s=this._normalizedTabs(),t=null,(n=e.keyCode)===l.LEFT||n===l.UP?t=0===this.props.selectedIndex?s.length-1:this.props.selectedIndex-1:(r=e.keyCode)!==l.RIGHT&&r!==l.DOWN||(t=this.props.selectedIndex===s.length-1?0:this.props.selectedIndex+1),null!=t)return e.preventDefault(),this._selectTab(t,{focusOnTab:!0})},_selectTab:function(e,t){var n;if(null==t&&(t={}),n=this._normalizedTabs()[e],this.props.onChange(n.value,e),t.focusOnTab===!0)return s.findDOMNode(this.refs[e]).focus()},_onClick:function(e,t){if(t.preventDefault(),e!==this.props.selectedIndex)return this._selectTab(e,{focusOnTab:!0})},_renderTab:function(e,n,s){var o,a,l,d,c;return a=t({"c-tabs__tab":!0,"c-tabs__tab--selected":n===this.props.selectedIndex,"c-tabs__tab--fr":e.rightAlign,"c-tabs__tab--rightmost":s}),d=n===this.props.selectedIndex,l=e.contentId?e.contentId:d?i.getTabContentId(this.props.idPrefix):"",c=d?"0":"-1",o=r.createElement("a",{href:"#",ref:n,id:i.getTabId(this.props.idPrefix,n),onClick:this._onClick.bind(this,n),onKeyDown:this._onKeydown,role:"tab","aria-selected":d,"aria-controls":l,tabIndex:c,className:"c-tabs__label"},e.label),r.createElement("li",{key:n,className:a,role:"presentation","data-value":e.value},o)},render:function(){var e,t,n,s;return s=this._normalizedTabs(),t=function(){var t,r,o;for(o=[],e=t=0,r=s.length;t<r;e=++t)n=s[e],o.push(this._renderTab(n,e,e===s.length-1));return o}.call(this),r.createElement("ul",{className:"c-tabs__bar",role:"tablist",ref:"tablist"},t)}})})}.call(this),function(){define("modules/clean/react/tabs/tab_nav",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/css","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/clean/react/tabs/tabs"],function(e,t,n,r,s,o,a,i){var l,d,c,p;return d=i.TabContent,p=r.DOM,l=r.PropTypes,c=r.createClass({displayName:"TabNav",propTypes:{tabs:l.arrayOf(l.oneOfType([l.string,l.number,l.shape({value:l.oneOfType([l.string,l.number]),label:l.string,rightAlign:l.bool})])),defaultSelectedIndex:l.number,onChange:l.func,idPrefix:l.string,variant:l.string,className:l.string},getDefaultProps:function(){return{defaultSelectedIndex:0,variant:a.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){return{selectedIndex:this.props.defaultSelectedIndex}},componentWillReceiveProps:function(e){if(this.props.defaultSelectedIndex!==e.defaultSelectedIndex)return this.setState({selectedIndex:e.defaultSelectedIndex})},_onChange:function(e,t){return this.props.onChange(e,t),this.setState({selectedIndex:t})},render:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),p.div({className:n(this.props.variant,this.props.className)},r.createElement(o,{tabs:this.props.tabs,onChange:this._onChange,idPrefix:e,selectedIndex:this.state.selectedIndex}),r.createElement(d,{isSelected:!0,id:a.getTabContentId(e),tabId:a.getTabId(e,this.state.selectedIndex)},this.props.children))}}),s(c,["/static/css/legacy_packages/components-vflRbDbou.css"])})}.call(this),function(){define("modules/clean/react/tabs/tab_util",[],function(){return{variants:{DEFAULT:"c-tabs",CENTER:"c-tabs c-tabs--center",MINIMAL:"c-tabs c-tabs--minimal",UNDERLINE:"c-tabs--underline",OVERLINE:"c-tabs--overline"},getTabId:function(e,t){return e+"_tab"+(null!=t?t:"")},getTabContentId:function(e,t){return e+"_tabcontent"+(null!=t?t:"")}}})}.call(this),function(){define("modules/clean/react/tabs/tabs",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/core/browser"],function(e,t,n,r,s,o,a){var i,l,d,c;return c=r.DOM,i=r.PropTypes,d=r.createClass({displayName:"Tabs",propTypes:{idPrefix:i.string,variant:i.string,selectedIndex:i.number,onChange:i.func,className:i.string},getDefaultProps:function(){return{variant:o.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),{selectedIndex:0,idPrefix:e}},componentWillMount:function(){var t,n,s;return s=[],n=this.state.selectedIndex,t=this.state.idPrefix,r.Children.forEach(this.props.children,function(e,r){var a;if(a=o.getTabContentId(t,r),s.push({label:e.props.title,contentId:a,hashPrefix:e.props.hashPrefix,hashURL:e.props.hashURL,rightAlign:e.props.rightAlign
}),e.props.isSelected)return n=r}),this.setState({tabs:s,selectedIndex:n}),e(window).on("hashchange",this._selectTabFromHash)},componentWillReceiveProps:function(e){if(void 0!==e.selectedIndex&&e.selectedIndex!==this.state.selectedIndex)return this.setState({selectedIndex:e.selectedIndex})},componentWillUnmount:function(){return e(window).off("hashchange",this._selectTabFromHash)},componentDidMount:function(){return this._selectTabFromHash()},_onChange:function(e,t){var n;return this.setState({selectedIndex:t}),n=this.state.tabs[t],n.hashURL&&a.set_hash(n.hashURL),this.props.onChange(e,t)},_selectTabFromHash:function(){var e,t,n,r,s,o,i,l,d;if(e=a.get_hash(),null!=e){for(d=this.state.tabs,i=[],r=s=0,o=d.length;s<o;r=++s){if(l=d[r],t=l.hashPrefix,n=l.hashURL,null!=t&&0===(null!=e?e.indexOf(t):void 0)||e===n){this.setState({selectedIndex:r});break}i.push(void 0)}return i}},render:function(){return c.div({className:n(this.props.variant,this.props.className)},r.createElement(s,{tabs:this.state.tabs,onChange:this._onChange,idPrefix:this.state.idPrefix,selectedIndex:this.state.selectedIndex}),r.Children.map(this.props.children,(function(e){return function(t,n){return r.cloneElement(t,{isSelected:n===e.state.selectedIndex,id:o.getTabContentId(e.state.idPrefix,n),tabId:o.getTabId(e.state.idPrefix,n)})}})(this)))}}),l=r.createClass({displayName:"TabContent",propTypes:{id:i.string,isSelected:i.bool,tabId:i.string,hashPrefix:i.string,hashURL:i.string,title:i.string},render:function(){var e;return e={"c-tabs__content":!0,"c-tabs__content--selected":this.props.isSelected},c.div({id:this.props.id,className:n(e),role:"tabpanel","aria-labelledby":this.props.tabId},this.props.children)}}),{Tabs:d,TabContent:l}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_folder_settings_modal",["external/react","external/underscore","modules/core/i18n","modules/clean/analytics","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/sharing/folder_settings_modal","modules/constants/python"],function(e,t,n,r,s,o,a,i){var l,d,c,p,u;return p=n._,c=r.TeamsWebActionsLogger,l=s.Modal,d=a.SharedFolderSettingsModal,u=e.createElement,{showWithProps:function(e){var n,r;return n={altAction:u(o,{upsellText:p("Want to access these settings as well as other admin controls? Upgrade to %(trademark_business)s.").format({trademark_business:i.TRADEMARK_BUSINESS}),upgradeButtonText:p("Upgrade now"),redirectQuery:{tk:"team_settings",_camp:"modal"},logEventName:"team_folder_settings_upsell"})},r=l.showInstance(u(d,t(e).extend(n))),c.log("team_folder_settings",null,null,null,!1,c.LOG_CATEGORY.TEAM_INFO),r}}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["external/react","modules/core/i18n","modules/clean/analytics","modules/clean/filepath","modules/clean/react/modal","modules/core/browser","modules/core/uri"],function(e,t,n,r,s,o,a){var i,l,d,c,p,u,m;return c=t._,d=n.TeamsWebActionsLogger,l=s.Modal,m=e.DOM,u=e.createElement,p=function(e){return d.log(e,null,null,null,!1,d.LOG_CATEGORY.TEAM_INFO)},i=e.createClass({mixins:[e.addons.PureRenderMixin],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:e.PropTypes.string.isRequired},_navigateToTeam:function(){return p("team_folder_share_invite"),o.redirect(a({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))},render:function(){var e;return e=r.filename(this.props.fqPath),u(l,{title:c("Share %(folder_name)s").format({folder_name:e}),acceptButtonText:c("Invite"),onAccept:this._navigateToTeam,showButtonDivider:!0},m.div({},c("To share the %(folder_name)s with someone, invite them to join your team!").format({folder_name:e})))}}),{showModalInstance:function(e){var t;return t=l.showInstance(u(i,e)),p("team_folder_share"),t}}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,n,r,s){var o,a,i,l,d;return a=r.button,o=s.TeamsWebActionsLogger,l=e.DOM,i=e.createElement,d=e.PropTypes,e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:d.string.isRequired,upsellText:d.string.isRequired,logEventName:d.string,redirectUrl:d.string,redirectQuery:d.shape({tk:d.string,_camp:d.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&o.log(this.props.logEventName,{},null,null,!1,o.LOG_CATEGORY.UPGRADE),t.redirect(n({path:this.props.redirectUrl?this.props.redirectUrl:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return l.div({className:"modal-upsell-bar"},l.div({className:"modal-upsell-bar__message"},this.props.upsellText),l.div({className:"modal-upsell-bar__action"},i(a,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})})}.call(this),define("modules/clean/react/tree_view",["require","exports","tslib","external/classnames","external/immutable","external/react","external/react-dom","external/underscore","jquery","modules/clean/ajax","modules/clean/em_string","modules/clean/filepath","modules/clean/keycode","modules/clean/react/browse/store","modules/clean/react/css","modules/clean/react/sprite","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LABEL_LENGTH=20,t.INDENT_SIZE_PX=15;var v;(function(e){e[e.None=0]="None",e[e.TreeItem=1]="TreeItem",e[e.HeaderItem=2]="HeaderItem",e[e.StaticHeader=3]="StaticHeader"})(v=t.RootStyle||(t.RootStyle={}));var b=(function(){function e(e){this.key=e.key,this.label=e.label?e.label:"",this.icon=e.icon?e.icon:null,this.disabled=!!e.disabled,this.canExpand=!!e.canExpand,this.forceExpanded=!!e.forceExpanded}return e})();t.TreeItem=b;var w=(function(){function e(e){var t=s.Map();this.rootItem=e.rootItem,this.items=e.items,this.childItemsByParentKey=e.childItemsByParentKey||t,this.parentItemByChildKey=e.parentItemByChildKey||s.Map()}return e.createWithRootItem=function(t){return new e({rootItem:t,items:s.Map([[t.key,t]])})},e.prototype.getParentItem=function(e){if(e){var t=this.parentItemByChildKey.get(e.key);return t?this.items.get(t):null}},e.prototype.getChildItems=function(e){return this.childItemsByParentKey.get(e.key)||null},e.prototype.isParent=function(e){return this.childItemsByParentKey.has(e.key)},e.prototype.setChildItems=function(t,n){n=s.List(n);var r=s.Map(n.map(function(e){return[e.key,e]})),o=s.Map(this.items).merge(r),a=s.Map(this.childItemsByParentKey).set(t.key,n),i=s.Map(this.parentItemByChildKey);return n.forEach(function(e){return i=i.set(e.key,t.key)}),new e({rootItem:this.rootItem,items:o,childItemsByParentKey:a,parentItemByChildKey:i})},e})();t.Tree=w;var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("ul",{className:"tree-view__group",role:"group"},this.props.children)},t})(o.Component),E=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){if(e.preventDefault(),e.stopPropagation(),!t.props.item.disabled){var n=a.findDOMNode(t.refs.expandButton);n&&n.contains(e.target)||t.props.onClick&&t.props.onClick(t.props.item)}},t.handleExpandClick=function(e){e.preventDefault(),t.props.onExpandButtonClick&&t.props.onExpandButtonClick(t.props.item,!t.props.isExpanded)},t}return n.__extends(s,e),s.prototype.renderExpandButton=function(){return o.createElement("div",{className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},o.createElement(_,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:this.props.isExpanded?g._("Collapse"):g._("Expand")}))},s.prototype.renderIcon=function(){return o.createElement("div",{className:"tree-view__icon-wrapper"},o.createElement(_,{className:"tree-view__item-icon",group:"web",name:this.props.item.icon,alt:""}))},s.prototype.render=function(){var e=!this.props.canExpand,n=r({"tree-view__item":!0,"tree-view__item--leaf":e}),s=this.props.canExpand&&!this.props.showAsHeader;return o.createElement("li",{key:this.props.item.key,id:this.props.id,className:n,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1,"aria-selected":!!this.props.isSelected||void 0,"aria-expanded":s?this.props.isExpanded:void 0},o.createElement("span",{className:r({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*t.INDENT_SIZE_PX}},this.props.showAsHeader||e?void 0:this.renderExpandButton(),this.props.item.icon?this.renderIcon():void 0,this.props.item.label?o.createElement("span",{className:"tree-view__item-label"},c.em_snippet(this.props.item.label,t.MAX_LABEL_LENGTH)):void 0),this.props.children)},s})(o.Component);E.defaultProps={isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:i.noop,onExpandButtonClick:i.noop,showAsHeader:!1},t.TreeItemView=E;var I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return this.props.item.icon?o.createElement(_,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null},t.prototype.render=function(){return o.createElement("div",{className:"tree-view__item-row"},this.renderIcon(),o.createElement("h3",{className:"tree-view__header",id:this.props.id},this.props.item.label))},t})(o.Component),C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedItemKey:null,expandedItemKeys:s.Set([t.props.tree.rootItem.key]),showFocused:!1},t.selectItem=function(e){t.setState({selectedItemKey:null!=e&&e.key?e.key:null}),t.props.onItemSelected(e)},t.handleExpandButtonClick=function(e,n){t.setState({expandedItemKeys:t.setItemExpanded(e.key,n)}),t.props.onItemExpanded(e,n)},t.handleKeyDown=function(e){switch(e.which){case u.KeyCode.UP:t.advanceSelection(!0)&&e.preventDefault();break;case u.KeyCode.DOWN:t.advanceSelection(!1)&&e.preventDefault();break;case u.KeyCode.RIGHT:if(null!=t.state.selectedItemKey){var n=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(n)&&(t.handleExpandButtonClick(n,!0),e.preventDefault())}break;case u.KeyCode.LEFT:if(t.state.selectedItemKey){var n=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(n)&&(t.handleExpandButtonClick(n,!1),e.preventDefault())}}},t.handleOnFocus=function(){return t.setState({showFocused:!0})},t.handleOnBlur=function(){return t.setState({showFocused:!1})},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){l(a.findDOMNode(this)).on({keydown:this.handleKeyDown})},t.prototype.componentWillUnmount=function(){l(a.findDOMNode(this)).off("keydown")},t.prototype.componentDidUpdate=function(e,t){if(this.state.selectedItemKey&&this.state.selectedItemKey!==t.selectedItemKey){var n=l(a.findDOMNode(this)),r=n.find('[aria-selected="true"]').eq(0);r.length&&this.scrollElementIntoViewIfNeeded(r,n)}},t.prototype.scrollElementIntoViewIfNeeded=function(e,t){var n=t.scrollTop(),r=n+e.position().top;if(r-n<0)return void t.scrollTop(r);var s=t.innerHeight(),o=n+s,a=e.innerHeight();r+a>o&&t.scrollTop(r-s+a)},t.prototype.hasSelectableRootItem=function(){var e=this.props.rootStyle;return e===v.TreeItem||e===v.HeaderItem},t.prototype.getHTMLIdPrefix=function(){return this.HTMLIdPrefix||(this.HTMLIdPrefix="tree-view-"+Math.floor(16777215*Math.random()).toString(16))},t.prototype.getLastLeafOf=function(e){var t=this.props.tree.getChildItems(e);return this.state.expandedItemKeys.contains(e.key)&&null!=t&&t.size>0?this.getLastLeafOf(t.last()):e},t.prototype.getPrevItem=function(e){if(!e)return null;var t=this.props.tree.getParentItem(e);if(!t)return null;var n=this.props.tree.getChildItems(t),r=n.indexOf(e);if(r>0)return this.getLastLeafOf(n.get(r-1));if(0===r){return t===this.props.tree.rootItem&&!this.hasSelectableRootItem()?null:t}return null},t.prototype.getNextItem=function(e,t){if(void 0===t&&(t=!0),!e)return null;var n=this.state.expandedItemKeys.contains(e.key),r=n&&this.props.tree.isParent(e);if(t&&r)return this.props.tree.getChildItems(e).first();var s=this.props.tree.getParentItem(e);if(!s)return null;var o=this.props.tree.getChildItems(s),a=o.size-1,i=o.indexOf(e);return i===a?this.getNextItem(s,!1):0<=i&&i<a?o.get(i+1)||null:null},t.prototype.advanceSelection=function(e){if(void 0===e&&(e=!1),!this.state.selectedItemKey){var t=void 0;if(this.hasSelectableRootItem())t=this.props.tree.rootItem;else{var n=this.props.tree.getChildItems(this.props.tree.rootItem);t=n?n.first():null}return this.selectItem(t),!0}var r=this.props.tree.items.get(this.state.selectedItemKey),s=e?this.getPrevItem(r):this.getNextItem(r);return!!s&&(this.selectItem(s),!0)},t.prototype.getValidHTMLIdForItem=function(e){return(""+this.getHTMLIdPrefix()+e.key).replace(/\s+/g,"_")},t.prototype.setItemExpanded=function(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)},t.prototype.canItemExpand=function(e){return e&&(e.canExpand||this.props.tree.isParent(e))},t.prototype.renderSingleItem=function(e,t,r,s){void 0===s&&(s={});var a=n.__assign({id:this.getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this.canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},s),i=this.props.treeItemView;return o.createElement(i,n.__assign({},a),r)},t.prototype.renderItemAndDescendants=function(e,t){var n,r=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded;return this.props.tree.isParent(e)&&r&&(n=this.renderChildrenOfItemAsGroup(e,t+1)),this.renderSingleItem(e,t,n)},t.prototype.renderChildrenOfItemAsGroup=function(e,t){var n=this;if(!e||!this.props.tree.isParent(e))return null;var r=this.props.tree.getChildItems(e).map(function(e){return n.renderItemAndDescendants(e,t)});return o.createElement(S,null,r.toJS())},t.prototype.render=function(){var e,t,n,s=this.props.tree.rootItem;if(this.props.rootStyle===v.TreeItem)t=o.createElement(S,null,this.renderItemAndDescendants(s,0));else if(this.props.rootStyle===v.HeaderItem)e=this.getValidHTMLIdForItem(s),t=o.createElement(S,null,this.renderSingleItem(s,0,null,{showAsHeader:!0,id:e}),this.renderChildrenOfItemAsGroup(s,0));else if(this.props.rootStyle===v.StaticHeader)e=this.getValidHTMLIdForItem(s),t=o.createElement(S,null,o.createElement(I,{item:s,id:e}),this.renderChildrenOfItemAsGroup(s,0));else{if(this.props.rootStyle!==v.None)throw new Error("Unknown root style: "+this.props.rootStyle);t=this.renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}if(this.state.selectedItemKey){var a=this.props.tree.items.get(this.state.selectedItemKey);n=this.getValidHTMLIdForItem(a)}return o.createElement("div",{role:"tree",tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:r("tree-view","ax-focusable",{"is-focused":this.state.showFocused}),"aria-labelledby":e?e:void 0,"aria-activedescendant":n},t,this.props.children)},t})(o.Component);C.defaultProps={rootStyle:v.None,onItemSelected:function(e){},onItemExpanded:function(e,t){},treeItemView:E},t.TreeView=h(C,["/static/css/react/tree_view-vflwT7sZY.css","/static/css/accessibility-vflMqZNeg.css"]);var N=(function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._pendingAjaxRequest=null,t.state={showLoadingScreen:!1,tree:void 0},t.asyncFetchSubFoldersForItem=function(e){var n,r,s=e.key,o=e===t.state.tree.rootItem;o&&t.setState({showLoadingScreen:!0});var a=m.browseStore.context();a.isNonUserRelativeContext?(r="/browse_util/tree_view_team_folder_contents",n={ns_id:a.rootNSID,ns_path:s,hide_tmfs:!0}):(r="/browse_util/tree_view_folders",n={folder:s}),t._pendingAjaxRequest&&t._pendingAjaxRequest.abort(),t._pendingAjaxRequest=d.WebRequestOref({url:r,type:"POST",subject_user:t.props.user.id,data:n,success:function(n){var r=t.parseFolderList(n),s=t.state.tree.setChildItems(e,r);t.setState({tree:s})},error:function(){y.error(g._("An error occurred while trying to load your folder."))},complete:function(){null!=t._pendingAjaxRequest&&(t._pendingAjaxRequest=null,o&&t.setState({showLoadingScreen:!1}))}})},t.handleItemSelected=function(e){t.props.onFolderSelected(e.key)},t.handleExpandButtonClick=function(e,n){n&&!t.state.tree.isParent(e)&&t.asyncFetchSubFoldersForItem(e)},t.renderLoadingMessage=function(){return o.createElement("span",{className:"tree-view__loading-label"},g._("Loading your folders…"))},t}return n.__extends(r,e),r.prototype.componentWillMount=function(){if(!this.state.tree){var e=this.constructRootItem();this.setState({tree:w.createWithRootItem(e)})}},r.prototype.componentDidMount=function(){this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)},r.prototype.componentWillUnmount=function(){this._pendingAjaxRequest&&(this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=null)},r.prototype.constructRootItem=function(){var e,t=this.props.treeRootName||f.get_role_title(this.props.user)||g._("Dropbox");return e=f.get_viewer().is_paired?this.props.user.is_team?"s_briefcase":"s_house":"dropbox",new b({key:this.props.rootPath,icon:e,label:t})},r.prototype.parseFolderList=function(e){return JSON.parse(e).map(function(e){return new b({key:e.path,label:p.filename(e.path),canExpand:e.has_subdirs,icon:e.icon,disabled:e.read_only})})},r.prototype.render=function(){var e=this.props.isRootSelectable?v.HeaderItem:v.StaticHeader;return o.createElement(t.TreeView,{tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick},this.state.showLoadingScreen?this.renderLoadingMessage():void 0)},r})(o.Component);N.defaultProps={rootPath:"/",onFolderSelected:function(e){},isRootSelectable:!1,treeRootName:null},t.FolderTreeView=N}),define("modules/clean/sharing/actions/share_modal",["require","exports","tslib","jquery","external/react","external/react-dom","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/error","modules/clean/browse_interface","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/file_viewer/store","modules/clean/react/modal","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/react/pass/store","modules/clean/react/pass/utils","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/confirmation_modals/simple_confirm_modal","modules/clean/sharing/constants","modules/clean/sharing/link_settings_modal","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/teams/membership_discovery_util","modules/clean/teams/modals/create_team_prompt_modal","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/zendesk_feedback","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M,P,T,k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var j=s.createElement,Q=K.i18n_default_project("sharing")._,Z=(function(){function t(t,r,o){var a=this;this.linkSeenStateInfo=null,this.groupSeenStateInfo=null,this.presentAccountIds=null,this.hasLoggedSet={},this.changeAccess=function(e,t,n){void 0===n&&(n=!1);var r=Promise.resolve({}),s=e.memberId(),o=a.getContentInfo(),i=o.id,l=g.browseStore.context().isNonUserRelativeContext;if(t===F.MEMBER_ACTION.REMOVE)s!==a.user.account_id||l?(r=(o.isFileFolder()?a.client.getParentFolderAccess({contentId:a.sharingInfo.parentSharedFolderId(),memberId:s}):a.removeMember(i,e,n,o.isFolder())).then(function(t){a.showParentFolderAccessModalIfQualified("remove",e,t)}),a.openShareModal()):a.client.relinquishMembership({contentId:i,leaveACopy:n}).then(function(){o.isFolder()?z.success(Q("Folder access removed.")):z.success(Q("File access removed.")),b.Modal.close(),a.redirectToBrowseUrl("/")});else if(t===F.ACCESS_LEVEL.OWNER)r=a.client.transferContent({contentId:i,memberId:s}).then(function(){a.dispatch(C.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS),z.success(Q("Made %(name)s the owner").format({name:e.displayName()})),a.fetchInitialData(),a.openShareModal()});else{var d=void 0;if(o.isFileFolder()&&t===F.ACCESS_LEVEL.READER)d=a.client.getParentFolderAccess({contentId:a.sharingInfo.parentSharedFolderId(),memberId:s,accessLevel:t});else{var c=a.getContentInfo().isFileFolder();c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:e}),d=a.shareIfFileFolder().then(function(){return c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e}),a.changeMemberAccess(a.getContentInfo().id,e,t)}).catch(function(){c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e})})}r=d.then(function(t){a.showParentFolderAccessModalIfQualified("update",e,t)})}return r.then(a.refreshSharedWithColumnContentData)},this.changeLinkAudience=function(e){var t=new P.CombinedPolicy({audience:e});if(a.getContentInfo().isFileFolder())return a.shareIfFileFolder(t);var n=a.sharingInfo.linkMetadata(),r=n&&n.current_audience||P.LinkAudience.members;a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_REQUEST,{newAudience:e});var s,o;return a.getContentInfo().isFile()?(s=F.ALPHA_FILE_METADATA_PERMISSIONS,o=a.client.updatePolicy.bind(a.client)):(s=F.ALPHA_FOLDER_METADATA_PERMISSIONS,o=a.client.updatePolicyAlpha.bind(a.client)),o({actions:Object.keys(s),contentId:a.getContentInfo().id,newPolicy:t}).then(function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SUCCESS,{metadata:e})}).catch(l.catchApiError(function(){return a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_FAILURE,{prevAudience:r}),Promise.reject({})}))},this.changeRecipientAccess=function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS,{newAccess:e})},this.changeRecipientMessage=function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE,{message:e})},this.createSharedLink=function(){return a.log("CLICK_TIB_CREATE_LINK"),a.dispatch(C.ShareModalActionTypes.CREATE_LINK_REQUEST),a.client.createSharedLink({fileIdOrPath:a.getContentInfo().displayPath()}).then(function(e){a.dispatch(C.ShareModalActionTypes.CREATE_LINK_SUCCESS,{linkMetadata:e}),a.refreshSharedWithColumnLinkData()}).catch(l.catchApiError(function(e){return e instanceof l.AppError&&e.error&&"access_denied"===e.error[".tag"]&&(a.getContentInfo().isFolder()?z.error("You don’t have permission to create a link to this folder"):z.error("You don’t have permission to create a link to this file")),a.dispatch(C.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e)}))},this.fetchMetadataForFile=function(e){return N.SharingActions.loadFileMetadata({user:a.user,contentId:e.id,sourceUrl:e.url(),client:a.client}).catch(l.catchApiError(a.handleLoadingError))},this.fetchMetadataForFileFolder=function(e){var t,r,s=F.MEMBER_ACTION.ALL,o=a.user.is_cdm_member?F.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE:F.VALIDATE_PATH_PERMISSIONS,i={actions:Object.keys(o),listMembersArg:{actions:s},shouldParseMetadataFromError:!0};return g.browseStore.context().isNonUserRelativeContext&&!a.user.is_cdm_member?(t=function(e){var t=y.validateFolderPath(e);return a.client.validatePathContinue(t,!1)},r={nsId:e.nsId(),nsPath:e.nsPath()}):(t=a.client.validateFqPath,r={fqPath:e.displayPath(),shareAsConfidential:a.sharingInfo.shareAsConfidential()}),t(n.__assign({},r,i)).then(function(e){var t=e.metadata,n=e.inheritedMembers;a.handleGetMetadataSuccess(t);var r=a.getContentInfo();a.listMembers(r.id,r.url(),r.isFileFolder()&&n||void 0)}).catch(l.catchApiError(a.handleLoadingError))},this.fetchMetadataForSharedFolder=function(e){return a.client.getMetadata({contentId:e.id,actions:Object.keys(F.ALPHA_FOLDER_METADATA_PERMISSIONS)}).then(a.handleGetMetadataSuccess).catch(l.catchApiError(a.handleLoadingError))},this.handleMemberAccessChange=function(e,t){var n=e.displayName();if(t===F.MEMBER_ACTION.REMOVE||t===F.ACCESS_LEVEL.OWNER){var r=t===F.MEMBER_ACTION.REMOVE&&e.memberId()===a.user.account_id,s=a.getContentInfo().isFolder(),o=a.getContentInfo().isNestedSharedFolder(),i=e.permissions.leave_a_copy&&e.permissions.leave_a_copy.allow,l=function(n){a.changeAccess(e,t,n===!0)},d=a.openShareModal;r?A.showRelinquishMembershipConfirmationModal(s,o,l,d,i):k.showMemberAccessChangeConfirmationModal(n,t,s,o,i,l,d)}else a.changeAccess(e,t)},this.handleGetMetadataSuccess=function(e){a.dispatch(C.ShareModalActionTypes.FETCH_METADATA_SUCCESS,{metadata:e}),p.dispatch({type:D.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:a.user})},this.handleLinkSettingsClick=function(){var e=function(){a.refreshSharedWithColumnLinkData(),a.setLinkMetadata(void 0),a.openShareModal()},t=a.sharingInfo.getInitialProps().onDeleteLink||e,n=function(e){a.setLinkMetadata(e),a.refreshSharedWithColumnLinkData()},r=L.showUpgradeToBizBanner(a.user);i.TeamsWebActionsLogger.log("open_link_settings_modal"),b.Modal.showInstance(s.createElement(L.SharedLinkSettingsModal,{client:a.client,isFile:a.getContentInfo().isFile(),linkMetadata:a.sharingInfo.linkMetadata(),onClose:a.openShareModal,onDeleteLink:t,onPolicySet:n,showUpgradeToBiz:r,isTeam:a.user.is_team}))},this.handleLoadingError=function(e){e instanceof l.AppError?a.dispatch(C.ShareModalActionTypes.FETCH_METADATA_FAILURE,{reason:e.error&&e.error.bad_path&&e.error.bad_path[".tag"]}):(z.error(e.message||Q("There was a problem completing this request.")),b.Modal.close())},this.handleSelectLinkAudience=function(e){if(a.sharingInfo.contentInfo().isFile())return a.changeLinkAudience(e);var t=a.sharingInfo.linkMetadata(),n=t&&t.current_audience||P.LinkAudience.members,r=t.audience_options.toArray().indexOf(n),o=t.audience_options.toArray().indexOf(e);if(o<r){var i="";if(e===P.LinkAudience.public)i=Q("All items in this folder will become viewable by anyone with the link.");else{if(e!==P.LinkAudience.team)throw"audience type not supported: %(newAudience)s".format({newAudience:e});i=Q("All items in this folder will become viewable by anyone on your team.")}b.Modal.showInstance(s.createElement(x.SimpleConfirmModal,{title:Q("Change link audience?"),confirmText:Q("Change audience"),onConfirm:function(){a.changeLinkAudience(e),a.openShareModal()},onCancel:a.openShareModal},i))}else if(o>r)return a.changeLinkAudience(e)},this.handleSetConfidential=function(e){var t=a.getContentInfo(),n=t.isSharedFolder()?t.sharedFolderId().toString():void 0;return n?a.client.setConfidentiality({contentId:n,confidential:e}):a.client.share({fqPath:t.displayPath(),confidential:e})},this.openShareModal=function(){b.Modal.showInstance(j(a.shareModalClass,{actionHandler:a}))},this.recipientsChange=function(e,t){return void 0===t&&(t=""),Promise.resolve({}).then(function(){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})})},this.redirectToPath=function(t,n){if(!g.browseStore.user()){var r=d.browse_uri_for_fq_path(a.user,t);return n&&r.updateQuery({shareoptions:"1"}),void Y.redirect(r.toString())}var s=function(){n&&e(["modules/clean/sharing/share_modal_util"],function(e){(0,e.showShareModal)(a.user,g.browseStore.context(),{origin:"PARENT_FOLDER_MODAL"})})};t!==g.browseStore.context().currentFQPath?(f.browseNavActions.setUrl({path:t}),f.browseNavActions.setPath({path:t,onPathLoaded:s})):s()},this.refreshSharedWithColumnContentData=function(){a.getContentInfo().isFolder()?p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[a.getContentInfo().id]}})},this.handleShareClick=function(e,t){return a.sharingInfo.contentInfo().pathExists()?a.sendShare(e):Promise.resolve().then(function(){a.setContentNameAndSendShare(e,t)})},this.shareIfFileFolder=function(e){if(!a.getContentInfo().isFileFolder())return Promise.resolve({});if(a.sharingInfo.shareFolderPromise())return a.sharingInfo.shareFolderPromise();var t;if(t=a.sharingInfo.isNonUserRelativeContext()&&!a.user.is_cdm_member?"ns:"+a.getContentInfo().nsId()+a.getContentInfo().nsPath():a.getContentInfo().displayPath(),F.TRUELINK.TRUELINK_UI[a.user.id]){var n=a.sharingInfo.linkMetadata();n&&n.current_audience!==P.LinkAudience.members&&(e||(e=new P.CombinedPolicy),e.audience||(e=e.set("audience",n.current_audience)))}var r={fqPath:t,folderPolicy:e,confidential:!1};a.sharingInfo.shareAsConfidential()&&(r.confidential=!0);var s=a.client.share(r);return a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_REQUEST,{promise:s}),s.then(function(e){return a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_SUCCESS,{metadata:e}),p.dispatch({type:D.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:a.user}),e}).catch(function(){return a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_FAILURE),Promise.reject({})})},this.showParentFolderAccessModalIfQualified=function(e,t,n){null!=n&&b.Modal.showInstance(s.createElement(O.ParentFolderAccessModal,{contentInfo:a.getContentInfo(),memberAccessLevelResult:n,memberDisplayName:t.displayName(),originalAction:e,isInContentManager:a.sharingInfo.isNonUserRelativeContext(),onClose:a.openShareModal,onParentFolderClicked:a.redirectToPath}))},this.parseParentFolderAccessError=function(e){var t=e.error;if("member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"])return T.memberAccessLevelApiToRecord(a.user.id,t);z.error(e.message||Q("There was a problem completing this request."))},this.turnLinkOnIfQualified=function(){var e=a.sharingInfo.linkMetadata();return!F.TRUELINK.TRUELINK_UI[a.user.id]||!F.TRUELINK.BROAD_AUDIENCE[a.user.id]||a.sharingInfo.parentSharedFolderId()||e&&e.current_audience!==P.LinkAudience.members?Promise.resolve({}):a.waitForAllMembersLoaded().then(function(){if(!a.sharingInfo.hasNonOwnerMembers())return a.changeLinkAudience(P.LinkAudience.default_on)})},this.updateLinkSettings=function(){},this.waitForAllMembersLoaded=function(){if(a.sharingInfo.areMembersFullyLoaded())return Promise.resolve({});var e=a.sharingInfo.fetchingMembersRequest();return e&&e.promise||Promise.resolve({})},this.client=t,this.user=r,this.shareModalClass=o}return t.prototype.initializeShareModal=function(e,t){void 0===t&&(t={});var n=e.contentInfo;return p.dispatch({type:C.ShareModalActionTypes.SHARE_MODAL_OPEN,data:{shareModalInfo:e,initialProps:t},contentIds:U.getContentIdsForContentInfo(n),user:this.user}),this.sharingInfo=R.sharingInfoStore.getSharingInfo(this.user.id,n.id),this.fetchInitialData()},t.prototype.fetchInitialData=function(){var e=this.sharingInfo.contentInfo(),t=this.sharingInfo.isNonUserRelativeContext();this.beginTime=Date.now(),this.fetchPassInfo(),this.fetchUpsellExperimentVariant();var n=[];return e.isFileFolder()?n.push(this.fetchMetadataForFileFolder(e)):(n.push(this.listMembers(e.id,e.url())),
e.isFile()?n.push(this.fetchMetadataForFile(e)):e.isSharedFolder()&&n.push(this.fetchMetadataForSharedFolder(e))),n.push(this.fetchMemberCounts()),F.TRUELINK.TRUELINK_UI[this.user.id]?(this.sharingInfo.isTeamPolicyLoaded()||n.push(this.fetchTeamPolicy()),this.sharingInfo.areSharingPrefsLoaded()||n.push(this.fetchSharingPrefs())):(n.push(this.fetchTeamPolicy()),n.push(this.fetchSharingPrefs()),this.sharingInfo.canShareLink()&&!t&&e.isMounted()&&n.push(this.fetchLinkMetadata())),F.SHARING_EXPERIMENTS.PAYWALL_SHARED_FOLDERS_ON_VARIANTS.indexOf(F.SHARING_EXPERIMENTS.PAYWALL_SHARED_FOLDER[this.user.id])>=0&&n.push(this.fetchSharingPaywallInfo()),Promise.all(n)},t.prototype.fetchPassInfo=function(){var e=this;this.sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout(function(){return e.dispatch(C.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD)},4e3);var t=this.getPassFileInfo(),n=t.nsId,r=t.sjid;if(t.fromBrowse&&(h.is_pass_ga_receive_enabled(this.user)||h.is_pass_enabled(this.user))){var s=E.passFetchingStatus(n,r);S.fetchingStatusIsSuccessful(s)?(o=E.getLinkAndGroupInfo(n,r),this.linkSeenStateInfo=o[0],this.groupSeenStateInfo=o[1],this.presentAccountIds=E.presence(n,r)):s||I.PassHelpers.setup({user:this.user,fileData:this.getFileData(),prevFileData:null,shouldWritePresence:!1});var o}},t.prototype.getSharingInfo=function(){return this.sharingInfo},t.prototype.clearCachedPassInfo=function(){e=[null,null,null],this.linkSeenStateInfo=e[0],this.groupSeenStateInfo=e[1],this.presentAccountIds=e[2];var e},t.prototype.getPassInfo=function(){var e=this.getContentInfo();if(!h.is_pass_ga_receive_enabled(this.user)&&!h.is_pass_enabled(this.user)||e.isFolder())return[[],{},[],S.PASS_FETCHING_STATUS.ERROR];if(this.linkSeenStateInfo&&this.groupSeenStateInfo&&this.presentAccountIds)return[this.linkSeenStateInfo,this.groupSeenStateInfo,this.presentAccountIds,S.PASS_FETCHING_STATUS.PASS_SUCCESS];var t=this.getPassFileInfo(),n=t.nsId,r=t.sjid;if(!n||!r)return l=[[],{},[]],this.linkSeenStateInfo=l[0],this.groupSeenStateInfo=l[1],this.presentAccountIds=l[2],[[],{},[],S.PASS_FETCHING_STATUS.ERROR];if(h.is_pass_ga_receive_enabled(this.user)){var s=E.getPassPermissions(e.id);if(E.isPassPermissionsPending(e.id)||null==s)return[[],{},[],S.PASS_FETCHING_STATUS.FETCHING];if(null!=s&&!s.canReadPresence)return[[],{},[],S.PASS_FETCHING_STATUS.ERROR]}var o=E.passFetchingStatus(n,r);if(S.fetchingStatusIsSuccessful(o)){var a=E.getLinkAndGroupInfo(n,r),i=E.presence(n,r);return this.linkSeenStateInfo=a[0],this.groupSeenStateInfo=a[1],this.presentAccountIds=i?i.slice():[],this.isContentInfoForFilePreview(e)&&this.presentAccountIds.indexOf(this.user.account_id)<0&&this.presentAccountIds.push(this.user.account_id),[this.linkSeenStateInfo,this.groupSeenStateInfo,this.presentAccountIds,o]}return[[],{},[],o];var l},t.prototype.getPassFileInfo=function(){var e,t,n,r=this.getContentInfo(),s=!r.isFolder()&&["BROWSE_FILE_ROW","BROWSE_FILE_FACEPILE"].indexOf(r.extras.origin)>=0,o=["BROWSE_FILE_ROW","BROWSE_FILE_FACEPILE","PREVIEW_PAGE_FACEPILE","PREVIEW_PAGE"].indexOf(r.extras.origin)>=0;return o&&!r.isSharedFolder()?(e=r.nsId(),t=r.sjid(),n=r.beaconContext()):(a=[null,null,null],e=a[0],t=a[1],n=a[2]),{nsId:e,sjid:t,beaconContext:n,fromBrowse:s,contentInfoId:r.id};var a},t.prototype.getUrl=function(){return this.getPassFileInfo().fromBrowse?void 0:v.FileViewerStore.instance.getSharedLinkInfo()&&v.FileViewerStore.instance.getSharedLinkInfo().url},t.prototype.getFileData=function(e){var t=this.getPassFileInfo();return{file:{ns_id:t.nsId,sjid:t.sjid,beacon_context:t.beaconContext,file_id:t.contentInfoId},url:e}},t.prototype.getContentInfo=function(){return this.sharingInfo.contentInfo()},t.prototype.dispatch=function(e,t){void 0===t&&(t={}),p.dispatch({type:e,data:t,contentIds:[this.getContentInfo().id],user:this.user})},t.prototype.changeMemberAccess=function(e,t,n){var r=this,s=t.access_type;return this.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:n}),this.client.updateMember({contentId:e,memberId:t.memberId(),accessLevel:n}).then(function(e){if(e.access_level&&e.warning)return r.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:e.access_level}),e}).catch(l.catchApiError(function(e){return r.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:s}),r.parseParentFolderAccessError(e)}))},t.prototype.fetchLinkMetadata=function(){var e=this;return F.TRUELINK.TRUELINK_UI[this.user.id]?Promise.resolve({}):(this.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_REQUEST),this.client.sharedLinkInfo({fileIdOrPath:this.getContentInfo().idForLink()}).then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:t})}).catch(function(){e.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE),g.browseStore.context().isNonUserRelativeContext||(z.error(Q("There was a problem completing this request.")),b.Modal.close())}))},t.prototype.fetchMemberCounts=function(){var e=this,t=this.getContentInfo();return this.dispatch(C.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST),t.isSharedFolder()||t.isFolder()&&t.isInSharedFolder()?this.client.getMemberCounts({contentId:t.isSharedFolder()?t.sharedFolderId():t.nsId()}).then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,{memberCounts:t})}):Promise.resolve({})},t.prototype.fetchSharingPrefs=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST),this.client.getSharingPrefs().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:t})})},t.prototype.fetchUpsellExperimentVariant=function(){var e=this;a.SilentBackgroundRequest({url:"/get_sl_upsell_variant",data:{_subject_uid:this.user.id},success:function(t){var n=JSON.parse(t);n&&n.variant&&e.dispatch(C.ShareModalActionTypes.FETCH_UPSELL_EXPERIMENT_VARIANT,n)}})},t.prototype.fetchSharingPaywallInfo=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PAYWALL_INFO_REQUEST),this.client.getSharingPaywallInfo().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PAYWALL_INFO_SUCCESS,{sharingPaywallInfo:t})})},t.prototype.logPaywallEvent=function(e,t){void 0===t&&(t={}),t.num_folders_owned=this.sharingInfo.paywallNumOwned(),u.log(m.PAYWALL_SERIES_LOGGING_NAME,e,t)},t.prototype.onShareModalUnmount=function(e){this.teardownPass(),this.sharingInfo.foldersToUnshare()&&this.sharingInfo.foldersToUnshare().size>0&&this.unshareFoldersBatch();var t=e&&e.serializeInputData()||{};this.dispatch(C.ShareModalActionTypes.SHARE_MODAL_CLOSE,t)},t.prototype.onUnshareFromPaywall=function(e){this.dispatch(C.ShareModalActionTypes.UNSHARE_FROM_PAYWALL,e)},t.prototype.unshareFoldersBatch=function(){var e=this.sharingInfo.foldersToUnshare().map(function(e){return String(e)}),t=this.sharingInfo.paywallKeepACopy();this.client.unshareFolderBatch({nsIds:e,leaveACopy:t}),this.dispatch(C.ShareModalActionTypes.CLEAR_UNSHARE_FROM_PAYWALL)},t.prototype.fetchTeamPolicy=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_TEAM_POLICY_REQUEST),this.client.getCurrentAccountCached().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_TEAM_POLICY_SUCCESS,{teamPolicy:t.team&&t.team.sharing_policies})})},t.prototype.getSuggestableUsers=function(t){var n=this;q.filterSuggestableUsers(t,function(t){var r=t.contacts,o=t.is_admin,a=n.getContentInfo().id;r.length>0?e(["modules/clean/teams/membership_suggestion_modal"],function(e){var t=e.MembershipSuggestionModal;b.Modal.showInstance(s.createElement(t,{isAdmin:o,isFile:n.sharingInfo.contentInfo().isFile(),contacts:r,nsId:a,accessLevel:n.sharingInfo.recipientAccess()}))}):b.Modal.close()},function(){return b.Modal.close()})},t.prototype.handleContentNameChange=function(e){var t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE";this.hasLoggedSet[t]||(this.sharingExperimentsLog(t),this.hasLoggedSet[t]=!0),this.dispatch(C.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE,{name:e})},t.prototype.handleContentNameFocusChange=function(e){this.dispatch(C.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE,{focus:e})},t.prototype.handleUpdateFilePolicy=function(e,t){this.handleUpdateSharingSettings(e);var n=this.getSharingInfo().filePolicy(),r=this.getPassFileInfo(),s=r.nsId,o=r.sjid,a=r.fromBrowse,i=r.contentInfoId;if(null!=s&&null!=o)if(n.pass_policy===P.PassPolicy.disabled&&t.pass_policy===P.PassPolicy.enabled)this.clearCachedPassInfo(),w.PassActions.resetPassInfo(s,o),w.PassActions.fetchPassError(s,o),this.dispatch(C.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);else{var l=n.audience===P.LinkAudience.members!=(t.audience===P.LinkAudience.members),d=n.pass_policy===P.PassPolicy.enabled&&t.pass_policy===P.PassPolicy.disabled;if(l||d){this.clearCachedPassInfo();var c=this.getUrl();d&&this.listMembers(i,c),I.PassHelpers.setup({user:this.user,fileData:this.getFileData(c),prevFileData:null,shouldWritePresence:!a})}}},t.prototype.handleUpdateSharingSettings=function(e){this.dispatch(C.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})},t.prototype.listMembers=function(e,t,n){return N.SharingActions.listMembers({user:this.user,contentId:this.getContentInfo().id,isFolder:this.sharingInfo.isFolder(),url:t,members:n,client:this.client})},t.prototype.isContentInfoForFilePreview=function(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()},t.prototype.log=function(e,t){void 0===t&&(t={}),B.logTiburonEvent(this.getContentInfo(),this.user.id,e,t)},t.prototype.logIfHaventBefore=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0),this.hasLoggedSet[e]||(this.hasLoggedSet[e]=!0,n&&(t.timing=Date.now()-this.beginTime),this.log(e,t))},t.prototype.onClickX=function(e){e&&e.finishLogging(!0),this.showTruelinkFeedbackIfQualified(),b.Modal.close()},t.prototype.redirectToBrowseUrl=function(e){f.browseNavActions.setUrl({path:e})},t.prototype.redirectToUpgrade=function(){Y.redirect("/upgrade?oqa=spw")},t.prototype.refreshSharedWithColumnLinkData=function(){p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.getContentInfo().displayPath()]}})},t.prototype.removeMember=function(e,t,n,r){var s=this;return this.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:t}),this.client.removeMember({contentId:e,memberId:t.memberId(),leaveACopy:n}).then(function(e){return s.fetchMemberCounts().then(function(){if(e&&null!=e.access_level&&null!=e.warning)return s.dispatch(C.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:e.access_level}),e;r?z.success(Q("Folder access removed.")):z.success(Q("File access removed.")),s.dispatch(C.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS,{member:t})})}).catch(l.catchApiError(function(e){return s.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:t}),s.parseParentFolderAccessError(e)}))},t.prototype.setAddMessageAsCommentChecked=function(e){this.dispatch(C.ShareModalActionTypes.SET_COMMENT_CHECKBOX_PREF_REQUEST,{checked:e}),this.client.setSharingPrefs({add_message_as_comment_checked:e})},t.prototype.setAddMessageAsCommentHelpClosed=function(){this.dispatch(C.ShareModalActionTypes.SET_COMMENT_CHECKBOX_HELP_PREF_REQUEST),this.client.setSharingPrefs({add_message_as_comment_help_shown:!1})},t.prototype.setContentNameAndSendShare=function(e,t){var n=this,s=o.findDOMNode(t),a=s&&s.value,i=c.parent_dir(this.sharingInfo.fqPath());new M.SharingApi(this.user).validate_new_sf_path(a,B.getNewFolderPathFromContentName(a,i),function(){n.dispatch(C.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS,{contentName:a}),n.sendShare(e)},function(e){n.sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME");var t=V.extract_errors(e.responseText);n.dispatch(C.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:t.folder_name&&t.folder_name.message_text});var o=r(s);o&&o.select()})},t.prototype.setLinkMetadata=function(e){this.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:e})},t.prototype.paywallGrandfatherModalDismiss=function(){this.dispatch(C.ShareModalActionTypes.PAYWALL_GRANDFATHER_MODAL_DISMISS)},t.prototype.paywallGrandfatherModalLearnMore=function(){this.logPaywallEvent("view_learn_more"),this.dispatch(C.ShareModalActionTypes.PAYWALL_GRANDFATHER_MODAL_LEARN_MORE)},t.prototype.sendShare=function(e){var t=this;this.log("CLICK_TIB_SEND_BUTTON");var n,r=Date.now(),o=this.isNewlySharedContent();return this.recipientsChange(e&&e.getContacts()).then(function(){return t.sharingInfo.contactsError().level===B.CONTACT_ERROR_LEVEL.ERROR?Promise.reject({}):(t.dispatch(C.ShareModalActionTypes.SEND_SHARE_REQUEST),n=T.contactsToMembers(t.sharingInfo.recipientTokens()),t.shareIfFileFolder())}).then(function(){return t.turnLinkOnIfQualified(),t.client.addMembers({accessLevel:t.sharingInfo.recipientAccess(),contentId:t.sharingInfo.contentInfo().id,addMessageAsComment:t.sharingInfo.isAddMessageAsCommentChecked(),customMessage:t.sharingInfo.recipientMessage(),members:n})}).catch(l.catchApiError(function(e){return t.dispatch(C.ShareModalActionTypes.SEND_SHARE_FAILURE),z.error(B.genAddMemberErrorMessage(e)),t.log("SHARE_MODAL_SEND_FAIL",{timing:Date.now()-r,num_recipients:n.length}),Promise.reject({})})).then(function(){if(t.dispatch(C.ShareModalActionTypes.SEND_SHARE_SUCCESS),z.success(B.genShareSuccessMessage(t.sharingInfo.recipientTokens(),t.sharingInfo.contentInfo().name(),t.sharingInfo.isTeamSharedFolder(),t.sharingInfo.isFolderInsideTeamFolderTree())),t.log("SHARE_MODAL_SEND_SUCCESS",{timing:Date.now()-r,num_recipients:n.length}),t.sharingInfo.getInitialProps().onSuccessSharing&&t.sharingInfo.getInitialProps().onSuccessSharing(),e&&e.finishLogging(!1),t.refreshSharedWithColumnContentData(),W.SHOW_CREATE_TEAM_MODAL_AFTER_SHARING&&o&&n.length>=2)b.Modal.showInstance(s.createElement(H.CreateTeamPromptModal,{invitedMembers:t.sharingInfo.recipientTokens().filter(function(e){return e.email!==t.user.email})}));else if(t.sharingInfo.ownerTeam()&&W.SUBGROWTH_PROJECT_MAGNET){var a=t.sharingInfo.recipientTokens().map(function(e){return e.email});t.getSuggestableUsers(a)}else t.showTruelinkFeedbackIfQualified(),b.Modal.close()})},t.prototype.isNewlySharedContent=function(){var e=this.getContentInfo();return e.isFileFolder()||e.isFile()&&!this.sharingInfo.hasNonOwnerMembers()},t.prototype.sharingExperimentsLog=function(e,t){void 0===t&&(t={});var n=this.getContentInfo().extras.modalSessionId;t.modalSessionId=t.modalSessionId||n,i.SharingExperimentsLogger.log(this.user.id,e,t)},t.prototype.showTruelinkFeedbackIfQualified=function(){F.TRUELINK.TRUELINK_UI[this.user.id]&&(this.sharingInfo.hasChangedSharingSettings()?G.showFeedbackFlyoutIfAllowed("settings"):this.sharingInfo.hasChangedLinkAudience()&&G.showFeedbackFlyoutIfAllowed("sender"))},t.prototype.teardownPass=function(){this.clearCachedPassInfo(),this.getPassFileInfo().fromBrowse&&I.PassHelpers.teardown({user:this.user,fileData:this.getFileData(),async:!0,shouldWritePresence:!1})},t.prototype.updateBanner=function(e){this.dispatch(C.ShareModalActionTypes.UPDATE_BANNER,{banner:e})},t})();t.ShareModalActionHandler=Z}),function(){define("modules/clean/sharing/api",["modules/clean/ajax","modules/core/exception","jquery"],function(e,t,n){var r,s,o;return o=e.WebRequest,r=e.FormWebRequest,t.assert,s=(function(){function e(e){this.user=e}return e.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded",e.prototype.get_sync_vars_for_ns_id=function(e,t,n,r){var s;return s={ns_id:e,sub_path:t},this._make_request("/sharing/get_sync_vars_for_ns_id",s,n,r,!0)},e.prototype.validate_new_sf_path=function(e,t,n,r){var s;return s={share_type:"new",folder_name:e,path:t},this._make_request("/share_ajax/validate_folder",s,n,r,!0)},e.prototype.validate_shareable_existing_sf_path=function(e,t,n){var r;return r={share_type:"shareable_existing",path:e},this._make_request("/share_ajax/validate_folder",r,t,n,!0)},e.prototype._make_request=function(t,s,a,i,l,d){var c,p;return null==l&&(l=!1),null==d&&(d=!0),c={url:t,data:s,success:function(r,o,i){return"function"==typeof a&&a(i),n(document).trigger(e.REQUEST_SUCCEEDED_EVENT,{request_url:t,ns_id:s.ns_id||null})},error:function(e){return"function"==typeof i?i(e):void 0},complete:(function(e){return function(){var t;return null!=(t=e.loading_elem)?t.removeClass("ajax-loading"):void 0}})(this)},d&&(c.subject_user=this.user.id),null!=(p=this.loading_elem)&&p.addClass("ajax-loading"),(l?r:o)(c)},e})(),{SharingApi:s}})}.call(this),define("modules/clean/sharing/components/button_group",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css"],function(e,t,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this;return r.createElement("div",{className:"c-btn-group sharing-button-group"},this.props.options.map(function(t){var n=t.value,o=t.label,a=n===e.props.value;return r.createElement("button",{key:n,className:s({"c-btn":!0,"c-btn--secondary":!a,"c-btn--primary":a}),onClick:function(){return e.props.onSelectValue(n)},disabled:a},o)}))},t})(r.Component);t.ButtonGroup=o(a,["/static/css/sharing/components-vflrV8W4h.css"])}),define("modules/clean/sharing/confirmation_modals/confirm_with_option_modal",["require","exports","tslib","external/react","modules/clean/react/modal"],function(e,t,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(t){var n=e.call(this,t)||this;if(null==n.props.children)throw new Error("Must have children prop");return n.state={checked:!1},n.handleOptionClick=n.handleOptionClick.bind(n),n.handleAccept=n.handleAccept.bind(n),n.handleDismissCompleted=n.handleDismissCompleted.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(s.Modal,{acceptButtonText:this.props.confirmText,autoClose:this.props.autoClose,className:"simple-modal confirm-with-option-modal",dismissButtonText:this.props.cancelText,onAccept:this.handleAccept,onDismissCompleted:this.handleDismissCompleted,title:this.props.title},r.createElement("div",{className:"simple-modal-content"},r.createElement("div",{className:"confirm-with-option-modal__body-text"},this.props.children),this.renderOption()))},t.prototype.renderOption=function(){return this.props.showOption?r.createElement("div",{className:"u-mar-vertical-s confirm-with-option-modal__option"},r.createElement("input",{"aria-checked":this.state.checked,checked:this.state.checked,className:"confirm-with-option-modal__option-input",id:"confirm-with-option-modal__input",name:"confirmation_option",onClick:this.handleOptionClick,role:"checkbox",type:"checkbox"}),r.createElement("label",{className:"confirm-with-option-modal__option-label",htmlFor:"confirm-with-option-modal__input"},this.props.optionLabel)):null},t.prototype.handleOptionClick=function(){this.setState({checked:!this.state.checked})},t.prototype.handleAccept=function(){this.props.onConfirm&&this.props.onConfirm(this.state.checked)},t.prototype.handleDismissCompleted=function(){this.props.onCancel&&this.props.onCancel(this.state.checked)},t})(r.Component);t.ConfirmWithOptionModal=o}),function(){define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["external/purify","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/react_format","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,s,o,a,i){var l,d,c,p,u,m,h,_;return c=r.Modal,h=s.reactFormat,l=o.ConfirmWithOptionModal,d=a.MEMBER_ACTION,u=t.createElement,m=t.DOM,p=i.i18n_default_project("sharing")._,_=function(e,t,r,s,o,a,i){var _,f,g,y,v;return y=n.em_snippet(e,40),g=null,t===d.REMOVE?(v=p("Remove access for %(name)s?").format({name:y}),r?(_=s?h(p("<strong>%(name)s</strong> may still have access to this folder through a company group or parent folder."),{strong:m.strong(),name:y}):h(p("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to these files."),{strong:m.strong(),name:y}),o&&(g=p("%(name)s should be able to keep a copy of these files").format({name:y}))):_=h(p("If you continue, <strong>%(name)s</strong> will lose access to this file."),{strong:m.strong(),name:y}),f=p("Remove")):(v=p("Make %(name)s the owner of this folder?").format({name:y}),_=h(p("Only <strong>%(name)s</strong> will be able to unshare this folder or change folder settings."),{strong:m.strong(),name:y}),f=p("Make owner")),c.showInstance(u(l,{autoClose:!1,confirmText:f,cancelText:p("Cancel"),onConfirm:a,onCancel:i,optionLabel:g,showOption:null!=g,title:v},_))},{showMemberAccessChangeConfirmationModal:_}})}.call(this),function(){define("modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal",["external/purify","external/react","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/core/i18n"],function(e,t,n,r,s){var o,a,i,l,d;return a=n.Modal,o=r.ConfirmWithOptionModal,l=t.createElement,i=s.i18n_default_project("sharing")._,d=function(e,t,n,r,s){var d,c,p;return c=null,e?(p=i("Remove your access to this folder?"),d=i(t?"You may still have access to this folder through a company group or parent folder.":"If you continue, you won’t be able to access this folder anymore."),s&&(c=i("Keep a copy of this folder"))):(p=i("Remove your access to this file?"),d=i("If you continue, you won’t be able to access this file anymore.")),a.showInstance(l(o,{cancelText:i("Cancel"),confirmText:i("Remove my access"),onCancel:r,onConfirm:n,optionLabel:c,showOption:null!=c,title:p},d))},{showRelinquishMembershipConfirmationModal:d}})}.call(this),define("modules/clean/sharing/confirmation_modals/reset_access_modal",["require","exports","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,s,o,a,i){"use strict";function l(e){var t,i=d("Let removed members keep a copy of these files");t=d(e.linkAccessLanguage?e.isFolder?e.isNestedSharedFolder?"The link to this folder will no longer work. Unsharing will only remove members who             don’t have access to the parent folder.":"The link to this folder will no longer work, and everyone will lose access to it.             You’ll still keep a copy of this folder in your Dropbox account.":"Everyone else will lose access to this file and its link         except those who have access from a parent folder.         You’ll still keep a copy of this file in your Dropbox.":e.isFolder?"Everyone else will lose access to this folder. You’ll         still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file. You’ll         still keep a copy of this folder in your Dropbox.");var l=d("Unshare “%(content_name)s”?").format({content_name:r.em_snippet(e.contentName,a.SNIPPET_SIZES.FILENAME)});s.Modal.showInstance(n.createElement(o.ConfirmWithOptionModal,{cancelText:d("Cancel"),confirmText:d("Unshare"),onCancel:e.onCancel,onConfirm:e.onConfirm,optionLabel:i,showOption:e.allowLeaveACopy&&e.isFolder,title:l},t))}Object.defineProperty(t,"__esModule",{value:!0});var d=i.i18n_default_project("sharing")._;t.confirmResetAccess=l}),define("modules/clean/sharing/confirmation_modals/simple_confirm_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/core/i18n"],function(e,t,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.i18n_default_project("sharing")._,i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(s.Modal,{style:"bare"},r.createElement("div",{className:"simple-confirm-modal"},r.createElement("div",{className:"simple-confirm-modal__main"},r.createElement("div",{className:"simple-confirm-modal__title"},this.props.title),r.createElement("div",{className:"simple-confirm-modal__body"},this.props.children)),r.createElement("div",{className:"simple-confirm-modal__footer"},r.createElement("button",{className:"simple-confirm-modal__cancel c-btn c-btn--secondary",onClick:this.props.onCancel},this.props.cancelText||a("Cancel")),r.createElement("button",{className:"simple-confirm-modal__confirm c-btn c-btn--primary",onClick:this.props.onConfirm},this.props.confirmText))))},t})(r.Component);t.SimpleConfirmModal=i}),define("modules/clean/sharing/content_info",["require","exports","tslib","external/immutable","modules/constants/python"],function(e,t,n,r,s){"use strict";function o(e){var t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.createFromParams=function(e){var n=new i(e);return new t({extras:n,id:o(n)})},t.prototype.setNsId=function(e){var t=this.setIn(["extras","targetNsId"],e);return t.set("id",o(t.extras))},t.prototype.setFQPath=function(e){var t=this.setIn(["extras","fqPath"],e);return t.set("id",o(t.extras))},t.prototype.isFolder=function(){return this.extras.isFolder},t.prototype.isFile=function(){return!this.isFolder()},t.prototype.isFileFolder=function(){return this.isFolder()&&!this.isSharedFolder()},t.prototype.isSharedFolder=function(){return Boolean(this.extras.targetNsId)},t.prototype.isTeamSharedFolder=function(){return this.extras.isTeamSharedFolder},t.prototype.isInSharedFolder=function(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)},t.prototype.isNestedSharedFolder=function(){return this.isInSharedFolder()&&this.isSharedFolder()},t.prototype.isOSXPackage=function(){var e=this.extras.fqPath,t=e.substr(e.lastIndexOf("."));return s.PACKAGE_EXTS.indexOf(t)>=0},t.prototype.isMounted=function(){return!this.extras.url},t.prototype.url=function(){return this.extras.url},t.prototype.pathExists=function(){return Boolean(this.extras.exists)},t.prototype.name=function(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()},t.prototype.idForLink=function(){var e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e},t.prototype.sharedFolderId=function(){var e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e},t.prototype.displayPath=function(){return this.extras.fqPath},t.prototype.filename=function(){return this.extras.filename},t.prototype.nsId=function(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId},t.prototype.nsPath=function(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath},t.prototype.sjid=function(){return this.extras.sjid},t.prototype.teamGroupInfo=function(){return this.extras&&this.extras.teamGroupInfo},t.prototype.beaconContext=function(){return this.extras&&this.extras.beaconContext},t})(r.Record({extras:null,id:null},"ContentInfo"));t.ContentInfo=a;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({beaconContext:null,exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras"));t.ContentInfoExtras=i}),define("modules/clean/sharing/file_settings_modal",["require","exports","tslib","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/util","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/core/i18n","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=b.i18n_default_project("sharing")._,E=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleAcceptClick=function(){var e=n.getPolicyDiff();e?p.setStatePromise(n,{isSubmitting:!0}).then(function(){return n.getClient().updatePolicy({contentId:n.props.contentId,newPolicy:e,actions:Object.keys(f.ALPHA_FILE_METADATA_PERMISSIONS)})}).catch(o.catchApiError(function(){n.setState({isSubmitting:!1}),Promise.reject({})})).then(function(e){w.success(S("File settings updated")),n.props.onPolicySet&&n.props.onPolicySet(e)}):n.props.onPolicySet&&n.props.onPolicySet(void 0)},n.handleDismissClick=function(){c.Modal.close(),n.props.onCancel&&n.props.onCancel()},n.handleDismissCompleted=function(){n.props.onCancel&&n.props.onCancel()},n.handlePolicyUpdate=function(e,t){n.setState({desiredPolicy:n.state.desiredPolicy.set(e,t)})},n.getPolicyDiff=function(){var e={};return n.state.desiredPolicy.keySeq().toArray().map(function(t){var r=n.state.desiredPolicy.get(t),o=n.props.initialPolicy.get(t);("object"==typeof r?s.isEqual(r,o):r===o)||(e[t]=n.state.desiredPolicy.get(t))}),e},n.handleUnshareFile=function(){var e=function(){return n.getClient().unshare({contentId:n.props.contentId}).then(function(){n.refreshSharedMemberData(),w.success(S("Unshared %(file_name)s").format({file_name:n.props.fileName})),c.Modal.close(),f.TRUELINK.TRUELINK_UI[n.props.user.id]&&u.SharingActions.loadFileMetadata({user:n.props.user,contentId:n.props.contentId})})};_.confirmResetAccess({allowLeaveACopy:!1,contentName:n.props.fileName,isFolder:!1,isNestedSharedFolder:!1,linkAccessLanguage:f.TRUELINK.TRUELINK_UI[n.props.user.id],onConfirm:e})},n.refreshSharedMemberData=function(){i.dispatch({type:d.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[n.props.contentId]}})},n.state={isSubmitting:!1,desiredPolicy:t.initialPolicy},n}return n.__extends(t,e),t.prototype.render=function(){return f.TRUELINK.TRUELINK_UI[this.props.user.id]?this.openSharingSettingsModal():r.createElement(I,{canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,contentId:this.props.contentId,desiredPolicy:this.state.desiredPolicy,fileName:this.props.fileName,handleUnshareFile:this.handleUnshareFile,isSubmitting:this.state.isSubmitting,onAccept:this.handleAcceptClick,onDismiss:this.handleDismissClick,onDismissCompleted:this.handleDismissCompleted,onPolicyUpdate:this.handlePolicyUpdate,user:this.props.user})},t.prototype.getClient=function(){return new m.FileShareApiClient({userId:this.props.user.id})},t.prototype.openSharingSettingsModal=function(){var e=this,t=function(t,n){var r=e.props.canChangeOptions;return v.isCommonSharingSettingsPolicy(t)&&(r=v.canChangePolicy(t,e.props.initialPolicy,e.state.desiredPolicy,e.props.linkMetadata,e.props.permissions)),[e.state.desiredPolicy.get(t),r]};return r.createElement(y.SharingSettingsModal,{contentId:this.props.contentId,currentPolicy:this.props.initialPolicy,fileName:this.props.fileName,folderName:this.props.fileName,getEffectivePolicyValue:t,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isFolder:!1,isLoading:!1,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onDismiss:this.handleDismissClick,onOptionChange:this.handlePolicyUpdate,onSaveSettings:this.handleAcceptClick,
onUnshare:this.handleUnshareFile,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,policyUpdate:this.getPolicyDiff(),user:this.props.user})},t})(r.Component);E.displayName="FileSettingsModal",t.FileSettingsModal=E;var I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e;return this.props.canChangeOptions&&(e=r.createElement(g.SettingsModalButtons,{disableSave:!1,isAccepting:this.props.isSubmitting,onAccept:this.props.onAccept,onDismiss:this.props.onDismiss})),r.createElement(c.Modal,{autoClose:!1,className:"file-settings-modal",buttonComponent:r.createElement("span",null),onDismissCompleted:this.props.onDismissCompleted,title:S("“%(file_name)s” settings").format({file_name:a.em_snippet(this.props.fileName,f.SNIPPET_SIZES.FILENAME)})},r.createElement("div",{className:"file-settings-form"},this.renderHeader(),this.renderPolicies(),this.renderButtons(),e))},t.prototype.renderHeader=function(){if(!this.props.canChangeOptions)return r.createElement("div",{className:"u-pad-xs u-font-center u-mar-bottom-s file-settings-form__no-permission-banner"},S("You don’t have permission to change the settings on this file."))},t.prototype.renderPolicies=function(){return r.createElement("div",null,null!=this.props.desiredPolicy.pass_policy?this.renderPassPolicy():void 0)},t.prototype.renderPassPolicy=function(){var e;return e=S(l.is_pass_enabled(this.props.user)?"Only show to people on your Dropbox team":"Only show to people on your Dropbox team and who can edit"),r.createElement(g.SinglePolicyControl,{canChange:this.props.canChangeOptions,policyName:h.PassPolicy.policy_name,policyDescription:S("Show who accessed this file?"),currentValue:this.props.desiredPolicy.pass_policy,options:[{label:e,value:h.PassPolicy.enabled},{label:S("Don’t show"),value:h.PassPolicy.disabled}],handleOptionChange:this.props.onPolicyUpdate})},t.prototype.renderButtons=function(){var e;return this.props.canUnshareFile&&(e=r.createElement("div",{className:"u-l-fl"},r.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.handleUnshareFile},S("Unshare file")))),r.createElement("div",{className:"u-mar-top-m clearfix"},e)},t})(r.Component);I.displayName="FileSettingsModalContents",t.FileSettingsModalContents=I}),function(){define("modules/clean/sharing/folder_settings_modal",["external/classnames","external/immutable","external/purify","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/store","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/util","modules/clean/sharing/actions/share_modal","modules/clean/sharing/constants","modules/clean/sharing/ui_util","modules/clean/sharing/settings_modal_components","modules/clean/sharing/share_page/action_types","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/user","modules/constants/python","modules/core/i18n","modules/core/uri","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M){var P,T,k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z,j,Q,Z,J,X,$,ee,te,ne,re,se,oe,ae,ie;return te=o.catchApiError,$=d.browseStore,O=p.Modal,K=p.SimpleModal,ie=u.setStatePromise,B=m.ShareModalActionHandler,R=h.SNIPPET_SIZES,Q=h.TRUELINK,oe=_.genContentManagerBridgeUri,U=f.SettingsModalButtons,z=f.SinglePolicyControl,q=g.SharePageActionTypes,F=y.FolderShareApiClient,Z=y.TeamSharingPolicies,P=v.CombinedPolicy,x=v.FolderPolicy,A=v.FolderPermissions,L=v.LinkMetadata,H=v.SharedContentLinkMetadata,V=v.SharedFolderMetadata,re=b.confirmResetAccess,Y=w.SharingSettingsModal,ee=S.canChangePolicy,ae=S.isCommonSharingSettingsPolicy,j=I.TRADEMARK_BUSINESS,ne=r.createElement,se=r.DOM,J=C.i18n_default_project("sharing")._,T={shared_folder_member_policy:"team"},k={shared_folder_member_policy:"team"},D={member_policy:"shared_folder_member_policy"},G=r.createClass({displayName:"SharedFolderSettingsModal",propTypes:{actionHandler:r.PropTypes.instanceOf(B),altAction:r.PropTypes.node,folderName:r.PropTypes.string.isRequired,folderId:r.PropTypes.string,folderPath:r.PropTypes.string,hasDisplayableMembers:r.PropTypes.bool,hasNonOwnerMembers:r.PropTypes.bool,nsId:r.PropTypes.string,nsPath:r.PropTypes.string,initialHasParentSharedFolder:r.PropTypes.bool,initialIsTeamSharedFolder:r.PropTypes.bool,initialMetadata:r.PropTypes.instanceOf(V),initialOwnerTeam:r.PropTypes.shape({id:r.PropTypes.string.isRequired,name:r.PropTypes.string.isRequired}),initialPermissions:r.PropTypes.instanceOf(A),initialPolicy:r.PropTypes.oneOfType([r.PropTypes.instanceOf(P),r.PropTypes.instanceOf(x)]),isFolderInsideTeamFolderTree:r.PropTypes.bool,isLimitedTeam:r.PropTypes.bool,isSharedFolder:r.PropTypes.bool,isUserOnOwnerTeam:r.PropTypes.bool,linkMetadata:r.PropTypes.oneOfType([r.PropTypes.instanceOf(L),r.PropTypes.instanceOf(H)]),onCancel:r.PropTypes.func,onPolicySet:r.PropTypes.func,onUnshare:r.PropTypes.func,showContentManagerBridge:r.PropTypes.bool,isInContentManager:r.PropTypes.bool,teamPolicy:r.PropTypes.instanceOf(Z),updateLinkSettings:r.PropTypes.func,user:r.PropTypes.instanceOf(E).isRequired},getInitialState:function(){return{currentPolicy:this.props.initialPolicy,hasParentSharedFolder:this.props.initialHasParentSharedFolder,isLoading:!(null!=this.props.initialPolicy&&null!=this.props.initialPermissions),isPolicyChangeRecursive:this._hasRecursivePolicyChanges(this.props.initialIsTeamSharedFolder,this.props.initialHasParentSharedFolder),isSubmitting:!1,isTeamSharedFolder:this.props.initialIsTeamSharedFolder,metadata:this.props.initialMetadata,teamPolicy:this.props.teamPolicy,newPolicy:this.props.initialPolicy,ownerTeam:this.props.initialOwnerTeam,permissions:this.props.initialPermissions}},componentDidMount:function(){if(this.state.isLoading)return this._fetchInitialState()},render:function(){var e;return e={altAction:this.props.altAction,contentId:this.props.folderId,currentPolicy:this.state.currentPolicy,folderId:this.props.folderId,folderName:this.props.folderName,folderPath:this.props.folderPath,getEffectivePolicyValue:this._getEffectivePolicyValue,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.state.hasParentSharedFolder,isFolder:!0,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isLimitedTeam:this.props.isLimitedTeam,isLoading:this.state.isLoading,isSharedFolder:this.props.isSharedFolder,isSubmitting:this.state.isSubmitting,isTeamSharedFolder:this.state.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismiss,onOptionChange:this._handleOptionChange,onSaveSettings:this._handleSaveSettings,onUnshare:this._handleUnshareFolder,ownerTeam:this.state.ownerTeam,permissions:this.state.permissions,showContentManagerBridge:this.props.showContentManagerBridge,shouldHideHeader:this.state.shouldHideHeader,teamPolicy:this.state.teamPolicy,policyUpdate:this._getPolicyUpdate(),user:this.props.user},Q.TRUELINK_UI[this.props.user.id]?ne(Y,e):ne(W,e)},_getClient:function(){var e;return e=$.context().isNonUserRelativeContext,new F({userId:this.props.user.id,isNonUserRelativeContext:e})},_fetchFolderMetadata:function(){var e;return e=[{".tag":"change_options"},{".tag":"unshare"}],null!=this.props.folderId?this._getClient().getMetadata({contentId:this.props.folderId,actions:e}):this._getClient().validateFqPath({fqPath:this.props.folderPath,actions:e}).then(function(e){return e.metadata})},_fetchInitialState:function(){return this._fetchFolderMetadata().then((function(e){return function(t){var n,r,s,o;if(e.isMounted())return n=t.policy,r={hasParentSharedFolder:null!=t.parent_shared_folder_id,isTeamSharedFolder:t.is_team_folder,shouldHideHeader:"folder_is_limited_team_folder"===(null!=(s=t.permissions)&&null!=(o=s.change_options)?o.reason:void 0),isLoading:!1,permissions:t.permissions,newPolicy:n,ownerTeam:t.owner_team,metadata:t},null!=e.props.folderId&&(r.currentPolicy=n),r.isPolicyChangeRecursive=e._hasRecursivePolicyChanges(r.isTeamSharedFolder,r.hasParentSharedFolder),ie(e,r)}})(this)).catch(te(function(){return O.close()}))},_hasRecursivePolicyChanges:function(e,t){return e||t},_handlePolicyUpdate:function(e,t){return this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_handleSaveSettings:function(){var e,t,r;if(t=this._getPolicyUpdate(),null!=t)return e=(function(e){return function(){var n;return n=e.props.onPolicySet,(e.isMounted()?ie(e,{isSubmitting:!0}):Promise.resolve()).then(function(){var n,r,s;return n=function(e){return M.success(J("Folder settings updated")),Promise.resolve({policyUpdate:t,sharedFolderMetadata:e})},null!=e.props.folderId?(r=e._getClient().updatePolicyAlpha,r({contentId:e.props.folderId,newPolicy:t,url:null!=(s=e.props.linkMetadata)?s.url:void 0}).then(n)):(t=Q.TRUELINK_UI[e.props.user.id]?new P(t):new x(t),e.props.actionHandler.shareIfFileFolder(t).then(n))}).then(function(e){var t,r;return t=e.policyUpdate,r=e.sharedFolderMetadata,"function"==typeof n?n(t,r):void 0}).catch(te(function(t){var n;if(M.error(null!=(n=t.user_message)?n:J("Something went wrong! Please try again.")),e.isMounted())return e.setState({isSubmitting:!1})}))}})(this),this.state.isPolicyChangeRecursive?(r=this.props,K.show({title_text:J("Save settings?"),body_html:this.state.isTeamSharedFolder?n.sanitize(J("Your changes will be applied to this team folder and any folders inside it.")):n.sanitize(J("Your changes will be applied to this folder and any folders inside it.")),confirm_text:J("Save settings"),cancel_text:J("Cancel"),autoclose:!1,confirm_callback:e,cancel_completed_callback:function(){return O.showInstance(ne(G,r))}})):e()},_handleDismiss:function(){var e;return O.close(),"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleDismissCompleted:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleUnshareFolder:function(){var e,t,n,r,s,o;if(null!=this.props.folderId&&(null!=(n=this.state.permissions)&&null!=(r=n.unshare)?r.allow:void 0))return e=(function(e){return function(t){var n;return n=e._getClient().unshare({contentId:e.props.folderId,leaveACopy:t}),n.then(function(){var t;return M.success(J("Unshared “%(folder_name)s”").format({folder_name:e.props.folderName})),null!=(t=e.props.actionHandler)&&t.refreshSharedWithColumnContentData(),O.close(),l.dispatch({type:q.UNSHARE_FOLDER_SUCCESS,metadata:e.state.metadata,user:e.props.user})})}})(this),t=(function(e){return function(){return O.showInstance(ne(G,e))}})(this.props),re({allowLeaveACopy:null!=(s=this.state.permissions)&&null!=(o=s.leave_a_copy)?o.allow:void 0,contentName:this.state.metadata.name,isFolder:!0,isNestedSharedFolder:this.props.hasParentSharedFolder,linkAccessLanguage:Q.TRUELINK_UI[this.props.user.id],onCancel:t,onConfirm:e})},_getPolicyUpdate:function(){var e;return null==this.state.newPolicy&&null==this.state.currentPolicy?null:(e={},this.state.newPolicy.forEach((function(t){return function(n,r){var o,a,i,l;if(l=t._getEffectivePolicyValue(r),a=l[0],o=l[1],o&&(i="object"==typeof n?s.isEqual(n,a):n===a,!i))return e[r]=n}})(this)),e)},_handleOptionChange:function(e,t){var n;if((null!=(n=this._getPolicyUpdate())?n[e]:void 0)!==t)return"function"==typeof this._handlePolicyUpdate?this._handlePolicyUpdate(e,t):void 0},_getEffectivePolicyValue:function(e,t){var n,r,s,o,a,i;return null==t&&(t=void 0),a=D[e],null!=a&&null!=this.props.teamPolicy&&(i=this.props.teamPolicy.get(a)),r=null!=(s=null!=t?t[e]:void 0)?s:this.state.currentPolicy.get(e),n=null!=(o=this.state.permissions.change_options)?o.allow:void 0,null!=i&&T[a]===i&&(n=!1,r=k[a]),ae(e)&&(n=ee(e,this.state.currentPolicy,this.state.newPolicy,this.props.linkMetadata,this.state.permissions,this.props.showContentManagerBridge)),this.props.showContentManagerBridge&&(n=!1),[r,n]}}),X=r.createClass({displayName:"SharedFolderSettingsModalContents",propTypes:{altAction:r.PropTypes.node,currentPolicy:r.PropTypes.instanceOf(x),folderId:r.PropTypes.string,folderName:r.PropTypes.string.isRequired,folderPath:r.PropTypes.string,permissions:r.PropTypes.instanceOf(A),getEffectivePolicyValue:r.PropTypes.func,hasParentSharedFolder:r.PropTypes.bool,isLimitedTeam:r.PropTypes.bool,isLoading:r.PropTypes.bool.isRequired,isSharedFolder:r.PropTypes.bool,isSubmitting:r.PropTypes.bool,isTeamSharedFolder:r.PropTypes.bool,isUserOnOwnerTeam:r.PropTypes.bool,onDismiss:r.PropTypes.func,onSaveSettings:r.PropTypes.func,onOptionChange:r.PropTypes.func,onUnshare:r.PropTypes.func,ownerTeam:r.PropTypes.shape({id:r.PropTypes.string.isRequired,name:r.PropTypes.string.isRequired}),showContentManagerBridge:r.PropTypes.bool,shouldHideHeader:r.PropTypes.bool,teamPolicy:r.PropTypes.instanceOf(Z),policyUpdate:r.PropTypes.instanceOf(x)},getDefaultProps:function(){return{currentPolicy:null,folderId:null,getEffectivePolicyValue:null,hasParentSharedFolder:!1,isTeamSharedFolder:!1,onDismiss:null,onOptionChange:null,onSaveSettings:null,onUnshareFolder:null,ownerTeam:null,shouldHideHeader:!1,teamPolicy:null,policyUpdate:null}},render:function(){var t,n;return ne(O,{altAction:this.props.altAction,autoClose:!1,className:e({"shared-folder-settings-modal":!0,"shared-folder-settings-modal--no-permissions":!(null!=(t=this.props.permissions)&&null!=(n=t.change_options)?n.allow:void 0)}),buttonComponent:se.span(),onDismissCompleted:this.props.onDismiss,title:this.props.isTeamSharedFolder?J("“%(folder_name)s” team folder settings").format({folder_name:a.em_snippet(this.props.folderName,R.FILENAME)}):J("“%(folder_name)s” settings").format({folder_name:a.em_snippet(this.props.folderName,R.FILENAME)})},this.props.isLoading?se.div({className:"shared-folder-settings-modal__loading-text"},J("Loading...")):se.div({},this._renderHeader(),this._renderPolicies(),this._renderButtons()))},_renderHeader:function(){var t,n,r,o,a,l,d;if(!this.props.shouldHideHeader)return t={"shared-folder-settings-form__team-folder-banner":!0,"u-pad-xs":!0,"u-font-center":!0,"u-mar-bottom-s":!0},l=se.div({},J("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName})),this.props.isInContentManager?se.div({className:e(t)},l):this.props.showContentManagerBridge?(n=i.parent_dir(this.props.folderPath),r=i.filename(this.props.folderPath),d=oe({containingFolder:n,filenameToSelect:r,isLimitedTeam:this.props.isLimitedTeam}),se.div({className:e(t)},l,se.div({},J("You can change these settings in the Admin Console. "),se.a({href:d.toString(),target:"_blank"},J("Open in new tab."))))):(this.props.isTeamSharedFolder||this.props.hasParentSharedFolder)&&this.props.isUserOnOwnerTeam?se.div({className:e(t)},l,se.div({},se.a({href:"/team",target:"_blank"},J("To edit, ask your admin.")))):(null!=(o=this.props.permissions)&&null!=(a=o.change_options)?a.allow:void 0)?void 0:se.div({className:e(s.extend(t,{"shared-folder-settings-form__team-folder-banner":!1,"shared-folder-settings-form__no-permissions-banner":!0}))},J("You don’t have permission to change the settings on this folder."))},_renderPolicies:function(){var e,t,n;return t=null!=this.props.ownerTeam,n=null!=this.props.ownerTeam&&!this.props.isLimitedTeam,e=this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree,se.div({},t?this._renderPolicy("member_policy",J(e?"Who can be added to folders?":"Who can be invited to this folder?"),[{label:this.props.isLimitedTeam?J("Only people on your team"):J("Only people on your %(trademark_business)s account").format({trademark_business:j}),value:"team"},{label:J("Anyone"),value:"anyone"}]):void 0,this._renderPolicy("acl_update_policy",J(e?"Who can manage access to folders?":"Who can manage access to this folder?"),[{label:J(e?"Only Team Admins":"Only owners"),value:"owner"},{label:t?this.props.isLimitedTeam?J("Anyone on your team with edit permissions"):J("Anyone on your %(trademark_business)s account with edit permissions").format({trademark_business:j}):J("People with edit permissions"),value:"editors"}]),n?this._renderPolicy("shared_link_policy",J(this.props.isTeamSharedFolder?"Allow members of this team folder to share links with others?":"Allow links to be shared with people outside of this folder?"),[{label:J("No"),value:"members"},{label:J("Yes"),value:"anyone"}]):void 0)},_renderPolicy:function(e,t,n){var r,s,o;return o=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),s=o[0],r=o[1],ne(z,{canChange:r,policyName:e,policyDescription:t,currentValue:s,options:n,handleOptionChange:this.props.onOptionChange})},_renderButtons:function(){var e,t,n;return e=null!=(t=this.props.permissions)&&null!=(n=t.unshare)?n.allow:void 0,se.div({className:"u-mar-top-m clearfix"},this.props.isSharedFolder&&e?se.div({className:"u-l-fl"},se.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},J(this.props.hasParentSharedFolder?"Reset membership":"Unshare folder"))):void 0,this._renderUpdateSettingsButtons())},_renderUpdateSettingsButtons:function(){var e;if(null!=(e=this.props.permissions)?e.change_options.allow:void 0)return ne(U,{disableSave:null==this.props.policyUpdate,isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss})}}),W=c(X,["/static/css/sharing/share_modal-vflXwiaMl.css"],[z]),{SharedFolderSettingsModal:G,SharedFolderSettingsModalContents:W}})}.call(this),function(){define("modules/clean/sharing/link_description",["external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/viewer","modules/core/i18n","modules/constants/python","modules/constants/sharing"],function(e,t,n,r,s,o,a,i,l){var d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M;return C=n.reactFormat,d=r.LinkAudience,c=s.SNIPPET_SIZES,p=i.TRADEMARK_BUSINESS,N=a.i18n_default_project("sharing"),u=N._,M=N.ungettext,v=e.DOM,S=function(e){return(function(){switch(e){case"public":return u("Anyone with the link");case"team_only":return u("Only people on your Dropbox team");case"password":return u("Only people with the password");case"team_and_password":return u("Only people on your Dropbox team with the password");default:throw Error("Unknown visibility option "+e)}})()},b=function(e,n,r){return null==r&&(r=null),e?(function(){switch(n){case"public":return u("Anyone with the link can comment.");case"team_only":return u("Only people on your Dropbox team can comment.");case"password":return u("Only people with the password can comment.");case"team_and_password":return u("Only people on your Dropbox team with the password can comment.");case"shared_folder_only":return u("Only members of the shared folder “%(shared_folder_name)s” can comment.").format({shared_folder_name:t.em_snippet(r,c.FILENAME)});case"only_you":return u("Only you can comment.");default:throw Error("Unknown visibility setting "+n)}})():u("No one can comment.")},E=function(e){var t,n,r,s;return t=null!=(s=null!=e?e.current_audience:void 0)?s:d.members,!(null!=e?e.url:void 0)&&t!==d.members||t===d.default_on?u("Updating link..."):(r=o.get_viewer().team_is_limited,n=(function(){if(t===d.members)return u("Only invited members can access");if(t===d.public)return u(e.password_protected?"Anyone with the link and password can view":"Anyone with the link can view");if(t===d.team)return e.password_protected?r?u("Only people on your team with the password can view"):u("Only people on your %(trademark_business)s team with the password can view").format({trademark_business:p}):r?u("Only people on your team can view"):u("Only people on your %(trademark_business)s team can view").format({trademark_business:p});throw Error("Unknown link audience "+e.current_audience)})(),e.expiry&&t!==d.members&&(n=n+" ("+I(e)+")"),n)},I=function(e,t){var n,r,s,o,a;return a=e.expiry-new Date,o=36e5,s=24*o,n=Math.floor(a/s),n<1?(r=Math.floor(a/o)+1,t?M("Expires in the next hour","Expires in the next %(num_hours)s hours",r,"sharing").format({num_hours:r}):M("link turns off in the next hour","link turns off in the next %(num_hours)s hours",r,"sharing",'comes after a phrase like: "Anyone with the link can view"').format({num_hours:r})):t?M("Expires in 1 day","Expires in %(num_days)s days",n,"sharing").format({num_days:n}):M("link turns off in 1 day","link turns off in %(num_days)s days",n,"sharing",'comes after a phrase like: "Anyone with the link can view"').format({num_days:n})},w=function(e){return e.link_permissions.allow_download===!1?h(e):m(e)},m=function(e){return null!=e.expires?g(e):_(e)},h=function(e){return null!=e.expires?y(e):f(e)},_=function(e){return(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this folder"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this folder"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of this folder</strong> with this link can <strong>view</strong> this folder"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link."),{strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this file"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link."),{strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},f=function(e){return(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of this folder</strong> with this link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link. (Downloading is turned off.)"),{strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link. (Downloading is turned off.)"),{strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},g=function(e){var t,n,r;return t=null!=e.expires?(n=e.expires-new Date,n<0&&(n=0),Math.floor(n/864e5)):null,null!=(r=e.teamInfo())?r.name:void 0,(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone </strong>with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},y=function(e){var t,n,r,s;return r=864e5,t=null!=e.expires?(n=e.expires-new Date,n<0&&(n=0),Math.floor(n/r)):null,null!=(s=e.teamInfo())?s.name:void 0,(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,
strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Only you<strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},{formatLinkCommentingVisibility:b,formatLinkVisibilityOption:S,formatLinkDescription:w,formatSharedContentLinkDescription:E,formatSharedContentLinkExpiry:I}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/link_settings_modal",["external/classnames","external/immutable","external/react","external/underscore","modules/clean/api_v2/types","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/react/bubble_menu","modules/clean/react/calendar","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/delete_link_modal","modules/clean/sharing/link_description","modules/clean/static_urls","modules/clean/user","modules/clean/previews/util","modules/constants/python","modules/core/i18n","modules/core/notify"],function(t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I){var C,N,M,P,T,k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z,j,Q,Z,J;return z=o.formatTimestamp,V=a.daysAfterToday,j=a.format_date,Q=a.localized_date_format,W=l.file_extension,C=d.BubbleMenu,N=d.BubbleMenuItem,M=c.Calendar,k=u.Modal,F=h.ShareApiClient,P=_.LinkMetadata,T=_.LinkPolicy,A=_.RequestedVisibilityPolicy,x=_.ResolvedVisibilityPolicy,R=_.VisibilityDisallowedReason,G=g.deleteLinkWithConfirm,Y=y.formatLinkCommentingVisibility,K=y.formatLinkVisibilityOption,J=v.static_url,O=S.TRADEMARK_BUSINESS,D=S.TRADEMARK_PLUS,q=r.createElement,H=r.DOM,U=E.i18n_default_project("sharing")._,B=r.createClass({displayName:"SharedLinkSettingsModal",propTypes:{client:r.PropTypes.instanceOf(F).isRequired,isFile:r.PropTypes.bool.isRequired,linkMetadata:r.PropTypes.instanceOf(P).isRequired,onClose:r.PropTypes.func,onDeleteLink:r.PropTypes.func,onPolicySet:r.PropTypes.func,showUpgradeToBiz:r.PropTypes.bool.isRequired,isTeam:r.PropTypes.bool},getInitialState:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.requested_visibility,n=this.props.linkMetadata.link_permissions.resolved_visibility,t===A.public&&n===x.team_only&&(t=A.team_only),e=T({requested_visibility:t,link_password:t===A.password?null:"",expires:this.props.linkMetadata.expires,allow_download:this.props.linkMetadata.link_permissions.allow_download}),{existingPolicy:e,isSubmitting:!1,newPolicy:e}},render:function(){var e,t;return e=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.disallowed_reason===R.user_account_type}),t=e.length>0,q(k,{autoClose:!1,className:"shared-link-settings-modal",buttonComponent:H.span(),onDismissCompleted:this._handleDismissed,title:U("Link permissions for “%(content_name)s”").format({content_name:this.props.linkMetadata.name})},q(L,{canSubmit:!this.state.existingPolicy.equals(this.state.newPolicy),isFile:this.props.isFile,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onCancel:this._dismissModal,onSubmit:this._saveSettings,onPolicyUpdate:this._handlePolicyUpdate,onDeleteLink:this._deleteLink,renderedPolicy:this.state.newPolicy,showUpgradeToBiz:this.props.showUpgradeToBiz,showUpgradeMessage:t,isTeam:this.props.isTeam}))},_handlePolicyUpdate:function(e,t){return"expires"===e&&null!=t&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59)),this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_getModifiedSettings:function(){var e,t;if(t=this.state.newPolicy,t.requested_visibility===A.password){if(null==t.link_password)t=t.set("requested_visibility",null);else if(""===t.link_password)return I.error(U("Password can’t be empty")),null}else t=t.set("link_password",null);return e=this.props.linkMetadata.link_permissions.resolved_visibility,e===x.shared_folder_only&&(t=t.set("requested_visibility",null)),null!=t.expires&&(t=this.props.linkMetadata.link_permissions.can_set_expiry?t.set("expires",z(t.expires)):t.set("expires",null)),t.allow_download===this.state.existingPolicy.allow_download&&(t=t.set("allow_download",void 0)),{url:this.props.linkMetadata.url,settings:t,remove_expiration:null!=this.props.linkMetadata.expires&&null==this.state.newPolicy.expires}},_saveSettings:function(){var e;if(e=this._getModifiedSettings(),null!=e)return this.setState({isSubmitting:!0}),this.props.client.modifySharedLinkSettings(e).catch((function(e){return function(){return e.setState({isSubmitting:!1}),Promise.reject()}})(this)).then((function(e){return function(t){var n;return I.success(U("Settings saved.")),"function"==typeof(n=e.props).onPolicySet&&n.onPolicySet(t),e._dismissModal()}})(this))},_dismissModal:function(){return k.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_deleteLink:function(){var e,t;return t=(function(e){return function(){var t;return"function"==typeof(t=e.props).onDeleteLink?t.onDeleteLink():void 0}})(this),e=(function(e){return function(){return k.showInstance(q(B,e))}})(this.props),G({client:this.props.client,contentName:this.props.linkMetadata.name,onCancel:e,onDeleteLink:t,url:this.props.linkMetadata.url})}}),L=r.createClass({displayName:"SharedLinkSettingsModalContents",propTypes:{canSubmit:r.PropTypes.bool.isRequired,isFile:r.PropTypes.bool.isRequired,isSubmitting:r.PropTypes.bool.isRequired,linkMetadata:r.PropTypes.instanceOf(P).isRequired,onCancel:r.PropTypes.func,onSubmit:r.PropTypes.func,onPolicyUpdate:r.PropTypes.func,onDeleteLink:r.PropTypes.func,renderedPolicy:r.PropTypes.instanceOf(T).isRequired,showUpgradeToBiz:r.PropTypes.bool.isRequired,showUpgradeMessage:r.PropTypes.bool.isRequired,isTeam:r.PropTypes.bool},getInitialState:function(){return{selectedExpiry:null!=this.props.renderedPolicy.expires?this.props.linkMetadata.link_permissions.can_set_expiry?"custom":"read-only":"no-expiry"}},render:function(){return H.div({className:"shared-link-settings-modal__contents"},this._renderHeader(),this._renderPolicies(),this._renderButtons())},_renderHeader:function(){var e,t;return this.props.showUpgradeToBiz?H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner"},H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-text"},U("Did you know %(trademark_business)s lets you add passwords and expiration dates to shared links?").format({trademark_business:O})),H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-cta"},H.a({className:"c-btn c-btn--secondary shared-link-settings-modal__upgrade-to-biz-banner-cta-button",href:"/business?tk=teams&camp=sharing_link_modal",target:"_blank"},U("Learn More")))):this.props.showUpgradeMessage?(this.props.isTeam?(e="/team/upgrade",t=U("Upgrade to %(trademark_business)s to enable permission settings").format({trademark_business:O})):(e="/upgrade?oqa=sfp",t=U("Upgrade to Dropbox %(trademark_plus)s to enable permission settings.").format({trademark_plus:D})),H.div({className:"shared-link-settings-modal__upgrade-to-pro-banner"},H.a({href:e,target:"_blank"},t))):void 0},_renderPolicies:function(){return H.div({},this._renderVisibilityPolicies(),this._renderExpiryPolicy(),this._renderDownloadPolicy(),this._renderCommentsPolicy())},_renderVisibilityPolicies:function(){var e,t;return t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.allowed||e.disallowed_reason===R.user_account_type}),e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,this._renderFieldset(U("Who can view this link?"),e===R.permission_denied&&0===t.length?this._renderNonPermissionVisibility():t.length<2?this._renderRestrictedBySharedFolderVisibility():t.map(this._renderVisibilityOption))},_renderNonPermissionVisibility:function(){var e;return e=this.props.linkMetadata.link_permissions.resolved_visibility,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},e===x.shared_folder_only?U("Only invited members can view this link."):K(e))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},U("You don’t have permission to change the visibility.")))},_renderRestrictedBySharedFolderVisibility:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.resolved_visibility,e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},function(){if(t===x.shared_folder_only)return n=this.props.linkMetadata.link_permissions.restricting_shared_folder_path,n=i.em_snippet(n,f.SNIPPET_SIZES.FILENAME),U("Only members of the shared folder “%(shared_folder_name)s” can view this link.").format({shared_folder_name:n});if(t===x.only_you)return U("Only you can view this link.");throw"Unexpected visibility "+t}.call(this))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},(function(){if(e===R.restricted_by_shared_folder)return U("To change who can access the link, go to the shared folder options.");if(e===R.delete_and_recreate)return U("To change who can access the link, delete this link and create a new one.");throw"Unexpected disallowed reason "+e})()))},_renderVisibilityOption:function(e){var n,r;return n=e.disallowed_reason===R.user_account_type,[H.label({className:t({"u-font-meta":!e.allowed}),key:"visibility-label"},H.input({checked:e.policy===this.props.renderedPolicy.requested_visibility,className:t((r={"shared-link-settings-modal__audience":!0},r["shared-link-settings-modal__audience-"+e.policy]=!0,r)),disabled:n,name:A.policy_name,onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),type:"radio",value:e.policy}),this._renderVisibilityLabelText(e)),e.policy===A.password&&this.props.renderedPolicy.requested_visibility===A.password?H.div({key:"password-input"},this._renderPasswordInput(n)):void 0]},_renderVisibilityLabelText:function(e){var n;return H.span({className:t((n={"shared-link-settings-modal__audience":!0},n["shared-link-settings-modal__audience-"+e.policy+"-label"]=!0,n))},K(e.resolved_policy))},_renderPasswordInput:function(e){var t,n;return n=null==this.props.renderedPolicy.link_password,H.div({className:"shared-link-settings-modal__password-container u-mar-left-m u-mar-right-xl u-mar-top-xs"},H.input({className:"shared-link-settings-modal__password-input c-input",disabled:e||n,name:"link_password",onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),placeholder:U("Set password"),value:null!=(t=this.props.renderedPolicy.link_password)?t:"123456",type:"password"}),n&&!e?H.button({className:"shared-link-settings-modal__password-change button-as-link",onClick:(function(e){return function(){return e.props.onPolicyUpdate("link_password","")}})(this)},U("Change",{comment:"A link to change the password for the shared link"})):void 0)},_renderExpiryPolicy:function(){return this._renderFieldset(U("Add an expiry date to this link?"),H.div({},H.label({className:t({"shared-link-settings-modal__expiry-label-yes":!0,"u-font-meta":!this.props.linkMetadata.link_permissions.can_set_expiry})},H.input({checked:"no-expiry"!==this.state.selectedExpiry,className:"shared-link-settings-modal__expiry-option-yes",disabled:!this.props.linkMetadata.link_permissions.can_set_expiry,onChange:(function(e){return function(){if("no-expiry"===e.state.selectedExpiry)return e._handleExpirySelectChange(30)}})(this),type:"radio"}),this._renderYesExpiryText()),"custom"===this.state.selectedExpiry?this._renderExpiryCustom():void 0,H.label({className:t({"u-font-meta":!this.props.linkMetadata.link_permissions.can_remove_expiry})},H.input({checked:null==this.props.renderedPolicy.expires,className:"shared-link-settings-modal__expiry-option-no",disabled:!this.props.linkMetadata.link_permissions.can_remove_expiry,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate&&t.onPolicyUpdate("expires",null),e.setState({selectedExpiry:"no-expiry"})}})(this),type:"radio"}),U("No"))))},_renderYesExpiryText:function(){var e,t;if(7===(e=this.state.selectedExpiry)||30===e)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires in",{comment:'Label followed by a date range e.g. "Yes, expires in 7 days"'})," ",this._renderExpirySelect());if("custom"===(t=this.state.selectedExpiry)||"read-only"===t)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires on",{comment:'Label followed by a date. e.g. "Yes, expires on 5/10/2017"'})," ","read-only"===this.state.selectedExpiry?j(this.props.linkMetadata.expires,Q):void 0);if("no-expiry"===this.state.selectedExpiry)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes"));throw"Expiry policy is in an unknown state"},_renderExpirySelect:function(){var e;return q(C,{position:C.POSITIONS.BOTTOM,targetFixed:!0,items:function(){var t,n,r,s;for(r=[7,30,"custom"],s=[],t=0,n=r.length;t<n;t++)e=r[t],s.push(q(N,{onClick:(function(e){return function(t){return function(){return e._handleExpirySelectChange(t)}}})(this)(e)},this._renderExpirySelectLabel(e)));return s}.call(this),targetButton:H.button({className:"shared-link-settings-modal__selected-expiry button-as-link"},this._renderExpirySelectLabel(this.state.selectedExpiry)," ",H.img({alt:"",className:"sprite sprite_web s_web_arrow-down-gray",src:J("/static/images/icons/icon_spacer-vflN3BYt2.gif")}))})},_renderExpirySelectLabel:function(e){if(7===e)return U("7 days",{comment:'as in "This link expires in 7 days"'});if(30===e)return U("30 days",{comment:'as in "This link expires in 30 days"'});if("custom"===e)return U("Custom date...",{comment:"Dropdown option for expiry date on a link. The user can choose 7 days, 30 days, or a custom expiry"});throw"Unknown selected expiry"},_handleExpirySelectChange:function(e){var t;return this.setState({selectedExpiry:e}),"custom"===e&&(e=30),"function"==typeof(t=this.props).onPolicyUpdate?t.onPolicyUpdate("expires",V(e)):void 0},_renderExpiryCustom:function(){var e;return H.span({className:"shared-link-settings-modal__calendar-input"},q(M,{alignAtLeft:!1,onDateChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).onPolicyUpdate?n.onPolicyUpdate("expires",t):void 0}})(this),initDate:null!=(e=this.props.linkMetadata.expires)?e:V(30),firstDay:V(1),lastDay:V(365)}))},_renderDownloadPolicy:function(){var e,n,r;if(r=this.props.linkMetadata.link_permissions.can_disallow_download,n=this.props.linkMetadata.link_permissions.can_allow_download,e=this.props.linkMetadata.link_permissions.allow_download,null!=r&&null!=n&&null!=e&&(r!==!1||e!==!0))return this._renderFieldset(U("Allow people to download this?"),H.div({},H.label({className:t({"u-font-meta":!n})},H.input({checked:this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-yes",disabled:!n,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!0):void 0}})(this),type:"radio"}),U("Yes")),H.label({className:t({"u-font-meta":!r})},H.input({checked:!this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-no",disabled:!r,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!1):void 0}})(this),type:"radio"}),U("No"))),this._renderNoPreviewFileWarning())},_renderNoPreviewFileWarning:function(){var t,n,r,s;if(this.props.isFile&&(t=W(this.props.linkMetadata.name),n=t.toUpperCase(),!(null!=(null!=(s=this.props.linkMetadata)?s.preview_type:void 0)&&(r=this.props.linkMetadata.preview_type,e.call(w.VALID_PREVIEW_TYPES,r)>=0))))return this.props.renderedPolicy.allow_download===!1?H.div({className:"shared-link-settings-modal__preview-warning c-banner c-banner--warning"},H.div({className:"o-flag"},H.div({className:"o-flag-fix"},q(m,{alt:"",group:"web",name:"page_white_32"})),H.div({className:"o-flag__flex u-pad-left-xs"},U("People can’t view this %(file_extension)s file if they can’t download it.",{comment:'as in "People can’t view this .PDF file'}).format({file_extension:"."+n})))):void 0},_renderCommentsPolicy:function(){if(!this.props.linkMetadata.link_permissions.team_restricts_comments)return this._renderFieldset(U("Who can comment?"),H.div({},H.div({className:"shared-link-settings-modal__commenting-policy"},Y(this.props.linkMetadata.link_permissions.allow_comments,this._getResolvedVisibility(this.props.renderedPolicy.requested_visibility),this.props.linkMetadata.link_permissions.restricting_shared_folder_path)),H.div({className:"shared-link-settings-modal__commenting-advice"},this.props.linkMetadata.link_permissions.allow_comments?H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to disable comments")):H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to enable comments")))))},_getResolvedVisibility:function(e){var t;if(t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(t){return t.policy===e}),1!==t.length)throw"Logic error: "+t.length+" should be 1.";return t[0].resolved_policy},_renderFieldset:function(e,t,n){return null==n&&(n=null),H.fieldset({className:"settings-form-entry"},H.legend({className:"settings-form-entry__explanation u-trim-margin"},e),H.div({className:"settings-form-entry__options"},t),H.div({className:"u-mar-top-m"},n))},_renderButtons:function(){return H.div({className:"u-mar-top-m clearfix"},this.props.linkMetadata.link_permissions.can_revoke?H.div({className:"u-l-fl"},H.button({className:"button-as-link delete-link",onClick:this.props.onDeleteLink,style:{lineHeight:"32px"},type:"button"},U("Delete link"))):void 0,H.div({className:"u-l-fr"},H.button({className:"c-btn c-btn--primary confirm-button",disabled:this.props.isSubmitting||!this.props.canSubmit,onClick:this.props.onSubmit},U(this.props.isSubmitting?"Saving...":"Save settings")),H.button({className:"c-btn c-btn--secondary u-mar-left-xs cancel-button",onClick:this.props.onCancel},U("Cancel"))))}}),Z=function(e){return f.SHARING_EXPERIMENTS.SHOW_UPGRADE_TO_BIZ_BANNER[e]},{SharedLinkSettingsModal:p(B,["/static/css/sharing/share_modal-vflXwiaMl.css"]),SharedLinkSettingsModalContents:L,showUpgradeToBizBanner:Z}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/member_avatars",["external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/initials_avatar","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/photo_avatar","modules/clean/avatar/shared_link_avatar","modules/clean/avatar/viewer_avatar","modules/clean/avatar/list","modules/clean/components/title_bubble","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/constants","modules/clean/sharing/link_description","modules/clean/viewer","modules/core/i18n","modules/clean/static_urls"],function(t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g){var y,v,b,w,S,E,I,C,N;return I=p.nice_date_with_month_name,y=m.SHMODEL_LINK_TOKEN_VISIBILITY,v=m.SNIPPET_SIZES,E=h.formatSharedContentLinkDescription,b=f._,N=f.ungettext,C=g.static_url,w=t.createElement,S=t.DOM,{getInitialState:function(){return{paired_users_in_sf:!1}},componentWillMount:function(){var e;return e=this.arePairedUsersInSf(this.props.joinedMembers),this.setState({paired_users_in_sf:e,paired_users_in_sf:e})},componentWillReceiveProps:function(e){var t;return t=this.arePairedUsersInSf(e.joinedMembers),this.setState({paired_users_in_sf:t,paired_users_in_sf:t})},_wrap_with_avatar_type_and_data:function(e,t,n){return function(r){return e(t,n),r.stopPropagation()}},arePairedUsersInSf:function(t){var n,r,s,o,a,i;return!!t&&(i=_.get_viewer(),!!(i.is_paired&&(a=i.get_user_ids(!0),n=(function(){var e,n,s;for(s=[],e=0,n=t.length;e<n;e++)r=t[e],s.push(r.user_id);return s})(),s=a[0],e.call(n,s)>=0&&(o=a[1],e.call(n,o)>=0))))},findOwnerAndMeInJoinedMembers:function(e){var t,n,r,s,o,a;for(a=null,s=null,t=n=0,r=e.length;n<r&&(o=e[t],"owner"===o.access_type&&(a=o),o.user_id===this.props.user.id&&(s=o),null==a||null==s);t=++n);return[a,s]},addGroupsMembersInvitations:function(t,n,r,s,o){var a,i,l,d,c,p,u,m,h,_,f;for(null==o&&(o=[]),l=0,p=n.length;l<p;l++)a=n[l],t.push(this.renderGroup(a));for(d=0,u=r.length;d<u;d++)h=r[d],_=h.user_id,e.call(o,_)<0&&t.push(this.renderJoinedMember(h));for(f=[],c=0,m=s.length;c<m;c++)i=s[c],f.push(t.push(this.renderInvitedPerson(i)));return f},renderAvatarList:function(e,t){var n;return null==t&&(t=""),n=(function(e){return function(t){var n,r,o;return n=99,o=N("%(count)s more member","%(count)s more members",t).format({count:t}),r=t>=n?n+"+":""+t,w(c,{key:"overflow_count",text:o,direction:e.props.titleButtonDirection},w(s,{alt:o,dimension:e.props.avatarDimension,initials:r,color:"#7B8994",shape:"CIRCLE",onClick:e.props.onOverflowCountClick}))}})(this),w(d,{avatars:e,avatarDimension:this.props.avatarDimension,maxVisible:this.props.maxVisibleAvatars,undisplayableCount:this.props.numUndisplayableUsersAndInvites||0,onOverflowCountClick:this.props.onOverflowCountClick,overflowCountRenderer:n,animation:this.props.animation,inheritedCountAvatar:this.renderInheritedCount(e.length),className:t,reverseAvatars:!this.props.isMaestroDesign})},renderJoinedMember:function(t){var r,s,a,i,d,p,m,h,f,g,y;return g=_.get_viewer(),f=t.user_id,p=e.call(g.get_user_ids(!0),f)>=0,i=null,p&&this.state.paired_users_in_sf?(d=t.user_id,h=g.get_user_by_role("personal",!0),y=g.get_user_by_role("work",!0),d===h.id?i="Personal":d===y.id&&null!=g.team_name&&(i=g.team_name)):i=t.display_name,this.props.isInAudienceBox&&(i=u.em_snippet(i,v.DISPLAY_NAME)),r=this.individualAccessTypeString(i,t.access_type,p,this.state.paired_users_in_sf),m=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"member",t),a={alt:r,dimension:this.props.avatarDimension,onPhotoClick:m,photoUrl:t.photo_url,defaultAvatar:w(o,{alt:r,dimension:this.props.avatarDimension,name:t.display_name,initials:this.props.isInAudienceBox?t.initials.toUpperCase():t.initials,shape:"CIRCLE",onClick:m})},s=p?w(l,a):w(n,a),w(c,{key:"user:"+t.user_id+":"+t.photo_url,text:r,direction:this.props.titleButtonDirection},s)},renderGroup:function(e){var t,n,r;return n=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"group",e),e.is_automatic?(r=this.teamAccessTypeString(e.name,e.access_type),t=w(a,{alt:r,dimension:this.props.avatarDimension,photoUrl:C("/static/images/icons/team_32-vflk8mBzO.png"),shape:"SQUARE",onClick:n})):(r=this.groupAccessTypeString(e.name,e.access_type,e.num_users),t=w(o,{alt:r,dimension:this.props.avatarDimension,name:e.name,shape:"SQUARE",initials:this.getInitials(e.name),onClick:n})),w(c,{key:"group:"+e.gid+":"+e.name,text:r,direction:this.props.titleButtonDirection},t)},renderInvitedPerson:function(e){var t,n;return n=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"invited",e),t=this.individualAccessTypeString(e.email_or_fbname,"pending",!1),w(c,{key:"invitation:"+e.invitation_id,text:t,direction:this.props.titleButtonDirection},w(s,{alt:t,dimension:this.props.avatarDimension,color:"#aaa",initials:this.getInitials(e.email_or_fbname),shape:"CIRCLE",onClick:n}))},renderInheritedCount:function(e){var t;if(this.props.numInheritedMembers>0)return t=N("%(inherited_count)s member from %(parent_folder)s folder","%(inherited_count)s members from %(parent_folder)s folder",this.props.numInheritedMembers).format({inherited_count:this.props.numInheritedMembers,parent_folder:this.props.parentFolderName}),S.div({},w(c,{text:t,direction:"south"},w(r,{inheritedMemberCount:this.props.numInheritedMembers,key:"count",onClick:this.props.onAvatarClick})),e>0?S.span({className:"members-column__plus-sign u-pad-left-xxs"},"+"):void 0)},getInitials:function(e){var t,n,r;return null!=e&&e.length>0?(r=e.split(" "),t=(function(){var e,t,s;for(s=[],e=0,t=r.length;e<t;e++)n=r[e],s.push(n.charAt(0).toLowerCase());return s})(),t.length>2&&(t=t.splice(0,2)),t.join("")):""},teamAccessTypeString:function(e,t){var n;return n=b("editor"===t?"%(team_group_name)s can edit":"%(team_group_name)s can view"),n.format({team_group_name:u.em_snippet(e,v.DISPLAY_NAME)})},groupAccessTypeString:function(e,t,n){var r;return r="editor"===t?N("%(num_users)s person in %(group_name)s can edit","%(num_users)s people in %(group_name)s can edit",n):N("%(num_users)s person in %(group_name)s can view","%(num_users)s people in %(group_name)s can view",n),r.format({group_name:u.em_snippet(e,v.DISPLAY_NAME),num_users:n})},individualAccessTypeString:function(e,t,n,r){var s,o,a,i;return null==r&&(r=!1),s={viewer:b("You can view"),editor:b("You can edit"),owner:b("You’re the owner"),team:b("You’re a member of this team folder"),default:b("You")},i={viewer:b("%(name)s can view"),editor:b("%(name)s can edit"),owner:b("%(name)s is the owner"),pending:b("%(name)s hasn’t added this to their Dropbox yet"),team:b("%(name)s is a member of this team folder"),default:b("%(name)s"),"no access":b("No access")},o={viewer:b("You (%(name)s) can view"),editor:b("You (%(name)s) can edit"),owner:b("You (%(name)s) are the owner")},a=n?r&&null!=e?o:s:i,a.hasOwnProperty(t)?a[t].format({name:u.em_snippet(e,v.DISPLAY_NAME)}):""},renderSharedLink:function(e,t){var n,r,s,o;return n=this.getDescriptionForSharedLinkInfo(e,t),r=w(i,{alt:n,dimension:this.props.avatarDimension,isMaestroDesign:this.props.isMaestroDesign,onClick:(function(t){return function(n){return t.props.onSharedLinkClick(e),n.stopPropagation()}})(this)}),(null!=e?e.allow_download:void 0)===!1?(s="sharing-icon-bubble-title u-font-center",o=!0):o=!1,w(c,{key:"shared_link",text:n,direction:"south",className:s,respectLineBreaks:o},r)},getDescriptionForSharedLinkInfo:function(e,t){var n,r,s,o,a,i,l,d,c,p,u,m;if(t)return E(t);if(m=e.visibility_type,o=e.expires_posix,p=e.shared_folder_link_policy,s="",o){if(d=(new Date).getTime()/1e3,c=o-d,r=Math.floor(c/86400),c<0)return b("Link Disabled");n=new Date(1e3*o),u=!1,i=!0,a=r>180,n=I(n,a,u,i)}if(e.allow_download===!1&&(s=". "+b("(Downloading is turned off.)",{comment:'This follows a description of link visibility. For example: "Anyone with the link can view this file. (Downloading is turned off.)"'})),l="MEMBERS_ONLY"===p,n){if(l)return b("Folder members with the link can view until %(date)s").format({date:n})+s;if(m===y.PUBLIC)return b("People with the link can view until %(date)s").format({date:n})+s;if(m===y.PASSWORD)return b("People with the password can view until %(date)s").format({date:n})+s;if(m===y.TEAM_ONLY)return b("People at %(team_name)s can view until %(date)s").format({team_name:_.get_viewer().team_name,date:n})+s;if(m===y.ONLY_YOU)return b("Only you can view until %(date)s").format({date:n})+s}else{if(l)return b("Folder members with the link can view")+s;if(m===y.PUBLIC)return b("People with the link can view")+s;if(m===y.PASSWORD)return b("People with the password can view")+s;if(m===y.TEAM_ONLY)return b("People at %(team_name)s with the link can view").format({team_name:_.get_viewer().team_name})+s;if(m===y.ONLY_YOU)return b("Only you can view")+s}}}})}.call(this),function(){define("modules/clean/sharing/parent_folder_access_modal",["external/classnames","external/react","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d){var c,p,u,m,h,_,f,g,y,v,b;return m=s.Modal,u=a.MemberAccessLevelResult,c=i.ACCESS_LEVEL,_=i.SNIPPET_SIZES,p=l.ContentInfo,g=t.createElement,y=t.DOM,v=d.i18n_default_project("sharing"),f=v._,b=v.ungettext,h=t.createClass({displayName:"ParentFolderAccessModal",propTypes:{contentInfo:t.PropTypes.instanceOf(p).isRequired,memberAccessLevelResult:t.PropTypes.instanceOf(u).isRequired,memberDisplayName:t.PropTypes.string.isRequired,originalAction:t.PropTypes.oneOf(["remove","update"]).isRequired,isInContentManager:t.PropTypes.bool,onClose:t.PropTypes.func,onParentFolderClicked:t.PropTypes.func},_dismissModal:function(){return m.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_handleNavigateToParentFolder:function(e){var t;return m.close(),"function"==typeof(t=this.props).onParentFolderClicked?t.onParentFolderClicked(e.path,this._arePermissionsAllowed(e.permissions)):void 0},_arePermissionsAllowed:function(e){return e.some(function(e){return null!=e?e.allow:void 0})},_memberCanEdit:function(){var e;return(e=this.props.memberAccessLevelResult.access_level)===c.OWNER||e===c.WRITER},_renderParentFolderContent:function(){var e
;return e="remove"===this.props.originalAction?this.props.contentInfo.isFolder()?b("As a member of the parent folder listed below, %(member_name)s can still access the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still access “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):"update"===this.props.originalAction?this.props.contentInfo.isFolder()?this._memberCanEdit()?b("As a member of the parent folder listed below, %(member_name)s can still edit the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still view the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):this._memberCanEdit()?b("As a member of the parent folder listed below, %(member_name)s can still edit “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still view “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):void 0,y.div({},e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME),content_name:n.em_snippet(this.props.contentInfo.name(),_.FILENAME)}),y.div({className:"parent-folder-access-modal__folder-list u-mar-top-s"},y.ul({className:"o-list-ui o-list-ui--dividers"},this.props.memberAccessLevelResult.parentFolders.map(this._renderParentFolder))))},_renderParentFolder:function(e){var t;return t=g(o,{group:"web",name:"folder_user_32",className:"u-pad-right-xs",alt:""}),y.li({},y.div({className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:this._handleNavigateToParentFolder.bind(null,e)},g(r.Flag,{leftAttachment:t,rightAttachment:this._renderFolderLink(e)},y.span({className:"parent-folder-access-modal__folder-name"},n.em_snippet(e.name,_.FILENAME)))))},_renderFolderLink:function(e){return y.button({className:"button-as-link",onClick:this._handleNavigateToParentFolder.bind(null,e),type:"button"},f(this._arePermissionsAllowed(e.permissions)?"Manage membership":"View folder"))},_renderSimpleContent:function(){return y.div({},y.span({className:"parent-folder-access-modal__warning"},this.props.memberAccessLevelResult.warning),y.div({className:"u-mar-top-m clearfix"},y.div({className:"u-l-fr"},y.button({className:"c-btn c-btn--primary confirm-button",onClick:this._dismissModal},f("OK")))))},render:function(){var e;return e="remove"===this.props.originalAction?f(this.props.contentInfo.isFolder()?"%(member_name)s can still access this folder":"%(member_name)s can still access this file"):"update"===this.props.originalAction?f(this.props.contentInfo.isFolder()?this._memberCanEdit()?"%(member_name)s can still edit this folder":"%(member_name)s can still view this folder":this._memberCanEdit()?"%(member_name)s can still edit this file":"%(member_name)s can still view this file"):void 0,g(m,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:y.span(),onDismissCompleted:this._handleDismissed,title:e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME)})},y.div({className:"parent-folder-access-modal__contents"},null==this.props.memberAccessLevelResult.parentFolders||this.props.isInContentManager?this._renderSimpleContent():this._renderParentFolderContent()))}}),{ParentFolderAccessModal:h}})}.call(this),function(){var e=function(e,n){function r(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/role_selector_modal",["jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(t,n,r,s){var o;return o=n.DBModal,(function(n){function o(e){this.onSelectRole=e,o.__super__.constructor.call(this,{element_id:"select-role-modal-sync"})}return e(o,n),o.prototype.on_show=function(){return t(".role-options li").click((function(e){return function(n){var o;return o=t(n.target).closest("li").data("role"),e.hide(),s.get_viewer().is_role_signed_in(o)?e.onSelectRole(o):r.show_modal({role:o,on_success:function(){return e.onSelectRole(o)}})}})(this))},o})(o)})}.call(this),function(){define("modules/clean/sharing/set_confidential_modal",["external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/modal","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,s,o,a){var i,l,d,c,p,u,m,h;return m=n.filename,h=n.parent_dir,i=r.Modal,l=o.SNIPPET_SIZES,p=e.createElement,u=e.DOM,c=a.i18n_default_project("sharing")._,d=e.createClass({displayName:"SetConfidentialModal",propTypes:{client:e.PropTypes.instanceOf(s).isRequired,folderId:e.PropTypes.string.isRequired,folderName:e.PropTypes.string.isRequired,folderPath:e.PropTypes.string.isRequired,initialIsConfidentialFolder:e.PropTypes.bool.isRequired,onCancel:e.PropTypes.func,onUpdateConfidentiality:e.PropTypes.func},getInitialState:function(){return{isAccepting:!1,setConfidential:this.props.initialIsConfidentialFolder}},render:function(){return p(i,{autoClose:!1,buttonComponent:u.span(),onDismissCompleted:this._handleDismiss,title:c("“%(folder_name)s” access").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME)})},this._renderContent(),this._renderButtons())},_renderContent:function(){var e;return e=t.em_snippet(m(h(this.props.folderPath)),l.FILENAME),u.div({className:"set-confidential-content"},u.div({className:"set-confidential-content__info"},c("Should members of the parent folder “%(parent_folder)s” automatically get access to the folder “%(folder_name)s”?").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME),parent_folder:e})),u.div({className:"set-confidential-content__options u-pad-top-s"},u.label({className:"u-l-b",key:"inherit"},u.input({checked:!this.state.setConfidential,name:"inherit",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!1}),c("Yes, allow members of “%(parent_folder)s” to access").format({parent_folder:e})),u.label({className:"u-l-b",key:"confidential"},u.input({checked:this.state.setConfidential,name:"confidential",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!0}),c("No, make this folder invite only"))))},_renderButtons:function(){return u.div({className:"u-l-fr"},u.button({className:"c-btn c-btn--primary",disabled:this.state.isAccepting||this.state.setConfidential===this.props.initialIsConfidentialFolder,onClick:this._handleAcceptClick},c(this.props.isAccepting?"Saving...":"Save")),u.button({className:"c-btn c-btn--secondary u-mar-left-xs",onClick:this._handleDismiss},c("Cancel")))},_handleSetConfidentialValueUpdate:function(e){return this.setState({setConfidential:"true"===e.target.value})},_handleAcceptClick:function(){return this.setState({isAccepting:!0}),this.props.folderId?this.props.client.setConfidentiality({contentId:this.props.folderId,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this)):this.props.client.share({fqPath:this.props.folderPath,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this))},_handleDismiss:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0}}),{SetConfidentialModal:d}})}.call(this),define("modules/clean/sharing/settings_modal/views/link_settings_tab",["require","exports","modules/clean/em_string","modules/core/i18n","modules/constants/python","external/react","modules/clean/sharing/api/types/metadata","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/gating_util"],function(e,t,n,r,s,o,a,i,l){"use strict";function d(){return p("Link settings")}function c(e){return l.isUserNoCommentEnabled(e)?[i.AUDIENCE_POLICY,i.ACCESS_LEVEL_POLICY,i.EXPIRY_POLICY,i.PASSWORD_POLICY]:[i.AUDIENCE_POLICY,i.EXPIRY_POLICY,i.PASSWORD_POLICY]}Object.defineProperty(t,"__esModule",{value:!0});var p=r.i18n_default_project("sharing")._;t.TabName=d,t.Description=function(e){var t;return t="owner"===e.aclUpdatePolicy?p(e.isTeamFolderTree?"Only team admins can change these settings":e.userIsOwner?"Only you (the owner) can change these settings":"Only the owner can change these settings"):null!=e.ownerTeam?p("Members of %(team_name)s with edit access can change these settings").format({team_name:n.em_snippet(e.ownerTeam.name,12)}):p("Anyone with edit access can change these settings"),o.createElement("span",null,t)},t.Banner=function(e){var t,n=e.linkMetadata.link_permissions&&e.linkMetadata.link_permissions.some(function(e){return!(!e||!e.allow)}),r=null!=e.linkMetadata.link_permissions.set_password&&e.linkMetadata.link_permissions.set_password.reason===a.VisibilityDisallowedReason.user_account_type;if(n){if(!r)return o.createElement("div",null);t=e.user.is_team?o.createElement("a",{href:"/team/upgrade",target:"_blank",rel:"noopener noreferrer"},p("Upgrade to %(trademark_business)s to enable expiration and password settings").format({trademark_business:s.TRADEMARK_BUSINESS})):o.createElement("a",{href:"/upgrade?oqa=sfp",target:"_blank",rel:"noopener noreferrer"},p("Upgrade to Dropbox %(trademark_plus)s to enable expiration and password settings.").format({trademark_plus:s.TRADEMARK_PLUS}))}else t=o.createElement("span",null,p("You don’t have permission to modify these link settings"));return o.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},t)},t.getPolicies=c}),function(){define("modules/clean/sharing/settings_modal_components",["external/classnames","external/react","modules/clean/react/css","modules/core/i18n"],function(e,t,n,r){var s,o,a,i,l;return l=t.DOM,a=r.i18n_default_project("sharing")._,s=t.createClass({displayName:"SettingsModalButtons",propTypes:{disableSave:t.PropTypes.bool,isAccepting:t.PropTypes.bool,onAccept:t.PropTypes.func,onDismiss:t.PropTypes.func},render:function(){return l.div({className:"u-l-fr"},l.button({className:"confirm-button c-btn c-btn--primary",disabled:this.props.disableSave||this.props.isAccepting,onClick:this.props.onAccept},a(this.props.isAccepting?"Saving...":"Save")),l.button({className:"cancel-button c-btn c-btn--secondary u-mar-left-xs",onClick:this.props.onDismiss},a("Cancel")))}}),i=t.createClass({displayName:"SinglePolicyControl",propTypes:{canChange:t.PropTypes.bool,currentValue:t.PropTypes.string,handleOptionChange:t.PropTypes.func,options:t.PropTypes.array,policyDescription:t.PropTypes.string,policyName:t.PropTypes.string},getDefaultProps:function(){return{canChange:!0}},render:function(){var t;return l.fieldset({className:e({"settings-form-entry":!0,"settings-form-entry--no-permissions":!this.props.canChange})},l.legend({className:"settings-form-entry__explanation u-trim-margin"},this.props.policyDescription),l.div({className:"settings-form-entry__options"},function(){var e,n,r,s;for(r=this.props.options,s=[],e=0,n=r.length;e<n;e++)t=r[e],s.push(l.label({key:t.value},l.input({checked:t.value===this.props.currentValue,className:"settings-form-entry-option-"+this.props.policyName+"__"+t.value,disabled:!this.props.canChange,name:this.props.policyName,onChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).handleOptionChange?n.handleOptionChange(t.target.name,t.target.value):void 0}})(this),type:"radio",value:t.value}),t.label));return s}.call(this)))}}),o=n(i,["/static/css/sharing/share_modal-vflXwiaMl.css"]),{SettingsModalButtons:s,SinglePolicyControl:o}})}.call(this),define("modules/clean/sharing/share_modal",["require","exports","tslib","external/immutable","external/react","modules/clean/flux/dispatcher","modules/clean/flux/store_listener","modules/clean/growth/experiments/manage_shared_folders_modal","modules/clean/growth/experiments/sharing_paywall_info_modal","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/api/util/types","modules/clean/sharing/file_settings_modal","modules/clean/sharing/folder_settings_modal","modules/clean/sharing/set_confidential_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/modal_content","modules/clean/sharing/views/viewer_list_modal","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/core/user_i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=s.createElement,k=N.i18n_default_project("sharing"),A=k._,x=k.ungettext,F=function(e){var t=u.getAnonymousUserIds(e),n=A("Guest");return t.map(function(e){return new m.UserMembershipInfo({access_type:h.ACCESS_LEVEL.READER,account:new m.BasicAccount({account_id:e,display_name:n,familiar_name:n,given_name:n,surname:""}),account_id:e,initials:P.getInitials(n),is_inherited:!1,permissions:new m.MemberPermissions({make_editor:new m.PermissionSetting({allow:!1}),make_viewer:new m.PermissionSetting({allow:!1}),make_owner:new m.PermissionSetting({allow:!1}),remove:new m.PermissionSetting({allow:!1})}),same_team:!1,time_last_seen:null})})},L=function(e){var t=e.actionHandler.getSharingInfo(),s=e.actionHandler.getPassInfo(),o=s[0],a=s[1],i=s[2],l=s[3],d={actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),banner:t.banner(),canChangeOptions:t.canChangeOptions(),canInviteEditor:t.canInviteEditor(),canInviteViewer:t.canInviteViewer(),canInviteViewerNoComment:t.canInviteViewerNoComment(),canMakeViewerNoComment:t.canMakeViewerNoComment(),canRelinquishMembership:t.canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.canUnshareFile(),canUnshareFolder:t.canUnshareFolder(),canUpdateConfidentiality:t.canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),guestMembers:F(i),groupSeenStateInfo:a,hasDisplayableMembers:t.hasDisplayableMembers(),hasNonOwnerMembers:t.hasNonOwnerMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),icon:t.icon(),initialRecipientRawInput:t.initialRecipientRawInput(),initialRecipientTokens:t.initialRecipientTokens(),isAddMessageAsCommentChecked:t.isAddMessageAsCommentChecked(),isAddMessageAsCommentHelpShown:t.isAddMessageAsCommentHelpShown(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isNoCommentEnabledForFolders:t.isNoCommentEnabledForFolders(),isNoCommentEnabledForLinks:t.isNoCommentEnabledForLinks(),isOwner:t.isOwner(),isSharingPaywallInfoLoaded:t.isSharingPaywallInfoLoaded(),isTeamPolicyLoaded:t.isTeamPolicyLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),linkSeenStateInfo:o,memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:l,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),presentAccountIds:r.Set(i),recipientAccess:t.recipientAccess(),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareFolderPromise:t.shareFolderPromise(),sharingPaywallInfo:{foldersToUnshare:t.foldersToUnshare(),isInExperiment:t.isPaywallOn(),maxOwned:t.paywallMax(),numOwned:t.paywallNumOwned(),grandfatherModal:t.paywallGrandfatherModal()},shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),expSubgrowthProOverquotaCreateSharedLink:t.expSubgrowthProOverquotaCreateSharedLink()};return n.__assign({},t.getInitialProps(),d)},O=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleLinkViewersClick=function(){p.Modal.showInstance(s.createElement(I.ViewerListModal,{contentInfo:n.props.contentInfo,seenStateInfo:n.props.linkSeenStateInfo,onCancel:n.props.actionHandler.openShareModal,presentAccountIds:n.props.presentAccountIds,user:n.props.user})),w.logTiburonEvent(n.props.contentInfo,n.props.user.id,"OPEN_SHARED_LINK_VIEWER_LIST_MODAL")},n.handleManageSharedFoldersClick=function(){var e=function(e,t){if(e&&e.size>0){n.props.actionHandler.onUnshareFromPaywall({foldersToUnshare:e,keepACopy:t});var r=x("%(num_folders)s folder will be unshared","%(num_folders)s folders will be unshared",e.size).format({num_folders:e.size});M.success(r)}n.props.sharingPaywallInfo&&n.props.sharingPaywallInfo.grandfatherModal&&n.props.sharingPaywallInfo.grandfatherModal.show&&n.props.actionHandler.paywallGrandfatherModalDismiss(),n.props.actionHandler.openShareModal()};p.Modal.showInstance(s.createElement(i.ManageSharedFoldersModal,{maxOwned:n.props.sharingPaywallInfo.maxOwned,numOwned:n.props.sharingPaywallInfo.numOwned,user:n.props.user,onUnshare:e}))},n.handleUpgradeClick=function(){return n.props.actionHandler.redirectToUpgrade()},n.handleSettingsClick=function(){n.props.contentInfo.isFolder()?n.handleFolderSettingsClick():n.handleFileSettingsClick()},n.handleSetConfidentialClick=function(){var e=function(e){e&&(n.props.actionHandler.handleGetMetadataSuccess(e),n.props.actionHandler.listMembers(e.shared_folder_id)),n.props.actionHandler.openShareModal()};w.GoldenGate.hasNewInheritedMembersUI(n.props.user.id)?p.Modal.showInstance(s.createElement(S.SetNewInheritedMembersUIConfidentialModal,{actionHandler:n.props.actionHandler,initialIsConfidentialFolder:n.props.isConfidentialFolder,contentInfo:n.props.contentInfo,teamName:n.props.ownerTeam.name,onCancel:e,onUpdateConfidentiality:e})):p.Modal.showInstance(s.createElement(y.SetConfidentialModal,{client:n.client,folderId:n.props.contentInfo.isSharedFolder()?n.props.contentInfo.sharedFolderId().toString():void 0,folderName:n.props.contentInfo.name(),folderPath:n.props.contentInfo.displayPath(),initialIsConfidentialFolder:n.props.isConfidentialFolder,onCancel:e.bind(n,null),onUpdateConfidentiality:e}))},n.client=n.props.client,n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e)},t.prototype.render=function(){var e=this,t=d.is_pass_ga_receive_enabled(this.props.user)&&u.getPassPermissions(this.props.contentInfo.id)&&u.getPassPermissions(this.props.contentInfo.id).canReadPresence,r={headerId:"unified-share-modal-title",areCheckboxSettingsLoaded:this.props.areSharingPrefsLoaded,isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:d.is_pass_enabled(this.props.user)||t,isInContentManager:this.props.isInContentManager,onSettingsClick:this.handleSettingsClick,onLinkViewersClick:this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length?this.handleLinkViewersClick:void 0,onSetConfidentialClick:this.handleSetConfidentialClick,mode:this.props.uiMode,ref:"content",showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:this.showFileSettings(),sharingPaywallInfo:{foldersToUnshare:this.props.sharingPaywallInfo.foldersToUnshare,isFolderOwner:this.props.isOwner,isInExperiment:this.props.sharingPaywallInfo.isInExperiment,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:function(){return e.props.actionHandler.paywallGrandfatherModalLearnMore()},onManageSharedFoldersClick:this.handleManageSharedFoldersClick,onUpgradeClick:this.handleUpgradeClick},suppressLinkUI:this.shouldSuppressLinkUI()};return r=n.__assign({},this.props,r),this.shouldShowGrandfatherModal()?this.renderSharingPaywallGrandfatherModal():s.createElement(p.Modal,{style:"bare",acceptButtonText:null,dismissButtonText:null,headerId:"unified-share-modal-title",ref:"modal"},T(E.ShareModalContent,r))},t.prototype.shouldSuppressLinkUI=function(){return this.props.isInContentManager&&!h.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.shouldShowGrandfatherModal=function(){return this.props.sharingPaywallInfo&&this.props.sharingPaywallInfo.grandfatherModal&&this.props.sharingPaywallInfo.grandfatherModal.show&&this.props.isOwner&&this.props.sharingPaywallInfo.isInExperiment&&this.props.contentInfo&&this.props.contentInfo.isFolder()},t.prototype.renderSharingPaywallGrandfatherModal=function(){var e=this,t=function(){e.props.actionHandler.paywallGrandfatherModalDismiss()};return s.createElement(l.SharingPaywallInfoModal,{actionHandler:this.props.actionHandler,onDismiss:t,onManage:this.handleManageSharedFoldersClick,sharedFolderCount:this.props.sharingPaywallInfo.numOwned,grandfather:!this.props.sharingPaywallInfo.grandfatherModal.learnMore})},t.prototype.showFileSettings=function(){return w.showFileSettings(this.props.user,this.props.contentInfo.id)},t.prototype.refreshSharedWithColumnLinkData=function(){o.dispatch({type:c.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.contentInfo.displayPath()]}})},t.prototype.handleFolderPolicySuccess=function(e,t){o.dispatch({type:v.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,metadata:t,folderPolicy:e})},t.prototype.getTokenizer=function(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer},t.prototype.handleFileSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?_.getCombinedPolicy(this.props.filePolicy,this.props.linkMetadata):this.props.filePolicy,n=function(n){null!=n&&e.props.actionHandler.handleUpdateFilePolicy(n,t),e.props.actionHandler.openShareModal()};p.Modal.showInstance(s.createElement(f.FileSettingsModal,{fileName:this.props.contentInfo.name(),contentId:this.props.contentInfo.id,canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,initialPolicy:t,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,user:this.props.user})),w.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FILE_SETTINGS_MODAL")},t.prototype.handleFolderSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?_.getCombinedPolicy(this.props.folderPolicy,this.props.linkMetadata):this.props.folderPolicy,n=function(t,n){null!=n&&(e.props.actionHandler.handleUpdateSharingSettings(n),e.handleFolderPolicySuccess(t,n),e.props.onSuccessSharing&&e.props.onSuccessSharing(),n.policy.shared_link_policy!==e.props.folderPolicy.shared_link_policy&&(e.props.actionHandler.fetchLinkMetadata(),e.refreshSharedWithColumnLinkData())),e.props.actionHandler.openShareModal()},r=null,o=null;this.props.contentInfo.extras&&this.props.contentInfo.extras.nsId&&(r=this.props.contentInfo.extras.nsId,o=this.props.contentInfo.extras.nsPath),p.Modal.showInstance(s.createElement(g.SharedFolderSettingsModal,{actionHandler:this.props.actionHandler,folderName:this.props.contentInfo.name(),folderId:this.props.metadata.shared_folder_id,folderPath:this.props.contentInfo.displayPath(),nsId:r,nsPath:o,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.props.hasParentSharedFolder,initialHasParentSharedFolder:this.props.hasParentSharedFolder,initialMetadata:this.props.metadata,initialOwnerTeam:this.props.ownerTeam,initialPermissions:this.props.permissions,initialPolicy:t,isInContentManager:this.props.isInContentManager,isSharedFolder:this.props.contentInfo.isSharedFolder(),initialIsTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isLimitedTeam:this.props.viewer.team_is_limited,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,showContentManagerBridge:this.shouldRenderContentManagerBridge(!0),teamPolicy:this.props.teamPolicy,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user}))},t.prototype.shouldRenderContentManagerBridge=function(e){return void 0===e&&(e=!1),!this.props.isInContentManager&&(!!w.GoldenGate.hasContentManagerAndSuperAdmin(this.props.user.id)&&(!!this.props.isTeamSharedFolder||!(!this.props.isFolderInsideTeamFolderTree||!this.props.isUserOnOwnerTeam)&&(e||!this.props.canInviteEditor)))},t})(s.Component);O.displayName="ShareModal",O.defaultProps={viewer:C.get_viewer()},t.ShareModal=a.listenToStores(O,{sharingInfoStore:b.sharingInfoStore,passStore:u},L)}),function(){define("modules/clean/sharing/share_modal_util",["external/react","external/underscore","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_folder_settings_modal","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/uri"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E){var I,C,N,M,P,T,k,A,x,F,L,O,D,R,U,B,q,H,V,G,W,Y,K,z;return M=n.EmailVerification,C=s.Contact,k=l.FileTypes,I=d.BrowseContext,P=d.File,c.Modal,F=m.ShareModalActionHandler,L=h.SharingApi,T=_.FileShareApiClient,A=_.FolderShareApiClient,N=f.ContentInfo,H=g.makePublicFolderLink,Y=g.showPublicFolderLinkModal,x=y.ShareModal,R=b.getNewFolderPathFromContentName,q=b.logTiburonEvent,e.createElement,D=function(){return Math.random()},B=function(e,n,r){var s,o,a;null==r&&(r={}),e.id||(e=S.get_viewer().get_user_by_id(e)),null==r.userHomeNs&&(r.userHomeNs=e.home_ns_id),a=U(n),t.extend(a,r),a.modalSessionId||(a.modalSessionId=D()),i.logViewShareModel({uid:e.id,modal_session_id:a.modalSessionId});try{o=N.createFromParams(a)}catch(e){o=null}return s=n instanceof I?n:a.browseContext,{browseContext:s,contentInfo:o,shareModalInfo:a,user:e}},K=function(e,t,n){var s,o,a,i,l,d,c,p,u,m,h,_;return null==n&&(n={}),m=B(e,t,n),o=m.browseContext,i=m.contentInfo,_=m.shareModalInfo,e=m.user,null!=i&&(q(i,e.id,"BEGIN_SHARE_FLOW"),!!V(e,_,o)||(!_.skipPublicFolderCheck&&i&&o&&(p=H(e.id,o.config,i.displayPath(),i.isFolder()))?(Y(p),!0):(c=(null!=o?o.isNonUserRelativeContext:void 0)||_.isNonUserRelativeContext,u=void 0,"PREVIEW_PAGE"===_.origin&&(u=r.SHARE_FILEVIEWER),c||M.get_for_user(e).verified_or_show(u)?(h=i.isFolder()?A:T,a=new h({userId:e.id,isNonUserRelativeContext:c}),s=new F(a,e,x),l=_.inLinksPage,d=_.prefillContacts,s.initializeShareModal({contentInfo:i,initialRecipientTokens:d,inLinksPage:l},{client:a,user:e,onDeleteLink:_.onDeleteLink,teamGroupInfo:i.teamGroupInfo(),isInContentManager:c,onSuccessSharing:_.onSuccessSharing,shareAsConfidential:_.shareAsConfidential,initialContentName:_.initialContentName}),s.openShareModal()):q(i,e.id,"SHARE_MODAL_EMAIL_UNVERIFIED"),!0)))},V=function(e,t,n){var r;if(t.isTeamSharedFolder&&S.get_viewer().team_is_limited)return!e.is_team_admin||"BROWSE_SHARED_FOLDER_BANNER"!==(r=t.origin)&&"BROWSE_GLOBAL_ACTIONS"!==r?u.showModalInstance({fqPath:t.fqPath}):p.showWithProps({folderId:t.targetNsId.toString(),folderName:n.getNameOfTargetFolder(),user:e}),!0},U=function(e){var t,n;return e instanceof P?(t=(n=e.type)===k.FILE||n===k.PACKAGE,{beaconContext:e.beacon_context,exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===k.TEAM_SHARED_FOLDER,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}):e instanceof I?O(e):e},O=function(e){return e.isInsideDeletedFolder||e.isInsideDeletedSharedFolder?null:e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}},G=function(e,t,n,r,s,o){var a;return null==t&&(t=null),null==n&&(n=null),null==r&&(r=null),null==s&&(s=!1),null==o&&(o=!1),t||(t=D()),a=function(){var e,t,r;for(e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=1;t<=100;++t)e+=r.charAt(Math.floor(Math.random()*r.length));return R(e,n)},K(e,{fqPath:a(),isFolder:!0,exists:!1,origin:"WIZARD",modalSessionId:t,initialContentName:r,shareAsConfidential:s,isNonUserRelativeContext:o})},z=function(e,t){var n,r;return n=new L(e),r=function(e){var n;return n=JSON.parse(e.responseText),v.showSharedContentSyncModal(n,t)},n.get_sync_vars_for_ns_id(t.ns_id,t.ns_path,r)},W=function(e){var t,n,r,s,a;return a=e.user,s=e.sharePrefillEmail,t=e.content,s?(n="GRANT_ACCESS",r=[new C({type:o.EMAIL,email:s})]):(n="DESKTOP_CLIENT",r=[]),K(a,t,{origin:n,prefillContacts:r})},{generateModalSessionId:D,getShareModalInfo:U,getSharingInfo:B,showFastrakShareModalIfAllowed:V,showNewFolderShareModal:G,showSharedContentLinkSyncModal:z,showShareModal:K,showPrefilledShareModal:W}})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_modal",["external/classnames","external/react","modules/clean/ajax","modules/clean/avatar/triple_avatars","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/faceholder","modules/clean/avatar/size","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/loggers/growth_features_events_logger","modules/clean/react/button","modules/clean/react/browse/models","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/teams","modules/constants/python","modules/constants/payments","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","require"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M,P,T,k){var A,x,F,L,O,D,R,U,B,q,H
;return O=r.TripleAvatars,L=s.ShareTibEventLogger,A=i.AVATAR_DIMENSION_BY_SIZE,R=u.button,x=m.File,F=_.Modal,q=g.reactFormat,H=b.static_url,I.TRADEMARK_BUSINESS,D=M.i18n_default_project("sharing")._,B=t.DOM,U=t.createElement,t.createClass({statics:{showInstance:function(e){return F.showInstance(e)}},displayName:"SharedContentLinkSyncModal",ASK:"ask",ASKING:"asking",propTypes:{accessLevel:t.PropTypes.string.isRequired,folderName:t.PropTypes.string.isRequired,folderSize:t.PropTypes.string.isRequired,onMountSharedFolder:t.PropTypes.func.isRequired,canRequestToJoin:t.PropTypes.bool,magnetControlLogging:t.PropTypes.bool,previewCallback:t.PropTypes.func,previewUrl:t.PropTypes.string,outOfQuotaQP:t.PropTypes.string,ownerName:t.PropTypes.string,senderName:t.PropTypes.string,usageRemaining:t.PropTypes.string,usageNeeded:t.PropTypes.string,targetFile:t.PropTypes.instanceOf(x),syncNSId:t.PropTypes.string,expProSharingOverquotaModal:t.PropTypes.string,ownerProfilePhotoUrl:t.PropTypes.string},getDefaultProps:function(){return{canRequestToJoin:!1,magnetControlLogging:!1}},getInitialState:function(){return{state:this.ASK,ownerTeam:null}},componentWillMount:function(){var e,t,n,r;return r=S.start_time(),e=(new Date).getTime(),this.user=w.get_viewer().get_users()[0],this.userId=this.user.id,n=y.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,t=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER",L.log(this.userId,t,n,{timing:e-r,ns_id:this.props.syncNSId})},_closeSyncModal:function(){var e,t,n;return this.props.outOfQuotaQP&&(this.props.canRequestToJoin?(e={is_limited:null!=(t=this.state.ownerTeam)?t.is_limited:void 0,ns_id:this.props.syncNSId,requested_team_id:null!=(n=this.state.ownerTeam)?n.id:void 0},p.logMagnetEvent("request_modal_OQ_dismissed",e)):this.props.magnetControlLogging&&(e={ns_id:this.props.syncNSId},p.logMagnetEvent("modal_OQ_dismissed"))),c.remove_query_param("sm"),this.refs.modal.close()},_renderTopPanelIcon:function(){return this.props.targetFile?U(f,{alt:"",group:"web",name:this.props.targetFile.icon}):U(f,{alt:"",group:"web",name:"folder_user_32"})},_renderTopPanelTitle:function(){return this.props.targetFile?l.em_snippet(d.filename(this.props.targetFile.fq_path,15)):l.em_snippet(this.props.folderName,15)},_renderTopPanelSubtitle:function(){return this.props.targetFile?null!=this.props.ownerName?D("Owned by %(name)s").format({name:this.props.ownerName}):D("Not currently owned"):this.props.folderSize},_renderAccessText:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?B.div({},B.div({className:"content-link-sync-modal__access-text u-mar-top-m"},U(O,{contacts:this.state.ownerTeam.contacts,count:this.state.ownerTeam.count})),B.div({className:"content-link-sync-modal__access-text"},D("Your Dropbox is full—join the %(team_name)s Dropbox?").format({team_name:this.state.ownerTeam.name}))):B.div({}):B.div({className:"content-link-sync-modal__access-text"},D("Not enough space")):B.div({className:"content-link-sync-modal__access-text"},null!=this.props.senderName?"can_view"===this.props.accessLevel?D("%(name)s gave you access to view this folder").format({name:this.props.senderName}):D("%(name)s gave you access to edit this folder").format({name:this.props.senderName}):D("can_view"===this.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},_renderSharedFolderInfo:function(){var e;return B.div({className:"content-link-sync-modal__shared-folder-info"},B.div({className:"content-link-sync-modal__shared-folder-text"},D((null!=(e=this.props.targetFile)?e.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),B.div({},U(f,{alt:"",group:"web",name:"folder_user_32"})),B.p({className:"u-font-meta"},this.props.folderName,B.br({}),this.props.folderSize))},_renderTipBody:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?this.state.ownerTeam.contacts.length>0?D("Join %(name)s and your coworkers and get more space to work together.").format({name:this.state.ownerTeam.contacts[0].display_name}):void 0:B.img({className:"content-link-sync-modal__loader",src:H("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:D("Loading")}):this.props.usageRemaining?D("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):D("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:this.props.usageNeeded}):this.state.state===this.ASKING?B.img({src:H("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:D("Loading")}):D("can_view"===this.props.accessLevel?this.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":this.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},_renderPreviewLink:function(){if("can_view"===this.props.accessLevel)return B.div({},B.span({className:"content-link-sync-modal__or"},D("Or")),B.button({className:"content-link-sync-modal__not-now-label button-as-link",onClick:this.onPreviewButtonClicked},D(!this.props.targetFile||this.props.targetFile.is_dir?"preview this folder":"preview this file")))},render:function(){var t,n,r,s,o;return r="V1"===(s=this.props.expProSharingOverquotaModal)||"V2"===s||"V3"===s,n=e({"content-link-sync-modal":!0,"can-request-to-join-team":this.props.canRequestToJoin,"content-link-sync-modal--pro-variant":r}),this.props.outOfQuotaQP&&r?(o=this.renderVariant(),t=this.renderButtonsVariant()):(o=this.renderControl(),t=this.renderButtons()),U(F,{autoClose:!1,buttonComponent:t,className:n,clickOutToClose:!1,ref:"modal",showX:!1,title:""},o)},renderControl:function(){return B.div({className:"content-link-sync-modal__content u-mar-bottom-xs"},B.div({className:"content-link-sync-modal__top-panel u-pad-s"},B.div({className:"content-link-sync-modal__icon"},this._renderTopPanelIcon()),B.div({className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},B.h3({className:"u-font-strong"},this._renderTopPanelTitle()),B.h4({className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),B.div({className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},U(v,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)}))),B.div({className:"content-link-sync-modal__tip-panel"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessText(),B.div({className:"content-link-sync-modal__tip-body"},this._renderTipBody())))},renderVariant:function(){var e,t,n;return n=this.props.usageRemaining>0?q(D("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have <span>%(remaining)s</span> of space left."),{strong:B.strong(),span:B.span({className:"content-link-sync-modal__alert"}),remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):q(D("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have no space left."),{strong:B.strong(),needed:this.props.usageNeeded}),t=null!=this.props.ownerName,B.div({className:"content-link-sync-modal--pro-variant__content u-mar-bottom-xs"},B.div({className:"content-link-sync-modal--pro-variant__close u-pad-xs u-font-right"},U(v,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)})),B.div({className:"content-link-sync-modal--pro-variant__container"},B.div({className:"content-link-sync-modal--pro-variant__left-container"},"V1"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):"V2"===this.props.expProSharingOverquotaModal?B.div({className:"content-link-sync-modal--pro-variant__folder-container"},U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}),t?B.div({className:"avatar-img"},U(o,{dimension:A.MEDIUM,photoUrl:this.props.ownerProfilePhotoUrl,shape:"CIRCLE",defaultAvatar:U(a,{dimension:A.MEDIUM})})):void 0):"V3"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")}):"V4"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):void 0,B.div({className:"content-link-sync-modal--pro-variant__content"},B.div({className:"content-link-sync-modal--pro-variant__folder-name"},l.em_snippet(this.props.folderName,y.OUT_OF_QUOTA_FOLDER_NAME)),"V1"!==(e=this.props.expProSharingOverquotaModal)&&"V2"!==e&&"V3"!==e||!t?void 0:B.div({className:"content-link-sync-modal--pro-variant__owner-name"},l.em_snippet(this.props.ownerName,y.DISPLAY_NAME)))),B.div({className:"content-link-sync-modal--pro-variant__right-container"},B.div({className:"content-link-sync-modal--pro-variant__tip-title"},D("Not enough space")),B.div({className:"content-link-sync-modal--pro-variant__tip-body"},n))))},renderButtons:function(){return this.props.canRequestToJoin&&this.props.outOfQuotaQP?this.state.ownerTeam?B.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},this.props.outOfQuotaQP?B.div({},this.state.ownerTeam.is_limited?void 0:U(R,{importance:"primary",className:"content-link-sync-modal__request-to-join-button",disabled:this.state.state===this.ASKING,onClick:this.onRequestButtonClicked},D("Request to join")),U(R,{importance:this.state.ownerTeam.is_limited?"primary":"tertiary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},D("Upgrade to add folder")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0):void 0):B.div({}):B.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},U(R,{importance:"primary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},D(this.props.outOfQuotaQP?"Upgrade to add folder":this.props.targetFile?this.user.is_cdm_member?"Add folder to member folder":"Add folder to Dropbox":this.user.is_cdm_member?"Add to member folder":"Add to Dropbox")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0)},renderButtonsVariant:function(){return B.div({className:"content-link-sync-modal--pro-variant__buttons"},U(R,{importance:"primary",className:"content-link-sync-modal--pro-variant__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onUpgradeButtonClicked},D("Upgrade to add folder")))},requestCallback:function(){var e,t,n,r;return this.props.outOfQuotaQP?(this.props.canRequestToJoin?(e={is_limited:null!=(n=this.state.ownerTeam)?n.is_limited:void 0,ns_id:this.props.syncNSId,requested_team_id:null!=(r=this.state.ownerTeam)?r.id:void 0},p.logMagnetEvent("request_modal_OQ_click_upgrade",e)):this.props.magnetControlLogging&&(e={ns_id:this.props.syncNSId},p.logMagnetEvent("modal_OQ_CTA_click",e)),t=C.BUY_URL,N.redirect(T({path:t}).updateQuery({oqa:this.props.outOfQuotaQP}))):(this.props.targetFile&&L.log(this.userId,"UNMOUNTED_SEARCH_SYNC","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.onMountSharedFolder())},onSyncButtonClicked:function(){return this.setState({state:this.ASKING}),this.props.canRequestToJoin&&!this.props.outOfQuotaQP?this.activateRequestModal():this.requestCallback()},onPreviewButtonClicked:function(){var e;return null!=this.props.previewCallback?(L.log(this.userId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.previewCallback()):(e=null!=this.props.previewUrl?T.parse(this.props.previewUrl):N.get_uri().removeQuery("sm"),e.updateQuery({from_sync_modal:!0}),N.redirect(e))},onRequestButtonClicked:function(){var e,t,n,r,s;return this.setState({state:this.ASKING}),k(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){return t.sendTeamRequest(e.state.ownerTeam.id,function(){return F.close()})}})(this)),t=(null!=(n=w.get_viewer().personal_user)?n.paid:void 0)?"plus":"basic",e={folder_size:this.props.usageNeeded,is_limited:null!=(r=this.state.ownerTeam)?r.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:null!=(s=this.state.ownerTeam)?s.id:void 0},p.logMagnetEvent("request_modal_OQ_CTA_click",e)},activateRequestModal:function(){if(this.props.canRequestToJoin)return k(["modules/clean/teams/membership_request_modal"],(function(e){return function(t){var n;return n=t.MembershipRequestModal,F.showInstance(U(n,{folderName:l.em_snippet(e.props.folderName,15),nsId:e.props.syncNSId,overQuotaQP:null!=e.props.outOfQuotaQP,quotaNeeded:e.props.usageNeeded,quotaRemaining:e.props.usageRemaining,requestCallback:e.requestCallback,senderName:e.props.senderName,team:e.state.ownerTeam}))}})(this))},componentDidMount:function(){var e,t,n,r,s;if(t=(null!=(n=w.get_viewer().personal_user)?n.paid:void 0)?"plus":"basic",this.props.canRequestToJoin&&(k(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){var n;return n=t.getDiscoverableTeamForFolder,e.setState({state:e.ASKING}),n(e.props.syncNSId,function(t){return e.setState({state:e.ASK,ownerTeam:t})})}})(this)),this.props.outOfQuotaQP&&(e={folder_size:this.props.usageNeeded,is_limited:null!=(r=this.state.ownerTeam)?r.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:null!=(s=this.state.ownerTeam)?s.id:void 0},p.logMagnetEvent("request_modal_OQ_open",e))),this.props.magnetControlLogging&&this.props.outOfQuotaQP)return e={folder_size:this.props.usageNeeded,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining},p.logMagnetEvent("modal_OQ_open",e)}})})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_utils",["external/react","modules/clean/ajax","modules/clean/api_v2/root_aware_client","modules/clean/browse_interface","modules/clean/multiaccount_login","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/role_selector_modal","modules/clean/sharing/shared_content_link_sync_modal","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m){var h,_,f,g,y,v,assert;return y=t.WebRequest,_=n.ApiV2RootAwareClient,f=o.FolderShareApiClient,h=a.ACCESS_LEVEL,assert=p.assert,v=u.i18n_default_project("sharing")._,g={mountSharedFolder:function(e,t,n,o,a,l){var p,u,h,_,b,w;if(null==o&&(o=!1),null==a&&(a=null),null==l&&(l=!1),t){if(!d.get_viewer().is_role_signed_in(t))return void s.show_modal({role:t,on_success:function(){return g.mountSharedFolder(e,t,n)}})}else if(d.get_viewer().is_paired)return u=function(t){return n="PREVIEW_PAGE",g.mountSharedFolder(e,t,n)},void new i(u).show();return w=d.get_viewer(),t?b=w.get_uid_by_role(t):(assert(!w.is_paired,"role can not be unspecified for paired viewer"),b=w.get_user_ids()[0]),h=v("Adding to your Dropbox..."),w.is_paired&&(w.get_user_by_id(b).is_team?(h=v("Adding to your %(team_name)s Dropbox..."),h=h.format({team_name:w.team_name})):h=v("Adding to your personal Dropbox...")),m.success(h),_=function(e){var t,n,s;return n=e,null!=a&&(n+=a.ns_path),t=d.get_viewer().get_user_by_id(b),s=r.browse_uri_for_fq_path(t,n),s.updateQuery({from_scl_sync_modal:o}),c.redirect(s)},l?y({url:"/share_action/rejoin",subject_user:b,data:{ns_id:e},success:_,error:function(){return m.error(v("We were unable to complete your request."))}}):(p=new f({userId:b}),p.mount({contentId:e,origin:n}).then(function(e){return _(e.path_lower)}).catch(function(e){return m.error(v("We were unable to complete your request."))}))},showSharedContentSyncModal:function(t,n){var r,s,o;if(null!=t?t.sync_ns_id:void 0)return s="SYNC_MODAL",o=t.sync_owner_name||t.ownerName,r=g.mountSharedFolder.bind(null,t.sync_ns_id,t.sync_role,s,!0,n),l.showInstance(e.createElement(l,{accessLevel:t.access_level,canRequestToJoin:t.can_request_to_join,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,magnetControlLogging:t.magnet_control,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,ownerName:o,targetFile:n,previewCallback:null!=n?c.redirect.bind(c,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:r,syncNSId:t.sync_ns_id,expProSharingOverquotaModal:t.expProSharingOverquotaModal,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl}))},proSharingOverquotaModalExperiment:function(e,t,n,r){var s,o;return t.expProSharingOverquotaModal=r,"V1"===r||"V2"===r||"V3"===r?(s=new f({userId:n,client:new _}),o=t.nsId||t.sync_ns_id,s.listMembers({contentId:o}).then(function(e){var n,r,s,o,a;if(r=e.users.filter(function(e){return e.access_type===h.OWNER}),1===(null!=r?r.size:void 0))return s=r.entries().next().value,s[0],n=s[1],t.ownerName=null!=n&&null!=(o=n.account)?o.display_name:void 0,t.ownerProfilePhotoUrl=null!=n&&null!=(a=n.account)?a.profile_photo_url:void 0}).finally(function(){return e(t)})):e(t)}}})}.call(this),define("modules/clean/sharing/sharing_settings_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEMBER_POLICY="member_policy",t.DOWNLOAD_POLICY="download_policy",t.PASS_POLICY="pass_policy",t.AUDIENCE_POLICY="audience",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.PASSWORD_POLICY="password",t.EXPIRY_POLICY="expiry",t.ACL_UPDATE_POLICY="acl_update_policy",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.PASSWORD_INPUT="password_input",t.EXPIRY_INPUT="expiry_input",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.LINK_SETTINGS="link_settings"}),define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,n,r,s){"use strict";function o(e){var t=e.customButton||n.createElement("button",{className:"c-btn c-btn--secondary sharing-settings-dropdown__button"},n.createElement("span",{className:"sharing-settings-dropdown__button-label"},e.optionsDict[e.currentValue].label),n.createElement(s,{alt:"",className:"u-l-fr",group:"web",name:"arrow-down-gray"})),o=e.valuesList.map(function(t){var o=n.createElement("span",null);return t===e.currentValue&&(o=n.createElement(s,{alt:"",group:"web",name:"check_gray"})),n.createElement(r.BubbleMenuItem,{checked:t===e.currentValue,key:t,onClick:function(){return e.onValueSelected(t)}},n.createElement("div",{className:"sharing-settings-dropdown-item"},n.createElement("div",{className:"sharing-settings-dropdown-item__left-margin"},o),n.createElement("div",{className:"sharing-settings-dropdown-item__label"},n.createElement("div",{className:"sharing-settings-dropdown-item__title"},e.optionsDict[t].label),n.createElement("div",{className:"sharing-settings-dropdown-item__description u-font-meta"},e.optionsDict[t].description))))});return n.createElement(r.BubbleMenu,{targetButton:t,targetFixed:!0,position:e.openUp?r.BubbleMenu.POSITIONS.TOP_ALIGN_RIGHT:r.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-settings-dropdown",items:o,shouldShowArrow:!1})}Object.defineProperty(t,"__esModule",{value:!0}),t.SettingDropdown=o}),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/previews/util","modules/clean/react/calendar","modules/clean/react_format","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/tabs/tab_nav","modules/clean/react/tabs/tab_util","modules/clean/sharing/components/button_group","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/ui_util","modules/core/i18n","modules/clean/sharing/api/types/metadata","modules/clean/sharing/settings_modal/views/link_settings_tab","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_util"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=S.i18n_default_project("sharing")._,T=s.createElement,k=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleTogglePasswordPolicy=function(e){n.props.onOptionChange(N.PASSWORD_POLICY,{status:e}),n.setState({passwordInputDisabled:"on"===n.props.currentPolicy.get(N.PASSWORD_POLICY).status})},n.handleChangePasswordClick=function(){n.setState({passwordInputDisabled:!1}),n.props.onOptionChange(N.PASSWORD_POLICY,{status:"on",value:""})},n.state={passwordInputDisabled:!0},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=o.extend({},this.props);return t=o.extend(t,{currentTab:this.state.currentTab,onChangePasswordClick:this.handleChangePasswordClick,onTabSelected:function(t){e.setState({currentTab:t})},onTogglePasswordPolicy:this.handleTogglePasswordPolicy,passwordInputDisabled:this.state.passwordInputDisabled}),T(x,t)},t})(s.Component);t.SharingSettingsModal=k;var A=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDefaultProps=function(){return{hasDisplayableMembers:!1,hasNonOwnerMembers:!1}},t.prototype.componentDidUpdate=function(e){!this.props.passwordInputDisabled&&e.passwordInputDisabled&&this.refs.passwordInputRef&&this.refs.passwordInputRef.focus()},t.prototype.render=function(){var e;return e=this.props.isLoading?s.createElement("div",{className:"sharing-settings-modal__loading-text"},P("Loading...")):s.createElement("div",{className:"sharing-settings-modal"},this.renderHeader(),this.renderTabs(),this.renderTabContent(),s.createElement("div",{className:"sharing-settings-modal__footer"},this.renderButtons())),s.createElement(m.Modal,{altAction:this.props.altAction,style:"bare"},e)},t.prototype.renderHeader=function(){var e,t={folder_name:i.em_snippet(this.props.folderName,v.SNIPPET_SIZES.FILENAME)};return e=P("Sharing settings for “%(folder_name)s”").format(t),s.createElement("div",{className:"sharing-settings-modal__header"},s.createElement("div",{className:"sharing-settings-modal__title-row"},s.createElement("div",{className:"u-l-fr"},s.createElement(y,{onClick:function(){return m.Modal.close()}})),s.createElement("div",{className:"u-l-b"},e)))},t.prototype.renderTabs=function(){return s.createElement(_,{tabs:this.getTabs(),onChange:this.props.onTabSelected,defaultSelectedIndex:0,variant:f.variants.UNDERLINE})},t.prototype.getTabs=function(){var e=this,t={value:N.FILE_SETTINGS,label:P("File settings")},n={value:N.FOLDER_SETTINGS,label:P("Folder settings")},r={value:N.LINK_SETTINGS,label:P("Link settings")},s=this.props.isFolder?[n]:[t];return!this.props.isTeamSharedFolder&&this.props.linkMetadata&&s.push(r),s.filter(function(t){return e.getTabInfo(t.value).policies.length>0})},t.prototype.getCurrentTab=function(){return this.props.currentTab||this.getTabs()[0].value},t.prototype.renderTabContent=function(){var e=this,t=this.getTabInfo(this.getCurrentTab());return s.createElement("div",null,t.banner,s.createElement("div",{className:"sharing-settings-modal__tab-content"},s.createElement("div",{className:"tab-content-header"},s.createElement("div",{className:"tab-content-header__title"},t.title),s.createElement("div",{className:"tab-content-header__description u-font-meta"},t.description)),s.createElement("div",null,t.policies.map(function(t){var n=e.getPolicyDict(t);return e.renderPolicy(t,n)}))))},t.prototype.getFolderSettingsBanner=function(){if(!this.props.shouldHideHeader&&this.props.isFolder){var e,t=P("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName});if(this.props.isInContentManager)e=t;else if(this.props.showContentManagerBridge){var n=l.parent_dir(this.props.folderPath),r=w.genContentManagerBridgeUri({containingFolder:n,isLimitedTeam:this.props.isLimitedTeam,filenameToSelect:this.props.folderName});e=s.createElement("div",null,t,s.createElement("div",null,P("You can change these settings in the Admin Console.")+" ",s.createElement("a",{href:r.toString(),target:"_blank"},P("Open in new tab."))))}else if(this.isTeamFolderTree())e=s.createElement("div",null,t,s.createElement("div",null,s.createElement("a",{href:"/team",target:"_blank"},P("To edit, ask your admin."))));else{if(this.props.permissions.change_options.allow)return;e=P("You don’t have permission to change the settings on this folder.")}return s.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},e)}},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getMemberPolicyQuestion=function(){return P(this.isTeamFolderTree()?"Who can be added to folders?":"Who can be invited to this folder?")},t.prototype.getAclUpdatePolicyQuestion=function(){return P(this.isTeamFolderTree()?"Who can invite new members and create a link to folders?":"Who can invite new members and create a link to this folder?")},t.prototype.getDownloadsPolicyDescription=function(){return P(this.isTeamFolderTree()?"Lets people download the folders. People with edit access can always download.":this.props.isFolder?"Lets people download this folder. People with edit access can always download.":"Lets people download this file. People with edit access can always download.")},t.prototype.getPassPolicyDescription=function(){if(d.is_pass_enabled(this.props.user)||!this.props.ownerTeam)return P(this.props.isFolder?"Shows who viewed the files.":"Shows who viewed the file.");var e=void 0;return e=P(this.props.isFolder?"Shows who viewed the files. Only members of %(team_name)s and people who can edit can see this info.":"Shows who viewed the file. Only members of %(team_name)s and people who can edit can see this info."),e.format({team_name:this.props.ownerTeam.name})},t.prototype.getFolderSettingPolicies=function(){var e=[];return Boolean(this.props.ownerTeam)&&(e.push(N.FOLDER_LINK_AUDIENCE_POLICY),e.push(N.MEMBER_POLICY)),e.push(N.ACL_UPDATE_POLICY),this.canChangePolicy(N.DOWNLOAD_POLICY)&&e.push(N.DOWNLOAD_POLICY),v.PASS_CONTROL_AVAILABILITY.SHOW_FOLDER_SETTINGS&&e.push(N.PASS_POLICY),e},t.prototype.getFileSettingPolicies=function(){var e=[];this.canChangePolicy(N.DOWNLOAD_POLICY)&&e.push(N.DOWNLOAD_POLICY);var t=h.getPassPermissions(this.props.contentId),n=d.is_pass_ga_receive_enabled(this.props.user)&&null!=t&&h.getPassPermissions(this.props.contentId).canReadPresence;return(d.is_pass_enabled(this.props.user)||n)&&e.push(N.PASS_POLICY),e},t.prototype.canChangePolicy=function(e){return this.props.getEffectivePolicyValue(e,this.props.policyUpdate)[1]},t.prototype.getMemberPolicyTeamLabel=function(){return P("Only members of %(team_name)s").format({team_name:i.em_snippet(this.props.ownerTeam.name,5,1)})},t.prototype.getAclUpdatePolicyEditorsLabel=function(){return this.props.ownerTeam?P("Members on %(team_name)s with edit access").format({team_name:i.em_snippet(this.props.ownerTeam.name,12)}):P("Members with edit access")},t.prototype.getAclUpdatePolicyEditorsDescription=function(){return this.props.ownerTeam?P("Any member of %(team_name)s with edit access to this folder.").format({team_name:i.em_snippet(this.props.ownerTeam.name,12)}):P("Anyone with edit access to this folder.")},t.prototype.getPolicyDict=function(e){var t=this;switch(e){case N.MEMBER_POLICY:return{title:P("Membership"),description:this.getMemberPolicyQuestion(),optionsDict:{team:{label:this.getMemberPolicyTeamLabel()},anyone:{label:P("Anyone")}},optionsList:["anyone","team"],type:N.DROPDOWN};case N.ACL_UPDATE_POLICY:return{title:P("Management"),description:this.getAclUpdatePolicyQuestion(),optionsDict:{owner:{label:P(this.isTeamFolderTree()?"Only Team Admins":"Only the owner"),description:P(this.isTeamFolderTree()?"Only Team Admins.":"Only the owner of this folder.")},editors:{label:this.getAclUpdatePolicyEditorsLabel(),description:this.getAclUpdatePolicyEditorsDescription()}},optionsList:["editors","owner"],type:N.DROPDOWN};case N.DOWNLOAD_POLICY:return{title:P("Downloads"),description:this.getDownloadsPolicyDescription(),optionsDict:{allow:{label:P("On")},disallow:{label:P("Off")}},optionsList:["allow","disallow"],type:N.TOGGLE};case N.PASS_POLICY:return{title:P("Viewer info"),description:this.getPassPolicyDescription(),optionsDict:{enabled:{label:P("On")},disabled:{label:P("Off")}},optionsList:["enabled","disabled"],type:N.TOGGLE};case N.AUDIENCE_POLICY:return{title:P("Link access"),description:P("Who can open the shared link?"),optionsDict:M.getAudienceOptionsDict(this.props.isFolder,this.props.ownerTeam&&this.props.ownerTeam.name,this.props.hasNonOwnerMembers,this.props.hasDisplayableMembers),optionsList:this.props.linkMetadata.audience_options.valueSeq().toArray(),type:N.DROPDOWN,extras:function(e){return t.renderAudiencePolicyExtras(e)}};case N.ACCESS_LEVEL_POLICY:return{title:P("Link permission"),description:P("What can users with links do?"),optionsDict:{viewer:{label:P("Can comment"),description:P("Lets them view and comment, but not edit.")},viewer_no_comment:{label:P("Can view"),description:P("Lets them view only. They can’t see comments.")}},optionsList:["viewer","viewer_no_comment"],type:N.DROPDOWN};case N.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:P("Link restrictions"),description:P("Limits who can access this folder via a link."),optionsDict:{anyone:{label:P("No restrictions"),description:P("Show all access options for links.")},team:{label:P("Team and invite-only"),description:P("Show “Only people at %(team_name)s” and “Only                               invited members.”").format({team_name:i.em_snippet(this.props.ownerTeam.name,12)})},members:{label:P("Invite-only"),description:P("Show “Only invited members” only.")}},optionsList:["anyone","team","members"],type:N.DROPDOWN};case N.PASSWORD_POLICY:return{title:P("Password protection"),description:P("Add a password to the shared link"),optionsDict:{on:{label:P("On")},off:{label:P("Off")}},optionsList:["on","off"],type:N.PASSWORD_INPUT};case N.EXPIRY_POLICY:return{title:P("Expiration"),description:P("Disables the shared link on a specific date"),optionsDict:{on:{label:P("On")},off:{label:P("Off")}},optionsList:["on","off"],type:N.EXPIRY_INPUT};default:throw new Error("Policy name not found")}},t.prototype.getFolderSettingsDescription=function(){return P(this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(N.ACL_UPDATE_POLICY)?"Only you (the owner) can change these settings":"Only the owner can change these settings")},t.prototype.getTabInfo=function(e){switch(e){case N.FILE_SETTINGS:return{title:P("File settings"),banner:void 0,description:"",policies:this.getFileSettingPolicies()};case N.FOLDER_SETTINGS:return{title:P("Folder settings"),banner:this.getFolderSettingsBanner(),description:this.getFolderSettingsDescription(),policies:this.getFolderSettingPolicies()};case N.LINK_SETTINGS:var t="owner"===this.props.currentPolicy.get(N.ACL_UPDATE_POLICY)&&this.canChangePolicy(N.AUDIENCE_POLICY);return{title:I.TabName(),banner:s.createElement(I.Banner,{linkMetadata:this.props.linkMetadata,user:this.props.user}),description:s.createElement(I.Description,{aclUpdatePolicy:this.props.currentPolicy.get(N.ACL_UPDATE_POLICY),isTeamFolderTree:this.isTeamFolderTree(),ownerTeam:this.props.ownerTeam,userIsOwner:t}),
policies:I.getPolicies(this.props.user)};default:throw new Error("tabName not found")}},t.prototype.renderPolicy=function(e,t){var n,o,a=this,i=t.title,l=t.description,d=t.optionsDict,c=t.optionsList,p=t.type,u=t.extras,m=void 0===u?null:u;f=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),n=f[0],o=f[1];var h;if(p===N.DROPDOWN)h=s.createElement(C.SettingDropdown,{currentValue:n,valuesList:c,optionsDict:d,onValueSelected:function(t){return a.props.onOptionChange(e,t)}});else if(p===N.TOGGLE)h=s.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(c,d),value:n,onSelectValue:function(t){return a.props.onOptionChange(e,t)}});else if(p===N.PASSWORD_INPUT)h=this.renderPasswordInput(e,n,d,c);else{if(p!==N.EXPIRY_INPUT)throw new Error("Selector type not found");h=this.renderExpiryInput(e,n,d,c)}var _=s.createElement("div",null);return m&&(_=m(n)),s.createElement("div",{className:r({policy:!0,"policy--no-permissions":!o})},s.createElement("div",{className:"policy__left"},s.createElement("div",{className:"policy__title"},i),s.createElement("div",{className:"policy__description u-font-meta"},l)),s.createElement("div",{className:"policy__selector"},h),s.createElement("div",{className:"policy__extras"},_));var f},t.prototype.renderAudiencePolicyExtras=function(e){var t=this.props.linkMetadata,n=s.createElement("div",null);if(t.audience_restricting_shared_folder&&t.audience_restricting_shared_folder.audience===e){var r=void 0,o=t.audience_restricting_shared_folder.name;r=1===t.audience_options.size?p.reactFormat(P("This setting is applied via a parent folder.              To change access, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:s.createElement("strong",null)}):p.reactFormat(P("This setting is limited via a parent folder.              To see more options, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:s.createElement("strong",null)}),n=s.createElement("div",{className:"policy__graybox"},r)}else this.props.isFolder&&e!==E.LinkAudience.members&&(n=s.createElement("div",{className:"policy__audience-extras"},P("Applies to all items in this folder")));return n},t.prototype.renderPasswordInput=function(e,t,n,r){var o=this,a=t,i=s.createElement("div",null);if("on"===a.status){var l=s.createElement("div",null);this.props.passwordInputDisabled&&this.props.linkMetadata.link_permissions.set_password.allow&&(l=s.createElement("button",{className:"password-input__change-button button-as-link",onClick:this.props.onChangePasswordClick},"Change")),i=s.createElement("div",{className:"password-input u-pad-top-s"},s.createElement("label",{htmlFor:"password-input"},"Password:"),s.createElement("br",null),s.createElement("input",{autoFocus:!0,className:"c-input password-input__input",disabled:this.props.passwordInputDisabled,id:"password-input",onChange:function(t){o.props.onOptionChange(e,{status:"on",value:t.target.value})},placeholder:P("Enter a new password"),ref:"passwordInputRef",type:"password",value:this.props.passwordInputDisabled?123456:a.value||""}),l)}return s.createElement("div",null,s.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(r,n),value:a.status,onSelectValue:this.props.onTogglePasswordPolicy}),i)},t.prototype.renderExpiryInput=function(e,t,n,r){var o=this,i=t,l=s.createElement("div",null),d=a.daysAfterToday(30);return"on"===i.status&&(l=s.createElement("div",{className:"u-pad-top-s"},s.createElement("div",null,P("Link deactivates on:")),s.createElement(c.Calendar,{alignAtLeft:!1,disabled:!this.props.linkMetadata.link_permissions.set_expiry.allow,firstDay:a.daysAfterToday(1),initDate:i.value?new Date(i.value):d,lastDay:a.daysAfterToday(365),onDateChange:function(t){return o.props.onOptionChange(e,{status:"on",value:t})}}))),s.createElement("div",null,s.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(r,n),value:i.status,onSelectValue:function(t){o.props.onOptionChange(e,{status:t,value:i.value||d})}}),l)},t.prototype.getButtonGroupOptions=function(e,t){return e.map(function(e){return{value:e,label:t[e].label}})},t.prototype.allowSaveSettings=function(){return!(!this.props.policyUpdate||0===o.keys(this.props.policyUpdate).length)&&!(this.props.policyUpdate.password&&"on"===this.props.policyUpdate.password.status&&!this.props.passwordInputDisabled&&(!this.props.policyUpdate.password.value||""===this.props.policyUpdate.password.value))},t.prototype.renderButtons=function(){var e;if(this.props.permissions.unshare.allow&&(this.props.isSharedFolder||!this.props.isFolder)){var t=void 0;t=P(this.props.isFolder?this.props.isFolderInsideTeamFolderTree?"Reset membership":"Unshare folder":"Unshare file"),e=s.createElement("div",{className:"u-l-fl"},s.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},t))}return s.createElement("div",{className:"clearfix sharing-settings-modal__buttons"},e,s.createElement(b.SettingsModalButtons,{disableSave:!this.allowSaveSettings(),isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss}))},t})(s.Component);t.SharingSettingsModalContentsView=A;var x=u(A,["/static/css/sharing/share_modal-vflXwiaMl.css"])}),define("modules/clean/sharing/sharing_settings_util",["require","exports","external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/sharing/sharing_settings_constants","modules/core/i18n"],function(e,t,n,r,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a.i18n_default_project("sharing")._;t.canChangePolicy=function(e,t,n,r,s,a){switch(e){case o.AUDIENCE_POLICY:return r&&r.link_permissions.change_audience.allow&&r.audience_options.size>1;case o.PASSWORD_POLICY:return r&&"members"!==n.get(o.AUDIENCE_POLICY)&&(r.link_permissions.set_password.allow||r.link_permissions.remove_password.allow&&"off"!==t.get(o.PASSWORD_POLICY).status);case o.EXPIRY_POLICY:return r&&"members"!==n.get(o.AUDIENCE_POLICY)&&(r.link_permissions.set_expiry.allow||r.link_permissions.remove_expiry.allow&&"off"!==t.get(o.EXPIRY_POLICY).status);case o.DOWNLOAD_POLICY:return!(!s||a)&&("allow"===t.get(o.DOWNLOAD_POLICY)?s.set_download_policy&&s.set_download_policy.allow:s.remove_download_policy&&s.remove_download_policy.allow);case o.PASS_POLICY:return!(!s||a)&&("enabled"===t.get(o.PASS_POLICY)?s.disable_pass&&s.disable_pass.allow:s.enable_pass&&s.enable_pass.allow);default:throw new Error("Link policy not found")}},t.isCommonSharingSettingsPolicy=function(e){return[o.AUDIENCE_POLICY,o.DOWNLOAD_POLICY,o.EXPIRY_POLICY,o.PASS_POLICY,o.PASSWORD_POLICY].indexOf(e)!==-1},t.getAudienceOptionsDict=function(e,t,o,a){var l,d,c=a&&!o;return c?(l=i("Only you"),d=i(e?"Only you can access this folder.":"Only you can access this file.")):(l=i("Invited members"),d=e?s.reactFormat(i("<strong>Most secure.</strong> Only those specifically invited can access this folder."),{strong:n.DOM.strong()}):s.reactFormat(i("<strong>Most secure.</strong> Only those specifically invited can access this file."),{strong:n.DOM.strong()})),{public:{label:i("Anyone with the link"),description:i(e?"Anyone who has the link can access this folder.":"Anyone who has the link can access this file.")},team:{label:i("Members of %(team_name)s").format({team_name:r.em_snippet(t||"",7,1)}),description:e?i("Only members of %(team_name)s and invited members can access this folder.").format({team_name:t}):i("Only members of %(team_name)s and invited members can access this file.").format({team_name:t})},members:{label:l,description:d}}}}),function(){define("modules/clean/sharing/strings",["modules/clean/sharing/constants","modules/core/i18n"],function(e,t){var n,r,s,o,a,i,l,d,c,p,u,m,h,_,f;return n=e.ACCESS_LEVEL,o=e.MEMBER_ACTION,c=t.i18n_default_project("sharing")._,p={},p[""+n.OWNER]=c("Owner"),p[""+n.WRITER]=c("Can edit"),p[""+n.READER]=c("Can view"),p[""+n.READER_NO_COMMENT]=c("View-only"),r=p,u={},u[""+n.OWNER]=c("Owner"),u[""+n.WRITER]=c("Can edit"),u[""+n.READER]=c("Can comment"),u[""+n.READER_NO_COMMENT]=c("Can view"),s=u,m={},m[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the file to their Dropbox"),m[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),m[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the files"),l=m,h={},h[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the files to their Dropbox"),h[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),h[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the file"),a=h,_={},_[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),_[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),_[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),d=_,f={},f[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),f[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),f[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),i=f,{ACCESS_NAME:r,ACCESS_NAME_NO_COMMENT:s,MEMBER_ACTION_FOLDER:l,MEMBER_ACTION_FILE:a,MEMBER_ACTION_FOLDER_NO_COMMENT:d,MEMBER_ACTION_FILE_NO_COMMENT:i}})}.call(this),function(){define("modules/clean/sharing/views/comments_help",["external/classnames","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,r,s,o,a){var i,l,d,c,p;return p=o.static_url,l=a._,d=t.createElement,c=t.DOM,i=t.createClass({displayName:"ShareModalCommentsHelp",mixins:[t.addons.PureRenderMixin],propTypes:{onClose:t.PropTypes.func.isRequired,onButtonClick:t.PropTypes.func.isRequired,isFeedbackRequest:t.PropTypes.bool},renderText:function(){return this.props.isFeedbackRequest?[c.h1({key:"heading"},l("Get feedback on your work")),c.p({key:"content"},l("This will ask recipients to leave comments on your file and post your message as a comment."))]:c.p({},l("New! You can now post your message as a comment on the file. Anyone who views this file can see this comment."))},render:function(){return c.div({className:e(["bubble-dropdown","right-bottom","u-font-center","u-pad-m","u-l-b","comments-help-dialog"])},c.div({className:"close-button u-font-right"},d(s,{onClick:this.props.onClose})),d(r,{src:p("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:p("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),this.renderText(),c.button({className:"c-btn c-btn--primary",onClick:this.props.onButtonClick},l("Try it out")),c.div({className:"bubble-arrow-border"}),c.div({className:"bubble-arrow"}))}}),i=n(i,["/static/css/legacy_packages/components-vflRbDbou.css"])})}.call(this),define("modules/clean/sharing/views/exp_share_link_upsell",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/react_format","modules/clean/static_urls","modules/constants/python","modules/constants/payments"],function(e,t,n,r,s,o,a,i,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=c.OUT_OF_SPACE_URL+"?oqa=sf_sloq";return r.createElement("div",{className:"share-link-upgrade__content"},r.createElement(o,{className:"unified-share-modal__illo",src:l.static_url("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:l.static_url("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),r.createElement("div",{className:"share-link-upgrade__footer"},r.createElement("div",{className:"share-link-upgrade__footer-content"},r.createElement("p",{className:"u-mar-top-s share-link-upgrade__copy"},i.reactFormat(a._("Get %(trademark_plus)s to add more shared content to your Dropbox."),{trademark_plus:d.TRADEMARK_PLUS})),r.createElement("a",{className:"c-btn c-btn--primary subgrowth_pro_overquota_create_shared_link",href:e},a._("Upgrade")))))},t})(r.Component);t.ExpShareLinkUpsellV1=s(p,["/static/css/sharing/exp_oq_shared_link_upsellV1-vflBUzAf2.css"]),t.ExpShareLinkUpsellV2=s(p,["/static/css/sharing/exp_oq_shared_link_upsellV2-vflI1ituq.css"])}),define("modules/clean/sharing/views/inherited_members",["require","exports","tslib","external/classnames","external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/undo","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=s.createElement,h=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={areMembersExpanded:!1},n}return n.__extends(t,e),t.prototype.onToggleShowMemberList=function(){0!==this.props.members.length&&this.setState({areMembersExpanded:!this.state.areMembersExpanded})},t.prototype.renderMembersList=function(){return this.state.areMembersExpanded?s.createElement("div",null,s.createElement("div",{className:"u-mar-top-xs u-mar-horizontal-xs u-pad-top-xs inherited-member-list__divider"}),s.createElement("div",null,s.createElement("ul",{className:"u-pad-horizontal-s u-pad-vertical-xs inherited-member-list__member"},this.props.children))):void 0},t.prototype.renderRemoveButton=function(){return this.props.canUpdateConfidentiality?s.createElement("button",{className:"inherited-member-list__remove-button button-as-link",onClick:this.props.onSetConfidentialClick},u._("Remove",{comment:"Shown on button that can be clicked to remove access to subfolder"})):void 0},t.prototype.renderTriangle=function(){var e=this;return 0===this.props.members.length?s.createElement("div",{className:"u-pad-horizontal-xs"}):s.createElement("a",{href:"#",className:"u-pad-horizontal-xxs o-flag__fix inherited-member-list__triangle",onClick:function(){return e.onToggleShowMemberList()}},m(l,{alt:u._("Toggle whether inherited members are displayed or hidden"),group:"web",name:this.state.areMembersExpanded?"triangle_open_1x":"triangle_closed_1x"}))},t.prototype.render=function(){var e,t=this,n=a.parent_dir(this.props.contentInfo.displayPath());if("/"===n)e=u._("Members of %(team_name)s shared workspace").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)});else{var i=a.filename(n);e=u._("Members of “%(folder_name)s” folder").format({folder_name:o.em_snippet(i,c.SNIPPET_SIZES.FILENAME)})}var d=this.props.members.length,p=u.ungettext("%(members_count)s member","%(members_count)s members",d).format({members_count:d}),h=r([{"u-mar-bottom-xs":!0,"inherited-member-list__outer-expanded":this.state.areMembersExpanded,"inherited-member-list__outer-closed":!this.state.areMembersExpanded}]),_=r([{"inherited-member-list__inner":!this.state.areMembersExpanded}]);return s.createElement("div",{className:h},s.createElement("div",{className:_},s.createElement("div",{className:"o-flag",onClick:function(){return t.onToggleShowMemberList()}},this.renderTriangle(),s.createElement("div",{className:"o-flag__flex u-pad-vertical-xs u-pad-right-s"},s.createElement("div",{className:"o-flag"},s.createElement("div",{className:"o-flag__fix"},m(l,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:"folder_user_32"})),s.createElement("div",{className:"o-flag__flex u-pad-left-s"},s.createElement("div",{className:"u-font-strong"},e),s.createElement("div",{className:"u-font-meta"},p)),s.createElement("div",{className:"o-flag__fix u-pad-right-xxs"},this.renderRemoveButton())))),s.createElement("div",null,this.renderMembersList())))},t})(s.Component);t.InheritedMembers=h;var _=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={isAccepting:!1},n}return n.__extends(t,e),t.prototype.renderContent=function(e,t,n){var r;return r=this.props.initialIsConfidentialFolder?e?d.reactFormat(u._("<strong>%(folder_name)s</strong> won’t be shared privately any more.\n             Everyone at %(team_name)s will have access to this folder.").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(n,15)}),{strong:s.createElement("strong",{style:{fontWeight:500}})}):d.reactFormat(u._("Everyone who can access <strong>%(parent_folder_name)s</strong> will be able to access this folder.").format({parent_folder_name:o.em_snippet(t,15)}),{strong:s.createElement("strong",{style:{fontWeight:500}})}):e?d.reactFormat(u._("Members of %(team_name)s won’t be able to access <strong>%(folder_name)s</strong>.").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(n,15)}),{strong:s.createElement("strong",{style:{fontWeight:500}})}):d.reactFormat(u._("Members of <strong>%(parent_folder_name)s</strong> folder won’t be able to access\n             <strong>%(folder_name)s</strong>.").format({parent_folder_name:o.em_snippet(t,15),folder_name:o.em_snippet(n,15)}),{strong:s.createElement("strong",{style:{fontWeight:500}})}),s.createElement("div",null,s.createElement("div",null,r),s.createElement("br",null))},t.prototype.renderButtons=function(e,t,n){var r=this,a=o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),i=e?u._("Share with %(team_name)s").format({team_name:a}):u._("Share"),l=this.props.initialIsConfidentialFolder?i:u._("Remove");return s.createElement("div",{className:"u-l-fr"},s.createElement("button",{className:"c-btn c-btn--primary",disabled:this.state.isAccepting,onClick:function(){return r.onToggleConfidentialFolder(!0,e,t,n)}},l),s.createElement("button",{className:"c-btn c-btn--secondary u-mar-left-xs",onClick:function(){return r.props.onCancel()}},u._("Cancel")))},t.prototype.onToggleConfidentialFolder=function(e,t,n,r){var s=this;e?(this.setState({isAccepting:!0}),this.props.actionHandler.handleSetConfidential(!this.props.initialIsConfidentialFolder).then(function(e){s.props.onUpdateConfidentiality(e);var a;a=s.props.initialIsConfidentialFolder?t?u._("“%(folder_name)s” shared with %(team_name)s.").format({folder_name:o.em_snippet(r,15),team_name:o.em_snippet(s.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("“%(folder_name)s” shared with members of “%(parent_folder_name)s”.").format({folder_name:o.em_snippet(r,15),parent_folder_name:o.em_snippet(n,15)}):t?u._("Members of %(team_name)s removed from “%(folder_name)s”.").format({team_name:o.em_snippet(s.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(r,15)}):u._("Members of “%(parent_folder_name)s” folder removed from “%(folder_name)s”.").format({parent_folder_name:o.em_snippet(n,15),folder_name:o.em_snippet(r,15)}),p.notifyWithUndo(a,{confidential:s.props.initialIsConfidentialFolder},function(){return s.onToggleConfidentialFolder(!1)},10,u._("Undo"))})):this.props.actionHandler.handleSetConfidential(this.props.initialIsConfidentialFolder).then(function(e){return s.props.onUpdateConfidentiality(e)})},t.prototype.render=function(){var e,t,n,r=this.props.contentInfo.displayPath(),l=a.parent_dir(r),d=a.filename(r);return"/"===l?t=!0:(t=!1,n=a.filename(l)),e=this.props.initialIsConfidentialFolder?t?u._("Share “%(folder_name)s” with everyone at %(team_name)s?").format({folder_name:o.em_snippet(d,15),team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("Share “%(folder_name)s” with everyone who can access “%(parent_folder_name)s”?").format({folder_name:o.em_snippet(d,15),parent_folder_name:o.em_snippet(n,15)}):t?u._("Remove members of %(team_name)s?").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("Remove members of “%(folder_name)s” folder?").format({folder_name:o.em_snippet(n,15)}),s.createElement(i.Modal,{autoClose:!1,buttonComponent:s.createElement("span",null),onDismissCompleted:this.props.onCancel,title:e},this.renderContent(t,n,d),this.renderButtons(t,n,d))},t})(s.Component);t.SetNewInheritedMembersUIConfidentialModal=_}),define("modules/clean/sharing/views/member_list",["require","exports","tslib","external/immutable","external/react","modules/clean/previews/util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/viewer_info","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/i18n","modules/clean/sharing/views/wrapped_group_viewers_maker"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=u.i18n_default_project("sharing")._,_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderMembersListItem=function(e){var n=e.memberKey(),r=void 0;return t.props.groupSeenStateInfo[e.memberId()]&&(r=t.renderWrappedGroupViewersElement(e)),s.createElement(l.SharingMemberListItem,{actionHandler:t.props.actionHandler,canInviteMembers:t.props.canInviteMembers,canMakeViewerNoComment:t.props.canMakeViewerNoComment,canRelinquishMembership:t.props.canRelinquishMembership,contentInfo:t.props.contentInfo,disabled:t.props.disabled,legacyGroupViewersLine:void 0,wrappedGroupViewersElement:r,isMemberActionPending:t.props.pendingMemberAction.has(n),isPresent:t.props.shouldShowPassUI&&t.isMemberCurrentlyViewing(e),key:n,member:e,user:t.props.user})},t}return n.__extends(t,e),t.prototype.render=function(){var e=c.makeMemberSortCmp(this.props.user,this.props.presentAccountIds,o.is_pass_enabled(this.props.user)||o.is_pass_ga_receive_enabled(this.props.user)),t=this.membersByInheritance(),n=t.get(!1);n&&(n=n.sort(e));var r=t.get(!0);r&&(r=r.sort(e));var a=null;a=c.GoldenGate.hasNewInheritedMembersUI(this.props.user.id)?this.renderNewInheritedUI(n,r):this.renderOldInheritedUI(n,r);var i=null;return this.props.areMembersFullyLoaded||(i=s.createElement("div",{className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},h("Loading more members..."))),s.createElement("div",{className:"sharing-member-list"},a,i)},t.prototype.renderNewInheritedUI=function(e,t){var n=null;!this.props.isConfidentialFolder&&this.props.isFolderInsideTeamFolderTree&&(n=s.createElement(i.InheritedMembers,{actionHandler:this.props.actionHandler,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,members:t?t.toArray():[],onSetConfidentialClick:this.props.onSetConfidentialClick,teamName:this.props.teamName},t?t.map(this.renderMembersListItem):null));var r=null;return e&&e.count()>0&&(r=s.createElement("div",{className:"u-pad-horizontal-s"},e.map(this.renderMembersListItem).toArray())),s.createElement("ul",{className:"o-list-ui u-trim-margin u-pad-horizontal-xs"},n,r)},t.prototype.renderOldInheritedUI=function(e,t){var n=null;e&&e.count()>0&&(n=s.createElement("ul",{className:"o-list-ui u-trim-margin u-pad-horizontal-m"},e.map(this.renderMembersListItem).toArray()));var r=null;if(t&&t.count()>0){var o=null;this.props.canUpdateConfidentiality&&(o=s.createElement("button",{className:"button-as-link u-l-fr",onClick:this.props.onSetConfidentialClick},h("Manage access")));r=[s.createElement("h5",{className:"sharing-member-list__inherited-separator u-pad-vertical-xs u-pad-horizontal-s u-font-meta u-font-strong",key:"separator"},h("Can access via parent folders"),o),s.createElement("ul",{className:"o-list-ui u-trim-margin u-pad-horizontal-m u-pad-top-xs",key:"inherited-members"},t.map(this.renderMembersListItem).toArray())]}return[n,r]},t.prototype.isMemberCurrentlyViewing=function(e){return!this.memberIsAssumed(e)&&(e instanceof a.UserMembershipInfo&&this.props.presentAccountIds&&this.props.presentAccountIds.has(e.account_id))},t.prototype.memberIsAssumed=function(e){return e instanceof a.UserMembershipInfo&&e.account_id===this.props.user.account_id&&p.get_viewer().is_assume_user_session},t.prototype.membersByInheritance=function(){var e=this,t=function(t){return e.shouldSortByInherited()&&t.is_inherited};return this.props.membership?this.props.membership.groups.valueSeq().concat(this.props.membership.invitees.valueSeq(),this.props.membership.users.valueSeq(),this.props.guestMembers).groupBy(t):this.props.guestMembers.length>0?r.List(this.props.guestMembers).groupBy(t):r.Map()},t.prototype.shouldSortByInherited=function(){return c.GoldenGate.canSetFolderConfidential(this.props.user.id)&&!!this.props.isFolderInsideTeamFolderTree},t.prototype.extractGroupSeenStateAndViewers=function(e){var t=this,n=this.props.groupSeenStateInfo[e.memberId()],r=[];return this.props.presentAccountIds&&(r=n.map(function(e){return new d.ViewerInfo(e)}).filter(function(e){return null!=e.time_last_seen||t.props.presentAccountIds.has(e.account_id)})),{singleGroupSeenStateInfo:n,viewers:r}},t.prototype.renderWrappedGroupViewersElement=function(e){var t=this.extractGroupSeenStateAndViewers(e).viewers;return t.length?m.WrappedGroupViewersMaker.make(t,this.props.presentAccountIds):{element:null,elementText:""}},t})(s.Component);_.displayName="SharingMemberList",_.defaultProps={disabled:!1,groupSeenStateInfo:{},presentAccountIds:r.Set()},t.SharingMemberList=_}),define("modules/clean/sharing/views/member_list_item",["require","exports","tslib","external/classnames","external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/sharing/views/viewer_info","modules/clean/static_urls","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=_.i18n_default_project("sharing"),y=g._,v=g.ungettext,b={FIRST_LINE:"FIRST_LINE",SECOND_LINE:"SECOND_LINE"},w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.shouldLinkToGroup=function(e){return"group"===e&&this.props.member instanceof c.GroupMembershipInfo&&(!!this.props.member.same_team&&(!!this.props.user.is_team_admin||!!this.props.member.is_member&&this.props.member.group_management_type!==c.GroupManagementType.system_managed))},t.prototype.linkToGroup=function(e,t){var n="/team#groups/%(id)s".format({id:e.group_id});return s.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"sharing-member-info__group-name-link sharing-member-info__display-name-title",title:e.group_name},t)},t.prototype.renderAvatar=function(e,t){var n,r=this.props.member.displayName()||"";this.props.member instanceof m.ViewerInfo||(n=this.props.member.initials),n=n||f.getInitials(r);var l="CIRCLE";return"group"===t&&(l="SQUARE"),s.createElement("div",{className:"o-flag__fix"},s.createElement(o,{dimension:i.AVATAR_DIMENSION_BY_SIZE.MEDIUM,photoUrl:e,shape:l,defaultAvatar:s.createElement(a,{dimension:i.AVATAR_DIMENSION_BY_SIZE.MEDIUM,shape:l,initials:n,name:r})}))},t.prototype.renderNameTitleAndText=function(e,t,n,r,o){return e?o!==b.SECOND_LINE&&this.props.member instanceof c.GroupMembershipInfo&&this.shouldLinkToGroup(t)?this.linkToGroup(this.props.member,r):s.createElement("span",{className:"sharing-member-info__display-name-title",title:n},r):null},t.prototype.renderDisabledMessage=function(e){return e?[s.createElement("span",{className:"u-font-meta dot"},"·"),s.createElement("span",{className:"u-font-danger"}," ",e)]:null},t.prototype.renderSeenState=function(e){if(e){var t=r({"u-font-meta":!0,"sharing-member-info__last-seen-text":!0,"sharing-member-info__last-seen-text--not-present":!this.props.isPresent});return[s.createElement("span",{className:"u-font-meta dot"},"·"),s.createElement("span",{className:t},e)]}return null},t.prototype.renderGroupCountMessage=function(e,t){return e===b.FIRST_LINE?[s.createElement("span",{className:"u-font-meta dot"},"·"),s.createElement("span",{className:"u-font-meta sharing-member-info__group-count-text"},t)]:null},t.prototype.renderOffTeamMessage=function(e){return e?[s.createElement("span",{className:"u-font-meta dot"},"·"),s.createElement("span",{className:"u-font-meta"},e)]:null},t.prototype.renderDisplayName=function(e,t,n,o,a){var i=this.props.member.displayName(),c="",u=null;this.props.wrappedGroupViewersElement?(c=this.props.wrappedGroupViewersElement.elementText,u=this.props.wrappedGroupViewersElement.element):this.props.isPresent?c=u=y("Currently viewing"):n&&(c=u=y("Viewed %(time_str)s").format({time_str:l.ago(n,!1)}));var m="";t&&t.disabled&&(m=y("Deleted"));var h="";m||c||!this.props.user.is_team||this.props.member.same_team||(h=y("Outside of your Dropbox team"));var _=0,f=0,g=0,v=0;if(i){c&&(_=new d("  ·  %s".format(c)).length),m&&(f=new d("  ·  %s".format(m)).length),a===b.FIRST_LINE&&(g=new d("  ·  %s".format(o)).length),h&&(v=new d("  ·  %s".format(h)).length);var w=p.SNIPPET_SIZES.DISPLAY_NAME-_-f-g-v,S=d.em_snippet(i,w),E="";S!==i&&(E=i);var I=r({"u-font-meta":this.props.isMemberActionPending,"u-font-strong":!0,"u-ellip":!0,"sharing-member-info__display-name":!0});return s.createElement("div",{className:I},this.renderNameTitleAndText(i,e,E,S,a),this.renderDisabledMessage(m),this.renderSeenState(u),this.renderGroupCountMessage(a,o),this.renderOffTeamMessage(h))}},t.prototype.renderMemberDetails=function(e,t,n,r){var o;return"group"===e?this.props.legacyGroupViewersLine?o=this.props.legacyGroupViewersLine:n===b.SECOND_LINE&&(o=this.props.member instanceof c.GroupMembershipInfo&&this.shouldLinkToGroup(e)?this.linkToGroup(this.props.member,t):t):r&&r.email&&r.email_verified&&(o=d.em_snippet(r.email,p.SNIPPET_SIZES.EMAIL)),s.createElement("div",{className:"u-font-meta u-ellip sharing-member-info__details"},o)},t.prototype.renderSharingBubbleMenu=function(){var e,t=this;if(this.props.isMemberActionPending)e=s.createElement("img",{src:h.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:y("Changing access")});else if(this.props.isViewOnly||this.props.member instanceof m.ViewerInfo)e=s.createElement("span",null);else{var n=this.props.member.permissions.get("make_viewer_no_comment"),r=n&&n.allow&&this.props.canMakeViewerNoComment,o=this.props.member.permissions.set("make_viewer_no_comment",new c.PermissionSetting({allow:r})),a=this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership,i=function(e){if(!(t.props.member instanceof m.ViewerInfo))return t.props.actionHandler&&t.props.actionHandler.handleMemberAccessChange(t.props.member,e)};e=s.createElement(u.SharingBubbleMenu,{allowRelinquishMembership:a,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:r,contentInfo:this.props.contentInfo,currentAccess:this.props.member.access_type,disabled:this.props.disabled,isInherited:this.props.member.is_inherited,memberPermissions:o,onAccessChange:i,pendingAccessChange:this.props.pendingAccessChange})}return s.createElement("div",{className:"o-flag__fix"},e)},t.prototype.render=function(){var e,t=null,n="invitee",o=null;if(this.props.member instanceof c.UserMembershipInfo){if(t=this.props.member.account,n="user",!t)return null;o=t.profile_photo_url||null,e=this.props.member.time_last_seen}else this.props.member instanceof c.GroupMembershipInfo?(n="group","team"===this.props.member.group_type&&(o=h.static_url("/static/images/icons/team_24@2x-vflR8kGKs.png"))):this.props.member instanceof m.ViewerInfo&&(t={email:this.props.member.email,email_verified:!!this.props.member.email},n="user",o=this.props.member.photo_circle_url,e=this.props.member.time_last_seen);var a="";"group"===n&&this.props.member instanceof c.GroupMembershipInfo&&this.props.member.member_count&&(a=v("%(member_num)s member","%(member_num)s members",this.props.member.member_count).format({member_num:this.props.member.member_count}));var i=null;a&&(i=this.props.legacyGroupViewersLine?b.FIRST_LINE:b.SECOND_LINE);var l=r({"sharing-member-info":!0,"o-flag":!0,"u-pad-right-m":!this.props.isViewOnly});return s.createElement("li",{className:"sharing-member-list__item o-flag"},s.createElement("div",{
className:"o-flag__flex"},s.createElement("div",{className:l},this.renderAvatar(o,n),s.createElement("div",{className:"sharing-member-info__contact o-flag__flex"},this.renderDisplayName(n,t,e,a,i),this.renderMemberDetails(n,a,i,t)))),this.renderSharingBubbleMenu())},t})(s.Component);w.displayName="SharingMemberListItem",w.defaultProps={canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,disabled:!1,isPresent:!1,isViewOnly:!1,legacyGroupViewersLine:void 0,wrappedGroupViewersElement:void 0},t.SharingMemberListItem=w}),function(){define("modules/clean/sharing/views/modal_content",["external/classnames","external/immutable","external/react","external/react-dom","external/underscore","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/contacts/util","modules/clean/em_string","modules/clean/filepath","modules/clean/growth/experiments/shared_folder_paywall_view","modules/clean/react/bubble_dropdown_v2","modules/clean/react/css","modules/clean/react/image","modules/clean/react/pass/constants","modules/clean/react/sprite","modules/clean/react/bubble","modules/clean/react/tooltip","modules/clean/react_format","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/comments_help","modules/clean/sharing/views/exp_share_link_upsell","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/views/member_list","modules/clean/sharing/views/modal_link_info","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/static_urls","modules/clean/user","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w,S,E,I,C,N,M,P,T,k,A,x,F){var L,O,D,R,U,B,q,H,V,G,W,Y,K,z,j,Q,Z,J,X,$,ee,te,ne,re,se,oe,ae,ie,le,de,ce,pe,ue,me,he,_e,fe,ge,ye,ve,be,we,Se;return q=o.ContactsTokenizer,h.PASS_FETCHING_STATUS,_e=h.fetchingStatusIsSuccessful,he=h.fetchingStatusIsComplete,le=g.Tooltip,de=g.TooltipPosition,ge=y.reactFormat,te=v.ShareModalActionHandler,W=b.FolderPolicy,z=b.LinkMetadata,Z=b.MemberCounts,J=b.MemberPermissions,$=b.PermissionSetting,re=b.SharedContentLinkMetadata,ae=b.SharingMembership,L=w.ACCESS_VALUES,w.COMMENTING,ee=w.SNIPPET_SIZES,ie=w.TRUELINK,H=S.ContentInfo,R=E.CONTACT_ERROR_LEVEL,fe=E.genContentManagerBridgeUri,Y=E.GoldenGate,ve=E.shouldEnforceMemberLimits,Se=E.validateContact,j=I.MODES,Q=I.MODE_VALUES,O=I.BANNERS,D=I.BANNER_VALUES,U=I.CONTENT_NAME_MESSAGE_LEVELS,B=I.CONTENT_NAME_MESSAGE_LEVEL_VALUES,K=I.LINK_ONLY_REASON,V=N.ExpShareLinkUpsellV1,G=N.ExpShareLinkUpsellV2,oe=P.SharingMemberList,X=T.ModalLinkInfo,se=k.SharingBubbleMenu,be=A.static_url,ue=n.createElement,me=n.DOM,ye=F.i18n_default_project("sharing"),ce=ye._,we=ye.ungettext,pe=n.createClass({displayName:"ShareModalContent",statics:{MODES:j},propTypes:{actionHandler:n.PropTypes.instanceOf(te).isRequired,areMembersFullyLoaded:n.PropTypes.bool,banner:n.PropTypes.oneOf(D),canInviteEditor:n.PropTypes.bool.isRequired,canInviteViewer:n.PropTypes.bool.isRequired,canInviteViewerNoComment:n.PropTypes.bool.isRequired,canMakeViewerNoComment:n.PropTypes.bool.isRequired,canRelinquishMembership:n.PropTypes.bool,canShareLink:n.PropTypes.bool.isRequired,canUpdateConfidentiality:n.PropTypes.bool,contactsError:n.PropTypes.shape({level:n.PropTypes.string,message:n.PropTypes.oneOfType([n.PropTypes.string,n.PropTypes.array])}),contentInfo:n.PropTypes.instanceOf(H).isRequired,contentNameMessage:n.PropTypes.string,contentNameMessageLevel:n.PropTypes.oneOf(B),displayContentNameTooltip:n.PropTypes.bool,displayContentNameBanner:n.PropTypes.bool,folderPolicy:n.PropTypes.instanceOf(W),guestMembers:n.PropTypes.array.isRequired,groupSeenStateInfo:n.PropTypes.object,hasDisplayableMembers:n.PropTypes.bool.isRequired,hasNonOwnerMembers:n.PropTypes.bool.isRequired,headerId:n.PropTypes.string,icon:n.PropTypes.string,initialContentName:n.PropTypes.string,initialRecipientRawInput:n.PropTypes.string,initialRecipientTokens:n.PropTypes.array,isAddMessageAsCommentChecked:n.PropTypes.bool,isAddMessageAsCommentHelpShown:n.PropTypes.bool,isConfidentialFolder:n.PropTypes.bool,isContentNameFocused:n.PropTypes.bool,isFolderInsideTeamFolderTree:n.PropTypes.bool,isInContentManager:n.PropTypes.bool,isLimitedTeam:n.PropTypes.bool,isLinkMetadataLoaded:n.PropTypes.bool.isRequired,isMetadataLoaded:n.PropTypes.bool.isRequired,isPassEnabled:n.PropTypes.bool,isTeamSharedFolder:n.PropTypes.bool,isTokenizerEmpty:n.PropTypes.bool.isRequired,linkMetadata:n.PropTypes.oneOfType([n.PropTypes.instanceOf(z),n.PropTypes.instanceOf(re)]),linkOnlyReason:n.PropTypes.oneOf(s.values(K)),linkSeenStateInfo:n.PropTypes.array,memberCounts:n.PropTypes.instanceOf(Z),memberCountWithRecipients:n.PropTypes.number,members:n.PropTypes.instanceOf(ae),mode:n.PropTypes.oneOf(Q),name:n.PropTypes.string,onSettingsClick:n.PropTypes.func,onLinkViewersClick:n.PropTypes.func,onSetConfidentialClick:n.PropTypes.func,ownerTeam:n.PropTypes.shape({id:n.PropTypes.string.isRequired,name:n.PropTypes.string.isRequired}),passFetchingStatus:n.PropTypes.number,pendingMemberAction:n.PropTypes.instanceOf(t.Set).isRequired,presentAccountIds:n.PropTypes.instanceOf(t.Set),recipientAccess:n.PropTypes.oneOf(L).isRequired,recipientMessage:n.PropTypes.string.isRequired,recipientTokens:n.PropTypes.array,shareFolderPromise:n.PropTypes.instanceOf(Promise),sharingPaywallInfo:n.PropTypes.shape({foldersToUnshare:n.PropTypes.object,isFolderOwner:n.PropTypes.bool,isInExperiment:n.PropTypes.bool,maxOwned:n.PropTypes.number,numOwned:n.PropTypes.number,onLearnMoreClick:n.PropTypes.func,onManageSharedFoldersClick:n.PropTypes.func,onUpgradeClick:n.PropTypes.func}),shouldBlockMemberListOnPassLoad:n.PropTypes.bool,showContentManagerBridge:n.PropTypes.bool,showPassFileSettings:n.PropTypes.bool,suppressLinkUI:n.PropTypes.bool,teamGroupInfo:n.PropTypes.shape({id:n.PropTypes.string,name:n.PropTypes.string}),user:n.PropTypes.instanceOf(x).isRequired,expSubgrowthProOverquotaCreateSharedLink:n.PropTypes.string},getDefaultProps:function(){return{contactsError:{level:null,message:null},headerId:"unified-share-modal-title",linkMetadata:null,members:null,initialRecipientRawInput:"",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:j.MEMBERSHIP,onFolderSettingsClick:null,onLinkViewersClick:null}},componentDidMount:function(){if(this.logTTI(),this.refs.contentNameInput)return r.findDOMNode(this.refs.contentNameInput).focus()},componentDidUpdate:function(e,t){return this.logTTI()},logTTI:function(){return this.props.mode===j.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore("VIEW_LINK_ONLY_MODAL"):this.props.isMetadataLoaded&&(this.props.actionHandler.logIfHaventBefore("VIEW_SHARE_MODAL"),!this._shouldRenderMainLoading())?this.props.actionHandler.logIfHaventBefore("MEMBER_LIST_LOADED",{member_count:this._getMemberNum()}):void 0},render:function(){return me.div({className:"unified-share-modal unified-share-modal--"+this.props.mode},this._renderHeaderSection(),this._renderToSection(),this._renderErrorMessageSection(),this._renderConfidentialFolderSection(),this._renderMainSection(),this._renderPaywallSection(),this._renderFooterSection())},_renderHeaderSection:function(){var t,n,r,s,o;return n=this._getMemberNum(),r=this.props.user.is_team&&(null!=(s=this.props.memberCounts)?s.users_outside_team:void 0)>0&&null!=this.props.ownerTeam?we("%(outside_team_count)s outside your Dropbox team","%(outside_team_count)s outside your Dropbox team",this.props.memberCounts.users_outside_team).format({outside_team_count:this.props.memberCounts.users_outside_team}):void 0,t=n?r?we("%(member_num)s member (%(outside_team_string)s)","%(member_num)s members (%(outside_team_string)s)",n,{comment:'Description of the count of total folder members and count of outside-of-team folder members, like "10 members (3 outside of your Dropbox team)"'}):we("%(member_num)s member","%(member_num)s members",n):"",t=t.format({member_num:n+((null!=(o=this.props.memberCounts)?o.exceeds_count:void 0)?"+":""),outside_team_string:r}),me.div({className:"unified-share-modal__section"},me.div({className:"unified-share-modal__close u-l-fr o-flag__fix"},ue(M,{className:"u-mar-left-s u-mar-top-xs",onClick:(function(e){return function(){return e.props.actionHandler.onClickX(e.refs.tokenizer)}})(this)})),me.div({className:"unified-share-modal__header o-flag"},me.span({className:"o-flag__fix"},ue(_,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:this.props.icon})),me.div({className:e("unified-share-modal__title","o-flag__flex",n?"unified-share-modal__title--member-count":void 0)},this.props.contentInfo.pathExists()?me.h3({className:"u-font-strong",id:this.props.headerId},l.em_snippet(this.props.contentInfo.name(),ee.FILENAME)):this._renderContentNameInput(),n?me.h4({className:"u-trim-margin u-font-meta"},t):void 0),ie.TRUELINK_UI[this.props.user.id]?me.span({className:"u-l-fr o-flag__fix"},this._renderContentSettings()):void 0))},_renderContentNameInput:function(){return me.div({className:"unified-share-modal__content-name"},null==this.props.contentNameMessage||!this.props.isContentNameFocused&&this.props.contentNameMessageLevel!==U.ERROR?void 0:ue(f,{arrow:f.ARROW.TOP,className:e({"unified-share-modal__content-name__tooltip":!0,"unified-share-modal__content-name__tooltip-error":this.props.contentNameMessageLevel===U.ERROR,"u-font-strong":!0})},me.div({className:e(["u-pad-top-xxs","u-pad-bottom-xxs","u-pad-left-xs","u-pad-right-xs"])},this.props.contentNameMessage)),me.input({className:e(["u-trim-padding","u-trim-margin","u-l-ib","u-font-strong"]),id:this.props.headerId,ref:"contentNameInput",onChange:(function(e){return function(t){return e.props.actionHandler.handleContentNameChange(t.target.value)}})(this),onFocus:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!0)}})(this),onBlur:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!1)}})(this),onKeyUp:(function(e){return function(t){var n,s;if((null!=(n=e.refs.tokenizer)&&null!=(s=n.refs.tokenizer)?s.refs.input:void 0)&&13===t.keyCode)return r.findDOMNode(e.refs.tokenizer.refs.tokenizer.refs.input).focus()}})(this),placeholder:this.props.isContentNameFocused?void 0:ce("Folder name"),defaultValue:this.props.initialContentName}))},_renderToSection:function(){var t,n;return this._shouldRenderPaywallBlocker()?null:this.props.linkOnlyReason===K.LINKS_PAGE?null:this.props.mode===j.LINK_ONLY?this._renderNoPermissionSection():this.props.isMetadataLoaded?this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.canInviteEditor||this.props.canInviteViewer?ve(this.props.user,this.props.isTeamSharedFolder,this.props.isFolderInsideTeamFolderTree)&&(null!=(t=this.props.memberCounts)?t.total_unique_users:void 0)>=Y.SHARING_TOTAL_LIMIT?this._renderOverLimitSection():(n=this.props.contentInfo.isFile()&&!this.props.canInviteEditor&&!this.props.canInviteViewerNoComment,me.div({className:"unified-share-modal__section unified-share-modal__section--to"},me.div({className:"o-flag"},me.label({className:"o-flag__fix u-font-strong",htmlFor:"unified-share-modal-contacts-tokenizer"},this.props.isTeamSharedFolder?ce("Add groups:",{comment:"Label for with whom to share"}):ce("To:",{comment:"Label for with whom to share"})),me.div({className:"unified-share-modal__to-input-box o-flag__flex"},ue(q,{ref:"tokenizer",context:"tiburon",customContactFilter:this.props.isTeamSharedFolder?function(e){return e.type!==a.FB&&e.group_id}:this.props.isInContentManager?function(e){return e.type!==a.FB}:(function(e){return function(t){return t.type!==a.FB&&t.email!==e.props.user.email}})(this),focusOnMount:this.props.contentInfo.pathExists(),id:"unified-share-modal-contacts-tokenizer",onContentsChange:this.props.actionHandler.recipientsChange,populatedInputData:{tokens:this.props.initialRecipientTokens,value:this.props.initialRecipientRawInput},customContactValidator:(function(e){return function(t){return Se(t,e.props.user,e.props.ownerTeam,e.props.folderPolicy,e.props.isTeamSharedFolder,e.props.isFolderInsideTeamFolderTree,e.props.memberCountWithRecipients)}})(this),placeholder:ce(this.props.isTeamSharedFolder?"Group names":this.props.user.is_team?"Email, name, or group":"Email or name"),shouldLogContactSearch:!0,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.isTeamSharedFolder?this.props.teamGroupInfo:null,user:this.props.user})),me.div({className:e({"o-flag__fix":!0})},n?ue(le,{position:de.BOTTOM,tooltip_contents:ce("Only folders can be shared with edit access"),tooltip_classname:"sharing-access-menu__tooltip"},me.span({className:"ax-visually-hidden"},ce("Only folders can be shared with edit access")),this._renderToSectionAccessDropdown()):this._renderToSectionAccessDropdown())))):this._renderNoPermissionSection():me.div({className:"unified-share-modal__section unified-share-modal__section--to"},me.div({className:"unified-share-modal__to-placeholder"}," "))},_renderToSectionAccessDropdown:function(){return ue(se,{asButton:!0,canMakeViewerNoComment:this.props.canMakeViewerNoComment,contentInfo:this.props.contentInfo,currentAccess:this.props.recipientAccess,disabled:this.props.showContentManagerBridge,memberPermissions:new J({make_editor:new $({allow:this.props.canInviteEditor}),make_viewer:new $({allow:this.props.canInviteViewer}),make_viewer_no_comment:new $({allow:this.props.canInviteViewerNoComment})}),onAccessChange:this.props.actionHandler.changeRecipientAccess})},_shouldRenderContentSettingsShareButton:function(){var e;return this.props.isMetadataLoaded&&this.props.mode!==j.LINK_ONLY&&(this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||(e=this.props.mode)===j.SHARE||e===j.SHARE_SENDING)&&!this._shouldRenderPaywallBlocker()},_shouldRenderFooterSection:function(){return this._renderLinkRowInFooter()?this._shouldRenderLinkRow():this._shouldRenderContentSettingsShareButton()},_renderFooterSection:function(){if(this._shouldRenderFooterSection())return me.div({className:"unified-share-modal__section unified-share-modal__section--footer clearfix"},this._renderLinkRowInFooter()?this._renderLinkRowContent():this._renderContentSettingsShareButton())},_renderContentSettingsShareButton:function(){if(this._shouldRenderContentSettingsShareButton())return me.div({},ie.TRUELINK_UI[this.props.user.id]?void 0:me.div({className:"u-l-fl"},this._renderContentSettings()),me.div({className:"u-l-fr"},function(){switch(this.props.mode){case j.SHARE:case j.SHARE_SENDING:return me.button({className:"unified-share-modal__share-send c-btn c-btn--primary",disabled:this.props.mode===j.SHARE_SENDING||this.props.isTokenizerEmpty||this.props.contactsError.level===R.ERROR||null!=this.props.contentNameMessage,onClick:(function(e){return function(){return e.props.actionHandler.handleShareClick(e.refs.tokenizer,e.refs.contentNameInput)}})(this)},ce(this.props.mode===j.SHARE_SENDING?this.props.isTeamSharedFolder?"Adding...":"Sharing...":this.props.isTeamSharedFolder?"Add":"Share"));default:return null}}.call(this)))},_renderContentSettings:function(){var e;if(this.props.isMetadataLoaded)return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings?me.button({"aria-label":ce("Settings"),className:"unified-share-modal__settings u-font-meta c-borderless-button",disabled:this.props.mode===j.SHARE_SENDING,onClick:(function(e){return function(){return e.props.onSettingsClick()}})(this)},ue(_,{alt:"",className:"u-mar-right-xs u-l-ib u-l-ib--m",group:"web",name:"settings"}),ie.TRUELINK_UI[this.props.user.id]?void 0:ce(this.props.contentInfo.isFile()?"File settings":"Folder settings")):!this.props.contentInfo.isFolder()&&(this._canSendFeedbackRequest()||(null!=(e=this.props.recipientMessage)?e.length:void 0)>0)?this._renderFeedbackCheckbox():void 0},_renderErrorMessageSection:function(){return this.props.contactsError.message?me.div({className:e(["unified-share-modal__section","unified-share-modal__error-message","u-font-center",this.props.contactsError.level===R.WARN?"unified-share-modal__warn":void 0,this.props.contactsError.level===R.ERROR?"unified-share-modal__error":void 0])},this.props.contactsError.message):null},_shouldRenderMainLoading:function(){var e,t,n,r;return n=this.props.isMetadataLoaded,t=this.props.hasNonOwnerMembers||this.props.areMembersFullyLoaded,r=!this.props.isPassEnabled||this._isPassInfoLoaded(),e=this.props.shouldBlockMemberListOnPassLoad&&!r,!n||!t||e},_renderMainSection:function(){if(this.props.mode===j.LINK_ONLY)return this._renderMainLinkOnly();if(this._shouldRenderMainLoading())return this._renderMainLoading();switch(this.props.mode){case j.MEMBERSHIP:return this._renderMainMembership();case j.SHARE:case j.SHARE_SENDING:return this._renderMainShare();default:return null}},_shouldRenderPaywallBlocker:function(){var e,t,n;return null!==this.props.sharingPaywallInfo&&(!((null!=(n=this.props.sharingPaywallInfo.foldersToUnshare)?n.size:void 0)>0)&&(e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),t=this.props.sharingPaywallInfo.numOwned>=this.props.sharingPaywallInfo.maxOwned,this.props.sharingPaywallInfo.isInExperiment&&e&&t))},_shouldRenderPaywallBanner:function(){var e,t,n,r;return null!==this.props.sharingPaywallInfo&&((null!=(r=this.props.sharingPaywallInfo.foldersToUnshare)?r.size:void 0)>0||(t=this.props.sharingPaywallInfo.isFolderOwner,n=this.props.sharingPaywallInfo.numOwned<this.props.sharingPaywallInfo.maxOwned,e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),this.props.sharingPaywallInfo.isInExperiment&&(this.props.contentInfo.isSharedFolder()&&t||e&&n)))},_renderPaywallSection:function(){var t;return this.props.isMetadataLoaded&&this._shouldRenderPaywallBanner()?(this.props.actionHandler.logPaywallEvent("show_sharing_paywall_banner_in_share_modal"),t=0===this.props.sharingPaywallInfo.numOwned?we("You can own %(max)s shared folder.","You can own %(max)s shared folders.",this.props.sharingPaywallInfo.maxOwned).format({max:this.props.sharingPaywallInfo.maxOwned}):we("You own %(num)s shared folder (max is %(max)s).","You own %(num)s shared folders (max is %(max)s).",this.props.sharingPaywallInfo.numOwned).format({num:this.props.sharingPaywallInfo.numOwned,max:this.props.sharingPaywallInfo.maxOwned}),me.div({className:e(["paywall-banner","unified-share-modal__section","unified-share-modal__no-permission","u-font-center"])},t," ",me.button({className:"button-as-link",onClick:this.props.sharingPaywallInfo.onLearnMoreClick},ce("Learn more")))):null},_renderNoPermissionSection:function(){var e;return me.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},this.props.mode===j.LINK_ONLY?this.props.contentInfo.isOSXPackage()?ce(ie.TRUELINK_UI[this.props.user.id]?"Package files can’t be shared.":"This package file can only be shared as a link."):this.props.linkOnlyReason===K.INSIDE_SHARED_FOLDER?ie.TRUELINK_UI[this.props.user.id]?ce("You don’t have permission to share this folder."):me.span({},ce("This folder can only be shared as a link because it’s in a shared folder.")+" ",me.a({href:"/help/1931",target:"_blank"},ce("Learn more"))):ie.TRUELINK_UI[this.props.user.id]?ce("This folder can’t be shared"):this.props.linkOnlyReason===K.CONTAINS_SHARED_FOLDER?me.span({},ce("This folder can only be shared as a link because it contains a shared folder.")+" ",me.a({href:"/help/1931",target:"_blank"},ce("Learn more"))):ce("This folder can only be shared as a link."):this.props.isTeamSharedFolder&&this._shouldRenderTeamFolderNoPermissionMessage(this.props.members)?ce("This folder is automatically shared with all members of %(team_name)s").format({team_name:this.props.ownerTeam.name}):this.props.isTeamSharedFolder?ge(ce("Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."),{admin_link:me.a({href:"/team?_tk=left_nav_team",target:"_blank"}),group_link:me.a({href:"/help/7232#transfer",target:"_blank"})}):ce(this.props.contentInfo.isFolder()?ie.TRUELINK_UI[this.props.user.id]&&(null!=(e=this.props.permissions)?e.change_options.allow:void 0)?"To add new members, you’ll need to add them to the parent folder.":"You don’t have permission to manage membership of this folder":"You don’t have permission to manage membership of this file"))},_renderConfidentialFolderSection:function(){if(this.props.isConfidentialFolder&&this.props.canUpdateConfidentiality)return me.div({className:"unified-share-modal__section unified-share-modal__confidential-folder u-font-center"},me.span({},ge(ce("<b>Invite only.</b> Members of parent folders can’t access."),{b:me.b()}),this.props.contentInfo.pathExists()?[" ",me.a({onClick:this.props.onSetConfidentialClick},ce("Restore access"))]:void 0))},_renderContentManagerBridge:function(){var e,t,n;return e=d.parent_dir(this.props.contentInfo.displayPath()),t=this.props.contentInfo.name(),n=fe({containingFolder:e,filenameToSelect:t,isLimitedTeam:this.props.isLimitedTeam}),me.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},me.span({},ce("You can manage folder membership in the Admin Console. "),me.a({href:n.toString(),target:"_blank"},ce("Open in new tab."))))},_renderOverLimitSection:function(){return me.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},me.div({},ce("This folder is over its %(member_limit)s-member limit.",{comment:"member limit is a number greater than 200"}).format({member_limit:Y.SHARING_TOTAL_LIMIT})),me.div({},ce("Please remove some members.")," ",me.a({href:"/help/9292",target:"_blank"},ce("Learn more."))))},_shouldRenderTeamFolderNoPermissionMessage:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){var n,r;return"team"===e.group_type&&(null!=(n=e.permissions.make_editor)?n.allow:void 0)&&(null!=(r=e.permissions.make_viewer)?r.allow:void 0)})},_isOwnerOfAtLeastOneGroup:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){return e.is_owner})},_renderMainLoading:function(){return me.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer"])},this._renderLinkRow(),me.div({className:"u-font-center u-font-meta u-pad-top-xl"},me.div({className:"c-loader"},ce("Loading..."))))},_renderMainLinkOnly:function(){return ie.TRUELINK_UI[this.props.user.id]&&this.props.linkOnlyReason!==K.LINKS_PAGE?null:me.div({className:e(["unified-share-modal__main","unified-share-modal__main--link-only","unified-share-modal__section",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow())},_renderMainMembership:function(){var t,n,r;return me.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer",this._shouldRenderPaywallBlocker()?"unified-share-modal__main--paywall":void 0,this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow(),r=this.props.user.is_cdm_member&&(this.props.members.users.size>0&&this.props.isFolderInsideTeamFolderTree||!this.props.isConfidentialFolder),this._shouldRenderPaywallBlocker()?(this.props.actionHandler.logPaywallEvent("view_shared_folder_paywall"),ue(c,{actionHandler:this.props.actionHandler,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:this.props.sharingPaywallInfo.onLearnMoreClick,onUpgradeClick:this.props.sharingPaywallInfo.onUpgradeClick,onManageClick:this.props.sharingPaywallInfo.onManageSharedFoldersClick})):this.props.hasNonOwnerMembers||r||this.props.guestMembers.length>0?ue(oe,{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.canInviteEditor||this.props.canInviteViewer,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,guestMembers:this.props.guestMembers,groupSeenStateInfo:this.props.groupSeenStateInfo,isConfidentialFolder:this.props.isConfidentialFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,membership:this.props.members,onSetConfidentialClick:this.props.onSetConfidentialClick,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&_e(this.props.passFetchingStatus),teamName:null!=(n=this.props.ownerTeam)?n.name:void 0,user:this.props.user,viewer:this.props.viewer}):this.props.banner===O.INPUT_CONTENT_NAME?me.div({className:e(["unified-share-modal__input-content-name-banner","u-font-center","u-font-meta","u-mar-top-xs"])},ue(m,{src:be("/static/images/sharing/illo-name-folder-vfl38PzAv.png"),srcHiRes:be("/static/images/sharing/illo-name-folder@2x-vflzK0uJv.png")}),me.h3({className:e(["u-font-strong","u-mar-top-xs"])},ce("Name your shared folder")),me.p({className:e(["u-pad-left-xxl","u-pad-right-xxl"])},ce("Shared folders are for collaborting on projects, client works, and organizing departments"))):me.div({className:e(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},this.props.isTeamSharedFolder?null!=this.props.teamGroupInfo?[me.p({className:"u-mar-top-xxl"},me.a({onClick:this._addEveryoneGroup},ce("Add everyone at %(team_name)s").format({team_name:this.props.ownerTeam.name}))),me.p({},ce("Or, add groups to this team folder.")+" ",me.a({href:"/team#groups/newgroup"},ce("Create a group")))]:me.p({className:"u-mar-top-xxl"},ce("Add groups to this team folder.")+" ",me.a({href:"/team#groups/newgroup"},ce("Create a group"))):(t=ie.TRUELINK_UI[this.props.user.id],t||"V1"!==this.props.expSubgrowthProOverquotaCreateSharedLink?t||"V2"!==this.props.expSubgrowthProOverquotaCreateSharedLink?me.div({},ue(m,{className:"unified-share-modal__illo",src:be("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:be("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),me.p({className:"u-mar-top-s"},ce("Add people you want to share with"))):ue(G):ue(V))))},_renderMainShare:function(){return me.div({className:"unified-share-modal__main unified-share-modal__section u-pad-horizontal-m"},this.props.isTeamSharedFolder?void 0:me.textarea({placeholder:ce("Add a message (optional)"),onChange:(function(e){return function(t){return e.props.actionHandler.changeRecipientMessage(t.target.value)}})(this),value:this.props.recipientMessage}))},_renderLinkRow:function(){if(!this._renderLinkRowInFooter())return this._renderLinkRowContent()},_renderLinkRowContent:function(){var e,t;if(this._shouldRenderLinkRow())return t=!this.props.contentInfo.isMounted()&&this.props.isPassEnabled&&this._isPassInfoLoaded()&&this.props.isMetadataLoaded,t||this.props.isLinkMetadataLoaded&&(this.props.isMetadataLoaded||this.props.mode===j.LINK_ONLY)?me.div({className:"unified-share-modal__link-info"},ue(X,{actionHandler:this.props.actionHandler,canShareLink:this.props.canShareLink||this.props.mode===j.LINK_ONLY,contentInfo:this.props.contentInfo,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isLimitedTeam:this.props.isLimitedTeam,linkMetadata:this.props.linkMetadata,linkSeenStateInfo:this.props.linkSeenStateInfo,mode:this.props.mode,onLinkViewersClick:this.props.onLinkViewersClick,shareFolderPromise:this.props.shareFolderPromise,teamName:null!=(e=this.props.ownerTeam)?e.name:void 0,presentAccountIds:this.props.presentAccountIds,user:this.props.user})):this.props.mode===j.LINK_ONLY?me.div({className:"unified-share-modal__link-info--loading"},me.div({className:"c-loader c-loader--spinner--blue u-l-b u-mar-horizontal-auto"},ce("Loading…"))):this.props.contentInfo.isTeamSharedFolder()?void 0:me.div({className:"unified-share-modal__link-info--filler"})},_renderFeedbackCheckbox:function(){var e,t;return t=this._canSendFeedbackRequest(),e=ce(t?"I want feedback on this file":"Post this message as a comment"),me.div({className:"u-pad-top-xs"},me.div({className:"unified-share-modal__add-message-as-comment-checkbox-container"},me.input({type:"checkbox",id:"add_message_as_comment",name:"add_message_as_comment",checked:this.props.isAddMessageAsCommentChecked,onChange:this._handleAddMessageAsCommentChange}),this.props.isAddMessageAsCommentHelpShown?ue(C,{onClose:this._commentsHelpClosed,onButtonClick:this._commentsHelpButtonClicked,isFeedbackRequest:t}):void 0),me.label({htmlFor:"add_message_as_comment"},e))},_getMemberNum:function(){var e;return null!=this.props.memberCounts?this.props.memberCounts.total_unique_users:null!=(e=this.props.members)?e.getMemberCount():void 0},_isPassInfoLoaded:function(){return he(this.props.passFetchingStatus)},_handleAddMessageAsCommentChange:function(e){return this.props.actionHandler.setAddMessageAsCommentChecked(e.target.checked)},_commentsHelpClosed:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed()},_commentsHelpButtonClicked:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed(),this.props.actionHandler.setAddMessageAsCommentChecked(!0)},_canSendFeedbackRequest:function(){return!this._renderLinkRowInFooter()},_addEveryoneGroup:function(){var e;return null!=(e=this.refs.tokenizer)?e.addExternalContacts([i.teamGroupInfoToContact(this.props.teamGroupInfo)]):void 0},_renderLinkRowInFooter:function(){return this.props.mode!==j.LINK_ONLY&&(this.props.mode!==j.SHARE&&this.props.mode!==j.SHARE_SENDING&&(!!this.props.isMetadataLoaded&&ie.TRUELINK_UI[this.props.user.id]))},_shouldRenderLinkRow:function(){return!(ie.TRUELINK_UI[this.props.user.id]&&this.props.isLinkMetadataLoaded&&!this.props.linkMetadata)&&(!this.props.suppressLinkUI&&this.props.canShareLink)}}),ne=u(pe,["/static/css/react/contacts_tokenizer-vflry-iG9.css","/static/css/scooter/scooter-scoped-vflm9UP03.css","/static/css/sharing/share_modal-vflXwiaMl.css"],[p]),{ShareModalContent:ne,MODES:j}})}.call(this),define("modules/clean/sharing/views/modal_link_info",["require","exports","tslib","jquery","external/classnames","external/react","modules/clean/clipboard_v2","modules/clean/em_string","modules/clean/react_format","modules/clean/react/sprite","modules/clean/react/util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/link_description","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/modal_viewers_line","modules/clean/sharing/views/viewer_info","modules/core/i18n","modules/core/notify"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m,h,_,f,g,y,v,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=b.i18n_default_project("sharing")._,E=(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.handleCreateLinkClicked=function(){if(r.isSharedContentLink())throw Error("Should not display this for shared content link");if(r.props.actionHandler)return r.props.actionHandler.createSharedLink()},r.handleCopyLinkClicked=function(){if(!r.state.showingUrl){var e={};r.props.linkMetadata instanceof p.SharedContentLinkMetadata?(e.type="scl",e.password_protected=r.props.linkMetadata.password_protected,e.audience=r.props.linkMetadata.current_audience,e.expiration=r.props.linkMetadata.expiry):r.props.linkMetadata instanceof p.LinkMetadata?(e.type="shmodel",
e.visibility=r.props.linkMetadata.link_permissions.resolved_visibility,e.expiration=r.props.linkMetadata.expires):r.isSharedContentLink()&&(e.type="scl"),f.logTiburonEvent(r.props.contentInfo,r.props.user.id,"CLICK_TIB_COPY_LINK",e),r.props.actionHandler&&r.props.actionHandler.turnLinkOnIfQualified()}return c.setStatePromise(r,{showingUrl:!r.state.showingUrl}).then(function(){if(r.urlField){var e=r.urlField;e.focus(),e.select(),r.clipboard.do_copy()}})},r.state={showingUrl:!1},r.clipboard=null,r}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.clipboard=new a(this.props.linkMetadata&&this.props.linkMetadata.url,function(){return w.success(S("Link copied to clipboard"))},function(){w.error(S("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked)},t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.setupCopy=function(){var e=r(".copy-link-button");e.length&&this.clipboard.setupCopy(e,r(".copy-link-container"))},t.prototype.render=function(){return this.props.linkMetadata||this.isSharedContentLink()?this.renderLink():this.props.contentInfo&&!this.props.contentInfo.isMounted()?this.renderUnmountedLinkInfo():this.props.canShareLink?this.renderNoLink():null},t.prototype.renderLink=function(){var e=this;if(!this.props.linkMetadata)return null;var t=null;this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&(t=this.renderSharedContentLinkInfo());var n;if(this.state.showingUrl)n=o.createElement("span",null,t,o.createElement("span",null,o.createElement("label",{className:"ax-visually-hidden",htmlFor:"unified-share-modal-link-url",key:"link-label"},S("Shared link URL")),o.createElement("input",{className:"unified-share-modal-link-info__url",id:"unified-share-modal-link-url",key:"link-url-input",onClick:this.handleUrlClick,readOnly:!0,ref:function(t){return e.urlField=t},type:"text",value:this.props.linkMetadata.url})));else{var r=null;this.props.linkMetadata instanceof p.LinkMetadata?r=m.formatLinkDescription(this.props.linkMetadata):this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&(r=this.renderSharedContentLinkInfo());var a=null;null!==r&&(a=o.createElement("span",{className:s({"unified-share-modal-link-info__description":!0,"unified-share-modal-link-info__description--content-link":this.isSharedContentLink()})},r)),n=o.createElement("span",null,a,this.renderLinkViewers())}var i=null;return this.isSharedContentLink()?this.props.linkMetadata&&this.props.linkMetadata.url?i=this.renderCopyLink():this.isSharingFolder()||(i=this.renderGetLink()):i=o.createElement("span",null,this.renderLinkSettings(),this.renderDivider(),this.renderCopyLink()),o.createElement("div",{className:"unified-share-modal-link-info o-flag"},o.createElement("div",{className:"o-flag__fix"},this.renderLinkIcon()),o.createElement("div",{className:this.detailsClassName()},n),o.createElement("ul",{className:"unified-share-modal-link-info__actions o-flag__fix"},i))},t.prototype.renderLinkSettings=function(){return!this.state.showingUrl&&this.props.actionHandler?o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:this.props.actionHandler.handleLinkSettingsClick},S("Link settings"))):null},t.prototype.renderDivider=function(){return this.state.showingUrl?null:o.createElement("span",{className:"u-l-ib u-mar-left-xs u-mar-right-xs"},"•")},t.prototype.renderCopyLink=function(){var e;return e=this.state.showingUrl?S("Hide link"):a.is_supported()?o.createElement("span",{className:"copy-link-button"},S("Copy link")):S("Show link"),o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link copy-link-container",onClick:this.handleCopyLinkClicked},e))},t.prototype.renderGetLink=function(){var e=this,t=function(){e.props.actionHandler&&e.props.actionHandler.turnLinkOnIfQualified().then(function(){e.props.actionHandler&&e.props.actionHandler.shareIfFileFolder()})};return o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:t},S("Get link")))},t.prototype.renderUnmountedLinkInfo=function(){var e=this.renderLinkViewers();return e||(e=S("No one else has viewed the link")),o.createElement("div",{className:s({"unified-share-modal-link-info":!0,"o-flag":!0,"u-mar-horizontal-s":!this.isSharedContentLink(),"u-mar-bottom-s":!0,"u-pad-top-s":!0})},o.createElement("div",{className:"o-flag__fix"},this.renderLinkIcon()),o.createElement("div",{className:this.detailsClassName()},e))},t.prototype.detailsClassName=function(){return"unified-share-modal-link-info__details o-flag__flex"},t.prototype.renderNoLink=function(){var e;return e=this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length?o.createElement("span",null,S("You haven’t created a link yet"),this.renderLinkViewers()):S("No link created yet"),o.createElement("div",{className:"unified-share-modal-link-info unified-share-modal-link-info--no-link o-flag"},o.createElement("div",{className:"o-flag__fix"},o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(d,{alt:"",group:"web",name:"shared_link_gray"}))),o.createElement("div",{className:this.detailsClassName()},e),o.createElement("div",{className:"unified-share-modal-link-info__actions o-flag__fix"},o.createElement("button",{className:"button-as-link",onClick:this.handleCreateLinkClicked},S("Create a link"))))},t.prototype.handleUrlClick=function(e){e.target.select()},t.prototype.renderLinkViewers=function(){if(!(this.props.presentAccountIds&&this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length))return null;var e=this.props.linkSeenStateInfo.map(function(e){return new v.ViewerInfo(e)});return o.createElement("button",{className:"unified-share-modal-link-info__viewers button-as-link",onClick:this.props.onLinkViewersClick},o.createElement(y.ModalViewersLine,{currentUserAccountId:this.props.user.account_id,presentAccountIds:this.props.presentAccountIds,viewers:e}))},t.prototype.isSharedContentLink=function(){return u.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.renderLinkIcon=function(){return o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(d,{alt:"",group:"web",name:"shared_link_white"}))},t.prototype.isSharingFolder=function(){return Boolean(this.props.shareFolderPromise)},t.prototype.renderSharedContentLinkInfo=function(){if(!(this.props.actionHandler&&this.props.linkMetadata&&this.props.linkMetadata instanceof p.SharedContentLinkMetadata))return null;if(this.isSharingFolder()||this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&this.props.linkMetadata.current_audience===p.LinkAudience.default_on)return o.createElement("div",null,S("Updating link"),o.createElement("div",{className:"c-loader"}));var e,t=this.props.linkMetadata.audience_options.size>1;this.props.linkMetadata.current_audience===p.LinkAudience.members?e=this.props.hasDisplayableMembers&&!this.props.hasNonOwnerMembers?l.reactFormat(S("<strong>Only you</strong> can use the link"),{strong:o.DOM.strong()}):l.reactFormat(S("<strong>Invited members</strong> with the link can view"),{strong:o.DOM.strong()}):this.props.linkMetadata.current_audience===p.LinkAudience.team?e=l.reactFormat(S("<strong>Members of %(team_name)s</strong> with the link can view"),{strong:o.DOM.strong(),team_name:i.em_snippet(this.props.teamName||"",10)}):this.props.linkMetadata.current_audience===p.LinkAudience.public&&(e=l.reactFormat(S("<strong>Anyone</strong> with the link can view"),{strong:o.DOM.strong()}));var n;if(t){var r=o.createElement("button",{className:"c-borderless-button change-audience-button"},e,o.createElement(d,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"}));n=o.createElement(h.SettingDropdown,{currentValue:this.props.linkMetadata.current_audience,valuesList:this.props.linkMetadata.audience_options.valueSeq().toArray(),optionsDict:_.getAudienceOptionsDict(this.props.contentInfo&&this.props.contentInfo.isFolder()||!1,this.props.teamName||"",this.props.hasNonOwnerMembers||!1,this.props.hasDisplayableMembers||!1),onValueSelected:this.props.actionHandler.handleSelectLinkAudience,customButton:r,openUp:this.props.mode!==g.MODES.LINK_ONLY})}else n=e;var s=[];this.props.linkMetadata.expiry&&s.push(m.formatSharedContentLinkExpiry(this.props.linkMetadata,!0)),this.props.linkMetadata.password_protected&&this.props.linkMetadata.expiry&&s.push(this.renderDivider()),this.props.linkMetadata.password_protected&&s.push(S("Password protected"));var a;if(this.props.linkMetadata.audience_restricting_shared_folder&&this.props.linkMetadata.audience_restricting_shared_folder.audience===this.props.linkMetadata.current_audience){var c=this.props.linkMetadata.audience_restricting_shared_folder.name;a=l.reactFormat(S("Applied via <strong>%(folder_name)s</strong>"),{strong:o.DOM.strong(),folder_name:c})}else this.props.contentInfo&&this.props.contentInfo.isFolder()&&this.props.linkMetadata.current_audience!==p.LinkAudience.members&&(a=S("Applies to all items in this folder"));return o.createElement("div",null,o.createElement("div",null,n),o.createElement("div",null,s),a)},t})(o.Component);E.displayName="ModalLinkInfo",t.ModalLinkInfo=E}),define("modules/clean/sharing/views/modal_viewers_line",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,r,s,o,a,i,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> is viewing now").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),p=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> are viewing now")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing now").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),u=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> viewed").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),m=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> viewed")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),h=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){for(var e=null,t=[],n=[],r=!0,s=0,o=this.props.viewers;s<o.length;s++){var a=o[s],i=this.props.presentAccountIds.has(a.account_id);a.account_id===this.props.currentUserAccountId?e=a:i?t.push(a):n.push(a),i||(r=!1)}var l;l=e?r?new p:new m:r?new c:new u;var d=e?[e]:[];return d.push.apply(d,t.concat(n)),this.buildViewerComponent(d,l)},t.prototype.buildViewerComponent=function(e,t){var n,s=function(e){return o.reactFormat(e,{NameSpan:r.createElement("span",null)})};switch(e.length){case 0:return r.createElement("span",null);case 1:n=s(t.formatOne(this.getName(e,0,!1)));break;case 2:n=s(t.formatTwo(this.getName(e,0),this.getName(e,1)));break;default:n=this.buildComplexTooltip(e,t)}return r.createElement("div",{className:"viewer-list-line"},n)},t.prototype.getName=function(e,t,n){void 0===n&&(n=!0);var r=e[t].display_name;return n&&(r=d.getShortName(r)),s.em_snippet(r,i.SNIPPET_SIZES.DISPLAY_NAME)},t.prototype.buildComplexTooltip=function(e,t){for(var n=e.length,s=n-2,i=[this.getName(e,2,!1)],d=Math.min(10,n),c=3;c<d;c++)i.push(r.createElement("br",null),this.getName(e,c,!1));var p=n-d;if(p){var u=l.ungettext("and %(num_additional)d more…","and %(num_additional)d more…",p,{comment:"text in a list of members, indicates there are also num_additional members not shown"}).format({num_additional:p});i.push(r.createElement("br",null),u)}var m=t.formatMulti(this.getName(e,0),this.getName(e,1),s),h=o.reactFormat(m,{NameSpan:r.createElement("span",null),PositioningTarget:r.createElement("span",{className:a.POSITIONING_TARGET_CLASS})});return r.createElement(a,{content:r.createElement("div",null,i),children:r.createElement("span",null,h),position:a.POSITIONS.BOTTOM,isTargetPositionFixed:!0})},t})(r.Component);t.ModalViewersLine=h}),define("modules/clean/sharing/views/sharing_bubble_menu",["require","exports","tslib","external/classnames","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=d.i18n_default_project("sharing")._,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMemberActionInfo=function(){var e=l.ACCESS_NAME;this.props.canMakeViewerNoComment&&(e=l.ACCESS_NAME_NO_COMMENT);var t=l.MEMBER_ACTION_FOLDER;this.props.canMakeViewerNoComment&&(t=l.MEMBER_ACTION_FOLDER_NO_COMMENT);var n=l.MEMBER_ACTION_FILE;this.props.canMakeViewerNoComment&&(n=l.MEMBER_ACTION_FILE_NO_COMMENT);var r=c("Remove");return this.props.allowRelinquishMembership&&(r=c("Remove my access")),[[i.MEMBER_ACTION.MAKE_EDITOR,{value:i.ACCESS_LEVEL.WRITER,title:e[i.ACCESS_LEVEL.WRITER],folder_description:t[i.MEMBER_ACTION.MAKE_EDITOR],file_description:n[i.MEMBER_ACTION.MAKE_EDITOR]}],[i.MEMBER_ACTION.MAKE_VIEWER,{value:i.ACCESS_LEVEL.READER,title:e[i.ACCESS_LEVEL.READER],folder_description:t[i.MEMBER_ACTION.MAKE_VIEWER],file_description:n[i.MEMBER_ACTION.MAKE_VIEWER]}],[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:i.ACCESS_LEVEL.READER_NO_COMMENT,title:e[i.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:t[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:n[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[i.MEMBER_ACTION.MAKE_OWNER,{value:i.ACCESS_LEVEL.OWNER,title:c("Make owner")}],[i.MEMBER_ACTION.REMOVE,{value:"remove",title:s.createElement("div",{className:"u-font-danger"},r)}]]},t.prototype.renderMenuItem=function(e){var t=this,n=e.value,r=e.title,i=e.file_description,l=e.folder_description,d=null;d=this.props.contentInfo&&this.props.contentInfo.isFolder()?l:i;var c=null;n!==this.props.currentAccess&&(c=function(){return t.props.onAccessChange(n)});var p=null;return n===this.props.currentAccess&&(p=s.createElement(a,{alt:"",group:"web",name:"check_gray"})),s.createElement(o.BubbleMenuItem,{className:"sharing-access-menu-item",key:n,onClick:c},s.createElement("div",{className:"sharing-access-menu-item__left-margin u-l-ib u-l-ib--t"},p),s.createElement("div",{className:"sharing-access-menu-item__label u-l-ib u-l-ib--t"},s.createElement("div",{className:"u-font-nowrap u-font-black sharing-access-menu-item__title"},r),s.createElement("div",{className:"u-font-wrap u-font-meta sharing-access-menu-item__description"},d)))},t.prototype.renderCurrentAccessText=function(e){var t=r({"sharing-access-menu__current-access":!0,"u-font-nowrap":!0,"c-btn--disabled":e,"sharing-access-menu__current-access--button":this.props.asButton,"c-btn":this.props.asButton,"c-btn--secondary":this.props.asButton,"u-trim-margin":this.props.asButton,"c-borderless-button":!this.props.asButton,"change-access-button":!this.props.asButton&&!e}),n=l.ACCESS_NAME[this.props.currentAccess];this.props.canMakeViewerNoComment&&(n=l.ACCESS_NAME_NO_COMMENT[this.props.currentAccess]);var o=null;return e||(o=[s.createElement("div",{className:"gray-arrow",key:"gray"},s.createElement(a,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"})),s.createElement("div",{className:"blue-arrow",key:"blue"},s.createElement(a,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-blue"}))]),s.createElement("button",{className:t},n,o)},t.prototype.render=function(){for(var e=[],t=0,n=this.getMemberActionInfo();t<n.length;t++){var r=n[t],a=r[0],l=r[1];(l.value===this.props.currentAccess||this.props.memberPermissions&&this.props.memberPermissions.get(a)&&this.props.memberPermissions.get(a).allow||l.value===i.MEMBER_ACTION.REMOVE&&this.props.allowRelinquishMembership)&&e.push(this.renderMenuItem(l))}if(e.length<=1||this.props.pendingAccessChange)return this.renderCurrentAccessText(!0);var d=0;return this.props.asButton&&(d=-5),s.createElement(o.BubbleMenu,{targetButton:this.renderCurrentAccessText(this.props.disabled||!1),targetFixed:!0,position:o.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-access-menu o-list-ui o-list-ui--dividers",items:e,shouldShowArrow:!1,disabled:this.props.disabled,verticalDisplacement:d})},t})(s.Component);p.displayName="SharingBubbleMenu",p.defaultProps={allowRelinquishMembership:!1,asButton:!1,canInviteMembers:!1,canMakeViewerNoComment:!1,disabled:!1,pendingAccessChange:void 0},t.SharingBubbleMenu=p}),define("modules/clean/sharing/views/viewer_info",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));var t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}return e.prototype.displayName=function(){return this.display_name},e.prototype.memberId=function(){return""},e})();t.ViewerInfo=n}),define("modules/clean/sharing/views/viewer_list_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/clean/sharing/views/member_list_item","modules/clean/sharing/ui_util","modules/clean/sharing/views/viewer_info","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(s.Modal,{autoclose:!1,className:"viewer-list-modal",buttonComponent:r.createElement("span",null),onDismissCompleted:this.props.onCancel,title:this.modalTitle()},this.createMemberList())},t.prototype.modalTitle=function(){return this.props.groupName?l._("Members of %(group_name)s who viewed").format({group_name:this.props.groupName}):l._("People who viewed this link")},t.prototype.createMemberList=function(){var e=this.props.seenStateInfo.map(function(e){return new i.ViewerInfo(e)}),t=a.makeMemberSortCmp(this.props.user,this.props.presentAccountIds,!0);return e.sort(t),r.createElement("div",{className:"sharing-member-list"},r.createElement("ul",{className:"o-list-ui u-trim-margin"},e.map(this.renderMemberListItem.bind(this))))},t.prototype.renderMemberListItem=function(e){return r.createElement(o.SharingMemberListItem,{canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,contentInfo:this.props.contentInfo,disabled:!1,isMemberActionPending:!1,isPresent:this.props.presentAccountIds.has(e.account_id),isViewOnly:!0,key:e.account_id,member:e,user:this.props.user})},t})(r.Component);t.ViewerListModal=d}),define("modules/clean/sharing/views/wrapped_group_viewers_maker",["require","exports","external/react","modules/clean/datetime","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,s,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.i18n_default_project("sharing"),d=l._,c=l.ungettext;(function(e){function t(e,t){for(var r=c("%(num_viewers)d viewer","%(num_viewers)d viewers",e.length).format({num_viewers:e.length}),s=e.length<=10,a=s?e.length:9,l=i(e[0],t),d=1;d<a;d++)l=l.concat(n.createElement("br",null),i(e[d],t));if(!s){var p=e.length-a,u=c("and %(num_others)d other","and %(num_others)d others",p).format({num_others:p});l=l.concat(n.createElement("br",null),n.createElement("span",{className:"group-tooltip__member-name"},u))}return{element:n.createElement(o,{content:n.createElement("div",null,l),className:"group-tooltip",children:n.createElement("span",{className:"u-font-meta sharing-member-info__viewer-count-text"},r),position:o.POSITIONS.BOTTOM,isTargetPositionFixed:!0}),elementText:r}}function i(e,t){var o=t.has(e.account_id)?d("Viewing now"):r.ago(e.time_last_seen,!1);return[n.createElement("span",{className:"group-tooltip__member-name"},s.em_snippet(e.displayName(),a.SNIPPET_SIZES.DISPLAY_NAME)),n.createElement("span",{className:"u-font-meta dot"},"·"),o]}e.make=t})(t.WrappedGroupViewersMaker||(t.WrappedGroupViewersMaker={}))}),define("modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/flag","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/clean/react/tooltip","modules/clean/static_urls","modules/constants/payments","modules/core/i18n"],function(e,t,n,r,s,o,a,i,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=r.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},r.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.handleSubmit},m._("Share anyway")),r.createElement("a",{className:"c-btn c-btn--primary u-mar-left-s",href:e},m._("Add more space")));return r.createElement(a.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return r.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio(),this.renderFooter())},t.prototype.renderRadio=function(){var e=r.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},r.createElement("span",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to create and share a new folder"),this.renderWarningTooltip())),t=r.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return r.createElement("div",{className:"radio-input"},r.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderWarningTooltip=function(){var e=r.createElement(o,{src:p.static_url("/static/images/out-of-space-lp/error-vflis8APx.png"),srcHiRes:p.static_url("/static/images/out-of-space-lp/error@2x-vflgzXrb2.png")}),t=m._("If you create and share a new folder, your contents will not sync to your Dropbox");return r.createElement(c.Tooltip,{tooltip_classname:"exp-shared-folder-wizard__tooltip",position:c.TooltipPosition.TOP,tooltip_contents:t},e)},t.prototype.renderFooter=function(){return r.createElement("div",{className:"exp-shared-folder-wizard__footer u-mar-top-s"},i.reactFormat(m._("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:r.createElement("span",{className:"exp-shared-folder-wizard__footer--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(r.Component);h.defaultProps={user:{},onSubmit:function(){},expProOQCreateSFVariant:"OFF"};var _=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Share a folder from your personal Dropbox"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=r.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},r.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},m._("Continue sharing")),r.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),r.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade now")));return r.createElement(a.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return r.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderHeader(),this.renderRadio())},t.prototype.renderHeader=function(){return r.createElement("div",{className:"exp-shared-folder-wizard__header"},m._("Your Dropbox is full. You currently have 0 MB of personal Dropbox space left.")," ",r.createElement("br",null),m._("What would you like to do?"))},t.prototype.renderRadio=function(){var e=r.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},m._("Create and share a new folder")),r.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},r.createElement("span",{className:"exp-shared-folder-wizard__option-subtext--warning"},m._("If you create and share a new folder, it will not sync to your Dropbox.")))),t=r.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},m._("Share an existing folder")),r.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},m._("If you share an existing folder, you will only be able to view contents."))),n={value:this.state.option,requestChange:this.handleChange};return r.createElement("div",{className:"radio-input"},r.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(r.Component),f=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"existing-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=r.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},r.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},m._("Continue anyway")),r.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),r.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade your plan")));return r.createElement(a.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return r.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu";return r.createElement("div",{className:"exp-shared-folder-wizard__header"},i.reactFormat(m._("You have 0 MB of personal Dropbox space left. If you create and share a new folder, it will not sync to your Dropbox. <a>Upgrade your plan to sync more shared folders.</a>"),{a:r.createElement("a",{href:e,"aria-label":m._("Link to upgrade page")})}))},t.prototype.renderRadio=function(){var e=r.createElement("div",{className:"c-radio-wrapper u-pad-m"},r.createElement("input",{disabled:!0,type:"radio",value:"new-folder",id:"radio-existing-folder-disabled","aria-checked":"false"}),r.createElement("label",{className:"c-radio-content",htmlFor:"radio-existing-folder-disabled"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title--disabled u-l-ib u-pad-left-xs"},m._("I’d like to create and share a new folder")))),t=r.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return r.createElement("div",{className:"radio-input"},r.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(r.Component),g=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent(),"new-folder"===this.state.option&&this.renderUpsell())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=r.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"
},"new-folder"===this.state.option?r.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade your plan")):r.createElement("button",{className:"c-btn c-btn--primary",onClick:this.handleSubmit},m._("Next")));return r.createElement(a.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return r.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){return r.createElement("div",{className:"exp-shared-folder-wizard__header--V6"},m._("What do you want to do?"))},t.prototype.renderRadio=function(){var e=r.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("Create and share a new folder"))),t=r.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},r.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("Share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return r.createElement("div",{className:"radio-input"},r.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderUpsell=function(){return r.createElement("div",{className:"exp-shared-folder-wizard__footer-upsell"},i.reactFormat(m._("<warning>Your Dropbox is out of space.</warning> If you try to create and share a new folder, you will not be able to add new content to your Dropbox. Upgrade your plan to get more space."),{warning:r.createElement("span",{className:"exp-shared-folder-wizard__footer-upsell--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(r.Component);t.ExpShareAFolderWizardModalV3=s(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV4=s(_,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV5=s(f,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV6=s(g,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"])}),function(){var e=function(e,n){function r(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/flag","modules/clean/react/image","modules/clean/react/input","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/core/i18n","modules/clean/user","modules/clean/static_urls","modules/clean/viewer"],function(t,n,r,s,o,a,i,l,d,c,p,u){var m,h,_,f,g,y,v,b,w,S,E,I;return o.text,E=a.reactFormat,_=i.Modal,f=l.RadioGroup,g=l.RadioItem,y=l.RadioItemVariant,I=p.static_url,w=t.createElement,S=t.DOM,b=d.i18n_default_project("sharing")._,v=t.createClass({displayName:"ShareAFolderWizardModal",propTypes:{onSubmit:t.PropTypes.func,user:t.PropTypes.instanceOf(c).isRequired},getInitialState:function(){return{option:"new-folder"}},render:function(){return w(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:S.span(),title:function(){switch(this.props.user.role){case"work":return b("Share a folder from your %(team_name)s Dropbox").format({team_name:u.get_viewer().team_name});case"personal":return b("Share a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return S.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderButtons())},_renderHeader:function(){return S.div({className:"shared-folder-wizard__header u-mar-bottom-s"},b("What would you like to do?"))},_renderRadio:function(){var e;return e={value:this.state.option,requestChange:this._handleChange},S.div({className:"radio-input"},w(f,{variant:y.Normal,legend:b("Share a Folder options"),displayLegend:!1,valueLink:e},this._renderRadioItems()))},_renderRadioItems:function(){var e,t;return t=w(g,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},S.div({className:"new-folder_title u-l-ib u-pad-left-xs"},b("I’d like to create and share a new folder"))),e=w(g,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},S.div({className:"existing-folder_title u-l-ib u-pad-left-xs"},b("I’d like to share an existing folder"))),[t,e]},_handleChange:function(e){return this.setState({option:e})},_renderButtons:function(){return S.div({className:"u-mar-top-m clearfix"},S.div({className:"u-l-fr"},S.button({className:"c-btn c-btn--primary",onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},b("Next"))))}}),m=(function(t){function n(e,t,r){n.__super__.constructor.call(this,e,t,r),this.state.showInterstitial=!0}return e(n,t),n.prototype.render=function(){return this.state.showInterstitial?w(_,{autoClose:!1,className:"shared-folder-wizard-interstitial",buttonComponent:S.span(),title:b("Your Dropbox is full")},this._renderInterstitial()):n.__super__.render.call(this)},n.prototype._renderInterstitial=function(){return S.div({className:"shared-folder-wizard-interstitial"},S.div({className:"shared-folder-wizard-interstitial__content"},S.div({className:"shared-folder-wizard-interstitial__header"},E(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:S.span({className:"shared-folder-wizard-interstitial__header--warning"})})),S.div({className:"shared-folder-wizard-interstitial__body"},b("If you create and share a new folder, you can add contents, but it will not sync to your Dropbox."))),S.div({className:"shared-folder-wizard-interstitial__image"},w(s,{src:I("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),w(r.Flag,{spacing:"s",rightAttachment:S.div({className:"shared-folder-wizard-interstitial__buttons u-mar-top-l"},S.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.setState({showInterstitial:!1})}})(this)},b("Share anyway")),S.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},n})(v),h=(function(t){function n(e,t,r){n.__super__.constructor.call(this,e,t,r)}return e(n,t),n.prototype.render=function(){return w(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:S.span(),title:b("Share a folder from your personal Dropbox")},this._renderContentV2())},n.prototype._renderContentV2=function(){return S.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderUpsell())},n.prototype._renderUpsell=function(){return S.div({className:"shared-folder-wizard-upsell u-mar-top-l"},S.div({className:"shared-folder-wizard-upsell__content"},S.div({className:"shared-folder-wizard-upsell__header"},E(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:S.span({className:"shared-folder-wizard-upsell__header--warning"})})),S.div({className:"shared-folder-wizard-upsell__body"},"If you create and share a new folder, you can add contents, but it will not sync to your Dropbox.")),S.div({className:"shared-folder-wizard-upsell__image"},w(s,{src:I("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),w(r.Flag,{spacing:"s",rightAttachment:S.div({className:"shared-folder-wizard-upsell__buttons u-mar-top-l"},S.button({className:"c-btn c-btn--secondary"},b("Share anyway")),S.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},n})(v),v=n(v,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),m=n(m,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),h=n(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),{ShareAFolderWizardModal:v,ExpShareAFolderWizardModalV1:m,ExpShareAFolderWizardModalV2:h}})}.call(this),function(){define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/tree_view","modules/core/i18n","modules/clean/user","modules/clean/viewer"],function(e,t,n,r,s,o,a,i){var l,d,c,p,u,m;return n.text,d=r.Modal,l=s.FolderTreeView,u=e.createElement,m=e.DOM,p=o.i18n_default_project("sharing")._,c=e.createClass({displayName:"ShareExistingFolderWizardModal",propTypes:{onBack:e.PropTypes.func,onSubmit:e.PropTypes.func,user:e.PropTypes.instanceOf(a).isRequired},getInitialState:function(){return{folderPath:null,errorMsg:null}},render:function(){return u(d,{autoClose:!1,className:"existing-shared-folder-wizard",buttonComponent:m.span(),onDismissCompleted:function(){return d.close()},title:function(){switch(this.props.user.role){case"work":return p("Choose a folder from your %(team_name)s Dropbox").format({team_name:i.get_viewer().team_name});case"personal":return p("Choose a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return m.form({className:"existing-shared-folder-wizard__contents",onSubmit:(function(e){return function(){return e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},this._renderError(),this._renderTreeView(),this._renderButtons())},_renderError:function(){var e;if(null!=this.state.folderPath&&(null!=(e=this.state.errorMsg)?e.length:void 0)>0)return m.div({className:"text-input-error-wrapper"},m.div({className:"text-input-error-text u-font-danger"},this.state.errorMsg))},_renderTreeView:function(){return m.div({className:"wizard-tree-view"},u(l,{user:this.props.user,onFolderSelected:this._setFolderPath,ref:"treeView"}))},_renderButtons:function(){return m.div({className:"u-mar-top-m clearfix"},m.div({className:"u-l-fr"},m.button({className:"c-btn c-btn--primary",disabled:!this._isValid(),onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},p("Next"))),m.div({className:"u-l-fl"},m.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:(function(e){return function(t){var n,r;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),d.close(),"function"==typeof(r=e.props).onBack?r.onBack():void 0}})(this)},p("Back"))))},_setFolderPath:function(e){return this.setState({folderPath:e,errorMsg:null})},_setError:function(e){var t;return this.setState({errorMsg:null!=e&&null!=(t=e.path)?t.message_text:void 0})},_isValid:function(){return null!=this.state.folderPath&&null==this.state.errorMsg}}),c=t(c,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),{ShareExistingFolderWizardModal:c}})}.call(this),function(){var e=[].slice;define("modules/clean/sharing/wizard/wizard_modals",["external/react","modules/core/notify","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","modules/constants/browse","modules/clean/sharing/constants","modules/clean/sharing/share_modal_util","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal"],function(t,n,r,s,o,a,i,l,d,c,p,u,m,h){var _,f,g,y,v,b,w,S,E,I,C,N,M,P,T,k,A,x,F;return _=r.EmailVerification,N=o.SharingExperimentsLogger,S=i.Modal,C=l.SharingApi,M=c.TRUELINK,P=p.generateModalSessionId,k=p.showNewFolderShareModal,F=p.showShareModal,I=u.ShareExistingFolderWizardModal,E=m.ShareAFolderWizardModal,f=m.ExpShareAFolderWizardModalV1,g=m.ExpShareAFolderWizardModalV2,y=h.ExpShareAFolderWizardModalV3,v=h.ExpShareAFolderWizardModalV4,b=h.ExpShareAFolderWizardModalV5,w=h.ExpShareAFolderWizardModalV6,T=function(e,t,r,s){var o,i,l;return l=function(){if(!F(e,{fqPath:t,isFolder:!0,exists:!0,origin:"WIZARD",shouldFetchNsId:!0,modalSessionId:null!=s?s:void 0}))throw new Error("Tiburon UI must be allowed")},o=function(e){var t;if(t=a.extract_errors(e.responseText),t!==!1)return"string"==typeof t?n.error(t):"function"==typeof r?r(t):void 0},M.TRUELINK_UI[e.id]?l():(i=new C(e),i.validate_shareable_existing_sf_path(t,l,o))},x=function(n,r,s){return null!=s&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),S.showInstance(t.createElement(I,{user:n,onBack:r,onSubmit:function(t,r){var o;return o=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],null!=s&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:s}),r.apply(null,t)},null!=s&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),T(n,t,o)}}))},A=function(e){var n,r,o;if(_.get_for_user(e).verified_or_show(s.SHARE_FOLDER))return o=P(),N.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:o}),n=d.EXP_SUBGROWTH_PRO_OQ_CREATE_SF,r=(function(){switch(n){case"V1":return f;case"V2":return g;case"V3":return y;case"V4":return v;case"V5":return b;case"V6":return w;default:return E}})(),S.showInstance(t.createElement(r,{user:e,onSubmit:function(t){return null!=o&&N.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:t,modalSessionId:o}),"new-folder"===t?k(e,o,e.cdm_tmf_path):"existing-folder"===t?x(e,A.bind(this,e,o),o):void 0},expProOQCreateSFVariant:n})),o},{shareExistingFolder:T,showShareAFolderWizardModal:A}})}.call(this),define("modules/clean/teams/admin/api/admin_console_api_client",["require","exports","modules/clean/api_v2/client","modules/clean/filepath","modules/clean/sharing/api/util/types","modules/clean/viewer"],function(e,t,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){void 0===e&&(e=!1);var t=o.get_viewer();t.work_user&&(this.teamMemberId=t.work_user.team_member_id),this.userId=t.get_uid_by_role("work"),this.rpcClient=new n.TeamActionsClient,this.isCMForCDM=e}return e.prototype.setPermanentDeletePolicy=function(e){var t={permanent_delete_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_permanent_delete_policy",t)},e.prototype.setMultipleAccountsPolicy=function(e){var t={multiple_accounts_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_multiple_accounts_policy",t)},e.prototype.setFileRequestPolicy=function(e){var t={file_request_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_file_request_policy",t)},e.prototype.setOfficeAddInPolicy=function(e){var t={office_addin_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_office_addin_policy",t)},e.prototype.setSharedLinkPolicy=function(e,t){var n={sharing_outside_enabled:e};1==e&&(n.default_visibility=t);return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_link_policy",n)},e.prototype.setSharedFolderSharingPolicy=function(e){var t={sharing_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_sharing_policy",t)},e.prototype.setSharedFolderJoiningPolicy=function(e){var t={joining_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_joining_policy",t)},e.prototype.setCommentingPolicy=function(e){var t={commenting_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_commenting_policy",t)},e.prototype.setPasswordStrength=function(e,t){var n="enabled"===e?t:"minimal_requirements",r={password_strength_policy:n};return this.rpcClient.rpc(this.userId,"team/set_password_requirements",r)},e.prototype.resetAllPasswords=function(){return this.rpcClient.rpc(this.userId,"team/reset_all_passwords")},e.prototype.setPaperPolicy=function(e,t,n,r){var s={paper_enabled:e};t&&(s.dropbox_terms="agree");var o={paper_deployment_type:n,enabled_members_update:{users_to_add:this.make_user_selector_list(r.users_to_add),users_to_remove:this.make_user_selector_list(r.users_to_remove)}};s.paper_deployment_mode=o;return this.rpcClient.rpc(this.userId,"team/paper/set_paper_policy",s)},e.prototype.setPaperSharingPolicy=function(e,t){var n={external_sharing_allowed:void 0===e||e,default_visibility:t};return this.rpcClient.rpc(this.userId,"team/paper/set_paper_sharing_policy",n)},e.prototype.setRequestMembershipPolicy=function(e){var t={request_membership:e};return this.rpcClient.rpc(this.userId,"team/set_request_membership_policy",t)},e.prototype.setSuggestMembersPolicy=function(e){var t={suggest_members_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_suggest_members_policy",t)},e.prototype.deviceManagementGetExcludedUsers=function(){return this.rpcClient.rpc(this.userId,"team/device_management/get_excluded_users",null)},e.prototype.deviceManagementUpdateExcludedUsers=function(e,t){var n={users_to_add:e,users_to_remove:t};return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",n)},e.prototype.deviceManagementConfigureSettings=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.mapValueToRolloutMethod=function(e){return 0===e?"unlink_all":1===e?"unlink_most_inactive":"add_member_to_exceptions"},e.prototype.deviceManagementConfigureSettingsForAcf=function(t,n,r,s,o){var a={is_enabled:!0,can_user_remove_device:n,rollout_method:{".tag":e.mapValueToRolloutMethod(o)},users_to_add:t.users_to_add,users_to_remove:t.users_to_remove};a.desktop_devices_limit=r==-1?{".tag":"unlimited"}:{limited:Number(r),".tag":"limited"},a.mobile_devices_limit=s==-1?{".tag":"unlimited"}:{limited:Number(s),".tag":"limited"};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",a)},e.prototype.deviceManagementExclusionList=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",e)},e.prototype.deviceManagementConfigureSettingsDisable=function(){var e={is_enabled:!1};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.prototype.deviceManagementRemoveDevice=function(e,t,n){var r={user_id:e,device_id:t,delete_data:n};return this.rpcClient.rpc(this.userId,"team/device_management/remove_device",r)},e.prototype.deviceManagementRemoveClient=function(e,t,n,r){var s={user_id:e,device_id:t,client_unique_identifier:n,delete_data:r};return this.rpcClient.rpc(this.userId,"team/device_management/remove_client",s)},e.prototype.webSessionManagementConfigureSettings=function(e,t){var n={remember_session_expires:e,idle_session_timeout:t};return this.rpcClient.rpc(this.userId,"team/web_session_management/configure_settings",n)},e.prototype.teamFolderArchive=function(e,t){void 0===t&&(t=!1);var n={team_folder_id:String(e),force_async_off:!t};return this.rpcClient.rpc(this.userId,"team/team_folder/archive",n)},e.prototype.teamFolderUnarchive=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/activate",t)},e.prototype.teamFolderCreate=function(e){var t={name:e};return this.rpcClient.rpc(this.userId,"team/team_folder/create",t)},e.prototype.teamFoldersList=function(e){void 0===e&&(e=1e3);var t={limit:e};return this.rpcClient.rpc(this.userId,"team/team_folder/list",t)},e.prototype.teamFolderRename=function(e,t){var n={team_folder_id:String(e),name:t};return this.rpcClient.rpc(this.userId,"team/team_folder/rename",n)},e.prototype.teamFolderPermanentlyDelete=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/permanently_delete",t)},e.prototype.setGroupsCreationPolicy=function(e){var t={group_creation:e};return this.rpcClient.rpc(this.userId,"team/groups/set_creation_policy",t)},e.prototype.setNTSBlockTrafficPolicy=function(e){var t={block_traffic_enabled:e};return this.rpcClient.rpc(this.userId,"team/nts/set_block_traffic_policy",t)},e.prototype.configureSso=function(e,t,n,r,s){var o={sso_policy:e,saml_cert:t,sign_in_url:n,sign_out_url:r,nameid_format:s};return this.rpcClient.rpc(this.userId,"team/configure_sso",o)},e.prototype.configureGoogleLoginPolicy=function(e){var t={google_login_enabled:e};return this.rpcClient.rpc(this.userId,"team/configure_google_login_policy",t)},e.prototype.setResellerSupportSetting=function(e){var t={reseller_support_enabled:e};return this.rpcClient.rpc(this.userId,"team/change_reseller_support",t)},e.prototype.folderCreate=function(e,t,n){"/"!=t&&(t+="/");var r="ns:"+e+t+n,s={path:r},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/create_folder",s,o)},e.prototype.bulkFileDelete=function(e){for(var t=[],n=null,r=0,s=e.length;r<s;r++)n=e[r],t.push({path:"ns:"+n.ns_id+n.ns_path});var o={entries:t},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/delete_batch_with_changeset_sync",o,a)},e.prototype.fileRename=function(e,t,n){var r="ns:"+e+t,s=t.substring(0,t.lastIndexOf("/"))+"/"+n,o="ns:"+e+s,a={from_path:r,to_path:o,autorename:!0},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move",a,i)},e.prototype.shareFolder=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var o="ns:"+e+t,a=s.combinedPolicyDiffToApi(n);a.path=o,a.confidentiality=r?"confidential":"not_confidential";var i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/alpha/share_folder",a,i)},e.prototype.validateFolderPath=function(e,t,n,r){var s="ns:"+e+t,o={path:s,actions:n,list_members_arg:r},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/validate_folder_path",o,a)},e.prototype.restoreFile=function(e,t,n){var r="ns:"+e+t,s={path:r,rev:n},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/restore",s,o)},e.prototype.permanentDeleteFile=function(e,t){var n="ns:"+e+t,r={path:n},s={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/permanently_delete",r,s)},e.prototype.listRevisions=function(e,t){var n="ns:"+e+t,r={path:n},s={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/list_revisions",r,s)},e.prototype.setTSDWritePolicy=function(e){var t={is_writable:e};return this.rpcClient.rpc(this.userId,"team/team_folder/set_tsd_writable_setting",t)},e.prototype.setInfinitePolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_infinite_policy",t)},e.prototype.setSmartSyncDesktopPolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_smart_sync_desktop_policy",t)},e.prototype.getTeamFolderNsPathForFile=function(e){return this.isCMForCDM?e.fq_path:"/"+e.fq_path.split("/").slice(2).join("/")},e.prototype.bulkFileMove=function(e,t,n){for(var s,o,a=[],i=null,l=0,d=t.length;l<d;l++)s=t[l],i=this.getTeamFolderNsPathForFile(s),o=r.filename(s.fq_path),a.push({from_path:"ns:"+e+i,to_path:"ns:"+e+n+"/"+o});var c={entries:a,autorename:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move_batch_sync",c,p)},e.prototype.bulkFileCopy=function(e,t,n){for(var s,o,a=[],i=null,l=0,d=t.length;l<d;l++)s=t[l],i=this.getTeamFolderNsPathForFile(s),o=r.filename(s.fq_path),a.push({from_path:"ns:"+e+i,to_path:"ns:"+e+n+"/"+o});var c={entries:a,autorename:!0,allow_shared_folder:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/copy_batch_sync",c,p)},e.prototype.setMemberSpaceLimits=function(e){var t={limit_level:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_default_limit",t)},e.prototype.setMslCapsType=function(e){var t={caps_type:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_caps_type",t)},e.prototype._create_user_selector_json=function(e){return{".tag":"email",email:e}},e.prototype.make_user_selector_list=function(e){return void 0===e&&(e=[]),e.map(this._create_user_selector_json)},e.prototype.memberSpaceLimitsUpdateExclusionList=function(e){var t=this.make_user_selector_list(e.users_to_add),n=this.make_user_selector_list(e.users_to_remove);return this.rpcClient.rpc(this.userId,"team/member_space_limits/update_excluded_users",{users_to_add:t,users_to_remove:n})},e.prototype.listAllMembers=function(e,t){void 0===t&&(t=null);var n={shared_folder_id:String(e)};t&&(n.path=t);var r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/list_all_members",n,r)},e.prototype.teamFolderGetAccessPoints=function(e,t,n){var r={dropbox_id:e,team_folder_id:String(t),path:n};return this.rpcClient.rpc(this.userId,"team/team_folder/get_access_points",r)},e.prototype.teamFolderGetFileMetadata=function(e,t){void 0===t&&(t=null);var n={team_folder_id:String(e)};return t&&(n.path=t),this.rpcClient.rpc(this.userId,"team/team_folder/get_file_metadata",n)},e.prototype.getUserInfos=function(e){var t={account_ids:e},n={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"users/get_account_batch",t,n)},e.prototype.emmConfigureSettings=function(e,t){var n=this,r={};["users_to_add","users_to_remove"].forEach(function(e){return r[e]=n.make_user_selector_list(t[e])});var s={emm_policy:{".tag":e},exclusion_list:r};return this.rpcClient.rpc(this.userId,"team/emm/configure_settings",s)},e.prototype.emmRefreshToken=function(){return this.rpcClient.rpc(this.userId,"team/emm/refresh_token")},e.prototype.emmGenerateUsageReport=function(){var e={report_type:"mobile_app_usage"};return this.rpcClient.rpc(this.userId,"team/emm/generate_report",e)},e})();t.AdminConsoleApiClient=a,t.default=a}),function(){define("modules/clean/teams/membership_discovery_util",["modules/clean/ajax","modules/clean/loggers/growth_features_events_logger","modules/clean/react/modal","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,s,o,a,i){var l,d,c,p,u,m,h,_,f;return l=r.TRADEMARK_BUSINESS,d=o._,f=o.ungettext,p=function(t,n){return e.WebRequest({url:"/team/discover/get_discoverable_team_for_folder",type:"POST",data:{ns_id:t},success:function(e){return e=JSON.parse(e),n(null!=e?e.team:void 0)},error:function(){return n()}})},h=function(t,n){return e.WebRequest({url:"/team/discover/join_ajax",data:{team_id:t,cont:"#"},success:function(e){switch(e=JSON.parse(e),null!=e?e.result:void 0){case"request_sent":a.success(d("Request to join sent."));break;case"can_join":s.redirect(e.url);break;case"max_team_size_achieved":a.error(d("This team has reached the maximum size. Please ask the admins of this team to upgrade to %(trademark_business)s, which allows teams to add as many members as possible.").format({trademark_business:l}));break;case"pending_approval":a.success(d("Your request to join is pending."));break;default:a.error(d("Invalid request"))}return"function"==typeof n?n(e):void 0},error:function(){return a.error(d("Error sending request.")),"function"==typeof n?n():void 0}})},m=function(t,n,r){return e.WebRequest({url:"/account/team/add_users",subject_user:n,data:{emails:t,team_id:r},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=f("Invitation sent.","Invitations sent.",e.num_invited),a.success(t)},error:function(){var e;return e=f("Error sending invitation.","Error sending invitations.",t.length),a.error(e)}})},u=function(r,o,l,c){return e.WebRequest({url:"/account/team/add_users",subject_user:o,data:{emails:r,team_id:l},success:function(e){var n,s;if(n={subject_user_id:o.id,team_id:l,num_suggested_users:r.length},t.logMagnetEvent("send_admin_invite_ajax_success",n),e=JSON.parse(e),e.num_invited)return s=f("Invitation sent.","Invitations sent.",e.num_invited),a.success(s)},error:function(e){var a;return a={subject_user_id:o.id,team_id:l,num_suggested_users:r.length,response_text:e.responseText},t.logMagnetEvent("send_admin_invite_ajax_fail",a),e.responseText.includes("You need an additional license to invite this user.")?n.SimpleModal.show({title_text:d("No available licenses"),body_html:d("You don’t have enough available licenses to invite additional members. Please visit the admin console to purchase more licenses."),confirm_text:d("Go to admin console"),confirm_callback:function(){return a={team_id:l,ui_object:"not_enough_licenses_modal"},t.logMagnetEvent("go_to_admin_console_clicked",a),s.redirect(new i({path:"/team/admin/members"}))},cancel_text:d("Not now"),cancel_callback:function(){return a={team_id:l,ui_object:"not_enough_licenses_modal"},t.logMagnetEvent("not_now_clicked",a)}}):_(r,c,function(){return s.redirect(new i({path:"/team/admin/requests",query:{invite_emails:r}}))})}})},_=function(t,n,r,s){return e.WebRequest({url:"/team/discover/suggest_ajax",data:{emails:JSON.stringify(t),ns_id:JSON.stringify(n)},success:function(e){var n;return n=f("Suggestion sent.","Suggestions sent.",t.length),a.success(n),"function"==typeof r?r(e):void 0},error:function(){var e;return e=f("Error sending suggestion.","Error sending suggestions.",t.length),a.error(e),"function"==typeof s?s():void 0}})},c=function(t,n,r){return e.WebRequest({url:"/team/discover/filter_suggestable_ajax",type:"POST",data:{emails:JSON.stringify(t)},success:function(e){return e=JSON.parse(e),"function"==typeof n?n(e):void 0},error:function(){return"function"==typeof r?r():void 0}})},{getDiscoverableTeamForFolder:p,sendAdminTeamInvitations:u,sendTeamRequest:h,sendLimitedTeamInvitations:m,sendTeamSuggestions:_,filterSuggestableUsers:c}})}.call(this),define("modules/clean/teams/modals/create_team_prompt_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,r,s,o,a,i,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;(function(e){e[e.CLICK_CREATE=0]="CLICK_CREATE",e[e.DISMISS=1]="DISMISS",e[e.CLICK_NEXT_TIME=2]="CLICK_NEXT_TIME"})(m||(m={}));var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCreate=function(){var e=t.props.invitedMembers.map(function(e){return e.email}).filter(function(e){return"string"==typeof e&&""!==e}),n=new u({path:"/team",query:{tk:"tib_upsell",invite_members:e.join(",")}});c.redirect(n.toString()),t.logClick(m.CLICK_CREATE)},t.onClickNextTime=function(){l.Modal.close(),t.logClick(m.CLICK_NEXT_TIME)},t.onDismiss=function(){s.WebRequest({url:"/team/stop_show_create_team_modal"}),t.logClick(m.DISMISS)},t}return n.__extends(t,e),t.prototype.logClick=function(e){o.TeamsWebActionsLogger.log("share_crt_team_modal",{num_shared:this.props.invitedMembers.length,clicked_create:e===m.CLICK_CREATE,clicked_nxt_time:e===m.CLICK_NEXT_TIME,dismissed:e===m.DISMISS})},t.prototype.renderButtons=function(){return r.createElement("div",{className:"db-modal-buttons"},r.createElement(a.Button,{className:"dbmodal-button",importance:"primary",onClick:this.onClickCreate},p._("Create free work Dropbox")),r.createElement(a.Button,{className:"dbmodal-button",importance:"tertiary",onClick:this.onClickNextTime},p._("Ask me next time")))},t.prototype.render=function(){for(var e=[],t=0,n=this.props.invitedMembers;t<n.length;t++){var s=n[t]
;s.name&&s.name!==s.email&&e.push(s.name)}var o=p._("Work with these people often?");return 2===e.length&&2===this.props.invitedMembers.length?o=p._("Work with %(firstname_1)s and %(firstname_2)s often?").format({firstname_1:e[0],firstname_2:e[1]}):3===e.length&&3===this.props.invitedMembers.length&&(o=p._("Work with %(firstname_1)s, %(firstname_2)s, and %(firstname_3)s often?").format({firstname_1:e[0],firstname_2:e[1],firstname_3:e[2]})),r.createElement(l.Modal,{style:"clean",className:"create-team-modal-after-sharing",buttonComponent:this.renderButtons(),onDismiss:this.onDismiss,clickOutToClose:!1,showX:!0,width:500},r.createElement("div",null,r.createElement(i,{className:"create-team-modal__team-illo u-mar-top-l",alt:p._("Work together"),src:d.static_url("/static/images/teams/modals/illo_how-create-vfl99WbqQ.png"),srcHiRes:d.static_url("/static/images/teams/modals/illo_how-create@2x-vflvsB25f.png")}),r.createElement("h1",{className:"create-team-modal__header u-mar-top-m u-mar-bottom-s"},o),r.createElement("div",{className:"create-team-modal__subheader"},p._("Get a free 2 GB work Dropbox to organize projects in one place,               collaborate from anywhere, and stay in sync."))))},t})(r.Component);t.CreateTeamPromptModal=h});
//# sourceMappingURL=pkg-sharing.min.js-vfl-kuciZ.map