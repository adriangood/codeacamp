define("modules/clean/appshell/pagelet_init_hooks",["require","exports","modules/core/notify","modules/clean/web_user_action_logger","modules/core/i18n"],function(e,t,r,s,n){"use strict";function o(){window.ensemble&&window.ensemble.switchedAccounts&&(r.success(n._("You have switched to your %(account_name)s account.").format({account_name:window.ensemble.viewer.getActiveUser().displayName.toLocaleLowerCase()})),s.WebUserActionLog.log(window.ensemble.viewer.getActiveUser().userId,s.WebUserActionLogEvents.SWITCH_ACCOUNT,{}))}Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=o}),define("modules/clean/browse_interface",["require","exports","tslib","modules/clean/history","modules/clean/viewer","modules/core/i18n","modules/core/uri"],function(e,t,r,s,n,o,i){"use strict";function a(e){return n.get_viewer().is_paired?"personal"===e.role?E+t.PERSONAL_ROOT:E+t.WORK_ROOT:E+t.HOME_ROOT}function c(e){return n.get_viewer().is_paired?n.get_root_name(e):o._("Files")}function l(){return n.get_viewer().get_users().map(function(e){return{name:c(e),path:a(e)}})}function _(e,t){return new i({scheme:"https",authority:"www.dropbox.com",path:""+a(e)+t})}function u(e,t){return"/"!==t.charAt(0)&&(t="/"+t),new i({scheme:"https",authority:"www.dropbox.com",path:E+"/preview"+t,query:{role:e.role}})}function h(e){E=e}function d(e,t){var s=e.fqPath,n=e.userId,o=r.__assign({},null==t?{}:t,(a={undelete:"1"},a._subject_uid=String(n),a));s=s.replace(/^[\/]/,"");return new i({path:"/history/"+s}).updateQuery(o).toString();var a}function p(e){var t=e.fqPath,r=e.userId,n=(o={prev:i.parse(s.get_url()).setFragment("").toString()},o._subject_uid=String(r),o);return t=t.replace(/^[\/]/,""),new i({path:"/restore/"+t}).updateQuery(n).toString();var o}Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_ROOT="/home",t.WORK_ROOT="/work",t.PERSONAL_ROOT="/personal";var E="";t.get_browse_root=a,t.get_browse_root_name=c,t.get_all_browse_roots=l,t.browse_uri_for_fq_path=_,t.preview_uri_for_fq_path=u,t.set_base_prefix=h,t.getFileHistoryUrl=d,t.getRestoreFileUrl=p}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";function s(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),s=0,n=r;s<n.length;s++){var o=n[s],i=Object.getOwnPropertyDescriptor(e,o);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,o,i)):t[o]=e[o]}return t}function n(e,t){var n=s(e);return t(n),r(n)}function o(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function i(e,t,n){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===n)return e;var o=s(e);return o[t]=n,r(o)}function a(e,t,r){return i(e,t,r(e[t]))}function c(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var s=t[0];return 1===t.length?a(e,s,r):i(e,s,c(e[s],t.slice(1),r))}function l(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var s=t[0];switch(t.length){case 1:return i(e,s,r);default:return i(e,s,l(e[s]||{},t.slice(1),r))}}function _(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var n=Object.keys(t).reduce(function(r,s){return t[s]!==e[s]&&r.push(s),r},[]);if(n.length){for(var o=s(e),i=0,a=n;i<a.length;i++){var c=a[i];Object.defineProperty(o,c,Object.getOwnPropertyDescriptor(t,c))}return r(o)}return e}function u(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return c(e,t,function(e){return _(e,r)})}function h(e,t,s){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var i=E.call(e);return i.splice.apply(i,[t,s].concat(n)),r(i)}function d(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var n=E.call(e);return n.unshift.apply(n,t),r(n)}function p(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var n=E.call(e);return n.push.apply(n,t),r(n)}Object.defineProperty(t,"__esModule",{value:!0});var E=Array.prototype.slice;t.thaw=s,t.withMutations=n,t.getIn=o,t.set=i,t.update=a,t.updateIn=c,t.setIn=l,t.merge=_,t.mergeIn=u,t.splice=h,t.unshift=d,t.push=p}),function(){define("modules/clean/profiling",["external/react","modules/clean/web_timing_logger"],function(e,t){var r,s;return r=e.DOM,s=e.createClass({render:function(){return r.div({},"Hello!")},componentDidMount:function(){return t.mark_time_to_interactive()}}),{hello_component:s}})}.call(this),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.PendingInitialRequest=1]="PendingInitialRequest",e[e.NotLive=2]="NotLive",e[e.Live=3]="Live"})(t.BrowseBoltClientStatus||(t.BrowseBoltClientStatus={})),t.BrowseActionTypes={INITIALIZE_EVERYTHING:"INITIALIZE_EVERYTHING",LOAD_PATH:"LOAD_PATH",ADD_FILES:"ADD_FILES",ADD_FILES_AND_SET_LOADING_STATE:"ADD_FILES_AND_SET_LOADING_STATE",SET_PATH:"SET_PATH",SET_USER:"SET_USER",SET_URL_PREFIX:"SET_URL_PREFIX",SET_LOADING_STATE:"SET_LOADING_STATE",SET_MOUNT_POINTS:"SET_MOUNT_POINTS",SET_TEAM_FOLDERS:"SET_TEAM_FOLDERS",CHANGE_FILES:"CHANGE_FILES",SET_SELECTION:"SET_SELECTION",SELECT_FILES_BY_FQ_PATH:"SELECT_FILES_BY_FQ_PATH",SET_SHOULD_SHOW_DELETED_FILES:"SET_SHOULD_SHOW_DELETED_FILES",SET_DROP_TARGET:"SET_DROP_TARGET",SORT_FILES:"SORT_FILES",SET_COPY_MODE:"SET_COPY_MODE",COPY_SELECTED_FILES_TO_CLIPBOARD:"COPY_SELECTED_FILES_TO_CLIPBOARD",REQUEST_NEW_FILE_NAME:"REQUEST_NEW_FILE_NAME",CANCEL_FILE_RENAME:"CANCEL_FILE_RENAME",SET_FILE_RENAME_PENDING:"SET_FILE_RENAME_PENDING",SET_FILE_RENAME_COMPLETE:"SET_FILE_RENAME_COMPLETE",REQUEST_FOLDER_NAME:"REQUEST_FOLDER_NAME",CREATE_FOLDER_PENDING:"CREATE_FOLDER_PENDING",CREATE_FOLDER_COMPLETE:"CREATE_FOLDER_COMPLETE",CANCEL_CREATE_FOLDER:"CANCEL_CREATE_FOLDER",SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:"SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",TEAM_FOLDER_DOWNGRADE:"TEAM_FOLDER_DOWNGRADE",ADD_COMMENT_STATUS_BATCH:"ADD_COMMENT_STATUS_BATCH",ADD_FILE_JUMP_KEY_CODE:"ADD_FILE_JUMP_KEY_CODE",RESET_FILE_JUMP:"RESET_FILE_JUMP",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",SET_CONTEXT_FILE:"SET_CONTEXT_FILE",FETCH_FOLDER_SIZES_COMPLETE:"FETCH_FOLDER_SIZES_COMPLETE"},t.NewFolderCreationStates={CREATE_FOLDER_INACTIVE:"CREATE_FOLDER_INACTIVE",PENDING_INPUT:"PENDING_INPUT",SAVING_INPUT:"SAVING_INPUT"},t.LoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_REMAINING_PAGES:"LOADING_REMAINING_PAGES"},t.Direction={UP:"UP",DOWN:"DOWN"};(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={})),t.REACT_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container",t.BrowseSortFields={FILENAME:"FILENAME",MODIFIED:"MODIFIED",CATEGORY:"CATEGORY",EXTENSION:"EXTENSION",SIZE:"SIZE",SHARED_WITH:"SHARED_WITH"},t.SortDirections={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},t.DropTargetHighlightMode={NONE:"NONE",ALL_FOLDERS:"ALL_FOLDERS",NONSELECTED_FOLDERS:"NONSELECTED_FOLDERS",NONSELECTED_NONSHARED_FOLDERS:"NONSELECTED_NONSHARED_FOLDERS",NONSELECTED_NONSHARED_NONTEAM_FOLDERS:"NONSELECTED_NONSHARED_NONTEAM_FOLDERS"};var s={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};t.BrowseTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.ItemTypes={CREATE_FOLDER_UI:"CreateFolderUI",LOADING_INDICATOR:"LoadingIndicator"},t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive"),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link"),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK"),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var n=0,o=Object.keys(s);n<o.length;n++)for(var i=o[n],a=s[i],c=0,l=a;c<l.length;c++){var _=l[c];t.ExtensionCategories[_]=i}t.RenameStates={PENDING_INPUT:"pending-input",SAVING_INPUT:"saving-input"};(function(e){e[e.NONE=-1]="NONE",e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(t.MouseEventButton||(t.MouseEventButton={}));(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(t.ShareFolderModalTypes||(t.ShareFolderModalTypes={})),t.SharedWithActionTypes={SET_SHARED_FOLDER_DATA:"SET_SHARED_FOLDER_DATA",SET_MEMBER_COUNTS_FOR_NS:"SET_MEMBER_COUNTS_FOR_NS",SET_SHARED_LINK_DATA:"SET_SHARED_LINK_DATA",SET_SHARED_FILE_DATA:"SET_SHARED_FILE_DATA",SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:"SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",CLEAR_SHARED_FOLDER_DATA_FOR_NS:"CLEAR_SHARED_FOLDER_DATA_FOR_NS",REMOVE_SHARED_LINK_DATA:"REMOVE_SHARED_LINK_DATA"},t.SEARCH_PREFIX="/search",t.ViewTypes={Grid:"GRID_VIEW",List:"LIST_VIEW"}}),define("modules/clean/react/browse/models",["require","exports","tslib","external/deep-freeze","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/react/browse/constants","modules/clean/sharing/constants","modules/constants/legacy","modules/clean/display_format"],function(e,t,r,s,n,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(){function e(e){this.ago=e.ago,this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_camera_uploads=e.is_camera_uploads,this.is_confidential_folder=e.is_confidential_folder,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_public_folder=e.is_public_folder,this.is_unmounted=e.is_unmounted,this.last_modified_fname=e.last_modified_fname,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.request_id=e.request_id,this.revision_id=e.revision_id,this.size=e.size,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_container=e.video_container,this.video_transcode_url=e.video_transcode_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.isDeleted=!!e.isDeleted,s(this)}return e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.merge=function(e){return n.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":o.file_extension(o.filename(e.fq_path))},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var s;if(t.is_dir)switch(s="FOLDER",t.type){case i.FileTypes.TEAM_SHARED_FOLDER:s="TEAM_SHARED_FOLDER";break;case i.FileTypes.SHARED_FOLDER:s="SHARED_FOLDER";break;case i.FileTypes.SANDBOX:s="SANDBOX";break;case i.FileTypes.TEAM_MEMBER_FOLDER:s="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(s="SHARED_FOLDER")}else s=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[s]:i.DeletedFileTypeCategoryTranslations[s]:r?i.FileTypeCapitalizedCategoryTranslations[s]:i.FileTypeCategoryTranslations[s]},e.isTeamSharedFolder=function(e){return e.type===i.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===i.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_edit")<0},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_view")<0},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.areEqual=function(e,t){return e.ns_id===t.ns_id&&e.sjid===t.sjid},e.revisionKey=function(e){return e.ns_id+":"+e.sjid},e.prototype.updateSize=function(e){return this.merge({bytes:e,size:l.format_bytes(e)})},e})();t.File=_;var u=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=u;var h=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,n=t.currentNSID,o=t.currentFQPath,i=t.currentMountPoint,l=t.currentNSPath,_=t.currentSharedFolderPermissionRole,h=t.currentNSAllowsNesting,d=t.inactiveNSIDByFQPath,p=t.permanentDeletionDisabledStateByNSID,E=t.isInFolderMode,S=t.isCurrentlyInRoot,m=t.isInsideSharedFolder,f=t.isInsideTeamFolderRoot,g=t.isInsideArchivedTeamFolder,R=t.isInsideTeamFolderTree,A=t.isInsideDeletedFolder,I=t.isInsideDeletedSharedFolder,T=t.isInsideDeletedNestedSharedFolder,O=t.isNonUserRelativeContext,D=t.pathRoot,y=t.rootNSID,C=t.showSharedFolderCreateTeamPromo,N=t.showPinnedTeamFolder,v=t.teamFolderOwnerTeamApiId,L=t.blockHash,F=t.config;this.canViewContainingNSMembers=null==r||r,this.currentNSID=n||c.root_ns_id,this.currentFQPath=o||"",this.currentMountPoint=i,this.currentNSPath=l,this.currentSharedFolderPermissionRole=null!=_?_:a.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!h,this.inactiveNSIDByFQPath=d||{},this.permanentDeletionDisabledStateByNSID=p||{},this.isInFolderMode=null==E||E,this.isCurrentlyInRoot=!!S,this.isInsideSharedFolder=!!m,this.isInsideTeamFolderRoot=!!f,this.isInsideArchivedTeamFolder=!!g,this.isInsideTeamFolderTree=!!R,this.isInsideDeletedFolder=!!A,this.isInsideDeletedSharedFolder=!!I,this.isInsideDeletedNestedSharedFolder=!!T,this.isNonUserRelativeContext=!!O,this.pathRoot=D,this.rootNSID=y,this.showSharedFolderCreateTeamPromo=!!C,this.showPinnedTeamFolder=!!N,this.teamFolderOwnerTeamApiId=v,this.blockHash=L,this.config=F||new u,s(this)}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var s;t.inside_shared_folder&&(s=a.NameSpaceAccess.ACCESS_READER);var n,o=t.containing_ns_permissions||[],i=o.includes("mount_shared_folders");return t.inside_shared_folder&&(o.includes("edit_contents")&&(s=a.NameSpaceAccess.ACCESS_WRITER),o.includes("change_folder_options")&&(s=a.NameSpaceAccess.ACCESS_OWNER),o.includes("view_members")||(n=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:n,config:u.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:i,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:s,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideTeamFolderRoot:t.inside_team_folder_root,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,showSharedFolderCreateTeamPromo:t.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===a.NameSpaceAccess.ACCESS_WRITER||t===a.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return o.filename(this.currentFQPath)},e})();t.BrowseContext=h;var d=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.creator_name=e.creator_name,this.last_modified_date=e.last_modified_date,this.request_id=e.request_id,this.sort_rank=e.sort_rank,s(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.Paper=d}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.ACCOUNT_MENU=3]="ACCOUNT_MENU",e[e.MAIN_CONTENT=4]="MAIN_CONTENT",e[e.SIDE_BAR=5]="SIDE_BAR"})(t.LAYOUT_TAB_ORDER||(t.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/image","modules/clean/static_urls","modules/clean/react/maestro/a11y_constants"],function(e,t,r,s,n,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return s.createElement("header",{className:"maestro-header page-header__shadow"},s.createElement(n.VerticallyFixed,{className:"page-header"},s.createElement("div",{className:"page-header__title",tabIndex:l.LAYOUT_TAB_ORDER.TITLE},this.props.title),s.createElement(i.TopMenuContainer,{user:this.props.user,showSearchBar:this.props.showSearchBar,currentPath:this.props.currentPath,onSearch:this.props.onSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness})))},t})(s.Component);_.defaultProps={showSearchBar:!0};var u=function(e){var t=e.children;return s.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=u;var h=function(){return s.createElement("a",{href:"/",className:"page-header__logo"},s.createElement(a,{src:c.static_url("/static/images/header_logo-vflzsBFzu.png"),srcHiRes:c.static_url("/static/images/header_logo@2x-vflt21Kis.png"),alt:"Dropbox"}))};t.MaestroHeaderLogo=h;var d=o(_,["/static/css/maestro_header-vfl-1yEEy.css"]);t.PageletMaestroHeader=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants"],function(e,t,r,s,n,o,i){"use strict";function a(e){var t=e.user,a=e.titleRegion,c=e.embeddedAppRegion,l=e.actionSidebarRegion,_=e.searchBarProps,u=null;return null!=l&&(u=s.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:i.LAYOUT_TAB_ORDER.SIDE_BAR},s.createElement(o.MaestroSecondarySidebar,null,l))),s.createElement("div",{className:"maestro-chrome"},s.createElement(n.PageletMaestroHeader,r.__assign({user:t,title:a},_||{})),s.createElement("main",{className:"maestro-app"},s.createElement("div",{className:"maestro-app-content",tabIndex:i.LAYOUT_TAB_ORDER.MAIN_CONTENT},c),u))}Object.defineProperty(t,"__esModule",{value:!0}),t.MaestroChrome=a}),define("modules/clean/react/maestro/profiling_blank_embedded_app",["require","exports","tslib","external/react","modules/clean/react/maestro/layout","modules/clean/profiling","modules/clean/react/maestro/header","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,s,n,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.get_viewer(),t=e.get_user_by_id(this.props.uid);return s.createElement(n.MaestroChrome,{user:t,titleRegion:s.createElement(i.MaestroHeaderTitle,null,"Blank App"),embeddedAppRegion:s.createElement(o.hello_component,null)})},t.prototype.componentWillMount=function(){c.log_js_modules_application_code_start()},t})(s.Component);t.BlankEmbeddedApp=l}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,t,r,s,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return s.createElement(n.VerticallyFixed,{className:"maestro-secondary-sidebar"},this.props.children,s.createElement(o.LegacyHAWrapper,null))},t})(s.Component);t.MaestroSecondarySidebar=i}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar","modules/clean/search/search_helpers","modules/core/uri","modules/clean/react/css"],function(e,t,r,s,n,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e,r){var s=new c({path:"/search/"+t.props.user.role});e&&o.redirect(s.updateQuery({path:t.props.currentPath,query:e,qsid:r}).toString())},t.onFileOrFolderOpen=function(e){if(e instanceof n.File)if(a.logSearchAction(e,t.props.user,e.is_dir?"folder_open":"file_view","top-menu-dropdown-view"),e.is_dir)o.open_tab(e.href);else{var r=e.fq_path.substring(1),s=new c({path:"/"+t.props.user.role}).updateQuery({preview:r});o.open_tab(s.toString())}else e instanceof n.Paper&&(a.logPaperSearchAction(e,t.props.user,"paper_open","top-menu-dropdown-view"),o.open_tab(e.url))},t}return r.__extends(t,e),t.prototype.renderSearchBar=function(){return this.props.showSearchBar?s.createElement(i.SearchBar,{user:this.props.user,currentPath:this.props.currentPath,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen||this.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness}):null},t.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:s.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},t.prototype.render=function(){return s.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},t})(s.Component);_.defaultProps={showSearchBar:!0,currentPath:"/"},t.TopMenuContainer=l(_,["/static/css/pagelet-vflBp79rc.css"],[i.SearchBar])}),function(){define("modules/clean/react/outside_event",["external/react","external/underscore","modules/clean/react/util"],function(e,t,r){var s,n,o,i,a;return a=r.mergeProps,i=e.createElement,e.DOM,o=function(r,s,n,o){var c,l,_;return c=null!=(_=r.displayName)?_:"UnnamedComponent",e.createClass({displayName:"Outside"+s+"Handled"+c,propTypes:(l={},l[""+n]=e.PropTypes.func,l[""+o]=e.PropTypes.func,l),componentDidMount:function(){return document.addEventListener(s,this._handleOutsideEvent,!1)},componentWillUnmount:function(){return document.removeEventListener(s,this._handleOutsideEvent,!1)},render:function(){var e,s;return s=a(t.omit(this.props,n,o,"children"),(e={},e[""+n]=this._handleInsideEvent,e)),i(r,s,this.props.children)},_handleOutsideEvent:function(e){var t;return"function"==typeof(t=this.props)[o]?t[o](e):void 0},_handleInsideEvent:function(e){var t,r;return e.stopPropagation(),"function"==typeof(t=e.nativeEvent).stopImmediatePropagation&&t.stopImmediatePropagation(),"function"==typeof(r=this.props)[n]?r[n](e):void 0}})},s=o("div","click","onClick","onOutsideClick"),n=o("div","mousedown","onMouseDown","onOutsideMouseDown"),{OutsideClickHandler:s,OutsideMouseDownHandler:n,addOutsideEventHandling:o}})}.call(this),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){n.Emitter.emit(n.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return s.createElement("div",null)},t})(s.Component);o.displayName="LegacyHAWrapper",t.LegacyHAWrapper=o}),function(){var e=[].slice,t={}.hasOwnProperty;define("modules/clean/react/selectable_list",["jquery","external/underscore","external/react","external/react-dom","external/immutable","external/keymaster","modules/clean/keycode","modules/clean/react/outside_event","modules/core/browser","modules/core/exception","modules/clean/react/helpers"],function(r,s,n,o,i,a,c,l,_,u,h){var d,p,E,S,m,f,g,assert,R,A,I,T;return c.KeyCode,g=l.addOutsideEventHandling,assert=u.assert,T=h.shallowCompareStateAndProps,S="",f=i.Record({selected:new i.OrderedSet,anchor:null}),A=function(e,t){return null==e&&(e=[]),null==t&&(t=null),new f({selected:new i.OrderedSet(e),anchor:t||e[0]})},E="up",p="down",I=function(e){return _.mac&&e.metaKey||!_.mac&&e.ctrlKey},function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],function(){var e,r,n,o;for(o=[],r=0,n=t.length;r<n;r++)e=t[r],s.isFunction(e)&&o.push(e.apply(this,arguments));return o}},m={onMouseEnter:"handleMouseEnterRow",onMouseDown:"handleMouseDownInRow",onMouseUp:"handleMouseUpInRow",onToggleRowSelected:"handleToggleRowSelected",onFocus:"handleInitialTab"},d={onMouseDown:"handleMouseDownInCheckbox",onToggleRowSelected:"handleToggleRowSelected",onMouseEnter:"noop",onMouseUp:"noop"},function(){var e;return"INPUT"===(e=document.activeElement.tagName)||"TEXTAREA"===e||"SELECT"===e||"BUTTON"===e},R=function(e,c){var l,u;return u=null!=(l=(null!=c?c:{}).shouldComponentUpdate)?l:T,e=g(e,"mouseup","onMouseUp","onOutsideMouseUp"),n.createClass({displayName:"Selectable"+e.displayName,propTypes:{allItemIds:n.PropTypes.instanceOf(i.List),onSelectionChange:n.PropTypes.func,selection:n.PropTypes.instanceOf(f),defaultSelection:n.PropTypes.instanceOf(f),keyScope:n.PropTypes.string,linkedOutsideClasses:n.PropTypes.array,addTabbingClassWhenKeyboardNavigating:n.PropTypes.bool,isCheckboxes:n.PropTypes.bool},getDefaultProps:function(){return{onSelectionChange:s.noop,selection:null,defaultSelection:new f,keyScope:"SelectableList",linkedOutsideClasses:[],addTabbingClassWhenKeyboardNavigating:!0}},getInitialState:function(){return{selection:this.props.defaultSelection}},componentWillMount:function(){return this._focusedItem=null,this._handlerCache={},this._isFocused=!1,this._keepFocusOnToggle=!1,this._mostRecentMousedownTarget=null,this._isSelecting=!1},componentDidMount:function(){return this._setupKeyboardShortcuts(),this._focusItem(this._selection().anchor),r(o.findDOMNode(this)).on("focusin.SelectableList",this.getFocusHandler(!0)).on("focusout.SelectableList",this.getFocusHandler(!1))},shouldComponentUpdate:u,componentDidUpdate:function(e,t){var r,s;if((null!=(r=e.selection)?r.anchor:void 0)!==(null!=(s=this.props.selection)?s.anchor:void 0)&&this._selection().selected.size&&(this._focusedItem=this._selection().anchor),this._focusedItem)return this._focusItem(this._focusedItem),this._focusedItem=null},componentWillUnmount:function(){return this._handlerCache=null,S!==this.props.keyScope&&(a.clearScope(this.props.keyScope),a.setScope(S)),r(o.findDOMNode(this)).off(".SelectableList")},
getFocusHandler:function(e){return(function(t){return function(){return t._isFocused=e,!0}})(this)},_setupKeyboardShortcuts:function(){var e,t,r,s,n,i,c,l,u;return S=a.getScope(),S!==this.props.keyScope&&a.setScope(this.props.keyScope),i=(function(e){return function(t){return e._isFocused&&"BUTTON"!==t.target.tagName}})(this),n=(function(e){return function(t){return!document.activeElement||document.activeElement===document.body||o.findDOMNode(e).contains(t.target)&&"INPUT"!==t.target.nodeName}})(this),s=function(e,t){return function(r){return e(r)?(r.preventDefault(),t(r)):null}},u=(function(e){return function(){return e._selectNeighboringItem({direction:E})}})(this),r=(function(e){return function(){return e._extendSelectionRange({direction:E})}})(this),l=(function(e){return function(){return e._selectNeighboringItem({direction:p})}})(this),t=(function(e){return function(){return e._extendSelectionRange({direction:p})}})(this),c=(function(e){return function(){return e._selectAllItems()}})(this),e=(function(e){return function(){return e._deselectAllItems()}})(this),a("up",this.props.keyScope,s(n,u)),a("shift+up",this.props.keyScope,s(n,r)),a("down",this.props.keyScope,s(n,l)),a("shift+down",this.props.keyScope,s(n,t)),a("escape",this.props.keyScope,s(n,e)),_.mac?a("command+a",this.props.keyScope,s(i,c)):a("ctrl+a",this.props.keyScope,s(i,c))},_focusItem:function(e){var t;if(t=this.refs[e],t&&!this._keepFocusOnToggle)return Promise.resolve().then((function(e){return function(){if(e.isMounted())return o.findDOMNode(t).focus()}})(this))},_itemIds:function(){var e;return this.props.allItemIds?this.props.allItemIds:(e=[],n.Children.forEach(this.props.children,function(t){var r;return(null!=t&&null!=(r=t.props)?r.selectableListId:void 0)?e.push(t.props.selectableListId):(null!=t?t.key:void 0)?e.push(t.key):void 0}),i.List(e))},_selection:function(){return this.props.selection?this.props.selection:this.state.selection},_updateState:function(e,t){if(null==t&&(t=!1),this._keepFocusOnToggle=t,this.setState({isSelecting:!1}),!i.is(this._selection(),e))return this.props.selection||this.setState({selection:e}),this.props.onSelectionChange(e)},_selectAllItems:function(){return this.setSelectedItems({itemIds:this._itemIds().toArray()})},_deselectAllItems:function(){if(this.setSelectedItems({itemIds:[]}),o.findDOMNode(this).contains(document.activeElement))return document.activeElement.blur()},_toggleItemSelected:function(e){var t,r,s,n,o,i,a,c,l,_,u,h;if(s=e.itemId,a=e.keepFocusOnToggle,h=this._selection(),h.selected.has(s)){for(h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.delete(s)}})(this)),c=null,t=this._itemIds().indexOf(s),r=o=l=t+1,_=this._itemIds().count();l<=_?o<_:o>_;r=l<=_?++o:--o)if(n=this._itemIds().get(r),h.selected.has(n)){c=n;break}if(!c)for(r=i=u=t-1;u<=0?i<=0:i>=0;r=u<=0?++i:--i)if(n=this._itemIds().get(r),h.selected.has(n)){c=n;break}c||(c=this._itemIds().get(0)),h=h.set("anchor",c)}else h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.add(s)}})(this)).set("anchor",s);return this._updateState(h,a)},_selectItemsInRangeTo:function(e){var t,r,s,n,o,i,a,c,l,_,u,h,d;if(i=e.itemId,h=this._selection(),t=null!=(_=h.anchor)?_:this._itemIds().get(0))return r=this._itemIds().indexOf(t),l=this._itemIds().indexOf(i),u=this._rangeOfSelectedBlockSurrounding(t),d=u.startIndex,s=u.endIndex,a=function(){var e,t,r,i;for(r=this._itemIds().toArray(),i=[],o=e=0,t=r.length;e<t;o=++e)n=r[o],d<=o&&o<=s&&i.push(n);return i}.call(this),c=function(){var e,t,s,i;for(s=this._itemIds().toArray(),i=[],o=e=0,t=s.length;e<t;o=++e)n=s[o],(l<=o&&o<=r||r<=o&&o<=l)&&i.push(n);return i}.call(this),l<r&&c.reverse(),h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.subtract(a).union(c)}})(this)),this._updateState(h)},_selectNeighboringItem:function(e){var t,s,n,o;if(t=e.direction,n=this._itemIds().indexOf(this._selection().selected.last()),s=0,t===E?s=Math.max(0,n-1):t===p&&(s=Math.min(this._itemIds().count()-1,n+1)),o=this._itemIds().get(s),this._focusedItem=o,this.setSelectedItems({itemIds:[o]}),this.props.addTabbingClassWhenKeyboardNavigating)return r(document.body).addClass("tabbing")},_extendSelectionRange:function(e){var t,s,n,o,i,a,c,l,_;if(n=e.direction,l=i=this._selection(),t=null!=(a=l.anchor)?a:this._itemIds().get(0))return s=this._itemIds().indexOf(t),c=this._rangeOfSelectedBlockSurrounding(t),_=c.startIndex,o=c.endIndex,this.setState({isSelecting:!0}),n===E?s===o?_-1>=0&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(_-1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(o))}})(this)):n===p&&(s===_||s!==o?o+1<this._itemIds().count()&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(o+1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(_))}})(this))),l!==i&&(this._focusedItem=l.selected.last(),this._updateState(l)),this.props.addTabbingClassWhenKeyboardNavigating?r(document.body).addClass("tabbing"):void 0},_rangeOfSelectedBlockSurrounding:function(e){var t,r,s,n;for(r=this._itemIds().indexOf(e);;)if(n=r,r-=1,r<0||!this._selection().selected.has(this._itemIds().get(r)))break;for(r=n;;){if(s=this._itemIds().get(r),null==s||!this._selection().selected.has(s))break;t=r,r+=1}return{startIndex:n,endIndex:t}},setSelectedItems:function(e){var t,r,s;return r=e.itemIds,this.setState({isSelecting:!0}),s=this._selection().set("selected",i.OrderedSet(r)),t=r.length>0?r[0]:this._itemIds().get(0),this._updateState(s.set("anchor",t))},handleMouseEnterRow:function(e,t){if(this._isSelecting)return this._selectItemsInRangeTo({itemId:e})},handleMouseDownInRow:function(e,t){return 2===t.button?void(this._selection().selected.has(e)||this.setSelectedItems({itemIds:[e]})):t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):I(t)?void this._toggleItemSelected({itemId:e}):(this._selection().selected.has(e)||(this.setSelectedItems({itemIds:[e]}),this._isSelecting=!0),this._mostRecentMousedownTarget=e)},handleMouseUpInRow:function(e,t,r){return e===this._mostRecentMousedownTarget&&this.setSelectedItems({itemIds:[e]}),this._isSelecting=!1},handleInitialTab:function(e){if(this._itemIds().first()===e&&!this._selection().selected.has(e)&&!this.state.isSelecting)return this.setSelectedItems({itemIds:[e]})},handleToggleRowSelected:function(e,t){return(null!=t?t.shiftKey:void 0)?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e,keepFocusOnToggle:!0})},handleOutsideMouseUp:function(e){var t;if(this._isSelecting=!1,this._mostRecentMousedownTarget=null,t=o.findDOMNode(this),!t.contains(e.target)&&!r(e.target).closest(this.props.linkedOutsideClasses.join()).length&&!this._mostRecentMousedownTarget)return this._deselectAllItems()},handleMouseDownInCheckbox:function(e,t){return t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e})},noop:function(e,t){},render:function(){var r,o,i,a;return o=this._handlerCache,this._handlerCache={},r=n.Children.map(this.props.children,(function(e){return function(r){var i,a,c,l,_,u,h,p,E;if(!(null!=r&&null!=(h=r.props)?h.selectableListId:void 0)&&!(null!=r?r.key:void 0))return r;u=null!=(p=null!=r&&null!=(E=r.props)?E.selectableListId:void 0)?p:r.key,l={},_=e.props.isCheckboxes?d:m;for(c in _)t.call(_,c)&&(a=_[c],assert(!r.props[c],"SelectableList does not support children having seperate "+c+" listeners"),i=c+u,l[c]=o[i]||e[a].bind(e,u),e._handlerCache[i]=l[c]);return n.cloneElement(r,s.extend(l,{ref:u,isSelected:e._selection().selected.has(u)}))}})(this)),i=Object.keys(this.constructor.propTypes),a=s.extend({},s.omit(this.props,i),{selection:this._selection(),onOutsideMouseUp:this.props.isCheckboxes?s.noop():this.handleOutsideMouseUp}),n.createElement(e,a,r)}})},{createSelectableList:R,createSelection:A}})}.call(this),define("modules/clean/search/actions",["require","exports","modules/clean/search/constants","modules/clean/search/dispatcher","modules/constants/search","modules/clean/search/api","modules/clean/search/store","modules/clean/search/models","modules/clean/react/browse/models"],function(e,t,r,s,n,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e,t){void 0===e&&(e=o.searchApiClient),void 0===t&&(t=i.searchStore),this._searchApi=e,this._searchStore=t}return e.prototype.focusSearchBar=function(){s.SearchDispatcher.dispatch({type:r.FOCUS_SEARCH_BAR_ACTION})},e.prototype.blurSearchBar=function(){s.SearchDispatcher.dispatch({type:r.BLUR_SEARCH_BAR_ACTION})},e.prototype.setSearchQuery=function(e){var t=e.nsid,n=e.path,o=e.query,i=e.user;o!==this._searchStore.rawQuery()&&(this._searchApi.abortPreviousLoading(),s.SearchDispatcher.dispatch({type:r.SET_SEARCH_QUERY_ACTION,data:{query:o}}),this._searchStore.isSearchBarLoading()&&this._loadSuggestions({nsid:t,path:n,query:o,user:i}))},e.prototype.setSearchSuggestions=function(e){var t=e.searchResults;s.SearchDispatcher.dispatch({type:r.SET_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setSlimSearchSuggestions=function(e){var t=e.searchResults;s.SearchDispatcher.dispatch({type:r.SET_SLIM_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setHighlightedRow=function(e){var t=e.index;s.SearchDispatcher.dispatch({type:r.SET_HIGHLIGHTED_ROW_ACTION,data:{index:t}})},e.prototype.highlightPreviousRow=function(){s.SearchDispatcher.dispatch({type:r.HIGHLIGHT_PREVIOUS_ROW_ACTION})},e.prototype.highlightNextRow=function(){s.SearchDispatcher.dispatch({type:r.HIGHLIGHT_NEXT_ROW_ACTION})},e.prototype.runSearch=function(e){var t=this,n=e.user,o=e.path,i=e.query,a=e.qsid,c=e.logOnceFetchedDataRequiredForTTI;s.SearchDispatcher.dispatch({type:r.START_SEARCH_ACTION,data:{query:i,qsid:a}}),this._searchApi.loadResults({user:n,path:o,query:i,loadDeleted:!1,start:0,onSuccess:function(e){var r=e.searchResults,s=e.context;"function"==typeof c&&c(),t._setSearchResults({searchResults:r,context:s}),t._loadDeletedResults({path:o,user:n})}})},e.prototype.loadMoreResults=function(e){var t,n=this,o=e.path,i=e.user;if(this._searchStore.loadingState()===r.SearchLoadingStates.LOADED){if(this._searchStore.hasMoreResults())t=!1;else{if(!this._searchStore.hasMoreResults(!0))return;t=!0}s.SearchDispatcher.dispatch({type:r.CONTINUE_SEARCH_ACTION,data:{didLoadDeletedResults:t}}),this._searchApi.loadResults({user:i,path:o,query:this._searchStore.latestQuery(),loadDeleted:t,start:t?this._searchStore.numDeletedResults():this._searchStore.searchResults().size,onSuccess:function(e){var t=e.searchResults,r=e.context,s=e.deleted;n._appendSearchResults({searchResults:t,context:r,deleted:s}),n._loadDeletedResults({path:o,user:i})}})}},e.prototype._setSearchResults=function(e){var t=e.searchResults,n=e.context;s.SearchDispatcher.dispatch({type:r.SET_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:n}})},e.prototype._appendSearchResults=function(e){var t=e.searchResults,n=e.context,o=e.deleted;s.SearchDispatcher.dispatch({type:r.APPEND_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:n,deleted:o}})},e.prototype._loadDeletedResults=function(e){var t=e.path,r=e.user;this._searchStore.hasMoreResults()||this._searchStore.didLoadDeletedResults()||this.loadMoreResults({path:t,user:r})},e.prototype._loadSuggestions=function(e){var t=this,r=e.nsid,s=e.path,o=e.query,a=e.user;!i.searchStore.browseContext().isNonUserRelativeContext&&n.SEARCH_LIGHTWEIGHT_DROPDOWN?this._searchApi.loadSlimResults({user:a,nsid:r,path:s,query:this._searchStore.normalizedQuery(),onSuccess:function(e){var r=e.searchResults;o===t._searchStore.rawQuery()&&(t.setSlimSearchSuggestions({searchResults:r}),t._searchApi.fetchAdditionalFileMetadata({searchResults:r,user:a,onSuccess:function(e){t.setSearchSuggestions({searchResults:e})}}))}}):this._searchApi.loadSuggestions({user:a,nsid:r,path:s,query:this._searchStore.normalizedQuery(),onSuccess:function(e){var r=e.searchResults;o===t._searchStore.rawQuery()&&(t.setSlimSearchSuggestions({searchResults:t._convertToSlimResults(r)}),t.setSearchSuggestions({searchResults:r}))}})},e.prototype._convertToSlimResults=function(e){for(var t=[],r=0,s=e;r<s.length;r++){var n=s[r];n instanceof c.File?t.push(a.SlimFileSearchResult.fromServerObject(n)):n instanceof c.Paper&&t.push(n)}return t},e.prototype.setSearchSelection=function(e){var t=e.selection;s.SearchDispatcher.dispatch({type:r.SET_SEARCH_SELECTION_ACTION,data:{selection:t}})},e.prototype.removeSearchResults=function(e){var t=e.fq_paths,n=t.map(function(e){return{before:e,after:null}}).toArray();s.SearchDispatcher.dispatch({type:r.CHANGE_FILES_ACTION,data:{fileDeltas:n}})},e.prototype.clearSearch=function(){s.SearchDispatcher.dispatch({type:r.CLEAR_SEARCH_ACTION})},e})();t.SearchActions=l,t.searchActions=new l}),define("modules/clean/search/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/analytics","modules/clean/react/browse/models","modules/constants/search","modules/clean/search/constants","modules/clean/search/types","modules/clean/search/models","modules/clean/search/store"],function(e,t,r,s,n,o,i,a,c,l,_,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(){function e(){this._activeRequest=null}return e.prototype.loadSuggestions=function(e){var t=e.user,r=e.nsid,s=e.path,n=e.query,o=e.onSuccess,i=e.onError,a=u.searchStore.browseContext().isNonUserRelativeContext,l={query:n,fq_path:s,filename_only:!0,max_results:c.MaxResults.MAX_SEARCH_SUGGESTIONS,show_paper_results:!a,show_unmounted_results:!0,ns_id:r,is_admin_console:a,is_dropdown:!0,start:0};this._fetchFullResults(l,t,!1,o,i)},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,s=e.query,n=e.loadDeleted,o=e.start,i=e.onSuccess,a=e.onError,l={query:s,fq_path:r,filename_only:!1,max_results:c.MaxResults.MAX_SEARCH_RESULTS,deleted:n,start:o,show_paper_results:!0,show_unmounted_results:!0};this._fetchFullResults(l,t,n,i,a)},e.prototype._extractBrowseContext=function(e){return new i.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,permanentDeletionDisabledStateByNSID:e.permanent_delete_is_disabled_by_ns_id})},e.prototype._extractSearchResultsList=function(e){for(var t=[],r=0,s=e;r<s.length;r++){var n=s[r];switch(n.search_result_type){case l.SearchResultTypes.FILE:t.push(i.File.fromServerObject(n));break;case l.SearchResultTypes.PAPER:t.push(i.Paper.fromServerObject(n))}}return t},e.prototype._extractSlimSearchResultsList=function(e){for(var t=[],r=0,s=e;r<s.length;r++){var n=s[r];switch(n.search_result_type){case l.SearchResultTypes.FILE:t.push(_.SlimFileSearchResult.fromServerObject(n));break;case l.SearchResultTypes.PAPER:t.push(i.Paper.fromServerObject(n))}}return t},e.prototype._getSearchType=function(e){return e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype._fetchFullResults=function(e,t,r,n,i){var a=this;null!=this._activeRequest&&this._activeRequest.abort();var c={path_scoped:"/"!==e.fq_path,search_type:this._getSearchType(e),query_string:e.query,start:e.start,search_session_id:u.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("query_started",t.id,c);var l=(new Date).getTime();this._activeRequest=s.WebRequest({url:"/ajax_fulltext_search",data:e,dataType:"json",subject_user:t,success:function(s,i,_){var h=a._extractBrowseContext(s),d=s.search_results,p=_.getResponseHeader("x-dropbox-request-id");d.forEach(function(e){return e.request_id=p});var E=!!d.find(function(e){return e.used_spellcorrect}),S=a._extractSearchResultsList(d);n({context:h,searchResults:S,deleted:r});var m=o.SearchClientActivityLogger.create_completion_log_dict(c,E,p,l,e.query,S.length,null,u.searchStore.searchSessionID());o.SearchClientActivityLogger.log("query_completed",t.id,m)},error:function(r,s,n){"abort"!==s&&"function"==typeof i&&i(n);var a=r.getResponseHeader("x-dropbox-request-id"),_=o.SearchClientActivityLogger.create_completion_log_dict(c,null,a,l,e.query,null,s,u.searchStore.searchSessionID());o.SearchClientActivityLogger.log("query_failed",t.id,_)},complete:function(){this._activeRequest=null}})},e.prototype.loadSlimResults=function(e){var t=e.user,r=e.nsid,s=e.path,n=e.query,o=e.onSuccess,i=e.onError,a=u.searchStore.browseContext().isNonUserRelativeContext,c={query:n,ns_id:r,fq_path:s,is_admin_console:a};this._fetchSlimResults(c,t,o,i)},e.prototype.fetchAdditionalFileMetadata=function(e){var t=this,r=e.searchResults,n=e.user,o=e.onSuccess,i=e.onError,a=r.filter(function(e){return e instanceof _.SlimFileSearchResult}),c=a.map(function(e){return[e.ns_id,e.sjid]});c.length>0?s.WebRequest({url:"/search/search_metadata",data:{nsid_sjid_pairs:JSON.stringify(c)},dataType:"json",subject_user:n,success:function(e,s,n){o(t._mergeFullResultsIntoSlimResults(e.search_results,r))},error:function(e,t,r){"abort"!==t&&"function"==typeof i&&i(r)}}):o(r)},e.prototype._mergeFullResultsIntoSlimResults=function(e,t){for(var s=[],o=function(t){if(t instanceof _.SlimFileSearchResult){var o=e.find(function(e){return e.search_result_type===l.SearchResultTypes.FILE&&n.paths_are_equal(e.fq_path,t.fq_path)});o&&s.push(i.File.fromServerObject(r.__assign({},o,{request_id:t.request_id,sort_rank:t.sort_rank})))}else t instanceof i.Paper&&s.push(t)},a=0,c=t;a<c.length;a++){o(c[a])}return s},e.prototype._fetchSlimResults=function(e,t,r,n){var i,c=this;null!=this._activeRequest&&this._activeRequest.abort();var l={path_scoped:"/"!==e.fq_path,search_type:"completion",query_string:e.query,search_session_id:u.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("query_started",t.id,l);var _=(new Date).getTime(),h=a.SEARCH_FRONTEND_SERVICE?"/search/dropdown_search":"/search/lightweight_dropdown_search_meta";this._activeRequest=s.WebRequest({url:h,data:e,dataType:"json",subject_user:t,success:function(s,n,i){for(var a=c._extractBrowseContext(s),h=s.search_results,d=i.getResponseHeader("x-dropbox-request-id"),p=0,E=0,S=h;E<S.length;E++){var m=S[E];m.request_id=d,m.sort_rank=p++}var f=c._extractSlimSearchResultsList(h);r({context:a,searchResults:f,deleted:!1});var g=o.SearchClientActivityLogger.create_completion_log_dict(l,!1,d,_,e.query,f.length,null,u.searchStore.searchSessionID());o.SearchClientActivityLogger.log("query_completed",t.id,g)},error:function(r,s,a){"abort"!==s&&"function"==typeof n&&n(a),i=r.getResponseHeader("x-dropbox-request-id");var c=o.SearchClientActivityLogger.create_completion_log_dict(l,null,i,_,e.query,null,s,u.searchStore.searchSessionID());o.SearchClientActivityLogger.log("query_failed",t.id,c)},complete:function(){this._activeRequest=null}})},e})();t.SearchApiClient=h,t.searchApiClient=new h}),define("modules/clean/search/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SearchLoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_ADDITIONAL_PAGE:"LOADING_ADDITIONAL_PAGE"}}),define("modules/clean/search/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchDispatcher=r}),define("modules/clean/search/models",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.request_id=e.request_id,this.sort_rank=e.sort_rank,r(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.SlimFileSearchResult=s}),define("modules/clean/search/search_bar",["require","exports","tslib","external/classnames","external/mcl/icon_global","external/react","jquery","modules/clean/analytics","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/keycode","modules/clean/react/button","modules/clean/react/css","modules/clean/react/maestro/a11y_constants","modules/clean/react/sprite","modules/clean/react_format","modules/clean/search/actions","modules/clean/search/api","modules/clean/search/search_helpers","modules/clean/search/models","modules/clean/search/store","modules/core/accessible_announce","modules/core/browser","modules/core/i18n","modules/core/uri","modules/core/notify"],function(e,t,r,s,n,o,i,a,c,l,_,u,h,d,p,E,S,m,f,g,R,A,I,T,O,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){function t(t){var r=e.call(this,t)||this;return r._onSearchStoreChanged=function(){r.setState(r._get_state_from_store())},r._handleInputChange=function(e){r._setSearchQuery(e.currentTarget.value)},r._handleCancelSearch=function(){r._setSearchQuery("")},r._handleInputKeydown=function(e){if(e.keyCode===_.KeyCode.ESC)return r._handleCancelSearch(),void r.props.onCancelSearch();e.stopPropagation(),e.keyCode===_.KeyCode.UP?(e.preventDefault(),S.searchActions.highlightPreviousRow()):e.keyCode===_.KeyCode.DOWN&&(e.preventDefault(),S.searchActions.highlightNextRow())},r._handleInputSubmit=function(e,t){if(e.preventDefault(),0===t)r.props.onSearch(r.state.normalizedQuery,R.searchStore.searchSessionID());else{var s=R.searchStore.searchSuggestions()[t-1];s?r.props.onFileOrFolderOpen(s):r._handleFileOrFolderOpen(R.searchStore.slimSearchSuggestions()[t-1])}},r._handleFileOrFolderOpen=function(e){f.fetchFullSearchResult({searchApiClient:m.searchApiClient,searchResult:e,user:r.props.user,onSuccess:function(e){r.props.onFileOrFolderOpen(e)},onError:function(e){D.error(e)}})},r._handleHighlightDropdownItem=function(e){S.searchActions.setHighlightedRow({index:e})},r._setSearchBarRef=function(e){return r._searchBarView=e},r.state=r._get_state_from_store(),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){R.searchStore.add_change_listener(this._onSearchStoreChanged)},t.prototype.componentWillUnmount=function(){R.searchStore.remove_change_listener(this._onSearchStoreChanged)},t.prototype._get_state_from_store=function(){return{isFocused:R.searchStore.isSearchBarFocused(),isActive:R.searchStore.isSearchBarActive(),isSearchActive:!!R.searchStore.latestQuery(),rawQuery:R.searchStore.rawQuery(),normalizedQuery:R.searchStore.normalizedQuery(),suggestions:R.searchStore.slimSearchSuggestions(),searchBarLoading:R.searchStore.isSearchBarLoading(),isAdminConsole:R.searchStore.browseContext().isNonUserRelativeContext}},t.prototype.getSearchBarView=function(){return this._searchBarView},t.prototype._setSearchQuery=function(e){S.searchActions.setSearchQuery({nsid:this.props.currentNSID,path:this.props.currentPath,query:e,user:this.props.user})},t.prototype.render=function(){return o.createElement(C,r.__assign({},this.props,this.state,{onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onFileOrFolderOpen:this._handleFileOrFolderOpen,onSearchBarFocus:S.searchActions.focusSearchBar,onSearchBarBlur:S.searchActions.blurSearchBar,onHighlightDropdownItem:this._handleHighlightDropdownItem,ref:this._setSearchBarRef,highlightedRow:R.searchStore.highlightedSearchRow(),user:this.props.user}))},t})(o.Component);y.defaultProps={onCancelSearch:function(){}},t.SearchBarComponent=y;var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleNavigation=function(){t._searchBarInput.blurSearchBarTextInput()},t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),I.redirect(new O({path:"/team/upgrade",query:{tk:"search_upsell_bar",camp:"web"}}).toString())},t._renderUpsellBar=function(){return t.props.limitedTeamBannerUpsell?o.createElement("div",{className:"search-bar__upsell"},o.createElement("div",{className:"search-bar__upsell__message"},T._("Search through file contents in addition to file names with %(trademark_business)s").format({trademark_business:t.props.trademarkBusiness})),o.createElement("div",{className:"search-bar__upsell__action"},o.createElement(u.button,{className:"search-bar__upsell__cta-button",onMouseDown:t._onMouseDown},T._("Upgrade")))):void 0},t._onFileOrFolderOpen=function(e){t.props.onFileOrFolderOpen(e),t._handleNavigation()},t._onSearch=function(e,r){t.props.onSearch(e,r),t._handleNavigation()},t._setSearchBarInputRef=function(e){return t._searchBarInput=e},t._setSearchBarDropdownRef=function(e){return t._searchBarDropdown=e},t}return r.__extends(t,e),t.prototype.getSearchBarInput=function(){return this._searchBarInput},t.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},t.prototype.render=function(){var e={"search-bar":!0,"is-expanded":this.props.isSearchActive,"is-focused":this.props.isFocused,"is-active":this.props.isActive};return o.createElement("div",{className:"search-bar--container u-l-fr"},o.createElement("div",{className:s(e)},o.createElement(N,{isActive:this.props.isActive,isFocused:this.props.isFocused,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onInputChange:this.props.onInputChange,onInputKeydown:this.props.onInputKeydown,onInputSubmit:this.props.onInputSubmit,onSearchBarBlur:this.props.onSearchBarBlur,onSearchBarFocus:this.props.onSearchBarFocus,rawQuery:this.props.rawQuery,highlightedRow:this.props.highlightedRow,isAdminConsole:this.props.isAdminConsole,placeholder:this.props.placeholder,ref:this._setSearchBarInputRef}),this.props.normalizedQuery&&this.props.normalizedQuery.length&&o.createElement(v,{onFileOrFolderOpen:this._onFileOrFolderOpen,onSearch:this._onSearch,currentPath:this.props.currentPath,highlightedRow:this.props.highlightedRow,isOpen:this.props.isFocused,normalizedQuery:this.props.normalizedQuery,onHighlightDropdownItem:this.props.onHighlightDropdownItem,suggestions:this.props.suggestions,bottomBanner:this._renderUpsellBar(),searchBarLoading:this.props.searchBarLoading,isAdminConsole:this.props.isAdminConsole,user:this.props.user,ref:this._setSearchBarDropdownRef})))},t})(o.Component);C.defaultProps={rawQuery:"",normalizedQuery:"",isAdminConsole:!1};var N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeydown=function(e){e.keyCode===_.KeyCode.ESC&&(t.blurSearchBarTextInput(),i(t._searchBarTextInput).val("")),t.props.onInputKeydown(e)},t._onSubmit=function(e){var r=R.searchStore.highlightedSearchRow();return t.props.isAdminConsole||t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){i(this._searchBarTextInput).on("keydown.SearchBarInput",this._onKeydown),i(this._searchBarTextInput).on("focusout.SearchBarInput",this.props.onSearchBarBlur)},t.prototype.componentWillUnmount=function(){i(this._searchBarTextInput).off(".SearchBarInput")},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur()},t.prototype.render=function(){return o.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},o.createElement("input",{"aria-activedescendant":"search-dropdown-suggestion"+this.props.highlightedRow,"aria-autocomplete":"list","aria-expanded":this.props.isFocused&&this.props.isActive,"aria-label":T._("Search"),"aria-owns":"search-bar__suggestions",className:"search-bar__text-input",onChange:this.props.onInputChange,onFocus:this.props.onSearchBarFocus,placeholder:this.props.placeholder?this.props.placeholder:T._("Search"),ref:this._setSearchBarTextInputRef,role:"combobox",defaultValue:this.props.rawQuery,tabIndex:d.LAYOUT_TAB_ORDER.SEARCH_BAR}),o.createElement("button",{"aria-label":T._("Search"),className:"search-bar__button",type:"submit"},o.createElement(n.IconGlobal,{name:"search-small"})))},t})(o.Component),v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._announceLoading=function(){A.AccessibleAnnounce.polite(T._("Loading search"))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.searchBarLoading&&this._announceLoading()},t.prototype.componentDidUpdate=function(e){this.props.searchBarLoading&&!e.searchBarLoading&&this._announceLoading(),this.props.normalizedQuery&&e.searchBarLoading&&!this.props.searchBarLoading&&A.AccessibleAnnounce.polite(T.ungettext("Found %(num)s search result","Found %(num)s search results",this.props.suggestions.length).format({num:this.props.suggestions.length}))},t.prototype.render=function(){!this.props.searchBarLoading&&this.props.isOpen&&this.props.bottomBanner&&!this._banner_view_logged&&(this._banner_view_logged=!0,a.TeamsWebActionsLogger.log("banner_search_displayed",{location:"search_bar",item_count:this.props.suggestions.length}));for(var e=[],t=0;t<this.props.suggestions.length;t++){var r=this.props.suggestions[t];r instanceof g.SlimFileSearchResult?e.push(o.createElement(b,{resultObject:r,key:r.fq_path,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow,user:this.props.user})):r instanceof l.Paper&&e.push(o.createElement(F,{resultObject:r,key:r.pad_id,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow,user:this.props.user}))}var n={"search-bar__dropdown":!0,"is-expanded":this.props.isOpen};return o.createElement("div",{className:s(n),"aria-hidden":!this.props.isOpen},o.createElement("div",{className:"search-bar__suggestions",id:"search-bar__suggestions"},!this.props.isAdminConsole&&o.createElement(L,{onSearch:this.props.onSearch,onHighlightDropdownItem:this.props.onHighlightDropdownItem,currentPath:this.props.currentPath,normalizedQuery:this.props.normalizedQuery,highlightedRow:this.props.highlightedRow,user:this.props.user}),e),this.props.searchBarLoading?o.createElement("div",{className:"search-bar__loading"},o.createElement("span",{className:"ax-visually-hidden"},T._("Loading search..."))):this.props.bottomBanner)},t})(o.Component);v.defaultProps={isAdminConsole:!1},t.SearchBarDropdown=v;var L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTitle=function(){return["/",""].includes(t.props.currentPath)?E.reactFormat(T._("View all results for <strong>%(query)s</strong>"),{query:t.props.normalizedQuery,strong:o.createElement("strong",{key:"title"})}):E.reactFormat(T._("Search for <strong>%(query)s</strong> in %(current_path)s"),{current_path:c.filename(t.props.currentPath),query:t.props.normalizedQuery,strong:o.createElement("strong",{key:"title"})})},t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),f.shouldHandleClick(e)&&t.props.onSearch(t.props.normalizedQuery,R.searchStore.searchSessionID())},t._onMouseEnter=function(){
return t.props.onHighlightDropdownItem(0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=0===this.props.highlightedRow,t={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":e,"search-bar__full_search_suggestion":!0},r=f.buildSearchURL(this.props.user,this.props.currentPath,this.props.normalizedQuery,R.searchStore.searchSessionID()).toString();return o.createElement("a",{href:r,className:s(t),id:"search-dropdown-suggestion0",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,role:"option","aria-selected":e},o.createElement("div",{className:"search-bar__suggestion-icon--search"}),o.createElement("div",{className:"search-bar__suggestion-first-row-name"},this._renderTitle()))},t})(o.Component),F=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject;return o.createElement(w,r.__assign({},this.props,{icon:"paper_white_32",title:f.highlightMatchReact(e.title,e.title_highlights),location:"Paper"}))},t})(o.Component),b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject,t=c.filename(e.fq_path),s=c.parent_dir(e.fq_path),n="Dropbox",i=s.split("/");i.shift(),e.is_unmounted&&i.length>0&&(n=i.shift());var a=i[i.length-1];return i.length>=2&&(n+="/..."),a&&a.length&&(n+="/"+a),o.createElement(w,r.__assign({},this.props,{icon:e.icon,title:f.highlightMatchReact(t,e.filename_highlights),location:n,isUnmounted:e.is_unmounted}))},t})(o.Component),w=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),f.shouldHandleClick(e)&&t.props.onFileOrFolderOpen(t.props.resultObject)},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(t._listIndex)},t._onContextMenuCapture=function(){f.fetchFullSearchResult({searchApiClient:m.searchApiClient,searchResult:t.props.resultObject,user:t.props.user,onSuccess:function(e){e instanceof l.File?f.logSearchAction(e,t.props.user,"context_menu"):f.logPaperSearchAction(e,t.props.user,"paper_context_menu")}})},t}return r.__extends(t,e),t.prototype.render=function(){var e;this._listIndex=this.props.rank+1;var t=this._listIndex===this.props.highlightedRow,r={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":t};e=this.props.isUnmounted?E.reactFormat(T._("not added yet, in <locationSpan>%(location)s</locationSpan>",{comment:"Describes the mountable directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{key:"location",title:this.props.location})}):E.reactFormat(T._("<locationSpan>in %(location)s</locationSpan>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{key:"location",title:this.props.location})});var n=f.resultObjectToUrl(this.props.resultObject,this.props.user);return o.createElement("li",{className:s(r),id:"search-dropdown-suggestion"+this._listIndex,role:"option","aria-selected":t,onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter},o.createElement(p,{group:"web",name:this.props.icon,className:"search-bar__suggestion-icon",alt:""}),o.createElement("a",{href:n,onContextMenuCapture:this._onContextMenuCapture},o.createElement("div",{className:"search-bar__suggestion-name"},this.props.title),o.createElement("div",{className:"search-bar__suggestion-desc"},e)))},t})(o.Component);t.SearchBar=h(y,["/static/css/search/search_bar_react-vfljV3fKD.css"])}),define("modules/clean/search/search_helpers",["require","exports","jquery","external/classnames","react","modules/clean/analytics","modules/clean/search/store","modules/clean/react/browse/models","modules/clean/search/models","modules/core/i18n","modules/core/uri","modules/clean/browse_interface","modules/core/browser"],function(e,t,r,s,n,o,i,a,c,l,_,u,h){"use strict";function d(e,t,r,s){return new _({path:"/search/"+e.role,query:{path:t,query:r,qsid:s}})}function p(e,t){return e instanceof c.SlimFileSearchResult?u.browse_uri_for_fq_path(t,e.fq_path).toString():e.url}function E(e,t,r,s){void 0===s&&(s="full-view");var n={file_nsid:e.ns_id,file_sjid:e.sjid,match_type:e.match_type,position:e.sort_rank,request_id:e.request_id,viewport:s,action_type:r,search_session_id:i.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("result_action",t.id,n)}function S(e,t,r,s){void 0===s&&(s="full-view");var n={paper_pad_id:e.pad_id,position:e.sort_rank,request_id:e.request_id,viewport:s,action_type:r,search_session_id:i.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("result_action",t.id,n)}function m(e,t){if(!t||!t.length)return[];var r=[],s=0;return t.forEach(function(t){var n=t.pos;n>s&&(s=n);var o=e.indexOf(t.string,s);o>=0&&r.push({pos:o,len:t.string.length,string:t.string})}),r}function f(e,t){if(!t)return[{text:e,isHighlighted:!1}];t=m(e,t);for(var r=0,s=0,n=[];r<e.length;){var o=void 0,i=void 0,a=t[s];s>=t.length?(i=!1,o=r+e.length):a.pos>r?(i=!1,o=a.pos):(i=!0,o=a.pos+a.len);var c=e.substring(r,o);n.push({text:c,isHighlighted:i}),r=o,i&&s++}return n}function g(e,t){return f(e,t).reduce(function(e,t){var s=r("<span/>").text(t.text);return t.isHighlighted&&(s.addClass("highlighted"),s.addClass("is-highlighted")),e.append(s)},r("<span />"))}function R(e,t){var r=f(e,t);return n.createElement("span",null,r.map(function(e,t){return n.createElement("span",{className:s({highlighted:e.isHighlighted,"is-highlighted":e.isHighlighted}),key:t},e.text)}))}function A(e){var t=e.searchApiClient,r=e.searchResult,s=e.user,n=e.onSuccess,o=e.onError;if(r instanceof c.SlimFileSearchResult){var _=i.searchStore.findSearchFileSuggestion(r);_?n(_):t.fetchAdditionalFileMetadata({searchResults:[r],user:s,onSuccess:function(e){if(e.length>0)n(e[0]);else if(o){var t=l._("There was a problem completing this request.");o(t)}},onError:o})}else r instanceof a.Paper&&n(r)}function I(){return h.mac}function T(e){return 0===e.button&&!e.altKey&&(!t.isMac()&&!e.ctrlKey||t.isMac()&&!e.metaKey)}Object.defineProperty(t,"__esModule",{value:!0}),t.buildSearchURL=d,t.resultObjectToUrl=p,t.logSearchAction=E,t.logPaperSearchAction=S,t.highlightMatchSections=f,t.highlightMatchJQuery=g,t.highlightMatchReact=R,t.fetchFullSearchResult=A,t.isMac=I,t.shouldHandleClick=T}),define("modules/clean/search/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/selectable_list","modules/clean/search/constants","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,r,s,n,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchBar(),r._resetSearchResults(),r}return r.__extends(t,e),t.prototype._resetSearchBar=function(){this._isSearchBarFocused=!1,this._isSearchBarLoading=!1,this._rawQuery="",this._normalizedQuery="",this._searchSessionID="",this._searchSuggestions=[],this._slimSearchSuggestions=[],this._highlightedSearchRow=0},t.prototype._resetSearchResults=function(){this._browseContext=new l.BrowseContext,this._latestQuery="",this._loadingState="LOADED",this._searchResults=s.List.of(),this._selection=i.createSelection(),this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1},t.prototype.isSearchBarFocused=function(){return this._isSearchBarFocused},t.prototype.isSearchBarActive=function(){return!!this._rawQuery},t.prototype.isSearchBarLoading=function(){return this._isSearchBarLoading},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.normalizedQuery=function(){return this._normalize(this._rawQuery)},t.prototype.searchSuggestions=function(){return this._searchSuggestions},t.prototype.slimSearchSuggestions=function(){return this._slimSearchSuggestions},t.prototype.highlightedSearchRow=function(){return this._highlightedSearchRow},t.prototype.searchSessionID=function(){return this._searchSessionID},t.prototype.browseContext=function(){return this._browseContext},t.prototype.latestQuery=function(){return this._latestQuery},t.prototype.loadingState=function(){return this._loadingState},t.prototype.searchResults=function(){return this._searchResults},t.prototype.findSearchFileSuggestion=function(e){var t=e.fq_path;return this._searchSuggestions.find(function(e){return e instanceof l.File&&n.paths_are_equal(e.fq_path,t)})},t.prototype.hasMoreResults=function(e){return void 0===e&&(e=!1),this._hasMoreLiveResults||e&&this._hasMoreDeletedResults},t.prototype.numDeletedResults=function(){return this._numDeletedResults},t.prototype.didLoadDeletedResults=function(){return this._didLoadDeletedResults},t.prototype.selection=function(){return this._selection},t.prototype.selectedFiles=function(){var e=this,t=this._searchResults.filter(function(t){return t instanceof l.File&&e._selection.selected.has(t.fq_path)});return s.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype._focusSearchBar=function(){this._isSearchBarFocused=!0,this._highlightedSearchRow=0,this.emit_change()},t.prototype._blurSearchBar=function(){this._isSearchBarFocused=!1,this._highlightedSearchRow=0,this.emit_change()},t.prototype._normalize=function(e){return e.trim().replace(/\ +/g," ")},t.prototype._isBlank=function(e){return!this._normalize(e)},t.prototype._shouldStartNewSearchSession=function(e,t){return!(!this._isBlank(e)||this._isBlank(t))||e.length>=3&&1===t.length},t.prototype._generateRandomID=function(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e},t.prototype._setRawQuery=function(e,t){t?this._searchSessionID=t:this._shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionID=this._generateRandomID()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query;this._setRawQuery(t),this._searchSuggestions=[],this._slimSearchSuggestions=[],this._highlightedSearchRow=0,this._isSearchBarLoading=!!this.normalizedQuery(),this.emit_change()},t.prototype._setSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._searchSuggestions=t,this.emit_change()},t.prototype._setSlimSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._slimSearchSuggestions=t,this.emit_change()},t.prototype._setHighlightedSearchRow=function(e){var t=e.index;this._highlightedSearchRow=t,this.emit_change()},t.prototype._highlightPreviousSearchRow=function(){this._highlightedSearchRow=Math.max(0,this._highlightedSearchRow-1),this.emit_change()},t.prototype._highlightNextSearchRow=function(){var e=this._slimSearchSuggestions.length||this._searchSuggestions.length;this._highlightedSearchRow=Math.min(e,this._highlightedSearchRow+1),this.emit_change()},t.prototype._startSearch=function(e){var t=e.query,r=e.qsid;this._resetSearchResults(),this._setRawQuery(t,r),this._latestQuery=this.normalizedQuery(),this._loadingState="LOADING_FIRST_PAGE",this.emit_change()},t.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;this._setSearchResultsInternal(t),this._loadingState="LOADED",this._browseContext=r,this._updateMoreResults(t),this.emit_change()},t.prototype._setSearchResultsInternal=function(e){this._searchResults=s.List(e)},t.prototype._continueSearch=function(e){e.didLoadDeletedResults&&(this._didLoadDeletedResults=!0),this._loadingState="LOADING_ADDITIONAL_PAGE",this.emit_change()},t.prototype._appendSearchResults=function(e){var t=e.deleted,r=e.searchResults,s=e.context;t&&(this._numDeletedResults+=r.length),this._searchResults=this._searchResults.concat(r),this._loadingState="LOADED",this._browseContext=s,this._updateMoreResults(r),this.emit_change()},t.prototype._clearSearch=function(){this._resetSearchBar(),this._resetSearchResults(),this.emit_change()},t.prototype._updateMoreResults=function(e){var t=e.length===a.MaxResults.MAX_SEARCH_RESULTS;this._hasMoreLiveResults?this._hasMoreLiveResults=t:this._hasMoreDeletedResults&&(this._hasMoreDeletedResults=t)},t.prototype._setSearchSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype._applyFileDeltas=function(e){var t=e.fileDeltas;if(t){for(var r=function(e,t){var r=void 0;!e&&t?s._searchResults=s._searchResults.push(t):e&&!t?(r=s._searchResults.findIndex(function(t){return t instanceof l.File&&n.paths_are_equal(t.fq_path,e)}),s._searchResults=s._searchResults.delete(r)):e&&t&&(r=s._searchResults.findIndex(function(t){return t instanceof l.File&&n.paths_are_equal(t.fq_path,e)}),s._searchResults=r>-1?s._searchResults.set(r,t):s._searchResults.push(t))},s=this,o=0,i=t;o<i.length;o++){var a=i[o];r(a.before,a.after)}this.emit_change()}},t.prototype._updateContext=function(e){this._browseContext=e.context},t.prototype._new_payload=function(e){switch(e.action.type){case a.FOCUS_SEARCH_BAR_ACTION:this._focusSearchBar();break;case a.BLUR_SEARCH_BAR_ACTION:this._blurSearchBar();break;case a.SET_SEARCH_QUERY_ACTION:this._setSearchQuery(e.action.data);break;case a.SET_SEARCH_SUGGESTIONS_ACTION:this._setSearchSuggestions(e.action.data);break;case a.SET_SLIM_SEARCH_SUGGESTIONS_ACTION:this._setSlimSearchSuggestions(e.action.data);break;case a.SET_HIGHLIGHTED_ROW_ACTION:this._setHighlightedSearchRow(e.action.data);break;case a.HIGHLIGHT_PREVIOUS_ROW_ACTION:this._highlightPreviousSearchRow();break;case a.HIGHLIGHT_NEXT_ROW_ACTION:this._highlightNextSearchRow();break;case a.START_SEARCH_ACTION:this._startSearch(e.action.data);break;case a.SET_SEARCH_RESULTS_ACTION:this._setSearchResults(e.action.data);break;case a.CONTINUE_SEARCH_ACTION:this._continueSearch(e.action.data);break;case a.APPEND_SEARCH_RESULTS_ACTION:this._appendSearchResults(e.action.data);break;case a.SET_SEARCH_SELECTION_ACTION:this._setSearchSelection(e.action.data);break;case a.CHANGE_FILES_ACTION:this._applyFileDeltas(e.action.data);break;case a.CLEAR_SEARCH_ACTION:this._clearSearch();break;case c.BrowseActionTypes.SET_URL_PREFIX:this._clearSearch();break;case c.BrowseActionTypes.LOAD_PATH:this._updateContext(e.action.data)}},t})(o);t.SearchStore=_,t.searchStore=new _}),define("modules/clean/search/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultTypes={FILE:"FILE",PAPER:"PAPER"}}),define("modules/clean/sharing/constants",["require","exports","external/underscore","modules/constants/sharing"],function(e,t,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={}));(function(e){e[e.PUBLIC=1]="PUBLIC",e[e.TEAM_ONLY=2]="TEAM_ONLY",e[e.PASSWORD=3]="PASSWORD",e[e.ONLY_YOU=99]="ONLY_YOU"})(t.SHMODEL_LINK_TOKEN_VISIBILITY||(t.SHMODEL_LINK_TOKEN_VISIBILITY={})),t.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},t.MEMBER_ACTION={LEAVE_A_COPY:"leave_a_copy",MAKE_EDITOR:"make_editor",MAKE_OWNER:"make_owner",MAKE_VIEWER:"make_viewer",MAKE_VIEWER_NO_COMMENT:"make_viewer_no_comment",REMOVE:"remove",ALL:["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"]},t.SNIPPET_SIZES={FILENAME:22,DISPLAY_NAME:26,EMAIL:30,OUT_OF_QUOTA_FOLDER_NAME:15},t.VALIDATE_PATH_PERMISSIONS={change_options:"canChangeOptions",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership"},t.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE={change_options:"canChangeOptions",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership"},t.ALPHA_FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_pass:"disable_viewer_info",disable_viewer_info:"disablePass",edit_contents:"canEditContents",enable_pass:"enable_viewer_info",enable_viewer_info:"enablePass",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",leave_a_copy:"leaveACopy",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unmount:"canUnmountFolder",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality"},t.ALPHA_FILE_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_pass:"disablePass",enable_pass:"enablePass",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unshare:"unshare"},t.FILE_METADATA_PERMISSIONS={invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",unshare:"unshare"},t.SHARE_ACTION_ORIGIN_TYPE={BROWSE_FILE_ACTIONS:"BROWSE_FILE_ACTIONS",BROWSE_FILE_ROW:"BROWSE_FILE_ROW",BROWSE_GLOBAL_ACTIONS:"BROWSE_GLOBAL_ACTIONS",BROWSE_SHARED_FOLDER_BANNER:"BROWSE_SHARED_FOLDER_BANNER",CONTENT_MANAGER:"CONTENT_MANAGER",DESKTOP_CLIENT:"DESKTOP_CLIENT",EVENTS_PAGE:"EVENTS_PAGE",FILE_ROW_SHARE_MENU:"FILE_ROW_SHARE_MENU",GRANT_ACCESS:"GRANT_ACCESS",LEGACY_BROWSE:"LEGACY_BROWSE",LINKS_PAGE:"LINKS_PAGE",NOTIFICATION_WEB:"NOTIFICATION_WEB",OFFICE_INTEGRATION:"OFFICE_INTEGRATION",OUT_OF_QUOTA_MODAL:"OUT_OF_QUOTA_MODAL",PARENT_FOLDER_MODAL:"PARENT_FOLDER_MODAL",PREVIEW_PAGE:"PREVIEW_PAGE",PREVIEW_PAGE_FACEPILE:"PREVIEW_PAGE_FACEPILE",RECENTS:"RECENTS",SHARE:"SHARE",SHARE_LINK_MODAL:"SHARE_LINK_MODAL",SYNC_MODAL:"SYNC_MODAL",WIZARD:"WIZARD"},t.TOKEN_LINK_TYPE={SHARED_LINK:"s",SHARED_CONTENT_LINK:"c"},t.ACCESS_VALUES=r.values(t.ACCESS_LEVEL),t.GOLDEN_GATE=s.GOLDEN_GATE,t.NDSL=s.NDSL,t.PASS_CONTROL_AVAILABILITY=s.PASS_CONTROL_AVAILABILITY,t.REQUEST_ACCESS=s.REQUEST_ACCESS,t.ShareTibActionOriginType=s.ShareTibActionOriginType,t.SHARING_EXPERIMENTS=s.SHARING_EXPERIMENTS,t.TRUELINK=s.TRUELINK}),function(){define("modules/clean/web_user_action_logger",["modules/clean/ajax"],function(e){var t,r,s,n;return n={DOWNLOAD:"download",MOVE:"move",OPEN_MOVE_MODAL:"open_move_modal",RENAME:"rename",ADD_COMMENT:"add_comment",OPEN_COPY_MODAL:"open_copy_modal",COPY:"copy",DELETE:"delete",PERMANENT_DELETE:"permanent_delete",VERSIONS:"versions",SORT_RECORDS:"sort_records",SELECT_ROW:"select_row",OPEN_ROW:"open_row",UPLOAD_FILE:"upload_file",CREATE_FOLDER:"create_folder",VIEW_SHARE_MODEL:"view_share_model",TOGGLE_DELETED_FILES:"toggle_deleted_files",NAV_NEW_PAGE:"nav_new_page",SWITCH_ACCOUNT:"switch_account",SWITCH_TO_GRID_VIEW:"switch_to_grid_view",SWITCH_TO_LIST_VIEW:"switch_to_list_view"},r=3,t=6e5,s=(function(){function s(){}return s.prototype.error_count=0,s.prototype.last_error=Date.now(),s.prototype.should_report=!0,s.prototype.log=function(s,n,o){if(this.should_report&&(this.error_count<r||Date.now()-this.last_error>t))return e.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:s,event_type:n,extra_params:JSON.stringify(o)},error:(function(e){return function(t){return 429===t.status?e.error_count=r:e.error_count+=1,e.last_error=Date.now()}})(this),success:(function(e){return function(t){var r,s;try{return r=JSON.parse(t),(null!=r?r.continue_sending:void 0)||(e.should_report=!1),e.error_count=0}catch(t){throw s=t,e.error_count+=1,e.last_error=Date.now(),s}}})(this)})},s})(),{WebUserActionLog:new s,WebUserActionLogEvents:n,WebUserActionLogClass:s,MAX_ERRORS:r}})}.call(this);
//# sourceMappingURL=pkg-embedded_app.min.js-vflJ98g9s.map