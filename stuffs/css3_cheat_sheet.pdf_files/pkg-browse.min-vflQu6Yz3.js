(function(){define("modules/clean/base64",[],function(){var e,t,o;return o=function(e){var t,o,r,s,i,n;for(n=[],i=0,t=0,o=0,r=0,s=0,e+="";i<e.length;)o=e.charCodeAt(i),o<128?(n[t++]=String.fromCharCode(o),i++):o>191&&o<224?(r=e.charCodeAt(i+1),n[t++]=String.fromCharCode((31&o)<<6|63&r),i+=2):(r=e.charCodeAt(i+1),s=e.charCodeAt(i+2),n[t++]=String.fromCharCode((15&o)<<12|(63&r)<<6|63&s),i+=3);return n.join("")},t=function(e){var t,o,r,s,i,n,a,l,c,d,u,p,h,m;if(o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=void 0,u=void 0,p=void 0,i=void 0,n=void 0,a=void 0,l=void 0,r=void 0,c=0,t=0,s="",m=[],!e)return e;for(;;)if(d=e.charCodeAt(c++),u=e.charCodeAt(c++),p=e.charCodeAt(c++),r=d<<16|u<<8|p,i=r>>18&63,n=r>>12&63,a=r>>6&63,l=63&r,m[t++]=o.charAt(i)+o.charAt(n)+o.charAt(a)+o.charAt(l),!(c<e.length))break;return s=m.join(""),h=e.length%3,(h?s.slice(0,h-3):s)+"===".slice(h||3)},e=function(e,t){var r,s,i,n,a,l,c,d,u,p,h,m,f,_,g;if(h=function(e){return e},a=t?h:o,"function"==typeof window.atob)return a(window.atob(e));if(s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,r=0,g=[],!e)return e;for(e+="";;)if(l=s.indexOf(e.charAt(p++)),c=s.indexOf(e.charAt(p++)),d=s.indexOf(e.charAt(p++)),u=s.indexOf(e.charAt(p++)),i=l<<18|c<<12|d<<6|u,m=i>>16&255,f=i>>8&255,_=255&i,g[r++]=64===d?String.fromCharCode(m):64===u?String.fromCharCode(m,f):String.fromCharCode(m,f,_),!(p<e.length))break;return n=g.join(""),n=a(n)},{encode:t,decode:e}})}).call(this),function(){var e=function(e,o){function r(){this.constructor=e}for(var s in o)t.call(o,s)&&(e[s]=o[s]);return r.prototype=o.prototype,e.prototype=new r,e.__super__=o.prototype,e},t={}.hasOwnProperty;define("modules/clean/bolt",["jquery","external/underscore","modules/clean/bolt_nodeps","modules/core/exception"],function(t,o,r,s){var i,n;return i=(function(r){function i(e,r,n){i.__super__.constructor.call(this,e,r,n,"bolt.dropbox.com",t.ajax,o,s)}return e(i,r),i})(r.BoltClient),n=(function(r){function i(e,r,n){i.__super__.constructor.call(this,e,r,n,"thunder.dropbox.com",t.ajax,o,s)}return e(i,r),i})(r.ThunderClient),{BoltClient:i,ThunderClient:n,ChannelId:r.ChannelId,SignedChannelState:r.SignedChannelState,Payload:r.Payload,ChannelPayloads:r.ChannelPayloads}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function r(){this.constructor=e}for(var s in t)o.call(t,s)&&(e[s]=t[s]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},o={}.hasOwnProperty;define("modules/clean/bolt_nodeps",[],function(){var o,r,s,i,n,a,l,c,d,u,p;return o=1e3,r=3e5,l="/2/notify/subscribe",c="/2/payloads/subscribe",n=(function(){function e(e,t){this.app_id=e,this.unique_id=t}return e})(),u=(function(){function e(e,t,o,r){this.app_id=e,this.unique_id=t,this.revision=o,this.token=r}return e})(),d=(function(){function e(e,t){this.revision=e,this.payload=t}return e})(),a=(function(){function e(e,t){this.channel_state=e,this.payloads=t}return e})(),s=(function(){function t(t,r,s,i,n,a,l){this._update_callback=r,this._refresh_callback=s,this._hostname=i,this._ajax=n,this._u=a,this._exclog=null!=l?l:null,this._handle_poll_error=e(this._handle_poll_error,this),this._handle_poll_success=e(this._handle_poll_success,this),this._must_find_state=e(this._must_find_state,this),this._long_poll=e(this._long_poll,this),this._find_state=e(this._find_state,this),this._signed_channel_states=[],this._started=!1,this._sequence_num=0,this._backoff_window=o,this._additional_headers={},this._timeout_id=null,this.update_states(t)}return t.prototype._encode_channel_state=function(e){return{channel_id:{app_id:e.app_id,unique_id:e.unique_id},revision:e.revision,token:e.token}},t.prototype._decode_channel_state=function(e){return new u(e.channel_id.app_id,e.channel_id.unique_id,e.revision,e.token)},t.prototype._decode_channel_id=function(e){return new n(e.app_id,e.unique_id)},t.prototype._compare_revisions=function(e,t){var o,r,s;return o=Math.max(e.length,t.length),r=Array(o-e.length+1).join("0")+e,s=Array(o-t.length+1).join("0")+t,r<s?-1:r>s?1:0},t.prototype._find_state=function(e){return this._u.find(this._signed_channel_states,(function(t){return function(o){return t._u.isEqual(e,o.channel_id)}})(this))},t.prototype.update_states=function(e){var t,o,r,s,i;for(i=[],t=0,o=e.length;t<o;t++)s=e[t],s=this._encode_channel_state(s),r=this._find_state(s.channel_id),null==r?i.push(this._signed_channel_states.push(s)):this._compare_revisions(s.revision,r.revision)>=0?(r.revision=s.revision,i.push(r.token=s.token)):i.push(void 0);return i},t.prototype.start=function(){if(!this._started)return this._started=!0,this._long_poll()},t.prototype.unsubscribe=function(){return this._started=!1,null!=this._long_poll_xhr&&this._long_poll_xhr.abort(),this._long_poll_xhr=null,window.clearTimeout(this._timeout_id),this._timeout_id=null},t.prototype._long_poll=function(){var e;return this._sequence_num++,e=this._sequence_num,this._long_poll_xhr=this._ajax({url:this._subscribe_url(),type:"POST",data:JSON.stringify({channel_states:this._signed_channel_states}),contentType:"application/json; charset=utf-8",headers:this._additional_headers,dataType:"json",timeout:12e4,success:(function(t){return function(o,r,s){return t._handle_poll_success(e,o,r,s)}})(this),error:(function(t){return function(o,r){return t._handle_poll_error(e,o,r)}})(this),xhrFields:{withCredentials:!0}})},t.prototype._must_find_state=function(e){var t,o,r;return o=this._find_state(e),null==o&&(t="Bolt returned unknown channel id "+e,null!=(r=this._exclog)&&r.reportStack(t)),o},t.prototype._handle_poll_data=function(){var e,t;return e="Method must be implemented.",null!=(t=this._exclog)?t.reportStack(e):void 0},t.prototype._subscribe_url=function(){return"https://"+this._hostname+this._subscribe_endpoint()},t.prototype._subscribe_endpoint=function(){var e,t;return e="Method must be implemented.",null!=(t=this._exclog)?t.reportStack(e):void 0},t.prototype._handle_poll_success=function(e,t,r,s){var i,n,a;if(e===this._sequence_num&&(this._long_poll_xhr=null,this._started))return a=this._handle_poll_data(t,r,s),a.length>0&&this._u.defer(this._update_callback,a),(null!=(n=t.invalid_channels)?n.length:void 0)>0?void this._u.defer(this._refresh_callback,function(){var e,o,r,s;for(r=t.invalid_channels,s=[],e=0,o=r.length;e<o;e++)i=r[e],s.push(this._decode_channel_id(i));return s}.call(this)):(this._backoff_window=o,this._timeout_id=window.setTimeout(this._long_poll,0))},t.prototype._handle_poll_error=function(e,t,o){var s;if(e===this._sequence_num&&(this._long_poll_xhr=null,this._started))return s=Math.random()*this._backoff_window,this._backoff_window=Math.min(2*this._backoff_window,r),window.setTimeout(this._long_poll,s)},t})(),i=(function(o){function r(t,o,s,i,n,a,l){null==l&&(l=null),this._handle_poll_data=e(this._handle_poll_data,this),r.__super__.constructor.call(this,t,o,s,i,n,a,l)}return t(r,o),r.prototype._subscribe_endpoint=function(){return l},r.prototype._handle_poll_data=function(e,t,o){var r,s,i,n,a,l;if(l=[],null!=e.channel_states)for(a=e.channel_states,r=0,s=a.length;r<s;r++)n=a[r],i=this._must_find_state(n.channel_id),this._compare_revisions(n.revision,i.revision)>0&&(i.revision=n.revision,i.token=n.token,l.push(this._decode_channel_state(n)));return l},r})(s),p=(function(o){function r(t,o,s,i,n,a,l){null==l&&(l=null),this._handle_poll_data=e(this._handle_poll_data,this),r.__super__.constructor.call(this,t,o,s,i,n,a,l)}var s;return t(r,o),s="X-Bolt-Session",r.prototype.unsubscribe=function(){return this._additional_headers[s]=null,r.__super__.unsubscribe.call(this)},r.prototype._subscribe_endpoint=function(){return c},r.prototype._handle_poll_data=function(e,t,o){var r,i,n,l,c,u,p,h,m,f,_,g,w;if(w=[],this._additional_headers={},this._additional_headers[s]=o.getResponseHeader(s),null!=e.channel_payloads)for(_=e.channel_payloads,n=0,c=_.length;n<c;n++){for(r=_[n],h=r.channel_state,p=this._must_find_state(h.channel_id),i=this._decode_channel_state(r.channel_state),f=[],g=r.payloads,l=0,u=g.length;l<u;l++)m=g[l],this._compare_revisions(m.revision,p.revision)>0&&f.push(new d(m.revision,m.payload));f.length>0&&w.push(new a(i,f)),this._compare_revisions(h.revision,p.revision)>0&&(p.revision=h.revision,p.token=h.token)}return w},r})(s),{BoltClient:i,ThunderClient:p,ChannelId:n,SignedChannelState:u,Payload:d,ChannelPayloads:a}})}.call(this),define("modules/clean/browse/browse_bolt_client",["require","exports","modules/clean/bolt","modules/clean/react/browse/constants","modules/clean/ajax_as_promised"],function(e,t,o,r,s){"use strict";function i(e){}Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){var t=e.userId,i=e.nsId,n=e.path,a=this;this.startLiveUpdate=function(e){return void 0===e&&(e=null),e&&(a.handleUpdate=e),a.status===r.BrowseBoltClientStatus.PendingInitialRequest?void setTimeout(a.startLiveUpdate,500):a.status===r.BrowseBoltClientStatus.NotReady?void a.requestBoltToken().then(function(){a.startLiveUpdate()}):(a.updateBoltClient(),void(a.status=r.BrowseBoltClientStatus.Live))},this.onBoltRefresh=function(){a.requestBoltToken().then(function(){a.updateBoltClient(),a.status=r.BrowseBoltClientStatus.Live})},this.onBoltUpdate=function(){a.handleUpdate&&a.handleUpdate()},this.updateBoltClient=function(){var e=a.boltIdToLatestSjidAndToken[a.boltUniqueId],t=e[0],r=e[1],s=new o.SignedChannelState("sfj",a.boltUniqueId,t.toString(),r);a.boltClient?a.boltClient.update_states([s]):(a.boltClient=new o.BoltClient([s],a.onBoltUpdate,a.onBoltRefresh),a.boltClient.start())},this.requestBoltToken=function(){return a.status=r.BrowseBoltClientStatus.PendingInitialRequest,s.WebRequest({url:"/get_browse_bolt_token",data:{encoded_ns_id:a.boltUniqueId,path:a.path},dataType:"json",subject_user:a.userId}).then(function(e){a.boltUniqueId=e.bolt_unique_id,a.boltIdToLatestSjidAndToken[a.boltUniqueId]=[e.latest_sjid,e.bolt_token]})},this.userId=t,this.boltIdToLatestSjidAndToken={},this.status=r.BrowseBoltClientStatus.NotReady,this.path=n,this.boltUniqueId=i.toString()}return e.prototype.init=function(){var e=this;this.requestBoltToken().then(function(){e.status=r.BrowseBoltClientStatus.NotLive}).catch(function(){i("Error in /get_browse_bolt_token from requestBoltToken()"),e.status=r.BrowseBoltClientStatus.NotReady})},e.prototype.getStatus=function(){return this.status},e.prototype.getCurrentBoltId=function(){return this.status!==r.BrowseBoltClientStatus.Live&&i("Request for current bolt id, but boltClient is not live!"),this.boltUniqueId},e.prototype.handleUpdateBoltClient=function(e){this.boltUniqueId=e.bolt_unique_id,this.boltIdToLatestSjidAndToken[this.boltUniqueId]=[e.latest_sjid,e.bolt_token],this.updateBoltClient()},e.prototype.stopLiveUpdate=function(){this.status=r.BrowseBoltClientStatus.NotLive,this.boltClient&&this.boltClient.unsubscribe()},e.prototype.updateCurrentLocation=function(e,t){var o=this.boltIdToLatestSjidAndToken[e];this.path=t,this.boltUniqueId=e.toString(),o?this.updateBoltClient():(this.status=r.BrowseBoltClientStatus.NotReady,this.onBoltRefresh())},e})();t.BrowseBoltClient=n}),define("modules/clean/file_operations/notifications",["require","exports","external/underscore","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i,n,a,l,c,d){"use strict";function u(e,t,o,r,s){var i=function(){return n.rollbackChangeSets({changesets:o,userId:t.id,progressText:c._("Undoing…"),rollbackHints:r?r:void 0,onSuccess:function(){d.success(c._("Undo complete.")),s&&s()}})};a.notifyWithUndo(e,o,i)}function p(e,t){var n=r.browse_uri_for_fq_path(t,e),a=s.em_snippet(i.filename(e),40);return{href:n,text:o.escape(a)}}function h(e,t,o,r,s,i){var n;if(r){var a=p(r,t);n=c.ungettext('Copied %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Copied %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:a.href,dest_name:a.text}),n=new l(n)}else n=c.ungettext("Copied %(num_items)d item.","Copied %(num_items)d items.",e).format({num_items:e});u(n,t,o,s,i)}function m(e,t,o,r,s,i){var n;if(r){var a=p(r,t);n=c.ungettext('Moved %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Moved %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:a.href,dest_name:a.text}),n=new l(n)}else n=c.ungettext("Moved %(num_items)d item.","Moved %(num_items)d items.",e).format({num_items:e});u(n,t,o,s,i)}function f(e,t,o,r,s){u(c.ungettext("Deleted %(num_items)d item.","Deleted %(num_items)d items.",e).format({num_items:e}),t,o,r,s)}function _(e,t,o,r){u(c._("Rename complete."),e,t,o,r)}function g(e,t,o){u(c._("Created folder %(folder_name)s.").format({folder_name:e}),t,o)}function w(e){var t=c.ungettext("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e).format({num:e});d.success(t)}function S(e){var t,r=e.length;if(1===r){var s=o.escape(i.filename(e[0].fq_path));t=c._("Restored <strong>%(filename)s</strong>.").format({filename:s}),t=new l(t)}else t=c.ungettext("Restored %(num)s file.","Restored %(num)s files.",r).format({num:r});d.success(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.notifyCopySuccess=h,t.notifyMoveSuccess=m,t.notifyDeleteSuccess=f,t.notifyRenameSuccess=_,t.notifyFolderCreationSuccess=g,t.notifyPurgeSuccess=w,t.notifyRestoreSuccess=S}),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),a=(function(){function e(e){this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items)}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],o=[],r=0,n=e;r<n.length;r++){var a=n[r],l=a[this.keyName];if(null==l)return void i.warning(s._("Invalid server response"));null==this.items[l]&&(this.items[l]=a,o.push(a),t.push(l))}this.pages.push(t),this.newDataCallback(this,o)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),r.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){var o=JSON.parse(t);e.nextRequestVoucher=o.next_request_voucher,e.mode.hasMoreItems=o.has_more_items,e.autoFetching&&e.fetchNext();for(var r=0,s=o.items;r<s.length;r++){var i=s[r];i.fq_path=e.fqPathPrefix+i.fq_path}e.addPage(o.items)},error:function(){i.error(s._("There was a problem completing this request."))}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,o=this.pages[e];return null==o?null:o.map(function(e){return t.items[e]})},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=a;var l=(function(e){function t(t){return e.call(this,o.__assign({},t,{mode:new n(t.firstPage.has_more_items)}))||this}return o.__extends(t,e),t.create=function(e){return new t(e)},t})(a);t.PaginationManager=l}),define("modules/clean/react/async_file_modal_controller",["require","exports"],function(e,t){"use strict";function o(t){e(["modules/clean/react/file_modal_controller"],t)}function r(e,t,r){o(function(o){return(0,o.showCopy)(e,t,r)})}function s(e,t,r,s){o(function(o){return(0,o.showMove)(e,t,r,s)})}function i(){o(function(e){return(0,e.showOverquota)()})}function n(e,t,r){o(function(o){return(0,o.showRestore)(e,t,r)})}function a(e,t,r){o(function(o){return(0,o.showPermanentlyDelete)(e,t,r)})}function l(e,t,r,s,i,n){void 0===i&&(i=!1),void 0===n&&(n=null),o(function(o){(0,o.showDelete)(e,t,r,s,i,n)})}function c(e,t,r){o(function(o){return(0,o.showNoAccess)(e,t,r)})}function d(e,t,r){o(function(o){return(0,o.showContentManagerBridge)(e,t,r)})}function u(e){o(function(t){return(0,t.showConfirmOwnershipTransferModal)(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=r,t.showMove=s,t.showOverquota=i,t.showRestore=n,t.showPermanentlyDelete=a,t.showDelete=l,t.showNoAccess=c,t.showContentManagerBridge=d,t.showConfirmOwnershipTransferModal=u}),define("modules/clean/react/browse/action_logger",["require","exports","modules/clean/react/browse/store","modules/clean/web_user_action_logger"],function(e,t,o,r){"use strict";function s(){var e=o.browseStore.selectedFiles().toArray(),t=e.filter(function(e){return e.is_dir}).length;return{num_files:e.filter(function(e){return!e.is_dir}).length,num_dirs:t}}function i(e,t,o){var i=s(),n=i.num_files,a=i.num_dirs;r.WebUserActionLog.log(e,o,{num_files_selected:n,num_folders_selected:a,source:t})}function n(e){var t=e.uid,o=e.entity_type;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.SELECT_ROW,{entity_type:o})}function a(e){var t=e.uid,o=e.entity_type,s=e.source;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.OPEN_ROW,{entity_type:o,source:s})}function l(e){var t=e.uid,o=e.num_files,s=e.num_dirs,i=e.uploader_type,n=e.upload_method;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.UPLOAD_FILE,{num_files:o,num_dirs:s,uploader_type:i,upload_method:n})}function c(e){var t=e.uid;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.CREATE_FOLDER,{})}function d(e){var t=e.uid,o=e.modal_session_id;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.VIEW_SHARE_MODEL,{modal_session_id:o})}function u(e){var t=e.uid,o=e.show_deleted_files;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.TOGGLE_DELETED_FILES,{show_deleted_files:o})}function p(e){var t=e.uid,o=e.sort_by,s=e.sort_direction;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.SORT_RECORDS,{sort_by:o,sort_direction:s})}function h(e){var t=e.uid;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.SWITCH_TO_GRID_VIEW,{})}function m(e){var t=e.uid;r.WebUserActionLog.log(t,r.WebUserActionLogEvents.SWITCH_TO_LIST_VIEW,{})}function f(e){i(e.uid,e.source,r.WebUserActionLogEvents.VERSIONS)}function _(e){i(e.uid,e.source,r.WebUserActionLogEvents.OPEN_MOVE_MODAL)}function g(e){i(e.uid,e.source,r.WebUserActionLogEvents.MOVE)}function w(e){i(e.uid,e.source,r.WebUserActionLogEvents.RENAME)}function S(e){i(e.uid,e.source,r.WebUserActionLogEvents.ADD_COMMENT)}function b(e){i(e.uid,e.source,r.WebUserActionLogEvents.DOWNLOAD)}function y(e){i(e.uid,e.source,r.WebUserActionLogEvents.OPEN_COPY_MODAL)}function v(e){i(e.uid,e.source,r.WebUserActionLogEvents.COPY)}function T(e){i(e.uid,e.source,r.WebUserActionLogEvents.DELETE)}function F(e){i(e.uid,e.source,r.WebUserActionLogEvents.PERMANENT_DELETE)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseLogEventSources={MAESTRO_RIGHT_SIDEBAR:"MAESTRO_RIGHT_SIDEBAR",MAESTRO_PHOTOS_RIGHT_SIDEBAR:"MAESTRO_PHOTOS_RIGHT_SIDEBAR",LEGACY_HEADER_ACTIONS:"LEGACY_HEADER_ACTIONS",DRAG:"DRAG"},t.logSelectRow=n,t.logOpenRow=a,t.logUploadFile=l,t.logCreateFolder=c,t.logViewShareModel=d,t.logToggleDeletedFiles=u,t.logSortRecords=p,t.logSwitchToGridView=h,t.logSwitchToListView=m,t.logVersions=f,t.logOpenMoveModal=_,t.logMoveFiles=g,t.logRenameFiles=w,t.logAddComment=S,t.logDownload=b,t.logOpenCopyModal=y,t.logCopyFiles=v,t.logDeleteFiles=T,t.logPermanentDeleteFiles=F}),define("modules/clean/react/browse/actions",["require","exports","tslib","jquery","external/underscore","modules/clean/browse_interface","modules/clean/downloads","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/browse/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/constants/python","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y){"use strict";function v(){return e("modules/clean/react/file_viewer/controller")}function T(){return e.defined("modules/clean/react/file_viewer/controller")}function F(t){var o=t.files,i=t.indexOfPreviewFile,n=t.user,a=t.shouldFocusComment,l=t.updateBrowserLocation,c=void 0===l||l,d=t.onCloseViewer,u=void 0===d?s.noop:d,p=t.onViewerUnmount,m=void 0===p?s.noop:p,f=t.fileViewAction,_=void 0===f?g.FileViewActionType.CLICK:f,w=t.fileViewOrigin,S=void 0===w?g.FileViewOriginType.BROWSE:w;e(["modules/clean/react/file_viewer/controller"],function(e){return e.open(o,i,n,h.REACT_FILE_VIEWER_ELEMENT_ID,{fileViewTarget:g.FileViewTargetType.PRIVATE,fileViewOrigin:S,fileViewAction:_,shouldFocusCommentInput:a,disableRouting:!c,onCloseViewer:u,onComponentDidMount:function(){return r(E).hide()},onComponentWillUnmount:function(){r(E).show(),m()}})})}Object.defineProperty(t,"__esModule",{value:!0});var E=[".maestro-chrome","#maestro-nav","#page-footer","#page-header","#page-sidebar","#browse-box",".growth-onboarding-progress-bar__container",".team-progress-bar-experience","#flash-upload-container"].join(),C=(function(){function e(e){this.dataApi=e}return e.prototype.initializeEverything=function(e){var t=e.user,o=e.path,r=e.files,s=e.urlPrefix,i=e.context,n=e.mountPoints,a=e.shouldShowDeletedFiles,l=e.fqPathsToSelect,d=e.loadingState,u=e.teamFolders;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.INITIALIZE_EVERYTHING,data:{user:t,path:o,files:r,urlPrefix:s,context:i,mountPoints:n,shouldShowDeletedFiles:a,fqPathsToSelect:l,loadingState:d,teamFolders:u}})},e.prototype.load=function(e){var t=e.path,o=e.files,r=e.context;f.browseNavActions.load({path:t,files:o,context:r})},e.prototype.add=function(e){var t=e.path,o=e.files;f.browseNavActions.add({path:t,files:o})},e.prototype.setContextFile=function(e){var t=e.file;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_CONTEXT_FILE,data:{file:t}})},e.prototype.setLoadingState=function(e){var t=e.loadingState,o=e.path;f.browseNavActions.setLoadingState({loadingState:t,path:o})},e.prototype.addFilesAndSetLoadingState=function(e){var t=e.path,o=e.loadingState,r=e.files;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.ADD_FILES_AND_SET_LOADING_STATE,data:{path:t,loadingState:o,files:r}})},e.prototype.setMountPoints=function(e){var t=e.mountPoints;f.browseNavActions.setMountPoints({mountPoints:t})},e.prototype.setTeamFolders=function(e){var t=e.teamFolders;f.browseNavActions.setTeamFolders({teamFolders:t})},e.prototype.setPath=function(e){var t=e.path,o=e.onPathLoaded,r=e.nsId,s=e.logFetchedDataRequiredForTTI,i=void 0!==s&&s;f.browseNavActions.setPath({path:t,onPathLoaded:o,nsId:r,logFetchedDataRequiredForTTI:i})},e.prototype.reloadCurrentPath=function(){this.setPath({path:_.browseStore.path()})},e.prototype.setUser=function(e){var t=e.user;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_USER,data:{user:t}})},e.prototype.updatePreview=function(e){var t=e.files;T()&&v().updateFiles(t)},e.prototype.closeFileViewer=function(){T()&&v().close()},e.prototype.setUrlPrefix=function(e){var t=e.prefix;f.browseNavActions.setUrlPrefix({prefix:t})},e.prototype.setUrl=function(e){var t=e.path,o=e.qargs;f.browseNavActions.setUrl({path:t,qargs:o})},e.prototype.copySelectedFilesToClipboard=function(){var e=_.browseStore.selectedFiles();if(e.size){if(e.some(function(e){return e.isDeleted}))return void y.error(b._("Deleted files cannot be added to the clipboard"));if(e.some(m.File.isTeamSharedFolder))return void y.error(b._("Team Folders can’t be copied."));var t=b.ungettext("Added %(num_items)s item to clipboard","Added %(num_items)s items to clipboard",e.size).format({num_items:e.size});y.success(t),c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.COPY_SELECTED_FILES_TO_CLIPBOARD})}},e.prototype.pasteClipboardFilesToCurrentPath=function(){this.copyFiles({files:_.browseStore.clipboardFiles().toArray(),newPath:_.browseStore.path()})},e.prototype.selectRowsFromNotServer=function(e){void 0===e&&(e=[]),this.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:e.map(function(e){return e.fq_path})})},e.prototype.setFilePathsToSelectOnNextUpdate=function(e){var t=e.fqPathsToSelect;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,data:{fqPathsToSelect:t}})},e.prototype.copyFiles=function(e){var t=this,o=e.files,r=e.newPath,s=_.browseStore.user();this.dataApi.copyFiles({files:o,newPath:r,userId:s.id,onSuccess:function(e){var i=e.files,n=e.changesets,l=e.rollbackHints;a.notifyCopySuccess(o.length,s,n,r,l,function(){t.selectRowsFromNotServer(o)}),t.selectRowsFromNotServer(i)}})},e.prototype.moveFiles=function(e){var t=this,o=e.path,r=e.files,s=e.newPath,i=_.browseStore.user(),n=function(e){var o=(e.path,e.fileDeltas,e.changesets),n=e.rollbackHints;a.notifyMoveSuccess(r.length,i,o,s,n,function(){t.selectRowsFromNotServer(r)})},l=function(e){"This will result in losing ownership of these folders."===e&&(y.clear(),u.showConfirmOwnershipTransferModal(function(){t.dataApi.moveFiles({path:o,files:r,newPath:s,userId:i.id,onSuccess:n,allowOwnershipTransfer:!0})}))};this.dataApi.moveFiles({path:o,files:r,newPath:s,userId:i.id,onSuccess:n,onError:l,allowOwnershipTransfer:!1})},e.prototype.showFileRename=function(e){var t=e.file;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.REQUEST_NEW_FILE_NAME,data:{file:t}})},e.prototype.cancelFileRename=function(e){var t=e.file;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CANCEL_FILE_RENAME,data:{file:t}})},e.prototype.renameFile=function(e){var t=this,o=e.file,r=e.newName;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_FILE_RENAME_PENDING,data:{file:o}});var s=_.browseStore.user();this.dataApi.renameFile({file:o,newName:r,userId:s.id,onSuccess:function(e){var r=e.renamedFile,i=e.changesets,n=e.rollbackHints;a.notifyRenameSuccess(s,i,n,function(){t.selectRowsFromNotServer([o])}),t.selectRowsFromNotServer([r])},onError:function(){t.cancelFileRename({file:o})}})},e.prototype.applyFileDeltas=function(e){var t=e.path,o=e.fileDeltas;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CHANGE_FILES,data:{path:t,fileDeltas:o}})},e.prototype.getMountPointUpdateForCurrentPath=function(e){var t,o,r=_.browseStore.path(),i=_.browseStore.mountPoints(),n=i?i.toJS():{},a=function(e){return e===r},l=parseInt(s.findKey(n,a),10);if(l)t=e[l]||null,o=n[l]||null;else{o=null;t=!!s.findKey(e,a)?r:null}return[o,t]},e.prototype.getPathForNewMountPoint=function(e,t){return e&&!t?_.browseStore.path():e&&t?l.paths_are_equal(e,t)?null:t:!e&&t?_.browseStore.path():null},e.prototype.showUserNotificationForPathChange=function(e,t){function o(e){return s.escape(l.filename(e))}function r(e){y.success(new S(e))}function n(e){y.error(new S(e))}var a=t.old_fq_path,c=i.get_browse_root(e)+t.new_fq_path,d=!t.is_changing_view,u=null!=t.change_type?t.change_type.toLowerCase():null;if("moved"===u)if(d)r(b._("This folder has been moved"));else{var p=b._('The folder ‘%(folder_name)s’ has been moved. <a href="%(href)s">View</a>').format({folder_name:o(a),href:s.escape(c)});n(p)}else if("renamed"===u)if(d){var p=b._("This folder has been renamed to ‘%(folder_name)s’").format({folder_name:o(t.change_to_fq_path)});r(p)}else{var p=b._('The folder ‘%(folder_name)s’ has been renamed. <a href="%(href)s">View</a>').format({folder_name:o(a),href:s.escape(c)});n(p)}else if("deleted"===u){var p=b._("The folder ‘%(folder_name)s’ has been deleted").format({folder_name:o(a)});n(p)}},e.prototype.computeAndApplyDeltasFromNotServer=function(e){var t=e.path,o=e.payload,r=e.currentNSId,s=o.added,i=o.moved,n=o.removed,a=o.mount_points,l=o.parent_changes;if(l&&l.change_to_fq_path){var c=_.browseStore.user();return this.showUserNotificationForPathChange(c,l),void this.setUrl({path:l.change_to_fq_path})}var d=this.getMountPointUpdateForCurrentPath(a),u=d[0],p=d[1];u&&!p&&y.success(b._("The folder was unshared."));var h=this.getPathForNewMountPoint(u,p);if(h)return void this.setPath({path:h,nsId:r});this.setMountPoints({mountPoints:a});for(var f=_.browseStore.filesMap(),g=[],w=0,S=s;w<S.length;w++){var v=S[w],T=null,F=m.File.fromServerObject(v);g.push({before:T,after:F})}for(var E=0,C=i;E<C.length;E++){var I=C[E],N=I[0],v=I[1],T=f.get(N,null),F=m.File.fromServerObject(v);g.push({before:T,after:F})}for(var D=0,P=n;D<P.length;D++){var A=P[D],T=f.get(A,null),F=null;g.push({before:T,after:F})}this.applyFileDeltas({path:t,fileDeltas:g})},e.prototype.setSelection=function(e){var t=e.selection;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_SELECTION,data:{selection:t}})},e.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SELECT_FILES_BY_FQ_PATH,data:{fqPathsToSelect:t}})},e.prototype.setActiveTab=function(e){var t=e.tabName;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_ACTIVE_TAB,data:{tabName:t}})},e.prototype.navigateToFileOrFolder=function(e){var t=e.file,o=e.shouldFocusComment,r=void 0!==o&&o,s=e.onFileViewerUnmount,i=e.fileViewAction,n=void 0===i?g.FileViewActionType.CLICK:i,a=e.fileViewOrigin,l=void 0===a?g.FileViewOriginType.BROWSE:a;if(!_.browseStore.context().isNonUserRelativeContext||t.is_dir)if(t.is_dir)m.File.isNoAccessSharedFolder(t)?u.showNoAccess(_.browseStore.user(),t,_.browseStore.context()):this.setUrl({path:t.fq_path});else{var c=void 0,d=_.browseStore.getIndexOfFile(t);d>-1?c=_.browseStore.files().toJS():(d=0,c=[t]),t.isDeleted?u.showRestore(_.browseStore.user(),[t]):"download"===t.preview_type?w.unsafe_open_tab(t.href):F({files:c,indexOfPreviewFile:d,shouldFocusComment:r,user:_.browseStore.user(),onViewerUnmount:s,fileViewAction:n,fileViewOrigin:l})}},e.prototype.openPreviewForFile=function(e){var t=e.file,o=e.onCloseViewer;F({files:[t],indexOfPreviewFile:0,user:_.browseStore.user(),updateBrowserLocation:!1,onCloseViewer:o})},e.prototype.openPreviewForFiles=function(e){var t=e.files,o=e.fileViewOrigin,r=e.index,s=e.onFileViewerUnmount;F({files:t,indexOfPreviewFile:r,user:_.browseStore.user(),updateBrowserLocation:!1,onViewerUnmount:s,fileViewAction:g.FileViewActionType.CLICK,fileViewOrigin:o})},e.prototype.navigateToParentFolder=function(){var e=l.parent_dir(_.browseStore.path());this.setUrl({path:e})},e.prototype.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles,o=e.shouldReloadFolder,r=void 0===o||o;t?d.update_query_param("d","1"):d.remove_query_param("d"),c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_SHOULD_SHOW_DELETED_FILES,data:{shouldShowDeletedFiles:t}}),r&&(_.browseStore.context().isNonUserRelativeContext?this.setPath({path:_.browseStore.path(),nsId:_.browseStore.context().rootNSID}):this.reloadCurrentPath())},e.prototype.sortFiles=function(e){var t=e.sortField,o=e.sortDirection;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SORT_FILES,data:{sortField:t,sortDirection:o}})},e.prototype.setCopyMode=function(e){var t=e.copyMode;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_COPY_MODE,data:{copyMode:t}})},e.prototype.downloadFiles=function(e){
var t=e.files,o=e.context,r=e.user;if(1!==t.count()||t.first().is_dir){if(o.blockHash)if(o.isNonUserRelativeContext)n.zip_batch_by_ns_id({parent_ns_id:o.rootNSID,parent_ns_path:o.currentFQPath,files:t.toArray(),subject_uid:r.id,block_hash:o.blockHash});else{var s=o.currentFQPath,i=t.toArray().map(function(e){return e.fq_path});n.get_zip({fq_paths:i,subject_uid:r.id,block_hash:o.blockHash,parent_path:s})}}else if(o.isNonUserRelativeContext){var a=t.first(),c=a.direct_blockserver_link,d=o.rootNSID,u=l.filename(a.fq_path),p="/"===o.currentFQPath?"/"+u:o.currentFQPath+"/"+u;n.get_blockserver_link({url:c,ns_id:d,ns_path:p,inside_admin_console:!0})}else n.get_blockserver_link({url:t.first().direct_blockserver_link})},e.prototype.nameNewFolder=function(){c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.REQUEST_FOLDER_NAME})},e.prototype.createFolder=function(e){var t=this,o=e.pathName,r=e.folderName,s=e.nsId,i=void 0===s?null:s;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CREATE_FOLDER_PENDING});var n=_.browseStore.user();this.dataApi.createNewFolder({pathName:o,folderName:r,nsId:i,userId:n.id,onSuccess:function(e){var o=e.changesets,s=e.createdFolder;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CREATE_FOLDER_COMPLETE}),a.notifyFolderCreationSuccess(r,n,o),t.selectRowsFromNotServer([s])},onError:function(){c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CANCEL_CREATE_FOLDER})}})},e.prototype.cancelCreateFolder=function(){c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.CANCEL_CREATE_FOLDER})},e.prototype.addCommentStatusBatch=function(e){var t=e.commentStatusByFqPath;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.ADD_COMMENT_STATUS_BATCH,data:{commentStatusByFqPath:t}})},e.prototype.setDropTarget=function(e){var t=e.target;c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.SET_DROP_TARGET,data:{target:t}})},e.prototype.setDataApi=function(e){this.dataApi=e,f.browseNavActions.setDataApi(e)},e.prototype.fetchFolderSizes=function(e){var t=e.file;return o.__awaiter(this,void 0,void 0,function(){var e,r,s;return o.__generator(this,function(o){switch(o.label){case 0:e=_.browseStore.user(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.dataApi.fetchFolderSizes({userId:e.id,fq_path:t.fq_path})];case 2:return r=o.sent(),c.BrowseDispatcher.dispatch({type:h.BrowseActionTypes.FETCH_FOLDER_SIZES_COMPLETE,data:r}),[3,4];case 3:return s=o.sent(),[3,4];case 4:return[2]}})})},e})();t.browseActions=new C(p)}),define("modules/clean/react/browse/api",["require","exports","external/underscore","modules/clean/ajax","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/api_v2/client"],function(e,t,o,r,s,i,n,a,l,c,d){"use strict";function u(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function p(e){var t=e.path,o=e.userId,s=e.onSuccess,i=e.includeDeletedFiles,n=void 0!==i&&i,a=e.sortFoldersFirst,l=void 0===a||a,c=e.onError;return r.WebRequest({data:{show_deleted:n||"",sort_folders_first:l,path2:t},url:"/browse",subject_user:o,success:function(e){var o=u(e);o&&s({path:t,data:o})},error:function(e,t,o){c&&c(e,t,o)}})}function h(e){var t=e.files,s=e.newPath,n=e.userId,c=e.onSuccess,d=t.map(function(e){return e.fq_path});return d.includes(s)?(l.error(a._("You can’t copy a folder into itself.")),null):r.WebProgressRequest({url:"/cmd/copy",data:{files:d,to_path:s},subject_user:n,progress_text:a._("Copying files..."),success:function(e){try{var t=o.isString(e)?JSON.parse(e):e;c({files:t.new_browse_files.map(i.File.fromServerObject),destinationPath:s,changesets:t.changesets,rollbackHints:t.rollback_hints})}catch(e){}}})}function m(e){var t=e.files,s=e.userId,i=e.onSuccess,n=t.map(function(e){return e.fq_path});return r.WebProgressRequest({url:"/cmd/delete",data:{files:n},subject_user:s,progress_text:a._("Deleting files..."),success:function(e){try{var r=o.isString(e)?JSON.parse(e):e;i({fileDeltas:t.map(function(e){return{before:e,after:null}}),changesets:r.changesets,rollbackHints:r.rollback_hints})}catch(e){}}})}function f(e){var t=e.path,c=e.files,d=e.newPath,u=e.userId,p=e.onSuccess,h=e.allowOwnershipTransfer;if(t===d)return l.error(a._("Those files already exist in that folder.")),null;var m=c.map(function(e){return e.fq_path});return m.includes(d)?(l.error(a._("You can’t move a folder into itself.")),null):r.WebProgressRequest({url:"/cmd/move",data:{files:m,to_path:d,allow_ownership_transfer:h},subject_user:u,progress_text:a._("Moving files..."),skipNotifyError:!h,success:function(e){try{var r=o.isString(e)?JSON.parse(e):e,a=n.browseStore.filesMap();p({path:t,destinationPath:d,fileDeltas:r.new_browse_files.map(function(e){return{before:a.get(o.find(m,function(t){return s.filename(t)===s.filename(e.fq_path)}),null),after:i.File.fromServerObject(e)}}),changesets:r.changesets,rollbackHints:r.rollback_hints})}catch(e){}},error:function(t,o,r){l.error(r),e.onError&&e.onError(r)}})}function _(e){var t=e.file,o=e.newName,s=e.userId,n=e.onSuccess,a=e.onError;return r.WebRequest({url:new c({path:"/cmd/rename"+t.fq_path}).toString(),subject_user:s,data:{to_path:o},success:function(e,t,o){var r=u(e);if(r){var s=i.File.fromServerObject(r.new_browse_files[0]);n({changesets:r.changesets,renamedFile:s,rollbackHints:r.rollback_hints})}else a&&a()},error:a})}function g(e){var t=e.files,o=e.userId,s=e.onSuccess;return r.WebProgressRequest({url:"/cmd/restore",data:{files:t.map(function(e){return e.fq_path})},subject_user:o,dataType:"json",progress_text:a._("Restoring…"),success:function(){s()}})}function w(e){var t=e.files,o=e.userId,s=e.onSuccess,i=e.progressText,n=void 0===i?a._("Deleting…"):i;return r.WebProgressRequest({url:"/cmd/purge",data:{files:t.map(function(e){return e.fq_path})},subject_user:o,dataType:"text",progress_text:n,success:function(e){var t=u(e);t&&"success"===t.status&&s()}})}function S(e){var t=e.userId,o=e.changesets,s=void 0===o?null:o,i=e.progressText,n=e.rollbackHints,a=void 0===n?{}:n,l=e.onSuccess;return r.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(s),rollback_hints:JSON.stringify(a)},subject_user:t,progress_text:i,success:function(){l()}})}function b(e){var t=e.pathName,o=e.folderName,s=e.userId,n=e.onSuccess,a=e.onError;return r.WebProgressRequest({url:new c({path:"/cmd/new"+t}).toString(),data:{to_path:o,folder:"yes"},subject_user:s,success:function(e){var t=u(e);if(t){var o=i.File.fromServerObject(t.new_browse_files[0]);n({changesets:t.changesets,createdFolder:o})}},error:function(){a()}})}function y(e){var t=e.path,s=e.userId,i=e.namespaceToJournalIdMap,a=e.currentNS,l=e.includeDeletedFiles,c=e.onSuccess,d="/"===t?"":t,p={fq_dir:d,ns_map:o.map(i,function(e,t){return t+"_"+e}).join(","),ns_id:a,show_deleted:!!l,admin_console:n.browseStore.context().isNonUserRelativeContext||void 0};return r.WebRequest({url:"/update/list_dir",subject_user:s,data:p,dataType:"text",success:function(e){var t=u(e);t&&c(t)}})}function v(e){var t=e.userId,o=e.fq_path;return(new d.ApiV2Client).rpc(t,"folders/get_folder_sizes",{fq_path:o})}Object.defineProperty(t,"__esModule",{value:!0}),t.loadPath=p,t.copyFiles=h,t.deleteFiles=m,t.moveFiles=f,t.renameFile=_,t.restoreFiles=g,t.purgeFiles=w,t.rollbackChangeSets=S,t.createNewFolder=b,t.getChangesForDirectory=y,t.fetchFolderSizes=v}),define("modules/clean/react/browse/async_onboarding_new_folder_modal_util",["require","exports"],function(e,t){"use strict";function o(t,o){e(["modules/clean/react/browse/onboarding_new_folder_modal"],function(e){e.showOnboardingNewFolderModal(t,o)})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowOnboardingNewFolderModal=o}),define("modules/clean/react/browse/browse",["require","exports","tslib","external/immutable","external/react","external/react-dom","external/underscore","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/js_client_stopwatch","modules/clean/notserver","modules/clean/pagination_manager","modules/constants/browse","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/browse/browse_bolt_client","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react_logger","modules/clean/search/actions","modules/clean/search/store","modules/clean/sharing/browse_exports","modules/clean/viewer","modules/clean/pagelet_logger","modules/clean/web_timing_logger","modules/core/cookies","modules/core/framework_args","modules/core/i18n","modules/core/notify","modules/core/uri","modules/pagelet_config"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A,x,R,M,L,O,U,k){"use strict";function B(){return!Q&&(!!e.defined("modules/clean/react/file_viewer/controller")&&e("modules/clean/react/file_viewer/controller").isShown())}function H(e){void 0===e&&(e={}),!e.preview&&B()&&g.browseActions.closeFileViewer()}function G(e){void 0===e&&(e={});var t=B();if(e.preview&&!t){var o=v.browseStore.getFileByFilename(e.preview);o&&g.browseActions.navigateToFileOrFolder({file:o})}else t&&!e.preview&&g.browseActions.closeFileViewer()}function V(){var e=document.getElementById(b.REACT_FILE_VIEWER_ELEMENT_ID);e||(e=document.createElement("div"),e.id=b.REACT_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))}function q(){var e=document.getElementById(b.REACT_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)}function W(){var e=R.read("browse_view_type");return n.values(b.ViewTypes).includes(e)||(e=b.ViewTypes.List),e}function z(e){if(!n.values(b.ViewTypes).includes(e))throw Error("View type cookie value must be a valid ViewType");R.delete("browse_view_type"),R.create("browse_view_type",e,1095)}function j(e){var t=c.parent_dir(e);"/"!==t&&O.success(L._("Folder is in %(path)s").format({path:l.em_snippet(t,22)}))}function K(e){var t=d.deconstruct_url().qargs;d.replace_state(e,n.pick.apply(n,[t,"d","select","preview"].concat(M.FRAMEWORK_ARGS)))}Object.defineProperty(t,"__esModule",{value:!0});var Q="undefined"!=typeof RUNNING_IN_REACTSERVER,J=(function(t){function C(e){var r=t.call(this,"BrowseAppController",e)||this;return r.logOnceFetchedDataRequiredForTTI=n.once(function(){return x.log_js_modules_fetched_data_required_for_tti()}),r.receiveStateFromStores=function(){r.setState(r.getStateFromStores())},r.handleComponentTTI=function(e){r.browseLogger&&r.browseLogger.componentReady(e)},r.handleFileLocationChange=function(e,t){e=Q?r.state.path:"/"+U.decode(e),G(t),e!==r.previousHistoryCallbackPath&&(r.previousHistoryCallbackPath=e,v.browseStore.isPathEqualsTo(e)||r.navigateToPath({path:e}))},r.handleSearchLocationChange=function(e,t){if(t){var o=t.query||t.query_unnormalized;e=t.path||t.last_fq_path||"/";var s=t.qsid;if(o&&(e!==r.state.path||o!==N.searchStore.latestQuery())){var i=r.state.user||P.get_viewer().get_user_by_id(r.props["user-id"]);r.previousHistoryCallbackPath=e,v.browseStore.isPathEqualsTo(e)||g.browseActions.setPath({path:e}),I.searchActions.runSearch({user:i,path:e,query:o,qsid:s,logOnceFetchedDataRequiredForTTI:r.logOnceFetchedDataRequiredForTTI})}}},r.handleFileListUpdated=function(){if(B())r.state.files.isEmpty()?g.browseActions.closeFileViewer():g.browseActions.updatePreview({files:r.state.files.toJS()});else{G(d.deconstruct_url().qargs)}},r.handleDelete=function(){var e=r.state,t=e.selectedFiles,o=e.context;if(!t.isEmpty()){var s=t.some(y.File.isTeamSharedFolder);if(o.isCurrentPathWriteable()&&!s){var i=t.toArray();f.showDelete(r.state.user,i,o,function(){return g.browseActions.selectRowsFromNotServer(i)},!!r.props["exp-subgrowth-biz-web-client-oq-delete"])}else s?O.error(L._("Team folders can’t be deleted.")):O.warning(L._("You don’t have permission to delete files in this folder."))}},r.handleContextFileDelete=function(){var e=r.state.contextFile,t=r.state,o=t.context,s=t.user,i=y.File.isTeamSharedFolder(e);o.isCurrentPathWriteable()&&!i?f.showDelete(s,[e],o,function(){return g.browseActions.selectRowsFromNotServer([e])},!!r.props["exp-subgrowth-biz-web-client-oq-delete"]):i?O.error(L._("Team folders can’t be deleted.")):O.warning(L._("You don’t have permission to delete files in this folder."))},r.handleContextFileRestore=function(){f.showRestore(r.state.user,[r.state.contextFile])},r.handleContextFilePermanentDelete=function(){f.showPermanentlyDelete(r.state.user,[r.state.contextFile],function(){return g.browseActions.reloadCurrentPath()})},r.handleRestoreMulti=function(){var e=r.state,t=e.user,o=e.selectedFiles;f.showRestore(t,o.toArray())},r.handlePermanentDelete=function(){var e=r.state,t=e.user,o=e.selectedFiles;f.showPermanentlyDelete(t,o.toArray(),function(){return g.browseActions.reloadCurrentPath()})},r.actionHandlers={onDelete:r.handleDelete,onRestoreMulti:r.handleRestoreMulti,onPermanentDelete:r.handlePermanentDelete},r.contextFileActionHandlers={onDelete:r.handleContextFileDelete,onRestoreMulti:r.handleContextFileRestore,onPermanentDelete:r.handleContextFilePermanentDelete},r.handleSwitchViewType=function(){var e,t=r.props["user-id"];r.state.viewType===b.ViewTypes.List?(e=b.ViewTypes.Grid,_.logSwitchToGridView({uid:t})):(e=b.ViewTypes.List,_.logSwitchToListView({uid:t})),z(e),r.setState({viewType:e})},r.state=o.__assign({},r.getStateFromStores(),{viewType:W()}),r}return o.__extends(C,t),C.prototype.componentWillMount=function(){x.log_js_modules_application_code_start();var e;e=this.props["search-query"]?["ItemListController"]:this.props["mcl-list-view"]?["FilesViewController","AppActionsView"]:["ItemListController","AppActionsView"],this.browseLogger=new A.PageletLogger("browse",e,!0,{view_type:this.state.viewType.toLowerCase(),responsive_browse:m.RESPONSIVE_BROWSE});var t=P.get_viewer().get_user_by_id(this.props["user-id"]),o=a.get_browse_root(t),r=this.props["init-fq-path"]||"/",s=!!this.props["should-show-deleted-files"],i=this.props["init-data"];if(i){x.log_js_modules_fetched_data_required_for_tti();var n=void 0,l=void 0;if(i.paginated?(l=b.LoadingStates.LOADING_REMAINING_PAGES,n=[]):(l=b.LoadingStates.LOADED,n=i.file_info),g.browseActions.initializeEverything({user:t,path:r,files:n,urlPrefix:o,context:y.BrowseContext.fromServerObject(i),mountPoints:i.ns_id_to_mount_point,fqPathsToSelect:this.props["select-fq-paths"],loadingState:l,shouldShowDeletedFiles:s,teamFolders:i.team_folders_js_info}),i.paginated){var c=new h.PaginationManager({firstPage:i.first_page,keyName:"sjid",ajaxURL:"/browse_get_next",userID:t.id,newDataAvailableCallback:function(e,t){e.areAllItemsReady()?(g.browseActions.addFilesAndSetLoadingState({path:r,files:t,loadingState:b.LoadingStates.LOADED}),e.stopAutoFetching()):g.browseActions.add({path:r,files:t})}});Q||c.startAutoFetching()}}else g.browseActions.setUrlPrefix({prefix:o}),g.browseActions.setUser({user:t}),g.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:s,shouldReloadFolder:!1}),g.browseActions.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:this.props["select-fq-paths"]}),this.props["search-query"]||this.navigateToPath({path:r,logFetchedDataRequiredForTTI:!0});var u=!this.props["search-query"];d.add_callback(o,this.handleFileLocationChange,!0),d.add_callback("/search",this.handleSearchLocationChange,u),d.add_exit_callback("/search",I.searchActions.clearSearch),this.receiveStateFromStores()},C.prototype.componentDidMount=function(){var t=this;this.mounted=!0,v.browseStore.add_change_listener(this.receiveStateFromStores),N.searchStore.add_change_listener(this.receiveStateFromStores),E.UploaderStore.add_change_listener(this.receiveStateFromStores),this.receiveStateFromStores();var o=d.deconstruct_url().qargs,r=this.state,s=r.path,a=r.user;if(o.from_scl_sync_modal&&(a.is_cdm_member?j(s):O.success(L._("%(file_name)s added to your Dropbox.").format({file_name:c.filename(s)}))),!this.props["search-query"]){var p=this.props["share-link"],h=!!this.props["preview-file-info"];if(!p&&!h){K(this.getUrlForFQPath(s))}p&&!h&&a.is_cdm_member&&j(s)}u.JSStopwatch.create_stopwatch_if_not_exist("maestro_tracing"),u.JSStopwatch.recordTrace("new_markPageletRendered",{stopwatchName:"maestro_tracing",traceTime:x.time_since_start()});var m=window.ensemble;m&&(m.markPageletRenderedByDOMNode?m.markPageletRenderedByDOMNode(i.findDOMNode(this)):m.markPageletRendered&&m.markPageletRendered(k.REQUIREJS_CONFIG.context)),this.props["init-data"]&&(this.hasTTVBeenLogged||(x.mark_time_to_view(),this.hasTTVBeenLogged=!0)),V();var f=!!this.props["show-share-modal"],_=this.props["share-prefill-email"],w=this.props["preview-file-info"];if(this.props["loaded-with-explicit-preview"]&&!w){var S=d.deconstruct_url(),b=S.path,F=S.qargs;delete F.preview,d.replace_state(b,F)}if(x.waitForTTI().then(function(){t.props["search-query"]||(t.props["browse-bolt-migration"]?(t.browseBoltClient||(t.browseBoltClient=new T.BrowseBoltClient({userId:a.id,nsId:v.browseStore.context().currentNSID,path:t.state.path}),t.browseBoltClient.init()),t.setupFileEventListener(a.id)):t.setupFileEventListener(a.id)),e(["modules/clean/react/file_viewer/controller","modules/clean/react/browse/shared_with","modules/clean/react/starred/browse_exports","modules/clean/react/file_modal_controller","modules/clean/sharing/share_modal_util","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/sharing/wizard/wizard_modals","modules/clean/contacts/bloodhound_contacts_v2","modules/clean/react/browse/comment_status","modules/clean/account/email","modules/clean/unity_browse_interface","modules/clean/unity/features","modules/clean/unity/check_file_cache"],function(e,r,s,i,a,l,c,d,u,p,h,m,f,_){var g=r.SharedWithStore,w=s.checkForMissingBrowseStarredData,S=s.StarredStore,b=u.BloodhoundContactsV2,y=h.EmailVerification;if(t.mounted){var T=t.state,F=T.user,E=T.path,C=T.files,I=C.toArray();g.initializeWith({path:E,files:I}),w(I);var N=S.addListener(function(){t.setState({starredState:S.getLoadingStates()})}),D=function(){return n.defer(function(){w(t.state.files.toArray())})};v.browseStore.add_change_listener(D),t.removeStarredStoreListener=function(){N(),v.browseStore.remove_change_listener(D)},b.getOrCreateForUser(F),p.setup(),t.setState({isSharedWithLoaded:!0,isStarredLoaded:!0,isUnityLoaded:!0}),o.email_just_verified?y.getForRole(F.role).show_verified_modal():o.email_just_verified_and_changed?y.getForRole(F.role).show_verified_and_changed_modal():t.props["send-verification-email"]&&y.getForRole(F.role).show_sent_modal()}})}),w){var C=y.File.fromServerObject(w);g.browseActions.openPreviewForFile({file:C,onCloseViewer:function(){var e=["browseView","itemListController","browseTileGrid","tileGrid"].reduce(function(e,t){return null==e?null:e.refs[t]},t);e&&e.getAndUpdateTileLayout(),t.restoreUrlAfterFileViewClose()}}),f&&x.waitForTTI().then(function(){t.mounted&&D.asyncShowPrefilledShareModal({user:a,sharePrefillEmail:_,content:C})})}else f&&x.waitForTTI().then(function(){if(t.mounted){var e=t.props["ns-id"],o=t.props["ns-path"];D.asyncShowPrefilledShareModal({user:a,sharePrefillEmail:_,content:{fqPath:s,isFolder:!0,nsId:e&&o?e:null,targetNsId:e&&!o?e:null}})}});var I=this.props["notify-path-is-deleted"],P=this.props["notify-path-does-not-exist"];null!=I?O.error(L._("The folder ‘%(folder_name)s’ is deleted.").format({folder_name:l.em_snippet(I,15)})):null!=P&&O.error(L._("The folder ‘%(folder_name)s’ doesn’t exist.").format({folder_name:l.em_snippet(P,15)})),u.JSStopwatch.create_stopwatch_if_not_exist("maestro_tracing"),u.JSStopwatch.recordTrace("old_markPageletRendered",{stopwatchName:"maestro_tracing",traceTime:x.time_since_start()})},C.prototype.componentWillUpdate=function(e,t){t.isSearchMode&&!this.state.isSearchMode?this.props["browse-bolt-migration"]?this.browseBoltClient&&this.browseBoltClient.stopLiveUpdate():p.NotClients[this.state.user.id].unsubscribe(this.handlerId):!t.isSearchMode&&this.state.isSearchMode&&this.setupFileEventListener(this.state.user.id),t.files.equals(this.state.files)||setTimeout(this.handleFileListUpdated,0)},C.prototype.componentWillUnmount=function(){e.defined("modules/clean/react/browse/comment_status")&&e("modules/clean/react/browse/comment_status").teardown(),this.removeStarredStoreListener&&this.removeStarredStoreListener(),q(),v.browseStore.remove_change_listener(this.receiveStateFromStores),N.searchStore.remove_change_listener(this.receiveStateFromStores),E.UploaderStore.remove_change_listener(this.receiveStateFromStores),this.mounted=!1},C.prototype.getStateFromStores=function(){var e=v.browseStore.path(),t=N.searchStore.latestQuery();return{context:v.browseStore.context(),contextFile:v.browseStore.contextFile(),files:v.browseStore.files(),filesWithoutTeamFolders:"/"===e?v.browseStore.filesWithoutTeamFolders():r.List(),teamFolders:v.browseStore.teamFolders(),loadingState:v.browseStore.loadingState(),path:e,selection:v.browseStore.selection(),selectedFiles:v.browseStore.selectedFiles(),fileRename:v.browseStore.fileRename(),user:v.browseStore.user(),shouldShowDeletedFiles:v.browseStore.shouldShowDeletedFiles(),isDraggingInternalFiles:F.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:F.FileUploaderController.isDraggingExternalFiles(),activeDropTarget:v.browseStore.activeDropTarget(),isUploadModalOpen:F.FileUploaderController.isUploadModalOpen(),isTextSelectable:!!v.browseStore.fileRename(),inCopyMode:v.browseStore.inCopyMode(),createNewFolderState:v.browseStore.newFolderCreationState(),isSearchMode:!!t,currentSort:v.browseStore.currentSort(),urlPrefix:v.browseStore.urlPrefix(),latestQuery:t}},C.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.getUrlForFQPath(this.state.path);e=this.props["loaded-with-explicit-preview"]?n.omit(d.deconstruct_url().qargs,"preview","select"):{},d.replace_state(t,e)},C.prototype.getUrlForFQPath=function(e){var t="/"===e?"":U.encode_parts(e);return this.state.urlPrefix+t},C.prototype.setupFileEventListener=function(e){var t=this,o=p.NotClients[e];this.props["browse-bolt-migration"]?this.browseBoltClient.startLiveUpdate(function(){null!=t.getChangesRequest&&t.getChangesRequest.abort();var r=t.state,s=r.path,i=r.shouldShowDeletedFiles;t.getChangesRequest=w.getChangesForDirectory({path:s,userId:e,namespaceToJournalIdMap:o.get_ns_map(),currentNS:parseInt(t.browseBoltClient.getCurrentBoltId()),includeDeletedFiles:i,onSuccess:function(e){t.getChangesRequest=null,g.browseActions.computeAndApplyDeltasFromNotServer({payload:e,path:s}),t.browseBoltClient.handleUpdateBoltClient(e.bolt_data)}})}):(o.handler_failure(this.handlerId),null!=this.getChangesRequest&&this.getChangesRequest.abort(),this.handlerId=o.subscribe_sfj({name:"BrowseEventDispatcher",handler:function(){var r=t.state,s=r.path,i=r.shouldShowDeletedFiles;t.getChangesRequest=w.getChangesForDirectory({path:s,userId:e,namespaceToJournalIdMap:o.get_ns_map(),currentNS:-1,includeDeletedFiles:i,onSuccess:function(e){t.getChangesRequest=null,g.browseActions.computeAndApplyDeltasFromNotServer({payload:e,path:s}),o.handler_success(t.handlerId,{ns_map:e.ns_map})}})}}))},C.prototype.navigateToPath=function(e){var t=this,o=e.path,r=e.logFetchedDataRequiredForTTI,s=void 0!==r&&r;g.browseActions.setPath({path:o,logFetchedDataRequiredForTTI:s,onPathLoaded:function(){t.hasTTVBeenLogged||(x.mark_time_to_view(),t.hasTTVBeenLogged=!0),t.props["browse-bolt-migration"]&&t.browseBoltClient&&t.browseBoltClient.updateCurrentLocation(v.browseStore.context().currentNSID,o)}})},C.prototype.render=function(){var e;if(this.state.loadingState===b.LoadingStates.LOADED)e=this.state.files.size;else{var t=this.props["init-data"];e=t&&t.first_page&&t.first_page.total_num_items||this.state.files.size}var o=this.state,r=o.activeDropTarget,i=o.context,n=o.user,a=o.path,l=o.createNewFolderState,c=o.currentSort,d=o.inCopyMode,u=o.shouldShowDeletedFiles,p=o.isUploadModalOpen,h=o.selection,m=o.fileRename,f=o.files,_=o.teamFolders,g=o.isTextSelectable,w=o.loadingState,y=o.selectedFiles,v=o.isSearchMode,T=o.viewType,F=o.starredState,E=o.filesWithoutTeamFolders,C=o.isSharedWithLoaded,I=o.isStarredLoaded,N=o.isUnityLoaded,D=o.isDraggingExternalFiles,P=o.isDraggingInternalFiles;return s.createElement(S.BrowseView,{ref:"browseView",actionHandlers:this.actionHandlers,activeDropTarget:r,context:i,contextFileActionHandlers:this.contextFileActionHandlers,createNewFolderState:l,currentSort:c,ensureFileViewerClosedIfNotPreviewing:H,fileRename:m,files:f,filesWithoutTeamFolders:E,handleComponentTTI:this.handleComponentTTI,inCopyMode:d,isDraggingExternalFiles:D,isDraggingInternalFiles:P,isFileViewerShown:B,isSearchMode:v,isTextSelectable:g,isUploadModalOpen:p,limitedTeamBannerUpsell:this.props["limited-team-banner-upsell"],loadingState:w,onSwitchViewType:this.handleSwitchViewType,path:a,selectedFiles:y,selection:h,shouldOpenUploadModal:this.props["should-open-upload-modal"],shouldShowDeletedFiles:u,starredState:F,teamFolders:_,totalNumItems:e,trademarkBusiness:this.props["trademark-business"],user:n,viewType:T,isSharedWithLoaded:C,isStarredLoaded:I,isUnityLoaded:N,isMclListViewEnabled:this.props["mcl-list-view"],isNoComment:this.props["is-no-comment"],isOverFreeQuota:this.props["is-over-free-quota"],loadNewUploader:this.props["load-new-uploader"],maestroGridViewPrewarmVariant:this.props["maestro-grid-view-prewarm-variant"],maestroListViewFullRowSelect:this.props["maestro-list-view-full-row-select"],removeBasicUploader:this.props["remove-basic-uploader"],uploaderFixGating:this.props["uploader-fix-gating"],expBizFoldersEmptyStateAdmin:this.props["exp-subgrowth-biz-folders-empty-state-admin"],expBizFoldersEmptyStateUser:this.props["exp-subgrowth-biz-folders-empty-state-user"],expBizOnboardingTriggerFolderRwl:this.props["exp-subgrowth-biz-onboarding-trigger-folder-rwl"],expSubgrowthBizTeamHomeContent:this.props["exp-subgrowth-biz-team-home-content"],expSubgrowthProNearquotaUploadModal:this.props["exp-subgrowth-pro-nearquota-upload-modal"]})},C})(C.ReactLogger);t.BrowseApp=J}),define("modules/clean/react/browse/browse_drag_and_drop",["require","exports","jquery","modules/clean/react/browse/actions","modules/clean/react/browse/models","modules/clean/react/browse/store"],function(e,t,o,r,s,i){"use strict";function n(e,t,s,i,n,a){o(document).on("dragenter."+e,function(e){(t()||s())&&!o(e.target).closest(n).length&&a()&&(r.browseActions.setDropTarget({target:null}),i())})}function a(e){o(document).off("dragenter."+e)}function l(e,t,o,n,a,l,c){if(t||o){if(e.is_dir&&!(n&&o)){if(a)return;r.browseActions.setDropTarget({target:e}),c({path:e.fq_path,hasPermissionToUploadToFolder:!s.File.isReadOnlySharedFolder(e)&&l.isCurrentPathWriteable()})}else r.browseActions.setDropTarget({target:null}),c({path:i.browseStore.path(),hasPermissionToUploadToFolder:l.isCurrentPathWriteable()})}}Object.defineProperty(t,"__esModule",{value:!0}),t.setupExternalDragHandler=n,t.cleanupExternalDragHandler=a,t.onFileDragEnterItem=l}),define("modules/clean/react/browse/browse_location",["require","exports","tslib","external/classnames","external/immutable","external/mcl/icon_arrow","external/react","external/react-dom","jquery","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/actions","modules/clean/react/bubble_menu","modules/clean/react/sprite","modules/clean/react/sprite_div","modules/clean/react_logger","modules/clean/sharing/browse_exports","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b){"use strict";function y(e,t){return t?g.GoldenGate.hasContentManagerCdm(e.id)?b._("Content"):b._("Team folders"):u.filename("",S.get_root_name(e))}function v(e,t){return 20-(t?2.625:new d(e).length)}function T(e,t,o){for(var r=y(e,o),s=t.split("/").filter(Boolean),i=[{path:"",folderName:r,icon:"work"===e.role?"work_icon":"personal_icon",alt:"work"===e.role?b._("Work"):b._("Personal")}],n=0;n<s.length;n++)t="/"+s.slice(0,n+1).join("/"),i.push({path:t,folderName:u.filename(t),icon:"folder_32",alt:b._("Folder")});if(i.length<3)return{dropdownCrumbs:[],inlineCrumbs:i,root:i[0]};for(var a=i[0]&&i[0].folderName||"",l=v(a,!1),c=i.map(function(e){return new d(e.folderName||"").length}),p=1,h=c[i.length-1],n=i.length-2;n>=1&&(h+=1.64,h+=c[n],!(h>l));n--)p+=1;i.length===p+1&&(p+=1);var m=i.length-p;return{dropdownCrumbs:i.slice(0,m),inlineCrumbs:i.slice(m),root:i[0]}}Object.defineProperty(t,"__esModule",{value:!0});t.generateBreadcrumbData=T;var F=(function(e){function t(t){return e.call(this,"BrowseLocation",t)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.path,r=this.props,s=r.user,i=r.isBrowseInContentManager,a=this.props,l=a.isDraggingInternalFiles,c=a.shouldHighlightDropTargets,d=a.setFileUploaderPath,p=T(s,t,i),h=p.dropdownCrumbs,m=p.inlineCrumbs,f=p.root,_=v(f&&f.folderName||"",h.length>0),g="page-header-text u-l-fl";return m.length>1||h.length>0?n.createElement("span",null,n.createElement("h1",{className:"ax-visually-hidden"},u.filename(t)),n.createElement("nav",{className:g,id:"browse-location","aria-label":b._("Folder hierarchy"),role:"navigation"},h.length>0&&n.createElement(N,{crumbs:h,currentPath:t,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:l,shouldHighlightDropTargets:c,setFileUploaderPath:d}),m.map(function(r,i){return n.createElement(C,o.__assign({},r,{key:encodeURI(r.path),user:s,isOnlyCrumb:0===i&&1===m.length&&0===h.length,isLastCrumb:i===m.length-1,maxWidth:_,currentPath:t,selectedFiles:e.props.selectedFiles,isDraggingInternalFiles:l,isHighlightedDropTarget:c,setFileUploaderPath:d}))}))):n.createElement("h1",{className:g},y(s,i))},t})(_.ReactPureLogger);F.defaultProps={path:"/",selectedFiles:s.OrderedMap(),isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,isBrowseInContentManager:!1,setFileUploaderPath:function(){}},t.BrowseLocation=F;var E=function(){return n.createElement("span",null,n.createElement(m,{group:"web",name:"chevron",className:"breadcrumb__spacer",alt:""}))},C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDraggedOver:!1},t.handleMouseEnter=function(){t.props.isDraggingInternalFiles&&t.setState({isDraggedOver:!0})},t.handleMouseLeave=function(){t.state.isDraggedOver&&t.setState({isDraggedOver:!1})},t.handleMouseUp=function(){t.state.isDraggedOver&&t.setState({isDraggedOver:!1})},t.navigateToFolder=function(e){var o=t.props.path;w.UEClient.sendEvent("BreadCrumbSegment","linkClicked",{path:o}),e.preventDefault(),p.browseActions.setUrl({path:o})},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=0,o=null;l(a.findDOMNode(this)).on("dragenter.breadcrumb",function(r){r.preventDefault(),r.target!==o&&(o=r.target,t+=1,e.setState({isDraggedOver:!0}),e.props.isLastCrumb||e.props.setFileUploaderPath(e.props.path))}).on("dragleave.breadcrumb",function(r){r.preventDefault(),o=null,t-=1,t<1&&(t=0,e.state.isDraggedOver&&(e.props.setFileUploaderPath(e.props.currentPath),e.setState({isDraggedOver:!1})))}).on("drop.breadcrumb",function(){e.setState({isDraggedOver:!1})}).on("dragover.breadcrumb",function(e){e.preventDefault(),e.stopPropagation()}).on("mouseenter.breadcrumb",this.handleMouseEnter).on("mouseleave.breadcrumb",this.handleMouseLeave).on("mouseup.breadcrumb",this.handleMouseUp)},t.prototype.componentWillUnmount=function(){l(a.findDOMNode(this)).off(".breadcrumb")},t.prototype.render=function(){var e=this.props,t=e.user,o=e.path,s=e.isOnlyCrumb,a=e.maxWidth,l=e.isLastCrumb,u=e.isHighlightedDropTarget,p=s?this.props.folderName:d.em_snippet(this.props.folderName,a),h={
"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!l&&u,"breadcrumb-segment--file-dragged-over":!l&&this.state.isDraggedOver};return l?n.createElement("span",null,p):n.createElement("span",{className:"breadcrumb-segment__wrapper"},n.createElement(w.UserEducationEffect,{containerName:"BreadCrumbSegment",name:"link-"+o,useSpan:!0},n.createElement("a",{href:c.browse_uri_for_fq_path(t,o).toString(),onClick:this.navigateToFolder,className:r(h)},p)),n.createElement(i.IconArrow,{name:"right"}))},t})(n.Component);C.defaultProps={isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1,selectedFiles:s.OrderedMap(),setFileUploaderPath:function(){}};var I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDraggedOver:!1},t.handleMouseEnter=function(){t.props.isDraggingInternalFiles&&t.setState({isDraggedOver:!0})},t.handleMouseLeave=function(){t.state.isDraggedOver&&t.setState({isDraggedOver:!1})},t.handleMouseUp=function(){t.state.isDraggedOver&&t.setState({isDraggedOver:!1}),t.props.isDraggingInternalFiles&&!t.props.isLastCrumb&&t.props.closeFunc()},t.handleCrumbClick=function(e){e.preventDefault(),p.browseActions.setUrl({path:t.props.path})},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=0,o=null;l(a.findDOMNode(this)).on("dragenter.breadcrumbMenuItem",function(r){r.preventDefault(),r.target!==o&&(o=r.target,t+=1,e.setState({isDraggedOver:!0}),e.props.setFileUploaderPath(e.props.path))}).on("dragleave.breadcrumbMenuItem",function(r){r.preventDefault(),o=null,t-=1,t<1&&(t=0,e.state.isDraggedOver&&(e.props.setFileUploaderPath(e.props.currentPath),e.setState({isDraggedOver:!1})))}).on("drop.breadcrumbMenuItem",function(t){e.setState({isDraggedOver:!1})}).on("dragover.breadcrumbMenuItem",function(e){e.preventDefault(),e.stopPropagation()}).on("mouseenter.breadcrumbMenuItem",this.handleMouseEnter).on("mouseleave.breadcrumbMenuItem",this.handleMouseLeave).on("mouseup.breadcrumbMenuItem",this.handleMouseUp)},t.prototype.componentWillUnmount=function(){l(a.findDOMNode(this)).off(".breadcrumbMenuItem")},t.prototype.render=function(){var e=this.props,t=e.closeFunc,o=e.icon,s=e.alt,i=e.folderName,a={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver};return n.createElement(h.BubbleMenuItem,{onClick:this.handleCrumbClick,closeFunc:t,className:r(a)},n.createElement("span",{className:"force-no-break"},n.createElement(f,{group:"web",name:o,alt:s,text:d.em_snippet(i,37)})))},t})(_.ReactLogger);I.defaultProps={isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1,selectedFiles:s.OrderedMap(),setFileUploaderPath:function(){}};var N=(function(e){function t(t){return e.call(this,"BreadCrumbDropdown",t)||this}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;l(a.findDOMNode(this)).on("dragenter.breadcrumbDropdown",function(t){t.preventDefault(),e.refs.bubbleMenu.showMenu()}).on("mouseenter.breadcrumbDropdown",function(t){e.props.isDraggingInternalFiles&&(t.preventDefault(),e.refs.bubbleMenu.showMenu())})},t.prototype.componentWillUnmount=function(){l(a.findDOMNode(this)).off(".breadcrumbDropdown")},t.prototype.render=function(){var e=this.props.crumbs.slice().reverse(),t=this.props,o=t.currentPath,r=t.shouldHighlightDropTargets,s=t.isDraggingInternalFiles,i=t.selectedFiles,a=t.setFileUploaderPath;return n.createElement("span",{className:"breadcrumb-dropdown-container"},n.createElement(h.BubbleMenu,{ref:"bubbleMenu",position:h.BubbleMenu.POSITIONS.BOTTOM_RIGHT,targetButton:n.createElement("button",{className:"u-unbutton breadcrumb-overflow-button u-l-fl"},n.createElement(m,{group:"web",name:"folder_arrow_32",alt:b._("Show parent folders (descending)")})),items:e.map(function(e){return n.createElement(I,{key:encodeURI(e.path),path:e.path,icon:e.icon,alt:e.alt,folderName:e.folderName,currentPath:o,isHighlightedDropTarget:r,isDraggingInternalFiles:s,selectedFiles:i,setFileUploaderPath:a})}),targetFixed:!0}),n.createElement(E,null))},t})(_.ReactLogger);N.defaultProps={shouldHighlightDropTargets:!1,selectedFiles:s.OrderedMap(),isDraggingInternalFiles:!1,setFileUploaderPath:function(){}}}),define("modules/clean/react/browse/browse_tile_header",["require","exports","tslib","external/react","external/mcl/icon_mode","external/mcl/vertically_fixed","modules/clean/react/browse/constants","modules/core/i18n","modules/clean/react/bubble_menu","modules/clean/react/title_bubble"],function(e,t,o,r,s,i,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createOnClickHandler=function(e,o){return function(){t.props.onSortChange(e,o)}},t}return o.__extends(t,e),t.prototype.renderDropdownButton=function(){if(!this.props.currentSortField)return null;var e=this.getCurrentSortOptionDisplayName(),t=r.createElement("button",{className:"file-tile-sort-button"},e);return r.createElement(l.BubbleMenu,{items:this.getMenuItems(),arrow_position:"top",position:l.BubbleMenu.POSITIONS.BOTTOM,targetButton:t})},t.prototype.getCurrentSortOptionDisplayName=function(){var e=this.props.currentSortField,t=this.props.currentSortDirection;return e===n.BrowseSortFields.FILENAME?a._("Sort by name",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortFields.MODIFIED&&t===n.SortDirections.DESCENDING?a._("Sort by newest",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortFields.MODIFIED&&t===n.SortDirections.ASCENDING?a._("Sort by oldest",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortFields.CATEGORY?a._("Sort by kind",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortFields.EXTENSION?a._("Sort by extension",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortFields.SIZE?a._("Sort by size",{comment:"This is an option for how to sort your files"}):a._("Sort by",{comment:"Dropdown label where users can choose how to sort their files"})},t.prototype.getMenuItem=function(e,t,o){var s=t===this.props.currentSortField&&o===this.props.currentSortDirection,i="file-bubble-menu file-tile-sort-option";return s&&(i+=" file-tile-sort-option--selected"),r.createElement(l.BubbleMenuItem,{className:i,onClick:this.createOnClickHandler(t,o)},e)},t.prototype.getMenuItems=function(){return[this.getMenuItem(a._("Name",{comment:"This is an option for how to sort your files. (ex: 'Sort by Name')"}),n.BrowseSortFields.FILENAME,n.SortDirections.ASCENDING),this.getMenuItem(a._("Newest",{comment:"This is an option for how to sort your files. (ex: 'Sort by Newest')"}),n.BrowseSortFields.MODIFIED,n.SortDirections.DESCENDING),this.getMenuItem(a._("Oldest",{comment:"This is an option for how to sort your files. (ex: 'Sort by Oldest')"}),n.BrowseSortFields.MODIFIED,n.SortDirections.ASCENDING),this.getMenuItem(a._("Kind",{comment:"This is an option for how to sort your files. (ex: 'Sort by Kind')"}),n.BrowseSortFields.CATEGORY,n.SortDirections.ASCENDING),this.getMenuItem(a._("Extension",{comment:"This is an option for how to sort your files. (ex: 'Sort by Extension')"}),n.BrowseSortFields.EXTENSION,n.SortDirections.ASCENDING),this.getMenuItem(a._("Size",{comment:"This is an option for how to sort your files. (ex: 'Sort by Size')"}),n.BrowseSortFields.SIZE,n.SortDirections.ASCENDING)]},t.prototype.render=function(){return r.createElement(i.VerticallyFixed,null,r.createElement("div",{className:"file-tile-grid-sort-header--shadow"},r.createElement("div",{className:"file-tile-grid-sort-header"},this.renderDropdownButton(),r.createElement(u,{onSwitchViewType:this.props.onSwitchViewType,currentViewType:this.props.currentViewType,ref:"toggleViewTypeButton"}))))},t})(r.PureComponent);t.BrowseTileHeader=d;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e,t;return this.props.currentViewType===n.ViewTypes.Grid?(e=a._("View as list"),t=r.createElement(s.IconMode,{name:"list"})):(e=a._("View as grid"),t=r.createElement(s.IconMode,{name:"tiles"})),r.createElement(c,{content:e,position:c.POSITIONS.TOP,isTargetPositionFixed:!1,className:"toggle-view-type__title-bubble"},r.createElement("button",{key:"toggle_view_column",className:"toggle-view-type toggle-view-type--grid-view c-column-header__button u-trim-margin u-trim-padding",onClick:this.props.onSwitchViewType,ref:"button"},r.createElement("div",{"aria-label":e},t)))},t})(r.PureComponent);t.ToggleViewTypeButton=u}),define("modules/clean/react/browse/browse_view",["require","exports","tslib","external/immutable","external/react","modules/clean/react_logger","modules/clean/react/app_actions_view","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/browse_location","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/global_actions","modules/clean/react/browse/item_list","modules/clean/react/browse/files_view/controller","modules/clean/react/browse/models","modules/clean/react/browse/pinned_team_folder","modules/clean/react/browse/store","modules/clean/react/browse/util","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/maestro/layout","modules/clean/search/search_helpers","modules/clean/search/search_results","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/constants/python","modules/constants/subgrowth_experiments","modules/core/browser","modules/core/i18n","modules/clean/history"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=a.BrowseLogEventSources,M=[E.NameSpaceAccess.ACCESS_NO_ACCESS,E.NameSpaceAccess.ACCESS_READER,E.NameSpaceAccess.ACCESS_READER_NO_COMMENT],L=(function(t){function r(e){var o=t.call(this,"BrowseView",e)||this;return o.handleShowFileUploader=function(){b.FileUploaderController.setPath(o.props.path),b.FileUploaderController.showModal()},o.handleOpenContextMenuAtPosition=function(){return null},o.handleSelectionChange=function(e){var t=g.browseStore.getFileByFullPath(e.selected.first());t&&a.logSelectRow({uid:o.props.user.id,entity_type:t.is_dir?"folder":"file"}),l.browseActions.setSelection({selection:e})},o.handleFileListSortChange=function(e,t){a.logSortRecords({uid:o.props.user.id,sort_by:e,sort_direction:t}),l.browseActions.sortFiles({sortField:e,sortDirection:t})},o.handleSearch=function(e,t){if(e){var r=v.buildSearchURL(o.props.user,o.props.path,e,t);x.push_state(r.getPath(),r.getQuery())}else o.handleCancelSearch()},o.handleCancelSearch=function(){l.browseActions.setUrl({path:o.props.path})},o.handleSearchSuggestionOpen=function(e){e instanceof f.File?e.is_unmounted?F.asyncShowSharedContentLinkSyncModal(o.props.user,e):(v.logSearchAction(e,o.props.user,e.is_dir?"folder_open":"file_view","dropdown-view"),l.browseActions.navigateToFileOrFolder({file:e,fileViewAction:N.FileViewActionType.SEARCH})):e instanceof f.Paper&&(v.logPaperSearchAction(e,o.props.user,"paper_open","dropdown-view"),P.open_tab(e.url))},o.handleFullSearch=function(e,t){var r=v.buildSearchURL(o.props.user,"/",e,t);x.push_state(r.getPath(),r.getQuery())},o.handleAllFileUploadsComplete=function(e){e.find(function(e){return e.errorType===S.UploadErrorType.OVER_QUOTA_ERROR})&&b.FileUploaderController.showModal("out-of-quota")},o.state={currentMultiColumnSortField:d.BrowseSortFields.SHARED_WITH,appActionsProps:o.getCurrentAppActionsProps(o.props),viewType:null,expHasSeenNewFolderModal:null},o}return o.__extends(r,t),r.prototype.componentWillReceiveProps=function(e){e.selectedFiles===this.props.selectedFiles&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.isNoComment===this.props.isNoComment&&e.isSharedWithLoaded===this.props.isSharedWithLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.isSearchMode===this.props.isSearchMode||this.setState({appActionsProps:this.getCurrentAppActionsProps(e)})},r.prototype.componentDidMount=function(){var e=this;I.waitForTTI().then(function(){e.defineFileUploader(),e.maybeOpenUploaderOnMount()}),C.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON())},r.prototype.componentDidUpdate=function(){this.props.loadingState===d.LoadingStates.LOADED&&C.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON())},r.prototype.maybeOpenUploaderOnMount=function(){this.props.shouldOpenUploadModal&&this.handleShowFileUploader()},r.prototype.getCurrentDropTargetHighlightMode=function(){var e=this.props.selectedFiles,t=this.props.context;return t.isInsideSharedFolder&&M.includes(t.currentSharedFolderPermissionRole)?d.DropTargetHighlightMode.NONE:this.props.isDraggingInternalFiles?e.some(function(e){return e.isDeleted||e.type===d.FileTypes.TEAM_SHARED_FOLDER})?d.DropTargetHighlightMode.NONE:e.some(function(e){return e.type===d.FileTypes.SHARED_FOLDER})?t.currentNSAllowsNesting?d.DropTargetHighlightMode.NONSELECTED_FOLDERS:d.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:d.DropTargetHighlightMode.NONSELECTED_FOLDERS:this.props.isDraggingExternalFiles&&!this.props.isUploadModalOpen?d.DropTargetHighlightMode.ALL_FOLDERS:d.DropTargetHighlightMode.NONE},r.prototype.getCurrentAppActionsProps=function(t){var o,r=this,i=t.selectedFiles,n=w.getSelectedFilesText(i,t.context),a=i.count(),l=s.createElement("div",null);if(a>0)o=u.getActionsForFileCollection({files:i,context:t.context,user:t.user,skipSharing:!1,actionHandlers:t.actionHandlers,source:R.MAESTRO_RIGHT_SIDEBAR,isUnityLoaded:t.isUnityLoaded,isSearchMode:t.isSearchMode,isOverFreeQuota:t.isOverFreeQuota}),1===a&&(l=this.renderSingleSelectionAudienceBox(t));else{var c;if(t.expBizOnboardingTriggerFolderRwl&&this.state&&null===this.state.expHasSeenNewFolderModal&&(this.setState({expHasSeenNewFolderModal:!1}),c={isActive:t.expBizOnboardingTriggerFolderRwl,hasSeenNewFolderModal:!1,hasSeenNewFolderModalCallback:function(){r.setState({expHasSeenNewFolderModal:!0}),c&&(c.hasSeenNewFolderModal=!0)}}),o=p.getGlobalActions({context:t.context,user:t.user,showDeletedFiles:t.shouldShowDeletedFiles,onFileUpload:this.handleShowFileUploader,isContextMenu:!1,isNoComment:this.props.isNoComment,experiments:{expBizOnboardingTriggerFolderRwl:c}}),t.isSharedWithLoaded){var d=e("modules/clean/react/browse/shared_with").SharedWithController;l=s.createElement(d,{browseContext:t.context,tabIndex:-1,isInAudienceBox:!0})}}var h=o.map(function(e){return{displayName:e.label,iconName:e.iconName,spriteName:e.iconName?null:e.spriteName,handleClick:e.performAction,disabled:e.disabled,className:e.className}});return t.isNoComment&&(l=s.createElement("div",null)),{headerText:n,popoverTriggerLabel:A._("Actions"),primaryMenuItem:h[0],primarySubnode:l,secondaryMenuItems:h.slice(1),handleComponentTTI:t.handleComponentTTI}},r.prototype.shouldShowPinnedTeamFolder=function(){if(this.isSubgrowthPinnedExp()&&("/"!==this.props.path||this.props.viewType!==d.ViewTypes.List))return!1;var e=this.props.loadingState===d.LoadingStates.LOADED;return this.props.context.showPinnedTeamFolder&&!this.props.teamFolders.isEmpty()&&e},r.prototype.isSubgrowthPinnedExp=function(){return"ON"===D.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||["V1","V2"].includes(D.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)},r.prototype.renderPinnedTeamFolder=function(){return s.createElement(_.PinnedTeamFolder,{teamFolders:this.props.teamFolders,context:this.props.context,user:this.props.user,selection:this.props.selection,activeDropTarget:this.props.activeDropTarget,dropTargetHighlightMode:this.getCurrentDropTargetHighlightMode(),isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isTextSelectable:this.props.isTextSelectable,setFileUploaderPath:b.FileUploaderController.setPathAndPermissions,expSubgrowthBizTeamHomeContent:this.props.expSubgrowthBizTeamHomeContent})},r.prototype.renderBrowseItemList=function(){var e=this.shouldShowPinnedTeamFolder(),t=e?this.props.filesWithoutTeamFolders:this.props.files,r={ref:"itemListController",items:t,selection:this.props.selection,selectedFiles:this.props.selectedFiles,onSelectionChange:this.handleSelectionChange,fileRename:this.props.fileRename,user:this.props.user,path:this.props.path,context:this.props.context,loadingState:this.props.loadingState,isTextSelectable:this.props.isTextSelectable,shouldShowDeletedFiles:this.props.shouldShowDeletedFiles,showFileUploaderModal:this.handleShowFileUploader,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,activeDropTarget:this.props.activeDropTarget,dropTargetHighlightMode:this.getCurrentDropTargetHighlightMode(),createNewFolderState:this.props.createNewFolderState,openContextMenuAtPosition:this.handleOpenContextMenuAtPosition,activeSortField:this.props.currentSort&&this.props.currentSort.sortField,activeSortDirection:this.props.currentSort&&this.props.currentSort.sortDirection,onSortChange:this.handleFileListSortChange,setFileUploaderPath:b.FileUploaderController.setPathAndPermissions,initialMultiColumnSortField:this.state.currentMultiColumnSortField,actionHandlers:this.props.actionHandlers,contextFileActionHandlers:this.props.contextFileActionHandlers,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown,isSharedWithLoaded:this.props.isSharedWithLoaded,isStarredLoaded:this.props.isStarredLoaded,isUnityLoaded:this.props.isUnityLoaded,isOverFreeQuota:this.props.isOverFreeQuota,viewType:this.props.viewType,onSwitchViewType:this.props.onSwitchViewType,totalNumItems:this.props.totalNumItems,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,maestroGridViewPrewarmVariant:this.props.maestroGridViewPrewarmVariant,isSubgrowthPinnedExp:e&&this.isSubgrowthPinnedExp(),numTeamFolders:this.props.teamFolders.size,expBizFoldersEmptyStateAdmin:this.props.expBizFoldersEmptyStateAdmin,expBizFoldersEmptyStateUser:this.props.expBizFoldersEmptyStateUser};if(this.props.isMclListViewEnabled){var i={currentSort:this.props.currentSort,files:r.items,onComponentTTI:r.handleComponentTTI,totalNumFiles:r.totalNumItems};return s.createElement(m.FilesViewController,o.__assign({},r,i))}return s.createElement(h.ItemListController,o.__assign({},r))},r.prototype.defineFileUploader=function(){b.FileUploaderController.loadCoreComponent()},r.prototype.maybeRenderBrowseFileUploader=function(){var e=this.props,t=e.user,o=e.context;return t&&null!=o.currentFQPath?s.createElement(b.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",loadOnRender:!1,needToSetStoreValues:!1,onAllFileUploadsComplete:this.handleAllFileUploadsComplete,expSubgrowthProNearquotaUploadModal:this.props.expSubgrowthProNearquotaUploadModal,loadNewUploader:this.props.loadNewUploader,removeBasicUploader:this.props.removeBasicUploader,uploaderFixGating:this.props.uploaderFixGating}):null},r.prototype.renderSingleSelectionAudienceBox=function(e){var t=e.selectedFiles.first();return e.isSharedWithLoaded?this.renderAudienceBox(e,t):null},r.prototype.renderAudienceBox=function(t,o){var r=e("modules/clean/react/browse/shared_with").SharedWithController;return s.createElement(r,{file:o,browseContext:t.context,tabIndex:-1,isInAudienceBox:!0})},r.prototype.renderBrowseLocation=function(){var e=this.props.path;if(e){var t=e.split("/"),o=t.length;document.title="/"!==e?A._("%(folder_name)s - Dropbox").format({folder_name:e.split("/")[o-1]}):A._("Files - Dropbox")}var r=this.props,i=r.isDraggingInternalFiles,n=r.isDraggingExternalFiles,a=r.isUploadModalOpen;return s.createElement(c.BrowseLocation,{path:this.props.path,user:this.props.user,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:i,setFileUploaderPath:b.FileUploaderController.setPathAndPermissions,shouldHighlightDropTargets:i||n&&!a})},r.prototype.renderSideBar=function(){return s.createElement("div",{className:"maestro-browse-action-sidebar"},this.maybeRenderBrowseFileUploader(),s.createElement(n.AppActionsView,o.__assign({},this.state.appActionsProps)))},r.prototype.renderAppContent=function(){return s.createElement("div",{className:"maestro-browse-app-content"},this.shouldShowPinnedTeamFolder()&&this.renderPinnedTeamFolder(),this.renderBrowseItemList())},r.prototype.renderBrowse=function(){var e=this.props.user;return s.createElement(y.MaestroChrome,{user:e,titleRegion:this.renderBrowseLocation(),embeddedAppRegion:this.renderAppContent(),actionSidebarRegion:this.renderSideBar(),searchBarProps:this.getSearchBarProps()})},r.prototype.renderSearchResults=function(){var e=this.props,t=e.path,o=e.user,r=e.limitedTeamBannerUpsell,i=e.trademarkBusiness,n=e.maestroListViewFullRowSelect,a=e.handleComponentTTI,l=e.isFileViewerShown,c=e.ensureFileViewerClosedIfNotPreviewing,d=e.contextFileActionHandlers;return s.createElement(T.SearchResultsController,{path:t,user:o,trademarkBusiness:i,limitedTeamBannerUpsell:r,maestroListViewFullRowSelect:n,onFullSearch:this.handleFullSearch,setFileUploaderPath:b.FileUploaderController.setPathAndPermissions,maestroSearchBarProps:this.getSearchBarProps(),handleComponentTTI:a,ensureFileViewerClosedIfNotPreviewing:c,isFileViewerShown:l,isMclListViewEnabled:this.props.isMclListViewEnabled,contextFileActionHandlers:d})},r.prototype.getSearchBarProps=function(){var e=this.props,t=e.path,o=e.limitedTeamBannerUpsell,r=e.trademarkBusiness;return{showSearchBar:!0,currentPath:t,onSearch:this.handleSearch,onCancelSearch:this.handleCancelSearch,onFileOrFolderOpen:this.handleSearchSuggestionOpen,limitedTeamBannerUpsell:o,trademarkBusiness:r}},r.prototype.render=function(){return this.props.isSearchMode?this.renderSearchResults():this.renderBrowse()},r})(i.ReactPureLogger);L.defaultProps={selectedFiles:r.OrderedMap(),viewType:d.ViewTypes.List},t.BrowseView=L}),define("modules/clean/react/browse/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseDispatcher=o}),define("modules/clean/react/browse/empty_folder_display_props",["require","exports","external/classnames","modules/clean/static_urls","modules/constants/python","modules/core/i18n"],function(e,t,o,r,s,i){"use strict";function n(e){return o({"exp-subgrowth-biz-folders-empty-state-admin":e.expBizFoldersEmptyStateAdmin,"exp-subgrowth-biz-folders-empty-state-user":e.expBizFoldersEmptyStateUser})}function a(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin)return e.isInsideTeamFolderTree?"/help/986":e.isInsideSharedFolder?"/help/19":"/help/140"}function l(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin)return e.isInsideTeamFolderTree?i._("team folder."):e.isInsideSharedFolder?i._("shared folder."):i._("private folder.")}function c(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin){if(!e.isInsideTeamFolderTree)return e.isInsideSharedFolder?r.static_url("/static/images/empty_states/shared_folder-vfluMX_ZB.svg"):r.static_url("/static/images/empty_states/private_folder-vfl9oQu0u.svg");if(e.expBizFoldersEmptyStateUser)return r.static_url("/static/images/empty_states/team_folder_users-vfl43jKCj.svg");if(e.expBizFoldersEmptyStateAdmin)return r.static_url("/static/images/empty_states/team_folder_admins-vflvhP--E.svg")}}function d(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin)return c(e)}function u(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin){if(!e.isInsideTeamFolderTree)return e.isInsideSharedFolder?i._("Changes to the contents of a shared folder are synced to everyone who has access to the shared folder. People with access can edit, view and comment on files. To add contents to this folder, drag and drop files onto this window."):i._("Private folders are not shared with anybody; only you can see the contents in a private folder. To add contents to this folder, drag and drop files onto this window.");if(e.expBizFoldersEmptyStateUser)return i._("Contents added to this team folder will be synced to everyone who has been granted permission to access it. Team folder permissions and settings are managed by your %(trademark_business)s team admin.").format({trademark_business:s.TRADEMARK_BUSINESS});if(e.expBizFoldersEmptyStateAdmin)return i._("Contents added to this team folder will be synced to everyone who has been granted permission to access it. You can manage permissions for this team folder in the Team Folder tab in the Admin Console.")}}function p(e){if(e.expBizFoldersEmptyStateUser||e.expBizFoldersEmptyStateAdmin)return e.isInsideTeamFolderTree?i._("This is a team folder."):e.isInsideSharedFolder?i._("This is a shared folder."):i._("This is a private folder.")}function h(e){return{className:n(e),helpLink:a(e),imgAlt:l(e),imgSrc:c(e),imgSrcHiRes:d(e),folderInfo:u(e),tagline:p(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyFolderDisplayProps=h}),define("modules/clean/react/browse/file_actions",["require","exports","tslib","external/underscore","modules/clean/ajax","modules/clean/analytics","modules/clean/browse_interface","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/home/home_access/home_access_util","modules/clean/search/search_helpers","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/react/browse/professional_collection_actions","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/browse","modules/constants/python","modules/constants/starred","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E){"use strict";function C(e,t){return t?e.isDeleted||e.is_unmounted:e.isDeleted}function I(e){var t=e.toArray().map(function(e){return e.fq_path});return a.inSameDirectory(t)}function N(e){var t=e.user,r=e.context,s=e.files,i=e.isPhotosPage,n=void 0!==i&&i,a=e.isUnityLoaded,l=void 0!==a&&a,c=o.__assign({},L);if(r.isInsideArchivedTeamFolder)return c.showDownload=!0,c;var d=!r.isNonUserRelativeContext,u=s.every(function(e){return!C(e,d)}),p=!u&&s.every(function(e){return C(e,d)});return u?D({actions:c,files:s,context:r,user:t,isPhotosPage:n,isUnityLoaded:l}):p?P({actions:c,files:s,context:r,user:t}):c}function D(t){var o,r=t.actions,s=t.files,i=t.context,n=t.user,a=t.isPhotosPage,l=void 0!==a&&a,c=t.isUnityLoaded,d=void 0!==c&&c,p=1===s.count(),m=p&&!s.first().is_dir,_=p&&s.first().is_dir,g=s.every(function(e){return e.type===u.FileTypes.FILE}),w=s.some(function(e){return e.type===u.FileTypes.TEAM_SHARED_FOLDER}),S=s.some(function(e){return e.type===u.FileTypes.TEAM_SHARED_FOLDER&&"archived"===e.team_folder_status}),y=s.some(function(e){return e.type===u.FileTypes.TEAM_SHARED_FOLDER&&"archive_in_progress"===e.team_folder_status}),T=s.some(function(e){return e.type===u.FileTypes.TEAM_MEMBER_FOLDER}),F=!1;if(r.showCopy=!w&&!T&&!l,w||T||(r.showDelete=!l,r.showRename=i.isInFolderMode&&p&&!l,r.showMove=!l),n&&n.is_team_admin&&f.GoldenGate.hasContentManagerAndSuperAdmin(n.id)&&p&&w&&(S&&(r.showUnarchive=!0,r.showRenameArchivedTeamFolder=!0,r.showPermanentDeleteTeamFolder=!0),y&&(r.showArchiveInProgress=!0)),n&&f.GoldenGate.hasContentManagerAndSuperAdmin(n.id)&&f.GoldenGate.hasNewOwnershipModel(n.id)&&i.isInsideTeamFolderTree&&!i.isNonUserRelativeContext&&(r.showManageAsAdmin=!0),p){var E=s.first();if(o=f.shouldUsePublicFolderSharing(i.config,E.fq_path),o||T||i.isNonUserRelativeContext&&(y||S)||(r.showTiburonShare=!0),d){var C=e("modules/clean/unity/features"),N=e("modules/clean/unity/check_file_cache");F=null!=C&&null!=N&&N.is_cached_and_locally_available(E.ns_id,E.ns_path),F&&(r.showOpen=!0)}}if(r.showShowInFolder=l&&I(s),m&&(i.isNonUserRelativeContext?r.showActivity=!0:r.showComment=!0,r.showVersions=!0,i.isInFolderMode?r.showCopyPublicFolderFileLink=!!o:r.showCopyPublicFolderFileLink=!1),F||w&&i.isNonUserRelativeContext||(r.showDownload=i.isInFolderMode||m||l),g&&i.isCurrentPathWriteable()&&b.PROFESSIONAL_COLLECTION_MAESTRO.forEach(function(e){e.uid===n.id&&e.rule&&(r.showProfessionalCollectionShare=!0)}),p&&!i.isNonUserRelativeContext){var D=s.first().type;D!==u.FileTypes.SHARED_FOLDER&&D!==u.FileTypes.TEAM_SHARED_FOLDER||i.isNonUserRelativeContext&&(y||S)||(r.showSharedFolderEvents=!0),b.BROWSE_GET_FOLDER_SIZES&&_&&!l&&(r.showCalculateFolderSize=!0)}var P=e.defined("modules/clean/react/starred/browse_exports");if(p&&h.isHomeEnabled()&&P){var A=e("modules/clean/react/starred/browse_exports").StarredStore,x={id:s.first().file_id,type:v.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID},R=A.getIsLoading(x),M=A.getIsStarred(x);r.showStar=M===!1,r.showUnstar=M===!0,r.showLoadingStar=R}return r}function P(e){var t=e.actions,o=e.files,r=e.context,s=e.user;if(o.some(function(e){return e.is_unmounted}))return t;var i,n,a=1===o.count()&&o.first().is_dir;a?(n=o.first(),i=!!r.inactiveNSIDByFQPath[n.fq_path.toLowerCase()]):i=!1,i?t.showReadd=!0:t.showRestore=!0;var l;if(r.isNonUserRelativeContext)l=!1;else if(r.isInFolderMode)l=r.permanentDeletionDisabledStateByNSID[r.currentNSID];else{var c=o.map(function(e){return e.ns_id});l=c.some(function(e){return r.permanentDeletionDisabledStateByNSID[e]})}return s&&f.GoldenGate.hasContentManagerAndSuperAdmin(s.id)&&f.GoldenGate.hasNewOwnershipModel(s.id)&&r.isInsideTeamFolderTree&&!r.isNonUserRelativeContext&&(t.showManageAsAdmin=!0),l||(i?t.showRemoveAccess=!0:t.showPermanentDelete=!0),r.isNonUserRelativeContext&&(t.showRemoveAccess=!1,t.showReadd=!1,(o.count()>1||a)&&(t.showRestore=!1),o.count()>1&&(t.showPermanentDelete=!1)),t}function A(e,t){var o=t.user,r=t.context,i=t.actionHandlers,n=t.firstFile,l=t.isSearchMode;if(r.isNonUserRelativeContext)i.onManage&&i.onManage(n);else if(l&&m.logSearchAction(n,o,"share"),e.autoShareLink){var c=new E({path:"/sm/create"+a.normalize(n.fq_path)});c.updateQuery("_subject_uid",o.id.toString()),c.updateQuery("redirect","0");var d=function(e){T.redirect(e)};s.WebRequest({url:c.toString(),type:"POST",success:d})}else f.asyncShowShareModal(o,n,{browseContext:r,origin:_.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS})}function x(e){var t=e.files,o=e.context,r=e.user,s=e.actionHandlers,i=e.skipSharing,n=void 0!==i&&i,a=e.source,l=e.isOverFreeQuota,c=void 0!==l&&l,d=e.isPhotosPage,u=void 0!==d&&d,h=e.isSearchMode,m=void 0!==h&&h,f=e.isUnityLoaded,_=void 0!==f&&f,g=t.first(),w=!o.isCurrentPathWriteable(),S=w,b=w,y=w,v=w,T=t.some(function(e){return!p.File.canViewFileMembers(e,o)}),E=T,C=T,I=t.every(p.File.isNoAccessSharedFolder),D=I,P=I,A=N({files:t,context:o,user:r,isUnityLoaded:_,isPhotosPage:u}),x=[],R={user:r,context:o,actionHandlers:s,files:t,firstFile:g,isSearchMode:m,source:a};if(!n&&A.showTiburonShare){var M=E;x.push({label:o.isNonUserRelativeContext?F._("Manage"):F._("Share"),spriteName:"s_rainbow",iconName:"link",performAction:U(R),disabled:M,className:"action-share"}),o.isNonUserRelativeContext||x.push({label:F._("Create link"),performAction:k(R),disabled:M,className:"action-share-link",iconName:"link"})}if(A.showCopyPublicFolderFileLink&&x.push({label:F._("Copy public link"),spriteName:"world_link",className:"action-world-link",performAction:H(R)}),A.showOpen&&x.push({label:F._("Open"),performAction:G(R),iconName:"open-in-app",className:"action-open-in-app"}),A.showShowInFolder&&x.push({
label:F._("Show in folder"),performAction:O(R),iconName:"open-in-app",className:"action-show-in-folder"}),A.showDownload&&x.push({label:F._("Download"),performAction:V(R),disabled:D,iconName:"download",className:"action-download"}),A.showProfessionalCollectionShare&&x.push({label:F._("Add to collection"),iconName:"add-to-collection",performAction:B(R)}),A.showComment&&x.push({label:F._("Add comment"),performAction:q(R),iconName:"add-comment",className:"action-add-comment"}),A.showStar&&x.push({label:F._("Star",{comment:'Verb describing the "starring" action, not the noun.'}),performAction:W({isStarred:!0,args:R}),disabled:A.showLoadingStar,iconName:"star",className:"action-star"}),A.showUnstar&&x.push({label:F._("Unstar",{comment:'Verb describing the "unstarring" action.'}),performAction:W({isStarred:!1,args:R}),disabled:A.showLoadingStar,iconName:"unstar",className:"action-unstar"}),A.showVersions&&x.push({label:F._("Version history"),performAction:re(R),iconName:"view-version-history",className:"action-view-version-history"}),A.showUnarchive&&x.push({label:F._("Restore"),spriteName:"restore",className:"action-restore",performAction:J(R)}),A.showPermanentDeleteTeamFolder&&x.push({label:F._("Permanently delete"),spriteName:"cancel",className:"action-cancel",performAction:Y(R)}),A.showArchiveInProgress&&x.push({label:F._("Archive in progress"),performAction:Z(R)}),A.showRename&&x.push({label:F._("Rename"),performAction:z(R),iconName:"rename",className:"action-rename",disabled:b}),A.showRenameTeamFolder&&x.push({label:F._("Rename"),performAction:j(R),iconName:"rename",className:"action-rename"}),A.showRenameArchivedTeamFolder&&x.push({label:F._("Rename"),performAction:K(R),iconName:"rename",className:"action-rename"}),A.showArchive&&x.push({label:F._("Archive"),performAction:Q(R),iconName:"delete",className:"action-delete"}),A.showMove){var L=c?ee():X(R);x.push({label:F._("Move"),performAction:L,disabled:y,iconName:"move",className:"action-move"})}if(A.showCopy){var de=c?ee():$(R);x.push({label:F._("Copy"),performAction:de,disabled:P,iconName:"copy",className:"action-copy"})}return A.showDelete&&x.push({label:F._("Delete"),performAction:ie(R),disabled:S,iconName:"delete",className:"action-delete"}),A.showRestore&&x.push({label:F._("Restore"),spriteName:"restore",className:"action-restore",performAction:te(R),disabled:v}),A.showReadd&&x.push({label:F._("Re-add shared folder"),spriteName:"restore",className:"action-re-add",performAction:oe(R),disabled:v}),A.showPermanentDelete&&x.push({label:F._("Permanently delete"),iconName:"delete",className:"action-permanently-delete",performAction:ne(R)}),A.showActivity&&x.push({label:F._("View activity"),performAction:se(R),iconName:"view-version-history",className:"action-view-version-history"}),A.showSharedFolderEvents&&x.push({label:F._("Events"),performAction:ae(R),disabled:C,iconName:"events",className:"action-events"}),A.showCalculateFolderSize&&x.push({label:F._("Calculate size"),performAction:le(R),iconName:"rename",className:"action-calculate-folder-size"}),A.showManageAsAdmin&&x.push({label:F._("Manage as admin"),performAction:ce(R),iconName:"settings-gear"}),x}function R(e){var t=e.event,o=e.user,s=e.files,i=e.index,n=e.onFileViewerUnmount,a=e.source;c.logOpenRow({uid:o.id,entity_type:"file",source:a}),t.button>0||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey||(t.preventDefault(),t.stopPropagation(),d.browseActions.openPreviewForFiles({files:s,index:i,onFileViewerUnmount:n||r.noop,fileViewOrigin:y.FileViewOriginType.PHOTOS}))}function M(e){var t=e.event,o=e.user,r=e.file,s=e.isSearchMode,n=e.constructorDisplayName,a=e.onFileViewerUnmount,l=e.source;if(c.logOpenRow({uid:o.id,entity_type:r.is_dir?"folder":"file",source:l}),!(t.button>0||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey))if(t.preventDefault(),t.stopPropagation(),r.type===u.FileTypes.TEAM_SHARED_FOLDER&&(w.UEClient.sendEvent(n,"TeamFolderClicked"),i.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:S.get_viewer().team_id})),s&&r.is_unmounted)m.logSearchAction(r,o,"unmounted_view"),f.asyncShowSharedContentLinkSyncModal(o,r);else{var p=y.FileViewActionType.CLICK;s&&(m.logSearchAction(r,o,r.is_dir?"folder_open":"file_view"),p=y.FileViewActionType.SEARCH),d.browseActions.navigateToFileOrFolder({file:r,onFileViewerUnmount:a,fileViewAction:p})}}Object.defineProperty(t,"__esModule",{value:!0});var L={showProfessionalCollectionShare:!1,showTiburonShare:!1,showCopyPublicFolderFileLink:!1,showOpen:!1,showDownload:!1,showComment:!1,showDelete:!1,showArchive:!1,showUnarchive:!1,showArchiveInProgress:!1,showRemove:!1,showRename:!1,showRenameTeamFolder:!1,showRenameArchivedTeamFolder:!1,showMove:!1,showCopy:!1,showVersions:!1,showRestore:!1,showReadd:!1,showPermanentDelete:!1,showPermanentDeleteTeamFolder:!1,showRemoveAccess:!1,showActivity:!1,showShowInFolder:!1,showStar:!1,showUnstar:!1,showLoadingStar:!1,showSharedFolderEvents:!1,showCalculateFolderSize:!1,showManageAsAdmin:!1},O=function(e){var t=e.user,o=e.files,r=o.map(function(e){return e.fq_path}).toArray();return function(){var e=r.map(function(e){return a.filename(e)}),o=a.parent_dir(r[0]),s=n.browse_uri_for_fq_path(t,o);e.length>1?s.updateQuery({select_multi:JSON.stringify(e)}):s.updateQuery({select:e[0]}),window.open(s.toString(),"_blank")}},U=function(e){return function(){A({autoShareLink:!1},e)}},k=function(e){return function(){A({autoShareLink:!0},e)}},B=function(e){return function(){var t=e.user,o=e.files;if(o.count()>=1){var r=o.map(function(e){return{ns_id:e.ns_id,ns_path:e.ns_path}}).toArray();g.showAddToCollectionModal(r,t)}}},H=function(e){return function(){var t=e.user,o=e.context,r=e.firstFile;if(o.config&&r&&r.fq_path){var s=f.makePublicFolderLink(t.id,o.config,r.fq_path,r.is_dir);s&&f.showPublicFolderLinkModal(s)}}},G=function(t){return function(){var o=t.user,r=t.firstFile;t.isSearchMode&&m.logSearchAction(r,o,"open"),e(["modules/clean/unity/features"],function(e){return e.open_file(r.ns_id,r.ns_path,o.id,e.standard_open_file_handler,function(){return e.standard_open_file_handler(!1)})})}},V=function(e){return function(){var t=e.user,o=e.context,r=e.files,s=e.firstFile,i=e.isSearchMode,n=e.source;i&&m.logSearchAction(s,t,"download"),c.logDownload({uid:t.id,source:n}),d.browseActions.downloadFiles({files:r,context:o,user:t})}},q=function(e){return function(){var t=e.user,o=e.firstFile,r=e.isSearchMode,s=e.source;r&&m.logSearchAction(o,t,"comment"),c.logAddComment({uid:t.id,source:s}),d.browseActions.navigateToFileOrFolder({file:o,shouldFocusComment:!0,fileViewOrigin:y.FileViewOriginType.BROWSE})}},W=function(t){var o=t.isStarred,r=t.args;return function(){var t=r.user,s=r.firstFile,i=r.isSearchMode;if(e.defined("modules/clean/react/starred/browse_exports")){i&&m.logSearchAction(s,t,"star");e("modules/clean/react/starred/browse_exports").StarredActions.update(t.role,s.file_id,v.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,o)}}},z=function(e){return function(){var t=e.user,o=e.firstFile,r=e.isSearchMode,s=e.source;r&&m.logSearchAction(o,t,"rename"),c.logRenameFiles({uid:t.id,source:s}),d.browseActions.showFileRename({file:o})}},j=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.files,i=e.firstFile,n=e.isSearchMode;o.isNonUserRelativeContext?r.onRenameTeamFolder&&r.onRenameTeamFolder(i):(n&&m.logSearchAction(i,t,"rename"),l.showContentManagerBridge(s.toArray(),"rename",S.get_viewer().team_is_limited))}},K=function(e){return function(){var t=e.context,o=e.actionHandlers,r=e.firstFile;t.isNonUserRelativeContext&&o.onRenameTeamFolderArchived&&o.onRenameTeamFolderArchived(r)}},Q=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.files,i=e.firstFile,n=e.isSearchMode;o.isNonUserRelativeContext?r.onArchive&&r.onArchive(i):(n&&m.logSearchAction(i,t,"archive"),l.showContentManagerBridge(s.toArray(),"archive",S.get_viewer().team_is_limited))}},J=function(e){return function(){var t=e.context,o=e.actionHandlers,r=e.firstFile;t.isNonUserRelativeContext&&o.onUnarchive&&o.onUnarchive(r)}},Y=function(e){return function(){var t=e.context,o=e.actionHandlers,r=e.firstFile;t.isNonUserRelativeContext&&o.onPermanentDeleteArchived&&o.onPermanentDeleteArchived(r)}},Z=function(e){return function(){var t=e.context,o=e.actionHandlers;t.isNonUserRelativeContext&&o.onArchiveInProgress&&o.onArchiveInProgress()}},X=function(e){return function(){var t=e.user,o=e.context,r=e.files,s=e.firstFile,i=e.source;e.isSearchMode&&m.logSearchAction(s,t,"move"),c.logOpenMoveModal({uid:t.id,source:i}),l.showMove(t,r.toArray(),o.currentFQPath,{onSuccess:function(){c.logMoveFiles({uid:t.id,source:i})},onUndo:function(){d.browseActions.selectRowsFromNotServer(r.toArray())},onRequestNotSent:function(){d.browseActions.selectFilesByFqPath({fqPathsToSelect:r.toArray().map(function(e){return e.fq_path})})}})}},$=function(e){return function(){var t=e.user,o=e.files,r=e.firstFile,s=e.isSearchMode,i=e.source;s&&m.logSearchAction(r,t,"copy"),c.logOpenCopyModal({uid:t.id,source:i}),l.showCopy(t,o.toArray(),{onSuccess:function(e){var o=e.files;c.logCopyFiles({uid:t.id,source:i}),d.browseActions.selectRowsFromNotServer(o)},onUndo:function(){d.browseActions.selectRowsFromNotServer(o.toArray())},onRequestNotSent:function(){d.browseActions.selectFilesByFqPath({fqPathsToSelect:o.toArray().map(function(e){return e.fq_path})})}})}},ee=function(){return function(){l.showOverquota()}},te=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.files,i=e.firstFile,a=e.isSearchMode;if(o.isNonUserRelativeContext)return void(r.onRestoreMulti&&r.onRestoreMulti());if(a&&m.logSearchAction(i,t,"restore"),1===s.size&&i.is_dir&&!o.isNonUserRelativeContext){var l=n.getRestoreFileUrl({fqPath:i.fq_path,userId:t.id});T.redirect(l)}else r.onRestoreMulti()}},oe=function(e){return function(){var t=e.user,o=e.context,r=e.firstFile,s=r.fq_path.toLowerCase(),i=o.inactiveNSIDByFQPath[s];i&&f.asyncMountSharedFolder(i,t.role,_.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,!1,null,!0)}},re=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.firstFile,i=e.isSearchMode,a=e.source;if(o.isNonUserRelativeContext)return void(r.onShowVersions&&r.onShowVersions(s));i&&m.logSearchAction(s,t,"revisions"),c.logVersions({uid:t.id,source:a});var l=n.getFileHistoryUrl({fqPath:s.fq_path,userId:t.id});T.redirect(l)}},se=function(e){return function(){var t=e.actionHandlers,o=e.firstFile;t.onViewActivity&&t.onViewActivity(o)}},ie=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.firstFile,i=e.isSearchMode,n=e.source;if(o.isNonUserRelativeContext)return void(r.onDelete&&r.onDelete());i&&m.logSearchAction(s,t,"delete"),c.logDeleteFiles({uid:t.id,source:n}),r.onDelete()}},ne=function(e){return function(){var t=e.user,o=e.context,r=e.actionHandlers,s=e.firstFile,i=e.isSearchMode,n=e.source;if(o.isNonUserRelativeContext)return void(r.onPermanentDelete&&r.onPermanentDelete());i&&m.logSearchAction(s,t,"purge"),c.logPermanentDeleteFiles({uid:t.id,source:n}),r.onPermanentDelete()}},ae=function(e){return function(){var t=e.user,o=e.firstFile,r=e.isSearchMode,s=o;r&&m.logSearchAction(s,t,"events"),T.redirect("/events?ns="+s.target_ns)}},le=function(e){return function(){var t=e.firstFile;d.browseActions.fetchFolderSizes({file:t})}},ce=function(e){return function(){var t=e.user,o=e.context;f.asyncGoToContentManagerForPath({isLimitedTeam:S.get_viewer().team_is_limited,containingFolder:o.currentFQPath,isCDM:t.is_cdm_member})}};t.getActionsForFileCollection=x,t.doOpenPhoto=R,t.doOpenFile=M}),define("modules/clean/react/browse/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/columnheader","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,o,r,s,i,n){"use strict";function a(e,t,a){var d=[],u=[],p=null;if(t===i.BrowseSortFields.CATEGORY)e.forEach(function(e,t){var o=n.File.getCategoryDescription(e,!0);o!==p&&(d.push(o),u.push(t),p=o)});else if(t===i.BrowseSortFields.EXTENSION)e.forEach(function(e,t){var o=e.is_dir?i.FileTypeCapitalizedCategoryTranslations.FOLDER:n.File.getExtension(e).toUpperCase();if(o!==p){var r=o;""===o&&(r=l),d.push(r),u.push(t),p=o}});else if(t===i.BrowseSortFields.MODIFIED)if(a===s.SortDirections.DESCENDING){var h=r.getTimeBands(Date.now());e.forEach(function(e,t){var r,s=e.ts?1e3*e.ts:0;r=s>=h.today?o._("Today"):s>=h.yesterday?o._("Yesterday"):s>=h.thisWeek?o._("This week"):s>=h.lastWeek?o._("Last week"):s>=h.thisMonth?o._("This month"):s>=h.lastMonth?o._("Last month"):s>=h.lastThreeMonths?o._("Three months ago"):o._("Older"),r!==p&&(d.push(r),u.push(t),p=r)})}else e.forEach(function(e,t){var o;if(e.ts){var s=new Date(1e3*e.ts),i=s.getMonth(),n=s.getFullYear();o=r.month_with_year(i,n)}else o=c;o!==p&&(d.push(o),u.push(t),p=o)});return{sectionLabels:d,sectionStartIndices:u}}Object.defineProperty(t,"__esModule",{value:!0});var l=o._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),c=o._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"});t.getSections=a}),define("modules/clean/react/browse/file_jump",["require","exports","modules/clean/keycode","modules/clean/react/browse/constants","modules/clean/react/browse/dispatcher","modules/clean/react/browse/store","modules/core/dom"],function(e,t,o,r,s,i,n){"use strict";function a(e){var t=null!=e.which?e.which:e.keyCode,a=String.fromCharCode(t);t<o.KeyCode.SPACE||l.includes(a)||n.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||t===o.KeyCode.SPACE&&!i.browseStore.isFileJumping()||(t===o.KeyCode.SPACE&&i.browseStore.isFileJumping()&&e.preventDefault(),s.BrowseDispatcher.dispatch({type:r.BrowseActionTypes.ADD_FILE_JUMP_KEY_CODE,data:{keyChar:a}}),null!=c&&clearTimeout(c),c=setTimeout(function(){s.BrowseDispatcher.dispatch({type:r.BrowseActionTypes.RESET_FILE_JUMP})},1e3))}Object.defineProperty(t,"__esModule",{value:!0});var l=["/","\\",":","?","*","<",">","|"],c=null;t.handleKeyPress=a}),define("modules/clean/react/browse/file_list_empty_folder",["require","exports","tslib","external/classnames","external/react","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/static_urls","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[c.NameSpaceAccess.ACCESS_READER,c.NameSpaceAccess.ACCESS_READER_NO_COMMENT],p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOpenFileUploader=function(){t.props.showFileUploaderModal(),t.logTeamAction("upload_files_clicked")},t}return o.__extends(t,e),t.prototype.logEmptyFolderView=function(){var e;e=this.props.isInsideTeamFolderTree?"view_team_folder":this.props.isInsideSharedFolder?"view_shared_folder":"view_normal_folder",this.logTeamAction(e)},t.prototype.logTeamAction=function(e){i.TeamsWebActionsLogger.log(e,null,null,this.props.userId,!1,i.TeamsWebActionsLogger.LOG_CATEGORY.TEAM_INFO)},t.prototype.getImgSrc=function(){var e=this.props.imgSrc;return e?e:this.props.isViewingTeamFolder?l.static_url("/static/images/empty_states/team-folder-vflZkv0TQ.png"):l.static_url("/static/images/empty_states/files-vflsVPyeo.png")},t.prototype.getImgSrcHiRes=function(){var e=this.props.imgSrcHiRes;return e?e:this.props.isViewingTeamFolder?l.static_url("/static/images/empty_states/team-folder@2x-vfloC8f3o.png"):l.static_url("/static/images/empty_states/files@2x-vflvkuH8g.png")},t.prototype.getImgAlt=function(){var e=this.props.imgAlt;return e?e:this.props.isViewingTeamFolder?d._("empty team folder"):d._("empty folder")},t.prototype.getTagLine=function(){return s.createElement("h2",{className:"empty-folder__tagline"},this.props.tagline)},t.prototype.getTeamFolderInfo=function(){var e=d._("Upload files"),t=d._("This team folder is empty. Upload files to this folder to share with your team.");return s.createElement("div",{className:"o-grid"},s.createElement("div",{className:"o-grid__col--centered u-pad-top-m o-grid__col--1-of-3"},s.createElement("div",null,t),s.createElement(n.button,{onClick:this.handleOpenFileUploader},e)))},t.prototype.getFolderInfo=function(){if(this.props.isBrowseInContentManager)return s.createElement("div",null);var e=this.props.folderInfo;return e?e:this.props.isViewingTeamFolder?this.getTeamFolderInfo():s.createElement("div",null,d._("Drag and drop files onto this window to upload."))},t.prototype.getHelpLink=function(){var e=this.props.helpLink;if(e)return s.createElement("a",{className:"empty-folder__help-link",href:e,target:"_blank"},d._("Learn More"))},t.prototype.render=function(){var e,t=this.props,o=t.isBrowseInContentManager,i=t.isInsideSharedFolder,c=t.currentSharedFolderPermissionRole,p=t.className,h=t.isSearchState,m=t.isViewingTeamFolder;p&&(e=p.split(" ").map(function(e){return"empty-folder--"+e}).join(" "));var f=r("u-font-center u-pad-top-xl","empty-folder",e,{"empty-folder-placeholder":!o});if(h)return s.createElement("div",{className:f},s.createElement(a,{src:l.static_url("/static/images/empty_states/search-vfl6DaX2I.png"),srcHiRes:l.static_url("/static/images/empty_states/search@2x-vflBsUhDE.png"),alt:""}),s.createElement("h2",{className:"u-pad-top-l"},d._("No results found")),s.createElement("div",null,d._("Please update your search and try again")));if(o){if(this.props.isArchiveState)return s.createElement("div",{className:r(f,"u-font-meta")},d._("No archived team folders"));if(this.props.isViewingTeamFolder)return s.createElement("div",{className:f,id:"cm-empty-state"},s.createElement(a,{src:l.static_url("/static/images/empty_states/collaboration-team-folder-vflapVQHo.png"),srcHiRes:l.static_url("/static/images/empty_states/collaboration-team-folder@2x-vflsqkNUB.png"),alt:""}),s.createElement("div",{className:"u-font-center u-font-meta content-manager__empty-state"},d._("Team folders let you share with your entire department or team.")," ",s.createElement("a",{href:"/help/9263",target:"_blank"},d._("Learn how"))),s.createElement(n.button,{onClick:this.props.onCreateTeamFolder},d._("Create team folder")),this.props.enableDataMigrationTool&&s.createElement("div",{className:"u-font-center u-font-meta content-manager__data-migration-tool-empty-state"},d._("Need help migrating files to Dropbox?"),s.createElement("button",{className:"dmt-link button-as-link",onClick:this.props.onShowDataMigrationToolModal},d._("Dropbox Migration Assistant"))))}this.logEmptyFolderView(),m&&this.logTeamAction("upload_files_displayed");var _=i&&u.includes(c);return s.createElement("div",{className:f},s.createElement(a,{src:this.getImgSrc(),srcHiRes:this.getImgSrcHiRes(),alt:this.getImgAlt(),className:"empty-folder__image"}),this.getTagLine(),s.createElement("div",{className:r({"u-l-dn":_,"drag-prompt":!0})},this.getFolderInfo(),this.getHelpLink()))},t})(s.PureComponent);p.defaultProps={tagline:d._("This folder is empty"),isSearchState:!1},t.EmptyFolder=p}),define("modules/clean/react/browse/file_list_utils",["require","exports","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/sharing/browse_exports"],function(e,t,o,r,s){"use strict";function i(e){var t=e.file,s=e.isSelected,i=e.dropTargetHighlightMode;if(i===o.DropTargetHighlightMode.NONE)return!1;if(!t.is_dir)return!1;if(r.File.isReadOnlySharedFolder(t))return!1;if(t.isDeleted)return!1;switch(i){case o.DropTargetHighlightMode.ALL_FOLDERS:return!0;case o.DropTargetHighlightMode.NONSELECTED_FOLDERS:return!s;case o.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:return!s&&t.type!==o.FileTypes.SHARED_FOLDER;case o.DropTargetHighlightMode.NONSELECTED_NONSHARED_NONTEAM_FOLDERS:return!s&&![o.FileTypes.SHARED_FOLDER,o.FileTypes.TEAM_SHARED_FOLDER].includes(t.type)}return!1}function n(e){var t=e.context,o=e.file;e.user;return o.isDeleted||o.is_dir&&s.shouldUsePublicFolderSharing(t.config,o.fq_path)||r.File.isTeamMemberFolder(o)||!r.File.canViewFileMembers(o,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldFileBeHighlightedDropTarget=i,t.isSharingDisabledForFile=n}),define("modules/clean/react/browse/files_view/column_header",["require","exports","tslib","external/classnames","external/mcl/checkbox","external/mcl/table","external/react","modules/clean/react/browse/files_view/column_header_menu","modules/clean/react/browse/files_view/constants","modules/clean/react/browse/files_view/sticky_table_head","modules/clean/react/browse/files_view/view_type_column_header_menu","modules/clean/react/browse/constants"],function(e,t,o,r,s,i,n,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return o.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===u.SortDirections.ASCENDING?"ascending":e===u.SortDirections.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,u=this.props,p=u.columnFlex,h=u.columns,m=u.isCompactMode,f=u.isSelectMode,_=u.isSticky,g=u.isTabbing,w=u.currentSort,S=u.onSelection,b=u.onSort,y=u.onSwitchViewType,v=u.selectAllCheckboxState,T=void 0===v?"unchecked":v,F=u.visibleColumns,E=u.viewType,C=!(g||f||t||m),I={className:r("brws-column-header",{"brws-column-header-compact":m}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},N=[n.createElement(i.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell"},n.createElement("div",{className:"brws-vertically-center"},n.createElement(s.Checkbox,{checked:T,isHovered:t,onChange:this.handleChangeSelectAllCheckbox,variant:C?"invisible":"default"})))].concat(F.map(function(t,o){var r=w&&w.sortField===t.sortField?w.sortDirection:void 0;return n.createElement(i.TableHeadCell,{key:o,role:"columnheader","aria-sort":e.getAriaSortValue(r),className:"brws-column-header-table-cell"},n.createElement(a.ColumnHeaderMenu,{column:t,sortDirection:r,columns:h,visibleColumns:F,onSelection:S,onSort:b}),o===F.length-1&&n.createElement(d.ViewTypeColumnHeaderMenu,{viewType:E,onSwitchViewType:y}))}));return _?n.createElement(c.StickyTableHead,o.__assign({columnFlex:p,offsetHeight:m?l.COMPACT_COLUMN_HEADER_HEIGHT:l.DEFAULT_COLUMN_HEADER_HEIGHT,offsetTop:m?l.COMPACT_PAGE_HEADER_HEIGHT:l.DEFAULT_PAGE_HEADER_HEIGHT},I),N):n.createElement(i.FixedTableHead,o.__assign({},I),N)},t})(n.PureComponent);t.ColumnHeader=p}),define("modules/clean/react/browse/files_view/column_header_menu",["require","exports","tslib","external/classnames","external/mcl/icon_form","external/mcl/popover","external/react","modules/clean/react/browse/constants","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var o=t.props,r=o.onSort,s=o.onSelection,i=o.column;e===a.SortDirections.ASCENDING||e===a.SortDirections.DESCENDING?r(i.sortField,e):(s(e,i),1===t.props.visibleColumns.length&&r(e.sortField,t.props.sortDirection||a.SortDirections.ASCENDING))},t}return o.__extends(t,e),t.prototype.render=function(){var e,t=this.props,o=t.column,c=t.columns,d=t.visibleColumns,u=t.sortDirection;!o.isLocked&&c&&c.length&&(e=[n.createElement(i.PopoverItemGroupSeparator,{key:"show-separator"}),n.createElement(i.PopoverItemGroup,{key:"show-item-group"},n.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},l._("Show")),c.filter(function(e){return!e.isLocked}).map(function(e){return n.createElement(i.PopoverSelectableItem,{key:e.sortField,disabled:d.includes(e)&&e.sortField!==o.sortField,selected:e.sortField===o.sortField,value:e},e.label)}))]);var p=u===a.SortDirections.ASCENDING?"sort-arrow-up":u===a.SortDirections.DESCENDING?"sort-arrow-down":"caret-down";return n.createElement(i.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection},n.createElement(i.PopoverTrigger,{className:r("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!u}),title:o.label},n.createElement("span",null,o.label),n.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},n.createElement(s.IconForm,{className:"brws-column-header-menu-label-icon",name:p}))),n.createElement(i.PopoverContent,null,n.createElement(i.PopoverItemGroup,null,n.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},l._("Order")),n.createElement(i.PopoverSelectableItem,{selected:u===a.SortDirections.ASCENDING,value:a.SortDirections.ASCENDING},l._("Ascending")),n.createElement(i.PopoverSelectableItem,{selected:u===a.SortDirections.DESCENDING,value:a.SortDirections.DESCENDING},l._("Descending"))),e))},t})(n.PureComponent);t.ColumnHeaderMenu=c}),define("modules/clean/react/browse/files_view/column_manager",["require","exports","tslib","external/react","modules/clean/immutability_helper"],function(e,t,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(t){var o=e.call(this,t)||this;return o.handleSelection=function(e,t){o.setState(function(o){var r=o.visibleColumns.indexOf(t);return r===-1||o.visibleColumns.includes(e)?o:{visibleColumns:s.splice(o.visibleColumns,r,1,e)}})},o.state=o.getStateFromProps(t),o}return o.__extends(t,e),t.prototype.componentWillReceiveProps=function(e,t){if(this.props.columns!==e.columns)if(1===e.numVisibleColumns&&e.columns.length&&e.currentSort){var o=e.columns,r=e.currentSort,s=o.find(function(e){return e.sortField===r.sortField});this.setState({visibleColumns:[s||o[0]]})}else this.setState(this.getStateFromProps(e));else e.numVisibleColumns<this.props.numVisibleColumns?this.setState(function(t){return{visibleColumns:t.visibleColumns.slice(0,e.numVisibleColumns)}}):e.numVisibleColumns>this.props.numVisibleColumns&&this.setState(function(t){var o=e.numVisibleColumns-t.visibleColumns.length,r=[];return e.columns.forEach(function(e){r.length<o&&!t.visibleColumns.includes(e)&&r.push(e)}),{visibleColumns:t.visibleColumns.concat(r)}})},t.prototype.getStateFromProps=function(e){return{visibleColumns:e.columns.slice(0,e.numVisibleColumns||e.columns.length)}},t.prototype.render=function(){var e=this.state.visibleColumns,t=this.props,o=t.children,r=t.columns;if(!o)return null;var s=o;return"function"==typeof o&&(s=o({columns:r,visibleColumns:e,handleSelection:this.handleSelection})),s},t})(r.PureComponent);t.ColumnManager=i}),define("modules/clean/react/browse/files_view/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PAGE_HEADER_HEIGHT=96,t.DEFAULT_COLUMN_HEADER_HEIGHT=40,t.DEFAULT_ROW_HEIGHT=72,t.DEFAULT_VIEWPORT_TOP_OFFSET=t.DEFAULT_PAGE_HEADER_HEIGHT+t.DEFAULT_COLUMN_HEADER_HEIGHT,t.COMPACT_PAGE_HEADER_HEIGHT=76,t.COMPACT_COLUMN_HEADER_HEIGHT=48,t.COMPACT_ROW_HEIGHT=80,t.COMPACT_VIEWPORT_TOP_OFFSET=t.COMPACT_PAGE_HEADER_HEIGHT+t.COMPACT_COLUMN_HEADER_HEIGHT}),define("modules/clean/react/browse/files_view/controller",["require","exports","tslib","external/classnames","external/immutable","external/mcl/match","external/mcl/media_table_skeleton","external/mcl/table","external/react","external/react-dom","external/underscore","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/browse/actions","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/constants","modules/clean/react/browse/empty_folder_display_props","modules/clean/react/browse/file_actions","modules/clean/react/browse/file_list_empty_folder","modules/clean/react/browse/files_view/column_header","modules/clean/react/browse/files_view/column_manager","modules/clean/react/browse/files_view/list","modules/clean/react/browse/files_view/selectable_list","modules/clean/react/browse/files_view/selectors","modules/clean/react/browse/files_view/tile_grid","modules/clean/react/browse/models","modules/clean/react/browse/internal_drag_status","modules/clean/react/file_uploader/constants","modules/clean/react_logger","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(){},R={3:["0 0 56px","1 1 50%","0 0 25%","0 0 25%"],2:["0 0 56px","1 1 60%","0 0 40%"],1:["0 0 56px","1 1 100%"]},M={2:["0 0 56px","1 1 66%","0 0 34%"],1:["0 0 56px","1 1 100%"]},L=["0 0 56px","1 1"],O=[{sortField:m.BrowseSortFields.FILENAME,label:P._("Name"),isLocked:!0},{sortField:m.BrowseSortFields.MODIFIED,label:P._("Modified")},{sortField:m.BrowseSortFields.SHARED_WITH,label:P._("Members")},{sortField:m.BrowseSortFields.CATEGORY,label:P._("Type")},{sortField:m.BrowseSortFields.EXTENSION,label:P._("Extension")},{sortField:m.BrowseSortFields.SIZE,label:P._("Size")}],U=[{sortField:m.BrowseSortFields.FILENAME,label:P._("Name")},{sortField:m.BrowseSortFields.MODIFIED,label:P._("Modified")},{sortField:m.BrowseSortFields.CATEGORY,label:P._("Type")},{sortField:m.BrowseSortFields.EXTENSION,label:P._("Extension")},{sortField:m.BrowseSortFields.SIZE,label:P._("Size")}],k=[".bubble-menu-item-wrapper",".browse-menu",".context-menu",".react-file-viewer",".db-modal"],B=(function(t){function I(e){var r=t.call(this,"FilesViewController",e)||this;return r.gridViewPrewarmedThumbnailRequestIds=[],r.state={isMatchedMedium:!1,isMatchedLarge:!1,isTabbing:!1},r.handleOpenFile=function(e,t){_.doOpenFile({event:e,user:r.props.user,file:t,isSearchMode:r.props.isSearchMode,constructorDisplayName:"FileRow",onFileViewerUnmount:function(){},source:"list_browse"})},r.handleMouseDownBody=function(){r.setState({isTabbing:!1})},r.handleKeyDownBody=function(e){9===e.keyCode&&r.setState({isTabbing:!0})},r.handleTabbingStart=function(){r.setState({isTabbing:!0})},r.handleNavigateToPath=function(e){p.browseActions.setUrl({path:e})},r.handleNewFolderSubmit=function(e){p.browseActions.createFolder({pathName:r.props.context.currentFQPath,folderName:e,nsId:r.props.context.rootNSID})},r.handleNewFolderCancel=function(){p.browseActions.cancelCreateFolder()},r.handleRenameSubmit=function(e,t){p.browseActions.renameFile({file:e,newName:t})},r.handleRenameCancel=function(e){p.browseActions.cancelFileRename({file:e})},r.handleSetFileUploaderPath=function(e){var t=e?e.path:r.props.path,o=e?e.hasPermissionToUploadToFolder:r.props.context.isCurrentPathWriteable();r.props.setFileUploaderPath({path:t,hasPermissionToUploadToFolder:o})},r.handleDragStart=function(e,t){void 0===t&&(t=[]);var s=r.props,i=s.path,n=s.selectedFiles,a=s.user,l=d.indexBy(t,"fq_path");l=o.__assign({},l,n.toJS());var u=d.values(l);if(u.some(function(e){return F.File.isTeamSharedFolder(e)}))return void A.error(P._("Team folders can’t be moved."));if(u.some(function(e){return F.File.isTeamMemberFolder(e)}))return void A.error(P._("Your member folder can’t be moved."));var p=e.dataTransfer;p&&p.setDragImage&&r.internalDragStatusRef&&(p.setDragImage(c.findDOMNode(r.internalDragStatusRef),-10,-10),p.setData(C.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:a.id,fromPath:i,filePaths:u.map(function(e){return e.fq_path})})),p.effectAllowed="copyMove")},r.handleFileDragEnter=function(e,t,o,s){h.onFileDragEnterItem(t,!!r.props.isDraggingExternalFiles,!!r.props.isDraggingInternalFiles,o,s,r.props.context,r.handleSetFileUploaderPath)},r.createOnDragEnterHandlerForFile=function(e,t,o){return function(s){r.handleFileDragEnter(s,e,t,o)}},r.handleMatchMedium=function(){r.setState({isMatchedMedium:!0})},r.handleUnmatchMedium=function(){r.setState({isMatchedMedium:!1})},
r.handleMatchLarge=function(){r.setState({isMatchedLarge:!0})},r.handleUnmatchLarge=function(){r.setState({isMatchedLarge:!1})},r.handleSelectionChange=function(e){N.UEClient.sendEvent("FileItemRow","CheckboxToggled"),r.props.onSelectionChange(e)},r.handleDeselectAll=function(){var e=r.props,t=e.selection;(0,e.onSelectionChange)(t.set("selected",s.OrderedSet()))},r.handleSelectAll=function(){var e=r.props,t=e.files,o=e.selection;(0,e.onSelectionChange)(o.set("selected",s.OrderedSet(t.filter(function(e){return e instanceof F.File}).map(function(e){return e.fq_path}))))},r.handleSwitchViewType=function(){r.props.currentSort&&r.props.currentSort.sortField!==m.BrowseSortFields.FILENAME&&!r.state.isMatchedLarge&&r.props.onSortChange(m.BrowseSortFields.FILENAME,m.SortDirections.ASCENDING),r.props.onSwitchViewType()},r.handleTTI=function(){r.props.onComponentTTI("FilesViewController")},r.setInternalDragStatusRef=function(e){r.internalDragStatusRef=e},r.getFileActions=function(e){return _.getActionsForFileCollection({files:s.Set([e]),context:r.props.context,user:r.props.user,actionHandlers:r.props.contextFileActionHandlers,skipSharing:!1,isUnityLoaded:r.props.isUnityLoaded,isSearchMode:r.props.isSearchMode,isOverFreeQuota:r.props.isOverFreeQuota})},r}return o.__extends(I,t),I.prototype.componentDidMount=function(){this.shouldShowEmptyFolderView()&&this.props.onComponentTTI("FilesViewController"),this.prewarmGridViewThumbStore(),this.setupUnity(),document.addEventListener("keydown",this.handleKeyDownBody),document.addEventListener("mousedown",this.handleMouseDownBody)},I.prototype.componentDidUpdate=function(e){e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&e.files!==this.props.files&&this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback(),e.path!==this.props.path&&this.handleScrollToTop()},I.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0,document.removeEventListener("keydown",this.handleKeyDownBody),document.removeEventListener("mousedown",this.handleMouseDownBody)},I.prototype.setupUnity=function(){return o.__awaiter(this,void 0,void 0,function(){var t,r=this;return o.__generator(this,function(o){switch(o.label){case 0:return[4,e(["modules/clean/unity_browse_interface"])];case 1:return t=o.sent()[0],this.triggerUnityChangeCallback=function(){t.browse_visible_change_callback(r.props.files.toArray(),r.props.user.id,0,r.props.files.size-1)},[2]}})})},I.prototype.prewarmGridViewThumbStore=function(){return o.__awaiter(this,void 0,void 0,function(){var e=this;return o.__generator(this,function(t){switch(t.label){case 0:return this.props.isSearchMode||this.props.viewType===m.ViewTypes.Grid?[2]:(this.undoPrewarmGridViewThumbStore(),[4,D.waitForTTI()]);case 1:return t.sent(),this.thumbStore=new u.GenericThumbStore,this.props.files.slice(0,100).forEach(function(t){var o=T.getThumbnailUrlForItem(t);if(o){var r=e.thumbStore.bind_url(o,{onSuccess:x});r&&e.gridViewPrewarmedThumbnailRequestIds.push(r)}}),[2]}})})},I.prototype.undoPrewarmGridViewThumbStore=function(){var e=this;this.thumbStore&&this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach(function(t){e.thumbStore.unbind_url(t)}),this.gridViewPrewarmedThumbnailRequestIds=[])},I.prototype.handleScrollToTop=function(){window.scrollTo(0,0)},I.prototype.renderEmptyFolderView=function(){if(this.props.customEmptyFolderView)return this.props.customEmptyFolderView();var e=this.props,t=e.context,r=e.expBizFoldersEmptyStateAdmin,s=e.expBizFoldersEmptyStateUser,i=r||s?f.getEmptyFolderDisplayProps({expBizFoldersEmptyStateAdmin:r,expBizFoldersEmptyStateUser:s,isInsideTeamFolderTree:t.isInsideTeamFolderTree,isInsideSharedFolder:t.isInsideSharedFolder}):{};return l.createElement(g.EmptyFolder,o.__assign({currentSharedFolderPermissionRole:t.currentSharedFolderPermissionRole,isArchiveState:!1,isInsideSharedFolder:t.isInsideSharedFolder,isInsideTeamFolderTree:t.isInsideTeamFolderTree,isViewingTeamFolder:t.isInsideTeamFolderRoot,showFileUploaderModal:this.props.showFileUploaderModal,userId:this.props.user.id},i))},I.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,o=e.files,r="unchecked";return t.size===o.size?r="checked":t.size&&(r="mixed"),r},I.prototype.getNumVisibleColumns=function(){var e=this.state,t=e.isMatchedLarge,o=e.isMatchedMedium,r=this.props,s=r.isSearchMode;return r.viewType===m.ViewTypes.Grid?1:t?s?2:3:o?2:1},I.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},I.prototype.shouldShowEmptyFolderView=function(){return!this.props.files.size&&!this.isCreateFolderUIActive()},I.prototype.render=function(){var e=this,t=this.props,o=t.currentSort,s=t.files,c=t.isSubgrowthPinnedExp,d=t.loadingState,u=t.selectedFiles,p=t.selection,h=t.viewType,f=this.state,_=f.isMatchedLarge,g=f.isTabbing;if(d===m.LoadingStates.LOADING_FIRST_PAGE)return l.createElement(n.MediaTableSkeleton,{numRows:15});if(this.shouldShowEmptyFolderView())return this.renderEmptyFolderView();var F=v.getItemIds(this.props),C=!_,I=!!u.size;return l.createElement("div",{className:"brws-files-view"},l.createElement(i.Match,{media:"(min-width: 1025px)",onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),l.createElement(i.Match,{media:"(min-width: 736px)",onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),l.createElement(S.ColumnManager,{columns:h===m.ViewTypes.List?O:U,currentSort:o,numVisibleColumns:this.getNumVisibleColumns()},function(t){var i=t.columns,n=t.visibleColumns,d=t.handleSelection,u=(e.props.isSearchMode?M:R)[n.length],f=e.props.isSearchMode?null:l.createElement(w.ColumnHeader,{columnFlex:u,columns:i,currentSort:e.props.currentSort,isCompactMode:C,isSelectMode:I,isSticky:c&&h===m.ViewTypes.List,isTabbing:g,onDeselectAll:e.handleDeselectAll,onSelectAll:e.handleSelectAll,onSelection:d,onSort:e.props.onSortChange,onSwitchViewType:e.handleSwitchViewType,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),visibleColumns:n,viewType:h});return h===m.ViewTypes.List?l.createElement(y.SelectableList,{itemIds:F,keyScope:"FilesViewSelectableList",linkedOutsideClasses:k,onSelectionChange:e.handleSelectionChange,onTabbingStart:e.handleTabbingStart,selection:p},function(t){var o=t.focusedFileId,i=t.handleDeselect,c=(t.handleDeselectAll,t.handleFocusFile),d=t.handleSelect,p=(t.handleSelectAll,t.isSelectableListEvent);return l.createElement(a.Table,{"aria-rowcount":e.props.totalNumFiles,className:r("brws-files-view-list",{"brws-files-view-list-compact":C}),role:"presentation",columnFlex:u},f,l.createElement(b.FilesViewList,{actionHandlers:e.props.actionHandlers,activeDropTarget:e.props.activeDropTarget,context:e.props.context,createNewFolderState:e.props.createNewFolderState,dropTargetHighlightMode:e.props.dropTargetHighlightMode,files:s,fileRename:e.props.fileRename,focusedFileId:o,getFileActions:e.getFileActions,isCompactMode:C,isDraggingExternalFiles:e.props.isDraggingExternalFiles,isDraggingInternalFiles:e.props.isDraggingInternalFiles,isFileViewerShown:e.props.isFileViewerShown,isSearchMode:e.props.isSearchMode,isSelectMode:I,isSelectableListEvent:p,isSharedWithLoaded:e.props.isSharedWithLoaded,isStarredLoaded:e.props.isStarredLoaded,isTabbing:g,keyScope:"FilesViewSelectableList",onDragStart:e.handleDragStart,onDragEnter:e.handleFileDragEnter,onDeselectFile:i,onFocusFile:c,onNavigateToPath:e.handleNavigateToPath,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenFile:e.handleOpenFile,onRenameCancel:e.handleRenameCancel,onRenameSubmit:e.handleRenameSubmit,onSelectFile:d,onSetFileUploaderPath:e.handleSetFileUploaderPath,onTTI:e.handleTTI,scrollToRow:o?F.indexOf(o):0,selectedFiles:e.props.selectedFiles,selection:e.props.selection,user:e.props.user,visibleColumns:n}))}):l.createElement("div",null,l.createElement(a.Table,{columnFlex:L},f),l.createElement(T.BrowseTileGrid,{actionHandlers:e.props.actionHandlers,activeDropTarget:e.props.activeDropTarget,activeSortDirection:o&&o.sortDirection,activeSortField:o&&o.sortField,context:e.props.context,contextFileActionHandlers:e.props.contextFileActionHandlers,createNewFolderState:e.props.createNewFolderState,createOnDragEnterHandlerForFile:e.createOnDragEnterHandlerForFile,deselectAll:e.handleDeselectAll,fileRename:e.props.fileRename,handleDragStart:e.handleDragStart,handleTTI:e.handleTTI,items:s,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:e.props.isDraggingExternalFiles,isDraggingInternalFiles:e.props.isDraggingInternalFiles,isSearchMode:e.props.isSearchMode,onSelectionChange:e.props.onSelectionChange,onSortChange:e.props.onSortChange,onSwitchViewType:e.props.onSwitchViewType,path:e.props.path,selectAll:e.handleSelectAll,selectedFiles:e.props.selectedFiles,selection:e.props.selection,setFileUploaderPath:e.props.setFileUploaderPath,showBrowseTileHeader:!1,thumbStore:e.thumbStore,totalNumItems:e.props.totalNumFiles,user:e.props.user}))}),l.createElement(E.InternalDragStatus,{className:"offscreen-drag-icon",files:this.props.selectedFiles.toArray(),ref:this.setInternalDragStatusRef}))},I})(I.ReactPureLogger);B.defaultProps={activeDropTarget:null,dropTargetHighlightMode:m.DropTargetHighlightMode.NONE,enableUnity:!0,fileRename:null,loadingState:m.LoadingStates.LOADING_FIRST_PAGE},t.FilesViewController=B}),define("modules/clean/react/browse/files_view/culled_table_body",["require","exports","tslib","external/mcl/table","external/react"],function(e,t,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rangeInViewStartIndex=0,t.rangeInViewEndIndex=0,t.handleRangeInView=function(e,o){var r=document.body.scrollTop,s=window.innerHeight-t.props.viewportTopOffset,i=t.props.listItemHeight,n=t.props.items.length,a=n*i;t.rangeInViewStartIndex=Math.floor(r/a*n),t.rangeInViewEndIndex=Math.ceil((r+s||1)/a*n)-1},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.props.scrollToRow&&this.updateScroll(this.props.scrollToRow)},t.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&this.updateScroll(e.scrollToRow)},t.prototype.updateScroll=function(e){var t=this.props,o=t.listItemHeight,r=t.viewportTopOffset;if(e<=this.rangeInViewStartIndex||e>=this.rangeInViewEndIndex){var s=document.body.scrollTop,i=window.innerHeight-r,n=(e+1)*o,a=e*o,l=0;l=a>s?Math.abs(i-n):n-o,window.scrollTo(0,l)}},t.prototype.render=function(){var e=this.props,t=(e.children,e.scrollToRow,e.viewportTopOffset),i=o.__rest(e,["children","scrollToRow","viewportTopOffset"]);return s.createElement(r.CulledTableBody,o.__assign({onRangeInView:this.handleRangeInView,viewportHeight:window.innerHeight-t},i))},t})(s.PureComponent);t.CulledTableBodyWithScrollToRow=i}),define("modules/clean/react/browse/files_view/file_name_cell",["require","exports","tslib","external/mcl/media_table","external/react","modules/clean/browse_interface","modules/clean/filepath","modules/clean/browse_interface","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/name_input","modules/clean/react/browse/render_partials","modules/clean/search/search_helpers","modules/clean/user_education/user_education_client","modules/constants/starred","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(t){function _(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleNameInputSubmit=function(t){e.props.onRenameSubmit(e.props.file,t)},e.handleNameInputCancel=function(){e.props.onRenameCancel(e.props.file)},e.handleOnClickName=function(t){e.props.isTextSelectable||e.props.isSelectMode||e.props.onOpenFile(t,e.props.file)},e.handleOnClickLocationLink=function(t){t.stopPropagation();var o=e.props,r=o.file,s=o.isSearchMode,i=o.user;if(s&&p.logSearchAction(r,i,"click_path_link"),!(t.button>0||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey)&&e.props.onNavigateToPath){t.preventDefault();var a=n.parent_dir(r.fq_path);e.props.onNavigateToPath(a)}},e}return o.__extends(_,t),_.prototype.renderFileIcon=function(){var e=this.props,t=e.file,o=e.showCDMUserEducationEffects,r=s.createElement(u.FileIcon,{ref:"icon",file:t,onClick:this.handleOnClickName});return o?s.createElement(h.UserEducationEffect,{containerName:"FileItemRow",name:"TMFIcon",useSpan:!0},r):r},_.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,o=t.file,r=t.isSelected;if(o.isDeleted&&e.push(f._("Deleted")),r&&e.push(f._("Selected")),o.is_dir&&(o.type===l.FileTypes.SHARED_FOLDER?c.File.isReadOnlySharedFolder(o)?e.push(f._("Read-only shared folder")):e.push(f._("Shared folder")):o.type===l.FileTypes.TEAM_SHARED_FOLDER?c.File.isReadOnlySharedFolder(o)?e.push(f._("Read-only team shared folder")):e.push(f._("Team shared folder")):e.push(f._("Folder"))),e.length>0)return s.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},_.prototype.renderTitle=function(){var e=this.props,t=e.file,o=e.renameState,r=e.user;if("saving-input"===o)return s.createElement("span",{role:"status"},f._("Renaming…"));var i,l=n.filename(t.fq_path);if(i=this.props.showHighlights&&t.filename_highlights?p.highlightMatchReact(l,t.filename_highlights):s.createElement("span",null,l),!t.is_unmounted){var c=t.is_dir?t.href:a.preview_uri_for_fq_path(r,t.fq_path).toString();i=s.createElement("a",{className:"brws-file-name-cell-filename",href:c,onClick:this.handleOnClickName},i)}return this.props.showUserEducationEffects?s.createElement(h.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileNameLabel",useSpan:!0},i):i},_.prototype.renderSubtitle=function(){var e=this.props,t=e.file,o=e.isSelectMode,r=e.renameState,a=e.renderLocationAsLink,l=e.showLocation,c=e.user;if(r||!l)return null;var d=n.parent_dir(t.fq_path),u="/"===d?i.get_browse_root_name(c):d.slice(1);if(t.is_unmounted)return f._("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:u});var p=f._("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:u});if(!a||o)return p;var h=i.browse_uri_for_fq_path(c,d);return s.createElement("a",{className:"brws-file-name-cell-location",href:h.toString(),onClick:this.handleOnClickLocationLink},p)},_.prototype.renderStar=function(){var t=this.props,o=t.file,r=t.user,i=t.showStar,n=t.renameState;if(i&&!n){var a=e("modules/clean/react/starred/browse_exports").Star;return s.createElement("div",{className:"brws-file-name-cell-star brws-vertically-center"},s.createElement(a,{id:o.file_id,key:"star",idType:m.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,role:r.role}))}},_.prototype.render=function(){var e,t=this.props,o=t.file,i=t.mediaActions,a=t.renameState;if("pending-input"===a){var l=o.is_dir?f._("Rename directory…"):f._("Rename file…");e=s.createElement(d.NameInput,{defaultValue:n.filename(o.fq_path),label:l,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel})}else e=[s.createElement(r.MediaCellText,{key:"title",highlight:this.props.isHovered},this.renderTitle(),this.renderScreenReaderExtraInfo()),s.createElement(r.MediaCellText,{highlight:this.props.isHovered,key:"subtitle",variant:"subtitle"},this.renderSubtitle())];return s.createElement(r.MediaCell,{icon:this.renderFileIcon()},s.createElement("div",{className:"brws-file-name-cell-text brws-vertically-center"},e),this.renderStar(),i)},_})(s.Component);_.defaultProps={renderLocationAsLink:!0},t.FileNameCell=_}),define("modules/clean/react/browse/files_view/file_row",["require","exports","tslib","external/classnames","external/mcl/button","external/mcl/icon_table","external/mcl/checkbox","external/mcl/media_table","external/react","external/react-dom","modules/clean/react/browse/constants","modules/clean/react/browse/files_view/file_name_cell","modules/clean/react/browse/models","modules/clean/react/browse/overflow_menu","modules/clean/react/browse/share_button","modules/clean/user_education/user_education_client","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){return e.type===d.FileTypes.TEAM_SHARED_FOLDER&&("archived"===e.team_folder_status||"archive_in_progress"===e.team_folder_status)},w=function(){return l.createElement("span",{"aria-hidden":!0},"--")},S=function(e){var t=e.isVisible,o=e.onClick;return l.createElement(s.Button,{className:"brws-file-row-view-file-button","aria-label":_._("View File"),onClick:o,tabIndex:t?void 0:-1,variant:t?"secondary":"invisible"},l.createElement(i.IconTable,{name:"view"}))},b=(function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleClick=function(t){if(!c.findDOMNode(e.checkboxRef).contains(t.target)){if(e.props.isSelectMode){t.preventDefault();var o=e.props.file.fq_path;return void(e.props.isSelected?e.props.onDeselect(o,t.shiftKey):e.props.onSelect(o,t.shiftKey))}e.props.onOpenFile(t,e.props.file)}},e.handleClickViewFileButton=function(t){e.props.onOpenFile(t,e.props.file)},e.handleChangeCheckbox=function(t,o){var r=e.props.file.fq_path;"checked"===t?e.props.onSelect(r,o.shiftKey):e.props.onDeselect(r,o.shiftKey)},e.handleDragEnter=function(t){var o=e.props,r=o.file,s=o.isSelected,i=o.isActiveDropTarget;e.props.onDragEnter(t,r,!!s,!!i)},e.handleDragStart=function(t){var o=e.props,r=o.file,s=o.isSelected,i=o.onDragStart,n=o.onSelect;s?i(t):(n(r.fq_path),i(t,[r]))},e.setCheckboxRef=function(t){e.checkboxRef=t},e}return o.__extends(s,t),s.prototype.componentDidUpdate=function(e){var t=this;this.props.isFocused&&!e.isFocused&&this.checkboxRef&&Promise.resolve().then(function(){var e=c.findDOMNode(t.checkboxRef);e&&e.focus()})},s.prototype.renderMediaActions=function(e){var t=this.props,r=t.file,s=t.user,i=t.context,n=t.isCompactMode,c=t.isSelected,d=t.isSelectMode,u=t.isSharingDisabled,p=t.isTabbing,f=t.getFileActions,_=t.isSearchMode,g={browseContext:i,file:r,isSearchMode:_,user:s};return d?l.createElement(a.MediaActions,null,!u&&l.createElement(m.ShareButton,o.__assign({},g,{isVisible:!n&&(c||e)})),l.createElement(S,{isVisible:c||n||e,onClick:this.handleClickViewFileButton})):l.createElement(a.MediaActions,null,!u&&l.createElement(m.ShareButton,o.__assign({},g,{isVisible:p||e&&!n})),l.createElement(h.BrowseOverflowMenu,{file:r,actionItems:f(r),showBorders:p||e}))},s.prototype.renderModifiedCell=function(e,t){var o=e.ago,r=e.last_modified_fname||void 0,s=r&&_._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:r});return l.createElement(a.MediaCell,{key:"modifiedAt",subtitle:s,title:o||l.createElement(w,null)},t)},s.prototype.renderSharedWithController=function(){var t=this.props,o=t.context,r=t.file,s=t.isSelectMode;if(!t.isSharedWithLoaded||g(r))return null;var i=e("modules/clean/react/browse/shared_with").SharedWithController;return l.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},l.createElement(i,{file:r,browseContext:o,isMaestroDesign:!0,inSelectMode:s}))},s.prototype.renderCell=function(e){var t=e.isHovered,o=e.isLastCell,r=e.sortField,s=this.props,i=s.file,n=s.user,c=s.isSearchMode,h=s.isSelectMode,m=s.isStarredLoaded,f=s.renameState,_=s.showCDMUserEducationEffects,g=s.showUserEducationEffects,S=o?this.renderMediaActions(t):void 0;switch(r){case d.BrowseSortFields.FILENAME:return l.createElement(u.FileNameCell,{key:"fileName",user:n,file:i,isHovered:t,isSearchMode:c,isSelectMode:h,mediaActions:S,onNavigateToPath:this.props.onNavigateToPath,onOpenFile:this.props.onOpenFile,onRenameCancel:this.props.onRenameCancel,onRenameSubmit:this.props.onRenameSubmit,renameState:f,showCDMUserEducationEffects:_,showHighlights:c,showLocation:c,showUserEducationEffects:g,showStar:m});case d.BrowseSortFields.MODIFIED:return this.renderModifiedCell(i,S);case d.BrowseSortFields.SHARED_WITH:return l.createElement(a.MediaCell,{key:"sharedWith"},this.renderSharedWithController(),S);case d.BrowseSortFields.CATEGORY:return l.createElement(a.MediaCell,{key:"category",title:p.File.getCategoryDescription(i)},S);case d.BrowseSortFields.EXTENSION:return l.createElement(a.MediaCell,{key:"extension",title:p.File.getExtension(i)},S);case d.BrowseSortFields.SIZE:return l.createElement(a.MediaCell,{key:"size",title:i.size||l.createElement(w,null)},S)}},s.prototype.render=function(){var e=this,t=this.props,o=t.file,s=t.topOffset,i=t.isActiveDropTarget,c=t.isAvailableDropTarget,d=t.isCompactMode,u=t.isSelectMode,h=t.isSelected,m=t.showUserEducationEffects,_=t.isTabbing,g=t.renameState,w=t.rowIndex,S=t.tabIndex,b=t.visibleColumns,y=r("brws-file-row",{"brws-file-row-selected":h,"brws-file-row-droppable":c&&!i,"brws-file-row-dragover":i,"brws-file-row-no-access":p.File.isNoAccessSharedFolder(o)}),v=i?"dragover":c&&!i?"droppable":h?"selected":"default";return l.createElement(a.CulledMediaRow,{"aria-rowindex":void 0!==w?w+1:void 0,className:y,draggable:!g,onClick:this.handleClick,onDragEnter:this.handleDragEnter,onDragStart:this.handleDragStart,tabIndex:S,topOffset:s,variant:v},function(t){var o=t.isHovered,r=!(_||o||h||u||d),s=l.createElement(n.Checkbox,{checked:h?"checked":"unchecked",isHovered:o,onChange:e.handleChangeCheckbox,ref:e.setCheckboxRef,variant:r?"invisible":"default"});return m&&(s=l.createElement(f.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},s)),[l.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},l.createElement("div",{className:"brws-vertically-center"},s))].concat(b.map(function(t,r){return e.renderCell({isHovered:o,isLastCell:r===b.length-1,sortField:t.sortField})}))})},s})(l.PureComponent);b.defaultProps={isSelectionEmpty:!0},t.FileRow=b}),define("modules/clean/react/browse/files_view/list",["require","exports","tslib","external/react","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/files_view/constants","modules/clean/react/browse/files_view/culled_table_body","modules/clean/react/browse/files_view/file_row","modules/clean/react/browse/files_view/new_folder_row","modules/clean/react/browse/files_view/paper_row","modules/clean/react/browse/files_view/selectors","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react_logger"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(){},f=(function(e){function t(t){var o=e.call(this,"FilesViewList",t)||this;return o.state={scrollToRow:0},o.getIsListEvent=function(e){return o.props.isSelectableListEvent()&&"BUTTON"!==e.target.tagName},o.getSelectedFiles=function(){return o.props.selectedFiles},o.getFocusSelectedItemAction=function(){return function(){var e=o.props.selectedFiles.first();e&&o.props.onFocusFile(e.fq_path)}},o.isCurrentPathWriteable=function(){return o.props.context.isCurrentPathWriteable()},o.enableContextMenu=function(){return!1},o.getActiveDropTarget=function(){return o.props.activeDropTarget},o.getIsDraggingInternalFiles=function(){return!!o.props.isDraggingInternalFiles},o.getIsDraggingExternalFiles=function(){return!!o.props.isDraggingExternalFiles},o.renderRow=function(e,t,s){if("NewFolderRow"===e.type)return r.createElement(l.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideTeamFolderTree:e.props.isInsideTeamFolderTree,onCancel:o.props.onNewFolderCancel,onSubmit:o.props.onNewFolderSubmit,rowIndex:t,topOffset:s});if("PaperRow"===e.type)return r.createElement(c.PaperRow,{paper:e.props.paper,isSearchMode:e.props.isSearchMode,rowIndex:t,topOffset:s,user:o.props.user,visibleColumns:e.props.visibleColumns});var i=o.props.selection,n=e.props.file,d=i.selected.last()===e.props.file.fq_path||!i.selected.size&&0===t?0:void 0;return r.createElement(a.FileRow,{context:o.props.context,file:n,getFileActions:o.props.getFileActions,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharedWithLoaded:e.props.isSharedWithLoaded,isSharingDisabled:e.props.isSharingDisabled,isStarredLoaded:e.props.isStarredLoaded,isTabbing:e.props.isTabbing,key:n.fq_path,onDeselect:o.props.onDeselectFile,onDragStart:o.props.onDragStart,onDragEnter:o.props.onDragEnter,onNavigateToPath:o.props.onNavigateToPath,onOpenFile:o.props.onOpenFile,onRenameCancel:o.props.onRenameCancel,onRenameSubmit:o.props.onRenameSubmit,onSelect:o.props.onSelectFile,renameState:e.props.renameState,rowIndex:t,showUserEducationEffects:0===t,showCDMUserEducationEffects:p.File.isTeamMemberFolder(n),tabIndex:d,topOffset:s,user:o.props.user,visibleColumns:e.props.visibleColumns})},o}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler(),this.props.selectedFiles.size&&!this.props.isFileViewerShown()&&this.setState({scrollToRow:this.getRowIndexForFile(this.props.selectedFiles.first())})},t.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&this.setState({scrollToRow:e.scrollToRow})},t.prototype.componentDidUpdate=function(e){e.createNewFolderState===this.props.createNewFolderState||"PENDING_INPUT"!==this.props.createNewFolderState||this.props.isFileViewerShown()||this.setState(function(e){return 0===e.scrollToRow?(window.scrollTo(0,0),{}):{scrollToRow:0}})},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),s.cleanupExternalDragHandler(this.props.keyScope)},t.prototype.getRowIndexForFile=function(e){return this.props.files.indexOf(e)},t.prototype.cleanupKeyboardShortcuts=function(){u.resetBrowseKeyboardShortcuts(this.props.keyScope)},t.prototype.setupKeyboardShortcuts=function(){u.setupItemListKeyboardShortcuts(this.getIsGlobalEvent(),this.getIsListEvent,this.getSelectedFiles,this.getFocusSelectedItemAction,this.isCurrentPathWriteable,this.enableContextMenu,m,m,this.props.actionHandlers.onDelete,m,this.props.keyScope)},t.prototype.setupExternalDragHandler=function(){s.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget)},t.prototype.getIsGlobalEvent=function(){return u.generateGetIsGlobalEvent(this)},t.prototype.render=function(){var e=this.props.isCompactMode;return r.createElement(n.CulledTableBodyWithScrollToRow,{items:d.getFilesViewListRowItems(this.props),listItemHeight:e?i.COMPACT_ROW_HEIGHT:i.DEFAULT_ROW_HEIGHT,renderRow:this.renderRow,scrollToRow:this.state.scrollToRow,viewportTopOffset:e?i.COMPACT_VIEWPORT_TOP_OFFSET:i.DEFAULT_VIEWPORT_TOP_OFFSET})},t})(h.ReactPureLogger);f.defaultProps={isFileViewerShown:function(){return!1}},t.FilesViewList=f}),define("modules/clean/react/browse/files_view/new_folder_row",["require","exports","external/mcl/media_table","external/mcl/table","external/react","modules/clean/react/browse/new_folder_icon","modules/clean/react/browse/name_input","modules/core/i18n"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFolderRow=function(e){var t,l=e.createNewFolderState,c=e.isInsideTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,h=e.rowIndex,m=e.topOffset;return t="SAVING_INPUT"===l?s.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},a._("Creating new folder…")):s.createElement(n.NameInput,{defaultValue:"",label:a._("Folder name"),onSubmit:p,onCancel:u}),s.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==h?h+1:void 0,className:"brws-new-folder-row",topOffset:m},s.createElement(r.TableCell,{className:"brws-checkbox-cell"}),s.createElement(o.MediaCell,{icon:s.createElement(i.NewFolderIcon,{inTeamFolder:d})},s.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},t)),s.createElement(r.TableCell,null),s.createElement(r.TableCell,null))}}),define("modules/clean/react/browse/files_view/paper_row",["require","exports","tslib","external/mcl/media_table","external/react","modules/clean/react/browse/constants","modules/clean/react/browse/paper_row_icon","modules/clean/search/search_helpers","modules/core/browser","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDocNameClick=function(e){t.props.isSearchMode&&a.logPaperSearchAction(t.props.paper,t.props.user,"paper_open"),e.stopPropagation()},t.handleRowClick=function(e){e.ctrlKey?l.open_tab(t.props.paper.url):l.redirect(t.props.paper.url)},t}return o.__extends(t,e),t.prototype.renderDocName=function(e){var t=this.props,o=t.paper,i=t.showHighlights,l=s.createElement("a",{className:"brws-paper-doc-name-cell-title",href:o.url,onClick:this.handleDocNameClick},i?a.highlightMatchReact(o.title,o.title_highlights):s.createElement("span",null,o.title));return s.createElement(r.MediaCell,{highlight:e,icon:s.createElement(n.PaperRowIcon,null),key:"docName"},s.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},s.createElement(r.MediaCellText,{highlight:e},l),s.createElement(r.MediaCellText,{highlight:e,variant:"subtitle"},c._("in Paper",{comment:"The Dropbox Paper page"}))))},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date?c._("Modified %(date)s").format({date:e.last_modified_date}):"";return s.createElement(r.MediaCell,{key:"docInfo",subtitle:e.creator_name,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered;switch(e.sortField){case i.BrowseSortFields.FILENAME:return this.renderDocName(t);case i.BrowseSortFields.MODIFIED:return this.renderDocInfo()}return null},t.prototype.render=function(){var e=this,t=this.props,o=t.rowIndex,i=t.topOffset,n=t.visibleColumns;return s.createElement(r.CulledMediaRow,{"aria-rowindex":void 0!==o?o+1:void 0,className:"brws-paper-row",draggable:!1,onClick:this.handleRowClick,topOffset:i,variant:"default"},function(t){var o=t.isHovered;return[s.createElement(r.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})].concat(n.map(function(t){return e.renderCell({isHovered:o,sortField:t.sortField})}))})},t})(s.PureComponent);d.defaultProps={showHighlights:!0,isSearchMode:!0},t.PaperRow=d}),define("modules/clean/react/browse/files_view/selectable_list",["require","exports","tslib","external/immutable","external/keymaster","external/react","external/react-dom","modules/core/browser"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="",c=(function(e){function t(t){var o=e.call(this,t)||this;return o.isFocused=!1,o.handleSelectPrevious=function(e){o.isGlobalEvent(e)&&(e.preventDefault(),o.selectNeighboringItem("up"))},o.handleExtendSelectionToPrevious=function(e){o.isGlobalEvent(e)&&(e.preventDefault(),o.extendSelectionRange("up"))},o.handleSelectNext=function(e){o.isGlobalEvent(e)&&(e.preventDefault(),o.selectNeighboringItem("down"))},o.handleExtendSelectionToNext=function(e){o.isGlobalEvent(e)&&(e.preventDefault(),o.extendSelectionRange("down"))},o.handleDeselectAll=function(e){var t=o.props.selection;if((!e||o.isGlobalEvent(e))&&t.selected.size&&(o.updateSelection([],!0),n.findDOMNode(o).contains(document.activeElement))){var r=document.activeElement;r.blur&&r.blur()}},o.handleSelectAll=function(e){var t=o.props,r=t.itemIds,s=t.selection;e&&!o.isGlobalEvent(e)||s.selected.size===r.length||o.updateSelection(o.props.itemIds,!0)},
o.handleDeselect=function(e,t){if(t)return o.extendOrShrinkSelectionByFile(e);o.updateSelectionById(e,"delete")},o.handleSelect=function(e,t){if(t)return o.extendOrShrinkSelectionByFile(e);o.updateSelectionById(e,"add")},o.handleFocusFile=function(e){o.setState({focusedFileId:e})},o.isSelectableListEvent=function(){return o.isFocused},o.handleFocus=function(){o.isFocused=!0},o.handleBlur=function(){o.isFocused=!1},o.state={focusedFileId:null,selection:t.selection},o}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.setupKeyboardShortcuts(),this.setFocusedIdFromSelection(this.props.selection)},t.prototype.componentDidUpdate=function(e,t){e.selection&&this.props.selection&&e.selection.anchor!==this.props.selection.anchor&&this.setFocusedIdFromSelection(this.props.selection)},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts()},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props.keyScope;l=s.getScope(),l!==t&&s.setScope(t),s.filter=function(t){var o=t.target||t.srcElement,r=o.tagName;return(!e.isSelectableListEvent()||"BUTTON"!==r)&&!(("INPUT"===r||"SELECT"===r||"TEXTAREA"===r)&&o instanceof HTMLInputElement&&"checkbox"!==o.type)},s("up",t,this.handleSelectPrevious),s("shift+up",t,this.handleExtendSelectionToPrevious),s("down",t,this.handleSelectNext),s("shift+down",t,this.handleExtendSelectionToNext),s("escape",t,this.handleDeselectAll),a.mac?s("command+a",t,this.handleSelectAll):s("ctrl+a",t,this.handleSelectAll)},t.prototype.cleanupKeyboardShortcuts=function(){s.clearScope(this.props.keyScope),l&&s.setScope(l),s.resetFilter()},t.prototype.setFocusedIdFromSelection=function(e){e.anchor&&0!==e.selected.size&&this.setState({focusedFileId:e.anchor})},t.prototype.handleTabbingStart=function(){document.body.classList.add("tabbing"),this.props.onTabbingStart()},t.prototype.updateSelection=function(e,t){void 0===t&&(t=!1);var o=this.props.selection,s=t?e.length?e[0]:this.props.itemIds[0]:o.anchor,i=o.merge({selected:r.OrderedSet(e),anchor:s});this.props.onSelectionChange(i)},t.prototype.selectNeighboringItem=function(e){var t=this.props,o=t.itemIds,r=t.selection,s=o.indexOf(r.selected.last()),i=0;i="up"===e?Math.max(0,s-1):Math.min(o.length-1,s+1);var n=o[i];this.setState({focusedFileId:n}),this.updateSelection([n],!0),this.handleTabbingStart()},t.prototype.extendSelectionRange=function(e){var t=this.props,o=t.itemIds,r=t.selection,s=r.anchor||o[0];if(s){var i=o.indexOf(r.selected.last()),n=r.selected.toArray(),a=o.indexOf(s),l=this.getRangeOfSelectedBlock(s),c=l.startIndex,d=l.endIndex;if("up"===e){if(0===i)return;if(a===d)c-1>=0&&n.push(o[c-1]);else{var u=n.indexOf(o[d]);n.splice(u,1)}}else{if(i===o.length)return;if(a===c||a!==d)d+1<o.length&&n.push(o[d+1]);else{var u=n.indexOf(o[c]);n.splice(u,1)}}this.setState({focusedFileId:n[n.length-1]}),this.updateSelection(n),this.handleTabbingStart()}},t.prototype.getRangeOfSelectedBlock=function(e){for(var t=this.props,o=t.itemIds,r=t.selection,s=o.indexOf(e),i=0,n=0;i=s,s--,!(s<0)&&r.selected.has(o[s]););for(s=i;;){var a=o[s];if(!a||!r.selected.has(a))break;n=s,s++}return{startIndex:i,endIndex:n}},t.prototype.extendOrShrinkSelectionByFile=function(e){var t=this.props,o=t.itemIds,r=t.selection,s=r.anchor||o[0];if(s){var i=o.indexOf(s),n=o.indexOf(e),a=this.getRangeOfSelectedBlock(s),l=a.startIndex,c=a.endIndex;if(n!==c){var d=[],u=[];o.forEach(function(e,t){l<=t&&t<=c&&d.push(e),(n<=t&&t<=i||i<=t&&t<=n)&&u.push(e)}),n<i&&u.reverse();var p=r.update("selected",function(e){return e.subtract(d).union(u)});this.setState({focusedFileId:e}),this.props.onSelectionChange(p),this.handleTabbingStart()}}},t.prototype.updateSelectionById=function(e,t){var o=this.props.selection,r=o.selected[t](e),s=o.merge({selected:r,anchor:r.first()||null});this.props.onSelectionChange(s)},t.prototype.isGlobalEvent=function(e){var t=e.target instanceof HTMLInputElement,o=t&&"checkbox"===e.target.type;return!document.activeElement||document.activeElement===document.body||n.findDOMNode(this).contains(e.target)&&(!t||o)},t.prototype.render=function(){var e=this.props.children,t=this.state.focusedFileId;if(!e)return null;var o=e;return"function"==typeof e&&(o=e({focusedFileId:t,handleDeselect:this.handleDeselect,handleDeselectAll:this.handleDeselectAll,handleFocusFile:this.handleFocusFile,handleSelect:this.handleSelect,handleSelectAll:this.handleSelectAll,isSelectableListEvent:this.isSelectableListEvent})),i.createElement("div",{onBlur:this.handleBlur,onFocus:this.handleFocus},o)},t})(i.PureComponent);t.SelectableList=c}),define("modules/clean/react/browse/files_view/selectors",["require","exports","tslib","external/reselect","modules/clean/react/browse/file_list_utils","modules/clean/react/browse/models"],function(e,t,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.createSelector(function(e){return e.isCompactMode},function(e){return e.isSelectMode},function(e){return e.isSharedWithLoaded},function(e){return e.isStarredLoaded},function(e){return e.isSearchMode},function(e){return e.isTabbing},function(e,t,o,r,s,i){return{isCompactMode:e,isSelectMode:t,isSharedWithLoaded:o,isStarredLoaded:r,isSearchMode:s,isTabbing:i}});t.getFilesViewListRowItems=r.createSelector(n,function(e){return e.activeDropTarget},function(e){return e.context},function(e){return e.createNewFolderState},function(e){return e.dropTargetHighlightMode},function(e){return e.files},function(e){return e.fileRename},function(e){return e.focusedFileId},function(e){return e.selection},function(e){return e.user},function(e){return e.visibleColumns},function(e,t,r,n,a,l,c,d,u,p,h){var m=l.toArray().map(function(n){if(n instanceof i.Paper)return{type:"PaperRow",props:{isSearchMode:e.isSearchMode,paper:n,visibleColumns:h}};var l=u.selected.has(n.fq_path),m=s.shouldFileBeHighlightedDropTarget({file:n,isSelected:l,dropTargetHighlightMode:a});return{type:"FileRow",props:o.__assign({},e,{file:n,isActiveDropTarget:m&&t===n,isAvailableDropTarget:m,isFocused:n.fq_path===d,isSelected:l,isSharingDisabled:s.isSharingDisabledForFile({context:r,file:n,user:p}),renameState:c&&c.file===n?c.state:void 0,visibleColumns:h})}});return n&&"CREATE_FOLDER_INACTIVE"!==n&&m.unshift({type:"NewFolderRow",props:{createNewFolderState:n,isInsideTeamFolderTree:r.isInsideTeamFolderTree}}),m}),t.getItemIds=r.createSelector(function(e){return e.files},function(e){return e.toArray().map(function(e){return e.fq_path})})}),define("modules/clean/react/browse/files_view/sticky_table_head",["require","exports","tslib","external/mcl/dimensions","external/mcl/table","external/react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=e.offsetHeight,d=e.offsetTop,u=o.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);return i.createElement("thead",{className:"brws-sticky-table-head"},i.createElement(r.Dimensions,{tagName:"tr"},function(e){var r=e.width;return i.createElement("td",{className:"brws-sticky-table-cell"},i.createElement(a.StickyContainer,{offsetTop:d,useNativeSticky:!0,useWindowToDetermineBottom:!0},i.createElement(n.Sticky,{offsetHeight:c},i.createElement(s.Table,{columnFlex:l,style:{width:r}},i.createElement(s.TableHead,o.__assign({},u),t)))))}))}}),define("modules/clean/react/browse/files_view/tile_grid",["require","exports","tslib","external/classnames","external/immutable","external/react","external/mcl/button","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/actions","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/browse_tile_header","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/file_grouper","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/browse/overflow_menu","modules/clean/react/browse/tile_label_name_input","modules/clean/react/maestro/tile_grid","modules/clean/react/title_bubble","modules/clean/react_logger","modules/clean/static_urls","modules/core/i18n","modules/core/uri"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F){"use strict";function E(e){var t;return e.thumbnail_url_tmpl&&(t=F.parse(e.thumbnail_url_tmpl),t=t.removeQuery("size").removeQuery("size_mode"),t=t.updateQuery({size:"256x256",size_mode:"2"}).toString()),t}Object.defineProperty(t,"__esModule",{value:!0}),t.getThumbnailUrlForItem=E;var C=["ai","au","fl","key","numbers","pages","pkg","pr","psd","sketch","txt","md"],I=["acrobat","code","compressed","excel","film","gear","picture","powerpoint","sound","word"],N=["folder","folder_app","folder_camera","folder_team","folder_team_locked","folder_user","folder_user_locked"],D=(function(e){function t(t){var o=e.call(this,"BrowseTileGrid",t)||this;return o.state={inSelectMode:!1,sectionLabels:s.List(),sectionStartIndices:s.List(),selectedIds:s.Set(),totalNumItems:0},o.handleCreateFolderSubmit=function(e){c.browseActions.createFolder({pathName:o.props.context.currentFQPath,folderName:e,nsId:o.props.context.rootNSID})},o.handleCreateFolderCancel=function(){c.browseActions.cancelCreateFolder()},o.setTileGridRef=function(e){o.tileGrid=e},o.getTileItem=function(e,t){var r,s=o.props;if(s.isCreateFolderUIActive){if(0===e)return o.getCreateFolderTile();e-=1}var a=s.items.get(e);if(!a){var c="Placeholder "+e;return{altText:c,iconUrl:o.props.isPhotosPage?v.static_url("/static/images/maestro/tile-icons/picture-vflIDcp5T.svg"):v.static_url("/static/images/maestro/tile-icons/unknown-vflEPx1xQ.svg"),id:c,isDraggable:!1,isSelectable:!1}}var d=o.createViewFileHandler(a),u=o.createToggleSelectHandler(a),p=a instanceof _.File,h=d,m=!1,f=!1;p&&(r=o.renderTileOverflowMenu(a,t)),o.state.inSelectMode&&(m=s.selection.anchor===a.fq_path,f=s.selection.selected.has(a.fq_path),h=u,p&&(r=i.createElement(n.Button,{className:"tile__action-button--view-file",variant:"secondary",size:"small","aria-label":T._("View File"),onClick:d})));var g=o.createOnTileDragStartForItem(a,f,u),w=s.isPhotosPage?void 0:o.renderLabelElement(a),S=l.filename(a.fq_path),b=E(a),y=a===o.props.activeDropTarget,F=o.getSVGIconName(a);return{id:a.sjid.toString(),labelNode:w,altText:S,iconUrl:v.static_url("/static/images/maestro/tile-icons/"+F+".svg"),thumbnailUrl:b,actionNode:r,onTileAction:h,isDraggable:!0,onDragEnter:o.props.createOnDragEnterHandlerForFile(a,f,y),onDragStart:g,isFocused:m,isSelectable:!0,handleToggleSelect:u,checkboxAriaText:T._("Select tile")}},o}return o.__extends(t,e),t.prototype.componentWillMount=function(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setTotalNumItems(this.props),this.setTileItemsSections(this.props),this.setSelectedTiles(this.props)},t.prototype.componentDidMount=function(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()},t.prototype.componentWillUnmount=function(){f.resetBrowseKeyboardShortcuts("BrowseTileGrid")},t.prototype.componentWillReceiveProps=function(e){e.items===this.props.items&&e.createNewFolderState===this.props.createNewFolderState||this.setTotalNumItems(e),e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0})),e.activeSortField===this.props.activeSortField&&e.activeSortDirection===this.props.activeSortDirection&&e.sections===this.props.sections&&e.items===this.props.items||this.setTileItemsSections(e)},t.prototype.componentDidUpdate=function(e){(e.createNewFolderState===p.NewFolderCreationStates.PENDING_INPUT&&this.props.createNewFolderState===p.NewFolderCreationStates.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items)&&this.tileGrid.forceUpdate()},t.prototype.setTotalNumItems=function(e){var t=Math.max(e.items.size,e.totalNumItems);e.isCreateFolderUIActive&&(t+=1),this.setState({totalNumItems:t})},t.prototype.setTileItemsSections=function(e){var t;t=e.sections?e.sections:e.activeSortField?m.getSections(e.items,e.activeSortField,e.activeSortDirection):{sectionLabels:[],sectionStartIndices:[]},this.setState({sectionLabels:s.List(t.sectionLabels),sectionStartIndices:s.List(t.sectionStartIndices)})},t.prototype.createRenameCancelHandler=function(e){return function(){c.browseActions.cancelFileRename({file:e})}},t.prototype.createRenameSubmitHandler=function(e){return function(t){c.browseActions.renameFile({file:e,newName:t})}},t.prototype.createToggleSelectHandler=function(e){var t=this,o=e.fq_path;return function(){var e=t.props.selection;e=e.selected.has(o)?e.update("selected",function(e){return e.delete(o)}):e.update("selected",function(e){return e.add(o)}).set("anchor",o),t.props.onSelectionChange(e)}},t.prototype.renderTileOverflowMenu=function(e,t){var o=h.getActionsForFileCollection({files:s.Set([e]),context:this.props.context,user:this.props.user,actionHandlers:this.props.contextFileActionHandlers,isUnityLoaded:this.props.isUnityLoaded,isPhotosPage:this.props.isPhotosPage,isSearchMode:this.props.isSearchMode,skipSharing:!1}),r=0===t?"left":"right";return i.createElement(g.BrowseOverflowMenu,{file:e,attachment:r,actionItems:o,size:g.OverflowMenuSize.Small,showBorders:!0})},t.prototype.renderLabelElement=function(e){var t=l.filename(e.fq_path);if(this.props.fileRename&&l.paths_are_equal(this.props.fileRename.file.fq_path,e.fq_path)){if(this.props.fileRename.state===p.RenameStates.PENDING_INPUT)return i.createElement(w.TileItemLabelInput,{defaultValue:t,label:t,handleCancel:this.createRenameCancelHandler(e),handleSubmit:this.createRenameSubmitHandler(e)});if(this.props.fileRename.state===p.RenameStates.SAVING_INPUT)return i.createElement(S.TileItemLabelText,{className:"tile-label__text--saving",label:T._("Renaming…")})}var o=a.em_snippet(t,16,.5),r=i.createElement(S.TileItemLabelText,{label:o});return t!==o?i.createElement(b,{content:t,position:b.POSITIONS.BOTTOM,className:"tile-label__title-bubble"},r):r},t.prototype.createViewFileHandler=function(e){var t=this;return this.props.isPhotosPage?function(o){o.preventDefault();var r=t.props.items.filter(function(e){return!!e}).toJS(),s=r.findIndex(function(t){return t.file_id===e.file_id});h.doOpenPhoto({event:o,user:t.props.user,files:r,index:s,onFileViewerUnmount:function(){return t.tileGrid&&t.tileGrid.getAndUpdateTileLayout()},source:"photos_page"})}:function(o){o.preventDefault(),h.doOpenFile({event:o,user:t.props.user,file:e,isSearchMode:t.props.isSearchMode,constructorDisplayName:"BrowseTileGrid",onFileViewerUnmount:function(){return t.tileGrid&&t.tileGrid.getAndUpdateTileLayout()},source:"visual_browse"})}},t.prototype.getSVGIconName=function(e){var t=this.getSVGIconBaseName(e);return e.isDeleted&&(t+="-disabled"),t},t.prototype.getSVGIconBaseName=function(e){var t=e.icon;if(t&&("_32"===t.slice(-3)&&(t=t.slice(0,-3)),"page_white_"===t.slice(0,11)&&(t=t.slice(11)),"_gray"===t.slice(-5)&&(t=t.slice(0,-5))),e.is_dir)return N.includes(t)?t:"folder";var o=l.file_extension(l.filename(e.fq_path));return C.includes(o)?o:I.includes(t)?t:"unknown"},t.prototype.setSelectedTiles=function(e){var t=s.Set().withMutations(function(t){e.selectedFiles.forEach(function(e){t.add(e.sjid.toString())})});this.setState({selectedIds:t})},t.prototype.setupExternalDragHandler=function(){var e=this,t=function(){return!!e.props.isDraggingInternalFiles},o=function(){return!!e.props.isDraggingExternalFiles},r=function(){e.props.setFileUploaderPath({path:e.props.path,hasPermissionToUploadToFolder:e.props.context.isCurrentPathWriteable()})},s=function(){return e.props.activeDropTarget};d.setupExternalDragHandler("BrowseTileGrid",t,o,r,".tile",s)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=f.generateGetIsGlobalEvent(this),o=t,r=function(){return e.props.selectedFiles},s=function(){return e.props.context.isCurrentPathWriteable()};f.setupGeneralBrowseKeyboardShortcuts(t,o,r,!1,s,this.props.selectAll,this.props.deselectAll,this.props.actionHandlers.onDelete,"BrowseTileGrid")},t.prototype.createOnTileDragStartForItem=function(e,t,o){var r=this;return function(s){return t?r.props.handleDragStart(s):(o(),r.props.handleDragStart(s,[e]))}},t.prototype.getCreateFolderTile=function(){var e=T._("New folder"),t=i.createElement("div",null);return this.props.createNewFolderState===p.NewFolderCreationStates.PENDING_INPUT?(e=T._("Folder name"),t=i.createElement(w.TileItemLabelInput,{label:e,handleSubmit:this.handleCreateFolderSubmit,handleCancel:this.handleCreateFolderCancel})):this.props.createNewFolderState===p.NewFolderCreationStates.SAVING_INPUT&&(e=T._("Creating new folder…"),t=i.createElement(S.TileItemLabelText,{className:"tile-label__text--saving",label:e})),{altText:e,iconUrl:v.static_url("/static/images/maestro/tile-icons/folder-vflMFXe_s.svg"),id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:t}},t.prototype.render=function(){var e=this.props,t=e.showBrowseTileHeader,o=e.enableMaxHeightGrouping,s=r({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode});return i.createElement("div",null,t&&i.createElement(u.BrowseTileHeader,{key:"tileGridHeader",ref:"tileGridHeader",onSortChange:this.props.onSortChange,currentSortField:this.props.activeSortField,currentSortDirection:this.props.activeSortDirection,onSwitchViewType:this.props.onSwitchViewType,currentViewType:p.ViewTypes.Grid}),i.createElement(S.InfiniteTileGrid,{key:"tileGrid",ref:this.setTileGridRef,totalNumItems:this.state.totalNumItems,containerClass:s,rowClass:"file-tile-row",enableMaxHeightGrouping:o,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:p.BrowseTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:p.BrowseTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:this.state.sectionStartIndices,sectionLabels:this.state.sectionLabels,showLabels:!this.props.isPhotosPage,contentOffset:136,getTileItem:this.getTileItem,selectedIds:this.state.selectedIds,handleTTI:this.props.handleTTI,thumbStore:this.props.thumbStore,onRangeInView:this.props.onRangeInView}))},t})(y.ReactPureLogger);D.defaultProps={isUnityLoaded:!1,enableMaxHeightGrouping:!1},t.BrowseTileGrid=D}),define("modules/clean/react/browse/files_view/view_type_column_header_menu",["require","exports","tslib","external/mcl/icon_form","external/mcl/icon_mode","external/mcl/popover","external/react","modules/clean/react/browse/constants","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.viewType;return n.createElement(i.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection},n.createElement(i.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger",title:e===a.ViewTypes.Grid?l._("Grid"):l._("List")},n.createElement(s.IconMode,{name:e===a.ViewTypes.Grid?"tiles":"list"}),n.createElement(r.IconForm,{name:"caret-down"})),n.createElement(i.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},n.createElement(i.PopoverItemGroup,null,n.createElement(i.PopoverItemGroupTitle,null,l._("View Mode")),n.createElement(i.PopoverSelectableItem,{icon:n.createElement(s.IconMode,{name:"list"}),selected:e===a.ViewTypes.List,value:a.ViewTypes.List},l._("List")),n.createElement(i.PopoverSelectableItem,{icon:n.createElement(s.IconMode,{name:"tiles"}),selected:e===a.ViewTypes.Grid,value:a.ViewTypes.Grid},l._("Grid")))))},t})(n.PureComponent);t.ViewTypeColumnHeaderMenu=c}),function(){define("modules/clean/react/browse/folder_list_row",["jquery","external/classnames","external/immutable","external/react","external/underscore","modules/clean/filepath","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/new_folder_icon","modules/core/i18n","modules/clean/react/browse/actions","modules/clean/react/browse/name_input","modules/clean/react/flag","modules/clean/react_logger","modules/clean/static_urls"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m){var f,_,g,w,S,b,y,v,T;return g=n.NewFolderCreationStates,f=a.BrowseContext,w=l.NewFolderIcon,b=c._,y=d.browseActions,_=u.NameInput,S=h.ReactLogger,m.static_url,T=r.DOM,v=r.createElement,r.createClass({displayName:"NewFolderCreationListRow",mixins:[r.addons.PureRenderMixin],propTypes:{newFolderState:r.PropTypes.oneOf(s.values(g)),context:r.PropTypes.instanceOf(f),topOffsetPx:r.PropTypes.number,user:r.PropTypes.object},componentWillMount:function(){return S.start(this.constructor.displayName)},componentDidMount:function(){return S.end(this.constructor.displayName)},_handleCancel:function(){return y.cancelCreateFolder()},_handleSubmit:function(e){return y.createFolder({pathName:this.props.context.currentFQPath,folderName:e,nsId:this.props.context.rootNSID})},_renderIcon:function(){return v(w,{inTeamFolder:this.props.context.isInsideTeamFolderTree})},_renderNewFolderCreationColumn:function(){var e,t;return e=this._renderIcon(),t=T.div({}),this.props.newFolderState===g.PENDING_INPUT?t=v(_,{defaultValue:"",label:b("Folder name"),onSubmit:this._handleSubmit,onCancel:this._handleCancel,className:"browse-file-row__input"}):this.props.newFolderState===g.SAVING_INPUT&&(t=T.div({className:"creating_folder_text",role:"status","aria-live":"polite"},b("Creating new folder…"))),T.div({className:"o-grid__col--1-of-2",role:"gridcell"},v(p.Flag,{leftAttachment:e},t))},_renderPlaceholder:function(){return T.div({role:"gridcell"})},render:function(){var e;return e={"browse-file-row":!0,"o-grid":!0,"o-grid--no-gutter":!0,"browse-file-row--is-selected":!0},T.li({className:t(e),role:"row",style:{position:"absolute",top:this.props.topOffsetPx}},this._renderPlaceholder(),this._renderNewFolderCreationColumn(),this._renderPlaceholder(),this._renderPlaceholder(),this._renderPlaceholder())}})})}.call(this),define("modules/clean/react/browse/global_actions",["require","exports","modules/clean/ajax","modules/clean/browse_interface","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/async_onboarding_new_folder_modal_util","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/viewer","modules/constants/cloud_content","modules/core/browser","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d,u,p){"use strict";function h(e){var t=e.context,o=e.user,r=e.showDeletedFiles,s=e.onFileUpload,i=(e.isContextMenu,e.isNoComment),n=void 0!==i&&i,l=e.experiments,c=void 0===l?{}:l,u=t.isCurrentlyInRoot,p=!t.canViewContainingNSMembers,h=t.isCurrentPathWriteable(),C={className:"action-upload",label:m,iconName:"upload",performAction:E(s),disabled:!h},R=[];if(t.isInsideDeletedSharedFolder||t.isInsideDeletedNestedSharedFolder)R.push({label:w,spriteName:"restore",performAction:P(o,t)});else if(t.isInsideDeletedFolder)R.push({label:g,spriteName:"restore",className:"action-restore",performAction:D(o,t)});else{var M={label:_,iconName:"new-folder",performAction:A(o,t,c.expBizOnboardingTriggerFolderRwl||{}),disabled:!h,className:"action-new-folder"},L={label:u?y:v,iconName:"new-shared-folder",performAction:I(o,t),disabled:p,className:"action-share-folder"};o.is_cdm_member&&"/"===t.currentFQPath?R.push(C,M):u?R.push(C,L,M):(R.push(L),R.push(C,M)),d.ENABLE_CREATE&&R.push({label:f,iconName:"upload",className:"action-google-docs",performAction:F,disabled:!1}),n||R.push({label:r?b:S,iconName:r?"hide":"show-deleted-files",performAction:N(o,r),disabled:p,className:"action-deleted-files"}),a.GoldenGate.hasContentManagerAndSuperAdmin(o.id)&&a.GoldenGate.hasNewOwnershipModel(o.id)&&!t.isNonUserRelativeContext&&t.isInsideTeamFolderTree&&R.push({label:T,iconName:"settings-gear",performAction:x(o,t)})}return R}Object.defineProperty(t,"__esModule",{value:!0});var m=p._("Upload files"),f=p._("New Google Doc"),_=p._("New folder"),g=p._("Restore folder"),w=p._("Re-add shared folder"),S=p._("Show deleted files"),b=p._("Hide deleted files"),y=p._("New shared folder"),v=p._("Share folder"),T=p._("Manage as admin"),F=function(){return null},E=function(e){return function(){e&&e()}},C=function(e,t){return function(){s.logCreateFolder({uid:e.id}),e.is_cdm_member&&"/"===t.currentFQPath?a.asyncShowCdmNewFolderModal(function(o,r){r?a.asyncShowNewFolderShareModal(e,null,t.currentFQPath,o,r):i.browseActions.createFolder({pathName:t.currentFQPath,folderName:o})},e):i.browseActions.nameNewFolder()}},I=function(e,t){return function(){t.isCurrentlyInRoot?a.asyncShowShareAFolderWizardModal(e):a.asyncShowShareModal(e,t,{origin:l.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS})}},N=function(e,t){return function(){s.logToggleDeletedFiles({uid:e.id,show_deleted_files:!t}),i.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!t})}},D=function(e,t){return function(){var o=r.getRestoreFileUrl({fqPath:t.currentFQPath,userId:e.id});u.redirect(o)}},P=function(e,t){return function(){var o=t.currentFQPath.toLowerCase(),r=t.inactiveNSIDByFQPath[o],s=t.isInsideDeletedNestedSharedFolder;r&&a.asyncMountSharedFolder(r,e.role,l.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,s)}},A=function(e,t,r){return function(){function s(t){void 0===t&&(t=F),o.WebRequest({url:"/browse_close_onboarding_new_folder_modal",subject_user:e,complete:t})}var i=r.isActive,a=r.hasSeenNewFolderModal,l=r.hasSeenNewFolderModalCallback;i&&!a?n.asyncShowOnboardingNewFolderModal(function(){return s(function(){return u.redirect("/guide/business/manage-files/organize-your-folders")})},function(){s(),l&&l(),C(e,t)()}):C(e,t)()}},x=function(e,t){return function(){a.asyncGoToContentManagerForPath({isLimitedTeam:c.get_viewer().team_is_limited,containingFolder:t.currentFQPath,isCDM:e.is_cdm_member})}};t.getGlobalActions=h}),define("modules/clean/react/browse/internal_drag_status",["require","exports","tslib","external/classnames","external/react","modules/clean/react/sprite"],function(e,t,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,o=e.files,n=r("active",t);return s.createElement("div",{id:"drag-status",className:n},s.createElement("div",{id:"drag-selection-status"},o.slice(0,4).map(function(e,t){return e.thumbnail_url_tmpl?s.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):s.createElement(i,{key:t,group:"web",name:e.icon,className:"icon icon"+t,alt:""})}),s.createElement("span",{className:"badge"},o.length)))},t})(s.PureComponent);t.InternalDragStatus=n}),define("modules/clean/react/browse/item_list",["require","exports","modules/clean/react/browse/item_list_legacy"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemList=o.ItemList,t.ItemListController=o.ItemListController}),function(){define("modules/clean/react/browse/item_list_legacy",["jquery","external/classnames","external/mcl/button","external/mcl/vertically_fixed","external/immutable","external/keymaster","external/react","external/react-dom","external/underscore","modules/clean/components/loading_indicator","modules/clean/filepath","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/constants","modules/clean/react/browse/empty_folder_display_props","modules/clean/react/browse/file_list_empty_folder","modules/clean/react/browse/files_view/tile_grid","modules/clean/react/browse/internal_drag_status","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/browse/file_list_utils","modules/clean/react/columnheader","modules/clean/react/file_uploader/constants","modules/clean/react/helpers","modules/clean/react/selectable_list","modules/clean/react_logger","modules/clean/undo","modules/core/accessible_announce","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/react/browse/item_list_row","modules/clean/react/browse/folder_list_row","modules/clean/react/browse/file_jump","modules/clean/react/maestro/checkbox","modules/clean/react/browse/browse_tile_header","modules/clean/react/sticky/container","modules/clean/react/sticky/sticky","require"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A,x,R,M,L,O,U){var k,B,H,G,V,q,W,z,j,K,Q,J,Y,Z,X,$,ee,te,oe,re,se,ie,ne,ae,le,ce,de,ue,pe,he,me,fe,_e,ge,we,Se,be,ye,ve,Te,Fe,Ee,Ce,Ie,Ne,De;return o.Button,pe=r.VerticallyFixed,Ee=u.setupExternalDragHandler,Te=u.onFileDragEnterItem,V=p.BrowseSortFields,Q=p.CulledListConstants,J=p.DropTargetHighlightMode,re=p.LoadingStates,se=p.NewFolderCreationStates,ae=p.RenameStates,he=p.ViewTypes,be=h.getEmptyFolderDisplayProps,Y=m.EmptyFolder,q=f.BrowseTileGrid,ye=f.getThumbnailUrlForItem,ee=_.InternalDragStatus,Se=g.generateGetIsGlobalEvent,Fe=g.resetBrowseKeyboardShortcuts,Ce=g.setupItemListKeyboardShortcuts,G=w.BrowseContext,Z=w.File,ie=w.Paper,Ne=S.shouldFileBeHighlightedDropTarget,j=b.ColumnHeader,K=b.ColumnTypes,le=b.SortDirections,X=y.INTERNAL_FILE_DATA_TRANSFER_TYPE,Ie=v.shallowCompareStateAndProps,_e=T.createSelectableList,ge=T.createSelection,ne=F.ReactLogger,H=C.AccessibleAnnounce,me=N._,W=R.Checkbox,z=R.CheckboxState,ue=M.ToggleViewTypeButton,de=L.StickyContainer,ce=O.Sticky,we=n.DOM,fe=n.createElement,$="ItemList",B="undefined"!=typeof window&&null!==window?e(window):null,k="undefined"!=typeof document&&null!==document?e(document.documentElement):null,s.Set(["ai","au","fl","key","numbers","pages","pkg","pr","psd","sketch","txt","md"]),s.Set(["acrobat","code","compressed","excel","film","gear","picture","powerpoint","sound","word"]),s.Set(["folder","folder_app","folder_camera","folder_team","folder_team_locked","folder_user","folder_user_locked"]),te=_e(n.createClass({displayName:"ItemList",propTypes:{user:n.PropTypes.object.isRequired,context:n.PropTypes.instanceOf(G).isRequired,path:n.PropTypes.string.isRequired,rowHeight:n.PropTypes.number,selectedFiles:n.PropTypes.instanceOf(s.OrderedMap),isBrowseInContentManager:n.PropTypes.bool,isRenaming:n.PropTypes.bool,itemListLength:n.PropTypes.number,openContextMenuAtPosition:n.PropTypes.func,setFileUploaderPath:n.PropTypes.func,onFocus:n.PropTypes.func,focusSelectedItem:n.PropTypes.func,isDraggingExternalFiles:n.PropTypes.bool,isDraggingInternalFiles:n.PropTypes.bool,className:n.PropTypes.string,actionHandlers:n.PropTypes.object,selectAll:n.PropTypes.func,deselectAll:n.PropTypes.func,viewType:n.PropTypes.oneOf(l.values(he)),maestroListViewFullRowSelect:n.PropTypes.bool},getDefaultProps:function(){return{rowHeight:Q.ITEM_ROW_HEIGHT_PX,selectedFiles:s.OrderedMap(),isDraggingExternalFiles:!1,isDraggingInternalFiles:!1,activeDropTarget:!1,isRenaming:!1,onFocus:function(){return{}},setFileUploaderPath:function(){return{}},isBrowseInContentManager:!1,className:null,actionHandlers:{},viewType:he.List}},componentWillMount:function(){return ne.start(this.constructor.displayName),this.isFocused=!1},componentDidMount:function(){return this._setupFocusHandler(),this._setupExternalDragHandler(),this._setupKeyboardShortcuts(),ne.end(this.constructor.displayName)},componentWillUnmount:function(){return Fe($),e(a.findDOMNode(this)).off(".ItemList")},_setupFocusHandler:function(){var t;return t=e(a.findDOMNode(this)),t.on("focusin.ItemList",(function(e){return function(){return e.isFocused=!0,e.props.onFocus(),!0}})(this)),t.on("focusout.ItemList",(function(e){return function(){return e.isFocused=!1,!0}})(this))},getFocusHandler:function(e){return(function(t){return function(){return t.isFocused=e,!0}})(this)},_setupExternalDragHandler:function(){var e,t,o,r,s;return r=(function(e){return function(){return e.props.isDraggingInternalFiles}})(this),o=(function(e){
return function(){return e.props.isDraggingExternalFiles}})(this),s=(function(e){return function(){return e.props.setFileUploaderPath({path:e.props.path,hasPermissionToUploadToFolder:e.props.context.isCurrentPathWriteable()})}})(this),e=".browse-file-row",t=(function(e){return function(){return e.props.activeDropTarget}})(this),Ee($,r,o,s,e,t)},_setupKeyboardShortcuts:function(){var e,t,o,r,s,i;return o=Se(this),r=(function(e){return function(t){return e.isFocused&&"BUTTON"!==t.target.tagName}})(this),s=(function(e){return function(){return e.props.selectedFiles}})(this),t=(function(e){return function(){return e.props.focusSelectedItem}})(this),i=(function(e){return function(){return e.props.context.isCurrentPathWriteable()}})(this),e=function(){return!1},Ce(o,r,s,t,i,e,this.props.selectAll,this.props.deselectAll,this.props.actionHandlers.onDelete,this.props.openContextMenuAtPosition,$)},render:function(){var e;return e=t(this.props.className,{"browse-files o-list-ui":!this.props.isBrowseInContentManager,"browse-files__content-manager":this.props.isBrowseInContentManager,"browse-files--single-selection":1===this.props.selectedFiles.size&&!this.props.maestroListViewFullRowSelect}),we.div({className:"browse-files-wrapper"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER?we.ul({className:e,role:"presentation"},this.props.children):we.ul({className:e,role:"presentation",style:{display:"block",position:"relative",height:this.props.itemListLength*this.props.rowHeight}},this.props.children))}})),oe=n.createClass({displayName:"ItemListController",gridViewPrewarmedThumbnailRequestIds:[],propTypes:{context:n.PropTypes.instanceOf(G).isRequired,items:n.PropTypes.instanceOf(s.List).isRequired,user:n.PropTypes.object.isRequired,path:n.PropTypes.string.isRequired,isSearchMode:n.PropTypes.bool,sections:n.PropTypes.shape({sectionLabels:n.PropTypes.arrayOf(n.PropTypes.string),sectionStartIndices:n.PropTypes.arrayOf(n.PropTypes.number)}),selection:n.PropTypes.shape({selected:n.PropTypes.instanceOf(s.OrderedSet),anchor:n.PropTypes.string}),selectedFiles:n.PropTypes.instanceOf(s.OrderedMap),createNewFolderState:n.PropTypes.oneOf(l.values(se)),customEmptyFolderView:n.PropTypes.func,dropTargetHighlightMode:n.PropTypes.oneOf((function(){var e;e=[];for(ve in J)De=J[ve],e.push(De);return e})()),fileRename:n.PropTypes.shape({file:n.PropTypes.instanceOf(Z),state:n.PropTypes.oneOf(l.values(ae))}),isArchiveState:n.PropTypes.bool,isBrowseInContentManager:n.PropTypes.bool,isTextSelectable:n.PropTypes.bool,loadingState:n.PropTypes.oneOf(l.values(re)),mostRecentlyDraggedOverFile:n.PropTypes.instanceOf(Z),openContextMenuAtPosition:n.PropTypes.func,isDraggingExternalFiles:n.PropTypes.bool,isDraggingInternalFiles:n.PropTypes.bool,activeDropTarget:n.PropTypes.object,onSelectionChange:n.PropTypes.func,showFilenameHighlights:n.PropTypes.bool,disableColumnDetail:n.PropTypes.bool,enableDoubleClickTraversal:n.PropTypes.bool,enableUnity:n.PropTypes.bool,enableMaxHeightGrouping:n.PropTypes.bool,onFocus:n.PropTypes.func,setFileUploaderPath:n.PropTypes.func,onCreateTeamFolder:n.PropTypes.func,enableDataMigrationTool:n.PropTypes.bool,isPhotosPage:n.PropTypes.bool,onShowDataMigrationToolModal:n.PropTypes.func,settingsGearMenuAlt:n.PropTypes.string,settingsGearMenuItems:n.PropTypes.arrayOf(n.PropTypes.shape({label:n.PropTypes.string,action:n.PropTypes.func})),activeSortField:n.PropTypes.oneOf(l.values(V)),activeSortDirection:n.PropTypes.oneOf(l.values(le)),onSortChange:n.PropTypes.func,initialMultiColumnSortField:n.PropTypes.string,actionHandlers:n.PropTypes.object,handleComponentTTI:n.PropTypes.func,showFileUploaderModal:n.PropTypes.func,isFileViewerShown:n.PropTypes.func,isSharedWithLoaded:n.PropTypes.bool,isStarredLoaded:n.PropTypes.bool,isUnityLoaded:n.PropTypes.bool,isOverFreeQuota:n.PropTypes.bool,expBizFoldersEmptyStateAdmin:n.PropTypes.bool,expBizFoldersEmptyStateUser:n.PropTypes.bool,viewType:n.PropTypes.oneOf(l.values(he)),maestroListViewFullRowSelect:n.PropTypes.bool,maestroGridViewPrewarmVariant:n.PropTypes.string,totalNumItems:n.PropTypes.number,onSwitchViewType:n.PropTypes.func,showBrowseTileHeader:n.PropTypes.bool,showOverflowActions:n.PropTypes.bool,isSubgrowthPinnedExp:n.PropTypes.bool,numTeamFolders:n.PropTypes.number,onRangeInView:n.PropTypes.func},getDefaultProps:function(){return{isSearchMode:!1,sections:null,selection:ge(),selectedFiles:s.OrderedMap(),createNewFolderState:se.CREATE_FOLDER_INACTIVE,customEmptyFolderView:null,showFileUploaderModal:function(){},dropTargetHighlightMode:J.NONE,fileRename:null,isArchiveState:!1,isColumnHeaderVisible:!0,isMultiColumnGroupVisible:!0,isBrowseInContentManager:!1,isPaginating:!1,isTextSelectable:!0,mostRecentlyDraggedOverFile:null,shouldHighlightDropTargets:!1,showFilenameHighlights:!1,disableColumnDetails:!1,enableDoubleClickTraversal:!0,expBizFoldersEmptyStateAdmin:!1,expBizFoldersEmptyStateUser:!1,enableUnity:!0,enableMaxHeightGrouping:!1,isDraggingExternalFiles:!1,isDraggingInternalFiles:!1,isPhotosPage:!1,isUnityLoaded:!1,onFocus:function(){},setFileUploaderPath:function(){},activeSortField:null,activeSortDirection:null,onSortChange:function(){},isFileViewerShown:function(){return!1},initialMultiColumnSortField:null,handleComponentTTI:function(){},viewType:he.List,maestroListViewFullRowSelect:!1,maestroGridViewPrewarmVariant:"OFF",totalNumItems:0,onSwitchViewType:function(){},showBrowseTileHeader:!0,showOverflowActions:!0,isSubgrowthPinnedExp:!1,numTeamFolders:0}},getInitialState:function(){var e;return{activeMultiColumnField:this.props.initialMultiColumnSortField,viewportHeight:("undefined"!=typeof document&&null!==document&&null!=(e=document.documentElement)?e.clientHeight:void 0)||0,rowHeight:this.getRowHeight(this.props),scrollPosition:0,lastSelectedItemIndex:-1,arrowingDown:!1,promptBannerIsVisible:!1}},componentWillMount:function(){return ne.start(this.constructor.displayName)},componentDidMount:function(){return window.addEventListener("scroll",this.updateOnScroll),window.addEventListener("resize",this.updateOnResize),this.props.selection.selected.size&&!this.props.isFileViewerShown()&&this.scrollItemRowsIntoView(),this.props.viewType===he.List&&this.props.loadingState!==re.LOADING_FIRST_PAGE&&this.props.handleComponentTTI(this.constructor.displayName),this.props.isSubgrowthPinnedExp&&document.querySelector(".has-top-notification")&&this.setState({promptBannerIsVisible:!0}),this.props.enableUnity&&U(["modules/clean/unity_browse_interface"],(function(e){return function(t){return e.triggerUnityChangeCallback=function(){return t.browse_visible_change_callback(e.props.items.toArray(),e.props.user.id,0,e.props.items.size-1)}}})(this)),this._maybePrewarmGalleryViewThumbStore(),ne.end(this.constructor.displayName)},componentWillUnmount:function(){return window.removeEventListener("scroll",this.updateOnScroll),window.removeEventListener("resize",this.updateOnResize),this.triggerUnityChangeCallback=void 0},shouldComponentUpdate:Ie,componentDidUpdate:function(e){var t,o,r,s,i;if(this.props.loadingState!==re.LOADING_FIRST_PAGE&&this.props.handleComponentTTI(this.constructor.displayName),this.props.enableUnity&&e.items!==this.props.items&&"function"==typeof this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback(),e.viewType!==this.props.viewType&&this.updateOnScroll(),t=this.props.selection.selected.subtract(e.selection.selected),!t.size||this.props.isFileViewerShown()||this.allSelected()?this.props.isFileViewerShown()||this.props.createNewFolderState===e.createNewFolderState||this.props.createNewFolderState===se.CREATE_FOLDER_INACTIVE||B.scrollTop(0):this.scrollItemRowsIntoView(),e.loadingState!==this.props.loadingState&&this.props.loadingState===re.LOADED&&H.polite(me("Finished loading files")),e.viewType!==this.props.viewType&&(i=this.props.viewType===he.List?this.refs.toggleViewTypeButton:null!=(o=this.refs.browseTileGrid)&&null!=(r=o.refs.tileGridHeader)?r.refs.toggleViewTypeButton:void 0,null!=i&&null!=(s=i.refs.button)&&s.focus()),e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath)return this._maybePrewarmGalleryViewThumbStore()},componentWillReceiveProps:function(e){var t,o,r,s,i,n;return null!=(null!=(n=e.selection)?n.selected:void 0)?(s=this.props.selection.selected.last(),i=this.getIndexOfItem(s),t=e.selection.selected.last(),o=this.getIndexOfItem(t,e.items),r={lastSelectedItemIndex:o,arrowingDown:!1},o-i===1&&(r.arrowingDown=!0),this.setState(r)):this.setState({lastSelectedItemIndex:-1}),this.setState({rowHeight:this.getRowHeight(e)})},_maybePrewarmGalleryViewThumbStore:function(){if(this.props.viewType===he.List&&"ON"===this.props.maestroGridViewPrewarmVariant)return this._undoPrewarmGalleryViewThumbStore(),U(["modules/clean/web_timing_logger","modules/clean/photos/thumb_loading/generic_thumb_store"],(function(e){return function(t,o){var r;return r=o.GenericThumbStore,t.waitForTTI().then(function(){return e.thumbStore=new r,e.props.items.slice(0,100).forEach(function(t){var o,r;if(r=ye(t),null!=r)return o=e.thumbStore.bind_url(r,{onSuccess:function(){}}),e.gridViewPrewarmedThumbnailRequestIds.push(o)})})}})(this))},_undoPrewarmGalleryViewThumbStore:function(){if(this.thumbStore&&this.gridViewPrewarmedThumbnailRequestIds.length>0)return this.gridViewPrewarmedThumbnailRequestIds.forEach((function(e){return function(t){return e.thumbStore.unbind_url(t)}})(this)),this.gridViewPrewarmedThumbnailRequestIds=[]},focusSelectedItem:function(){var t,o,r;if(o=this.props.selectedFiles.first(),o&&(r=this.getIndexOfItem(o.fq_path),t=this.props.viewType===he.Grid?e(a.findDOMNode(this)).find(".file-tile-grid-container .tile__preview:eq("+r+")"):e(a.findDOMNode(this)).find(".browse-files .browse-file-row:eq("+r+")"),!t.is(":focus")))return t.focus()},getRowHeight:function(e){return Q.ITEM_ROW_HEIGHT_PX,e.isSearchMode?Q.MAESTRO_SEARCH_ROW_HEIGHT_PX:Q.MAESTRO_ITEM_ROW_HEIGHT_PX},getIndexOfItem:function(e,t){return null==t&&(t=this.props.items),t.findIndex(function(t){return t instanceof Z?d.paths_are_equal(t.fq_path,e):t instanceof ie?t.pad_id===e:void 0})},scrollItemRowsIntoView:function(){var t,o,r,s,i,n,a,l,c;if(s=this.state.lastSelectedItemIndex,r=1,s>=0){if(o="fixed"===e(".browse-header").css("position"),c=o?parseInt(e(".browse-files").css("marginTop"))||Q.DEFAULT_HEADER_HEIGHT_PX:0,this.isGridView())return void(null!=(l=this.refs.tileGrid)&&l.scrollTileIntoView(this.state.viewportHeight,this.state.lastSelectedItemIndex));if(t=this.state.viewportHeight-c-this.state.rowHeight-r,i=s*this.state.rowHeight-r,a=this.state.scrollPosition,n=this.state.scrollPosition+t,a<=i&&i<=n)return;return i<a?B.scrollTop(i):this.state.arrowingDown?B.scrollTop(i-t+r):B.scrollTop(i-Math.round(t/2)+r)}},isGridView:function(){return this.props.viewType===he.Grid},anySelected:function(){return this.props.selectedFiles.size>0},allSelected:function(){return this.props.selectedFiles.size===this.props.items.size},selectNone:function(){return this.props.onSelectionChange(this.props.selection.set("selected",s.OrderedSet([])))},selectAll:function(){var e;return this.props.onSelectionChange(this.props.selection.set("selected",s.OrderedSet(function(){var t,o,r,s;for(r=this.props.items.toArray(),s=[],t=0,o=r.length;t<o;t++)e=r[t],s.push(e.fq_path);return s}.call(this))))},_toggleSelectAll:function(){return this.anySelected()?this.selectNone():this.selectAll(),event.target.focus()},_getCheckboxState:function(){var e,t,o;return t=this.anySelected(),e=this.allSelected(),o=z.Unchecked,t&&(o=z.PartiallyChecked),e&&(o=z.Checked),o},_getColumns:function(){var e,t;return e=[{type:K.STATIC,content:this.renderSelectToggleCheckbox(),headerClassName:"select-all-checkbox",labelClassName:"ax-visually-hidden",label:me("Select All Checkboxes"),role:"gridcell"},{type:K.SINGLE,label:me("Name"),headerClassName:"columnheader--filename o-grid__col o-grid__col--6-of-12",sortField:V.FILENAME},{type:K.SINGLE,label:me("Modified"),headerClassName:"columnheader--modified o-grid__col o-grid__col--3-of-12",sortField:V.MODIFIED},{type:K.MULTI,columns:[{label:me("Members"),headerClassName:"columnheader--sharedwith o-grid__col o-grid__col--3-of-12",sortField:V.SHARED_WITH},{label:me("Type"),headerClassName:"columnheader--type o-grid__col o-grid__col--3-of-12",sortField:V.CATEGORY},{label:me("Extension"),headerClassName:"columnheader--extension o-grid__col o-grid__col--3-of-12",sortField:V.EXTENSION},{label:me("Size"),headerClassName:"columnheader--size o-grid__col o-grid__col--3-of-12",sortField:V.SIZE}]},{type:K.STATIC,label:me("Actions"),headerClassName:"ax-visually-hidden"}],t=fe(ue,{onSwitchViewType:this.props.onSwitchViewType,currentViewType:this.props.viewType,ref:"toggleViewTypeButton"}),e.push({type:K.STATIC,content:t,headerClassName:"toggle-view-type--list-view",labelClassName:"ax-visually-hidden",label:me("Toggle View Type")}),e},handleDragStart:function(e,t,o){var r,s,i,n,c;return null==t&&(t=[]),null==o&&(o=!0),o?(n=l.indexBy(t,"fq_path"),Object.assign(n,this.props.selectedFiles.toJS()),c=l.values(n)):c=t,c.some(function(e){return Z.isTeamSharedFolder(e)})?void D.error(me("Team folders can’t be moved.")):c.some(function(e){return Z.isTeamMemberFolder(e)})?void D.error(me("Your member folder can’t be moved.")):(s={userId:this.props.user.id,fromPath:this.props.path,filePaths:(function(){var e,t,o;for(o=[],e=0,t=c.length;e<t;e++)i=c[e],o.push(i.fq_path);return o})()},null!=e.dataTransfer?("function"==typeof(r=e.dataTransfer).setDragImage&&r.setDragImage(a.findDOMNode(this.refs.dragIcon),-10,-10),e.dataTransfer.setData(X,JSON.stringify(s)),e.dataTransfer.effectAllowed="copyMove"):void 0)},createOnDragEnterHandlerForFile:function(e,t,o){return(function(r){return function(){return Te(e,r.props.isDraggingExternalFiles,r.props.isDraggingInternalFiles,t,o,r.props.context,r.props.setFileUploaderPath)}})(this)},_handleGridTTI:function(){return this.props.handleComponentTTI(this.constructor.displayName)},_renderPaperRow:function(e,t,o){var r;return r=this.state.rowHeight*t,fe(P.PaperItemRow,{paper:e,user:this.props.user,key:e.pad_id,topOffsetPx:r,rowIndex:t,totalRowCount:o,showTitleHighlights:!0,isSearchMode:this.props.isSearchMode})},_renderFileRow:function(e,t,o){var r,s,i,n,a,l,c,u;return i=this.props.selection.selected.has(e.fq_path),r=Ne({file:e,isSelected:i,dropTargetHighlightMode:this.props.dropTargetHighlightMode}),s=e===this.props.activeDropTarget,d.paths_are_equal(null!=(a=this.props.fileRename)?a.file.fq_path:void 0,e.fq_path)&&(l=this.props.fileRename.state),n=this.props.selection.selected.last()===e.fq_path||!this.props.selection.selected.size&&0===t,u=this.state.rowHeight*t,c=this.props.context.isNonUserRelativeContext&&e.isDeleted?null:this.props.settingsGearMenuItems,fe(P.FileItemRow,{selectableListId:e.fq_path,key:encodeURI(e.fq_path)+":"+t,file:e,user:this.props.user,isTabbable:n,enableDoubleClickTraversal:this.props.enableDoubleClickTraversal,isSearchMode:this.props.isSearchMode,topOffsetPx:u,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isAvailableDropTarget:r,isActiveDropTarget:s,isArchiveState:this.props.isArchiveState,isModifiedColumnVisible:this.props.isModifiedColumnVisible,isMultiColumnGroupVisible:this.props.isMultiColumnGroupVisible,isUnityLoaded:this.props.isUnityLoaded,isTextSelectable:this.props.isTextSelectable,isOverFreeQuota:this.props.isOverFreeQuota,context:this.props.context,renameState:l,loadingState:this.props.loadingState,rowIndex:t,totalRowCount:o,settingsGearMenuAlt:this.props.settingsGearMenuAlt,settingsGearMenuItems:c,showColumnDetail:!this.props.isColumnHeaderVisible&&!this.props.disableColumnDetails,showFilenameHighlights:this.props.showFilenameHighlights,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,inSelectMode:this.props.selectedFiles.count()>0,selectedFilesCount:this.props.selectedFiles.count(),setFileUploaderPath:this.props.setFileUploaderPath,onDragStart:this.handleDragStart,onFileDragEnterItem:this.createOnDragEnterHandlerForFile(e,i,s),actionHandlers:this.props.actionHandlers,contextFileActionHandlers:this.props.contextFileActionHandlers,isSharedWithLoaded:this.props.isSharedWithLoaded,isStarredLoaded:this.props.isStarredLoaded,showOverflowActions:this.props.showOverflowActions})},_renderLoadingIndicator:function(e,o){var r,s;return r=["u-font-center item-list-loading-indicator-wrapper",{"item-list-loading-indicator-wrapper--grid":this.props.viewType===he.Grid}],s={className:t(r),key:"loadingIndicator"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||(s.style={position:"absolute",top:o*this.state.rowHeight||0,width:"100%"}),we.li(s,fe(c,{style:c.LoadingIndicatorStyle.BLUE_SPINNER,startMessage:e}))},_renderEmptyFolder:function(){var e,t;return t={key:"emptyFolderPlaceholder",currentSharedFolderPermissionRole:this.props.context.currentSharedFolderPermissionRole,onCreateTeamFolder:this.props.onCreateTeamFolder,enableDataMigrationTool:this.props.enableDataMigrationTool,onShowDataMigrationToolModal:this.props.onShowDataMigrationToolModal,isArchiveState:this.props.isArchiveState&&!this.props.context.isInsideArchivedTeamFolder,isBrowseInContentManager:this.props.isBrowseInContentManager,isInsideSharedFolder:this.props.context.isInsideSharedFolder,isViewingTeamFolder:this.props.context.isInsideTeamFolderRoot,isInsideTeamFolderTree:this.props.context.isInsideTeamFolderTree,userId:this.props.user.id,userFamiliarName:this.props.user.familiar_name,showFileUploaderModal:this.props.showFileUploaderModal},(this.props.expBizFoldersEmptyStateAdmin||this.props.expBizFoldersEmptyStateuser)&&(e=be({expBizFoldersEmptyStateAdmin:this.props.expBizFoldersEmptyStateAdmin,expBizFoldersEmptyStateUser:this.props.expBizFoldersEmptyStateUser,isInsideTeamFolderTree:this.props.context.isInsideTeamFolderTree,isInsideSharedFolder:this.props.context.isInsideSharedFolder}),Object.assign(t,e)),fe(Y,t)},_getPerformanceHackColumnClassName:function(){switch(this.state.activeMultiColumnField){case V.SHARED_WITH:return"is-sharedwith-column-visible";case V.CATEGORY:return"is-type-column-visible";case V.EXTENSION:return"is-extension-column-visible";case V.SIZE:return"is-size-column-visible"}},_renderItemGrid:function(e){var t;return t=this.props.activeSortField,t===V.SHARED_WITH&&(t=V.FILENAME),fe(q,{key:"browseTileGrid",ref:"browseTileGrid",isCreateFolderUIActive:e,context:this.props.context,items:this.props.items,user:this.props.user,isSearchMode:this.props.isSearchMode,isUnityLoaded:this.props.isUnityLoaded,sections:this.props.sections,selection:this.props.selection,selectedFiles:this.props.selectedFiles,createNewFolderState:this.props.createNewFolderState,isPhotosPage:this.props.isPhotosPage,enableMaxHeightGrouping:this.props.enableMaxHeightGrouping,actionHandlers:this.props.actionHandlers,selectAll:this.selectAll,deselectAll:this.selectNone,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,setFileUploaderPath:this.props.setFileUploaderPath,path:this.props.path,activeDropTarget:this.props.activeDropTarget,createOnDragEnterHandlerForFile:this.createOnDragEnterHandlerForFile,handleDragStart:this.handleDragStart,contextFileActionHandlers:this.props.contextFileActionHandlers,fileRename:this.props.fileRename,onSelectionChange:this.props.onSelectionChange,onSwitchViewType:this.props.onSwitchViewType,onSortChange:this.props.onSortChange,showBrowseTileHeader:this.props.showBrowseTileHeader,activeSortField:t,activeSortDirection:this.props.activeSortDirection,totalNumItems:this.props.totalNumItems,currentViewType:this.props.viewType,handleTTI:this._handleGridTTI,thumbStore:this.thumbStore,onRangeInView:this.props.onRangeInView})},_renderItemList:function(e){var t,o,r;return o=this.props.items.toArray(),r=0,e&&(r+=1),this.props.loadingState===re.LOADING_REMAINING_PAGES&&(r+=1),t=this.props.loadingState===re.LOADING_FIRST_PAGE?0:o.length+r,fe(te,{key:"itemList",ref:"itemList",allItemIds:this.props.items.map(function(e){return e.fq_path}),user:this.props.user,path:this.props.path,context:this.props.context,rowHeight:this.state.rowHeight,selectedFiles:this.props.selectedFiles,isBrowseInContentManager:this.props.isBrowseInContentManager,isRenaming:!!this.props.fileRename,openContextMenuAtPosition:this.props.openContextMenuAtPosition,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,itemListLength:t,activeDropTarget:this.props.activeDropTarget,keyScope:$,linkedOutsideClasses:[".bubble-menu-item-wrapper",".browse-menu",".context-menu",".react-file-viewer",".db-modal"],selection:this.props.selection,setFileUploaderPath:this.props.setFileUploaderPath,onFocus:this.props.onFocus,onSelectionChange:this.props.onSelectionChange,focusSelectedItem:this.focusSelectedItem,className:this._getPerformanceHackColumnClassName(),actionHandlers:this.props.actionHandlers,isCheckboxes:!0,selectAll:this.selectAll,deselectAll:this.selectNone},this._renderItemRows(o,e))},_renderCreateFolderUI:function(){return fe(A,{newFolderState:this.props.createNewFolderState,context:this.props.context,user:this.props.user,topOffsetPx:0})},_expGetPinnedFolderHeight:function(){var e;return e=92,this.state.rowHeight*this.props.numTeamFolders+e},_renderItemRows:function(e,t){var o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A;if(C=[],E=(function(e){return function(t,o,r){return t instanceof Z?C.push(e._renderFileRow(t,o,r)):t instanceof ie?C.push(e._renderPaperRow(t,o,r)):void 0}})(this),"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER){for(a=n=0,h=e.length;n<h;a=++n)l=e[a],E(l,a+1,e.length);return this.props.loadingState===re.LOADING_REMAINING_PAGES&&C.push(this._renderLoadingIndicator(me("Loading files…"),e.length)),C}for(y=0,b=0,t&&(y=1),this.props.loadingState===re.LOADING_REMAINING_PAGES&&(b=1),F=e.length,A=F+y+b,w=Math.ceil(this.state.viewportHeight/this.state.rowHeight)+2*Q.ITEM_BUFFER_SIZE,v=Math.min(A,w),s=this.props.isSubgrowthPinnedExp?this._expGetPinnedFolderHeight():0,P=Math.max(0,this.state.scrollPosition-Q.ITEM_BUFFER_SIZE*this.state.rowHeight-s),D=Math.min(Math.floor(P/this.state.rowHeight),A-v),r=Math.min(D+v-1,A-1),o=e.slice(D,+r+1||9e9),p=this.state.lastSelectedItemIndex,c=[],d=[],p>=0&&(p<D?(i=Math.max(0,p-1),u=Math.min(p+1,D-1),c=function(){I=[];for(var e=i;i<=u?e<=u:e>=u;i<=u?e++:e--)I.push(e);return I}.apply(this)):p>r&&(i=Math.max(r+1,p-1),u=Math.min(p+1,F-1),d=function(){N=[];for(var e=i;i<=u?e<=u:e>=u;i<=u?e++:e--)N.push(e);return N}.apply(this))),g=0,m=c.length;g<m;g++)a=c[g],l=e[a],E(l,a+y,A);for(S=0,f=o.length;S<f;S++)l=o[S],E(l,D+y,A),D+=1;for(u=D,T=0,_=d.length;T<_;T++)a=d[T],l=e[a],E(l,a+y,A);return t&&C.unshift(this._renderCreateFolderUI()),this.props.loadingState===re.LOADING_REMAINING_PAGES&&C.push(this._renderLoadingIndicator(me("Loading files…"),u)),C},updateOnResize:function(){var e;if(e=document.documentElement.clientHeight,this.state.viewportHeight!==e)return this.setState({viewportHeight:e})},updateOnScroll:function(){var e;if(this.props.viewType!==he.Grid&&(e=B.scrollTop(),0!==e||"fixed"!==k.css("position")))return null!=e&&this.state.scrollPosition!==e?this.setState({scrollPosition:e}):void 0},handleMultiColumnChange:function(e){return this.setState({activeMultiColumnField:e.sortField})},renderSelectToggleCheckbox:function(){var e;return e=this._getCheckboxState(),we.div({className:t({"file-select-checkbox":!0,"file-select-checkbox--gridview":this.isGridView(),"show-boxes":this.anySelected()}),key:"selection_toggle_column"},fe(pe,{},fe(W,{ariaLabel:me("Select all"),checkboxState:e,onClick:this._toggleSelectAll})))},renderColumnHeaderContent:function(){var e;return e=["browse-file-list-header o-grid o-grid--no-gutter",{"ax-visually-hidden":!this.props.items.size}],this.props.isSubgrowthPinnedExp&&e.push("exp-pinned-sticky__header"),fe(j,{columns:this._getColumns(),className:t(e),tabbable:!0,disabled:this.props.loadingState!==re.LOADED,activeSortField:this.props.activeSortField,initialMultiColumnSortField:this.state.activeMultiColumnField,activeSortDirection:this.props.activeSortDirection,onSortChange:this.props.onSortChange,onMultiColumnChange:this.handleMultiColumnChange,isMaestroDesign:!0})},renderColumnHeader:function(){return this.props.isSubgrowthPinnedExp?fe(ce,{offsetHeight:40,className:"exp-pinned-sticky"},this.renderColumnHeaderContent()):this.props.viewType===he.List?we.div({key:"columnHeaderShadow",className:"browse-file-list-header__shadow"},fe(pe,{},this.renderColumnHeaderContent())):this.props.loadingState!==re.LOADING_FIRST_PAGE?this.renderSelectToggleCheckbox():void 0},render:function(){var e,o,r,s,i;return o=this.props.createNewFolderState!==se.CREATE_FOLDER_INACTIVE,r=this.props.loadingState===re.LOADED&&!this.props.items.count()&&!o,i=[],this.props.isColumnHeaderVisible&&!r&&i.push(this.renderColumnHeader()),r?i.push(("function"==typeof(e=this.props).customEmptyFolderView?e.customEmptyFolderView():void 0)||this._renderEmptyFolder()):this.props.loadingState===re.LOADING_FIRST_PAGE?i.push(we.ul({key:"loadingIndicatorContainer",className:t("browse-files o-list-ui")},this._renderLoadingIndicator(me("Loading files…")))):this.props.viewType===he.List?i.push(this._renderItemList(o)):this.props.viewType===he.Grid&&i.push(this._renderItemGrid(o)),i.push(we.div({key:"dragIcon",ref:"dragIcon",className:"offscreen-drag-icon"},this.props.selectedFiles.count()?fe(ee,{files:this.props.selectedFiles.toArray()}):void 0)),this.props.isSubgrowthPinnedExp?(s=96,this.state.promptBannerIsVisible&&(s+=48),we.div({role:"grid","aria-readonly":"true"},fe(de,{offsetTop:s,useNativeSticky:!0},i))):we.div({role:"grid","aria-readonly":"true"},i)}}),{ItemListController:oe,ItemList:te}})}.call(this),function(){define("modules/clean/react/browse/item_list_row",["jquery","external/immutable","external/underscore","external/classnames","external/mcl/button","external/react","external/react-dom","modules/clean/browse_interface","modules/clean/filepath","modules/clean/keycode","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/name_input","modules/clean/react/browse/paper_row_icon","modules/clean/react/browse/settings_gear_menu","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/browse/render_partials","modules/clean/react/browse/overflow_menu","modules/clean/react/content_manager/path_util","modules/clean/react_format","modules/clean/react/selectable_list","modules/clean/search/search_helpers","modules/clean/sharing/browse_exports","modules/constants/starred","modules/clean/react/home/home_access/home_access_util","modules/core/dom","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/react/browse/share_button","modules/clean/react/flag","modules/clean/react/helpers","modules/clean/user_education/user_education_client","modules/clean/react/maestro/checkbox","modules/clean/react_logger","modules/clean/react/title_bubble","require"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I,N,D,P,A,x,R,M,L,O,U,k){var B,H,G,V,q,W,z,j,K,Q,J,Y,Z,X,$,ee,te,oe,re,se,ie,ne,ae,le,ce,de,ue,pe,he,me,fe,_e;return G=s.Button,ce=a.browse_uri_for_fq_path,pe=a.get_browse_root_name,Y=c.KeyCode,le=d.browseActions,oe=u.RenameStates,K=u.FileTypes,Z=h.NameInput,ee=m.PaperRowIcon,re=f.SettingsGearMenuBubble,W=_.File,B=_.BrowseContext,X=_.Paper,g.browseStore,z=w.FileIcon,H=S.BrowseOverflowMenu,y.reactFormat,v.createSelection,Q=F.GoldenGate,_e=F.shouldUsePublicFolderSharing,J=E.HOME_RESOURCE_ID_TYPE,he=C.isHomeEnabled,ae=N._,se=A.ShareButton,fe=R.shallowCompareStateAndProps,ie=M.UEClient,ne=M.UserEducationEffect,V=L.Checkbox,q=L.CheckboxState,te=O.ReactLogger,ue=i.DOM,de=i.createElement,me=function(e,t,o,r,s){return(!t.is_dir||!_e(o.config,t.fq_path))&&(!(!e||t.isDeleted)&&(!W.isTeamMemberFolder(t)&&(!!W.canViewFileMembers(t,o)&&((!o.isNonUserRelativeContext||!s)&&!(o.isNonUserRelativeContext&&r&&!s)))))},j=i.createClass({displayName:"FileItemRow",propTypes:{context:i.PropTypes.instanceOf(B).isRequired,file:i.PropTypes.instanceOf(W).isRequired,user:i.PropTypes.object,columnClasses:i.PropTypes.string,isTabbable:i.PropTypes.bool,enableDoubleClickTraversal:i.PropTypes.bool,isSearchMode:i.PropTypes.bool,topOffsetPx:i.PropTypes.number,isSelected:i.PropTypes.bool,isDraggingInternalFiles:i.PropTypes.bool,isDraggingExternalFiles:i.PropTypes.bool,isAvailableDropTarget:i.PropTypes.bool,isActiveDropTarget:i.PropTypes.bool,isArchiveState:i.PropTypes.bool,isTextSelectable:i.PropTypes.bool,isMultiColumnGroupVisible:i.PropTypes.bool,isModifiedColumnVisible:i.PropTypes.bool,isUnityLoaded:i.PropTypes.bool,renameState:i.PropTypes.oneOf(o.values(oe)),rowIndex:i.PropTypes.number,showColumnDetail:i.PropTypes.bool,showFilenameHighlights:i.PropTypes.bool,maestroListViewFullRowSelect:i.PropTypes.bool,inSelectMode:i.PropTypes.bool,disableCheckbox:i.PropTypes.bool,settingsGearMenuAlt:i.PropTypes.string,settingsGearMenuItems:i.PropTypes.arrayOf(i.PropTypes.shape({label:i.PropTypes.string,action:i.PropTypes.func})),totalRowCount:i.PropTypes.number,selectedFilesCount:i.PropTypes.number,onMouseEnter:i.PropTypes.func,onMouseDown:i.PropTypes.func,onMouseUp:i.PropTypes.func,onDragStart:i.PropTypes.func,onFileDragEnterItem:i.PropTypes.func,setFileUploaderPath:i.PropTypes.func,onToggleRowSelected:i.PropTypes.func,contextFileActionHandlers:i.PropTypes.object,isSharedWithLoaded:i.PropTypes.bool,isStarredLoaded:i.PropTypes.bool,isOverFreeQuota:i.PropTypes.bool,showOverflowActions:i.PropTypes.bool},getDefaultProps:function(){return{columnClasses:"browse-file-row__column o-grid__col o-grid__col--am",isSearchMode:!1,isSelected:!1,isTabbable:!1,enableDoubleClickTraversal:!0,isDraggingInternalFiles:!1,isDraggingExternalFiles:!1,isAvailableDropTarget:!1,isActiveDropTarget:!1,isArchiveState:!1,isTextSelectable:!0,renameState:null,isMultiColumnGroupVisible:!0,isModifiedColumnVisible:!0,isUnityLoaded:!1,showColumnDetail:!1,showFilenameHighlights:!1,maestroListViewFullRowSelect:!1,inSelectMode:!1,disableCheckbox:!1,onFileDragEnterItem:function(){},setFileUploaderPath:function(){},showOverflowActions:!0,onMouseEnter:null,onMouseDown:null,onMouseUp:null,onToggleRowSelected:null,onFocus:null,onDragStart:function(){},isHovered:!1}},getInitialState:function(){return{hasThumbErrored:!1,wasSelectedBeforeMostRecentMouseDown:!1,shouldShowSettingsBubble:!1,isHovered:!1}},componentWillMount:function(){return te.start(this.constructor.displayName)},componentDidMount:function(){return this._isMounted=!0,te.end(this.constructor.displayName),e(n.findDOMNode(this)).on("dragenter.fileRow",(function(e){return function(){return e.props.onFileDragEnterItem()}})(this)).on("focusin.fileRow",(function(e){return function(t){var o;if(!e.state.focusedIn)return e.setState({focusedIn:!0}),"function"==typeof(o=e.props).onFocus?o.onFocus(t):void 0}})(this)).on("focusout.fileRow",(function(e){return function(){return e.setState({focusedIn:!1})}})(this)).on("mouseup.fileRow",this.handleMouseUp)},componentWillReceiveProps:function(e){if(this.props.isSelected&&!e.isSelected)return this.setState({wasSelectedBeforeMostRecentMouseDown:!1,shouldShowSettingsBubble:!1})},shouldComponentUpdate:fe,componentWillUnmount:function(){return e(n.findDOMNode(this)).off(".fileRow"),this._isMounted=!1},_setTabIndices:function(){var e,t,o,r,s;for(t=I.getFocusableElementsIn(n.findDOMNode(this),!1),s=[],o=0,r=t.length;o<r;o++)e=t[o],"selection_checkbox"===e.className?s.push(e.tabIndex=-1):this.props.isTabbable?s.push(e.tabIndex=0):s.push(e.tabIndex=-1);return s},handleMouseEnter:function(e){return this.props.isDraggingInternalFiles||this.props.isDraggingExternalFiles?void le.setDropTarget({target:this.props.file}):(this.setState({isHovered:!0}),
this.props.onMouseEnter(e))},handleMouseLeave:function(){return this.props.isDraggingInternalFiles||this.props.isDraggingExternalFiles?void le.setDropTarget({target:null}):this.setState({isHovered:!1})},handleMouseDown:function(e){return this.setState({wasSelectedBeforeMostRecentMouseDown:this.props.isSelected}),this.props.onMouseDown(e)},handleMouseUp:function(e){if(!this.props.maestroListViewFullRowSelect||!this.props.inSelectMode)return this.handleSettingsGearMenuMouseUp(e),this.props.onMouseUp(e)},handleSettingsGearMenuMouseUp:function(t){if(null!=this.props.settingsGearMenuItems){if(this.state.shouldShowSettingsBubble)return this.setState({shouldShowSettingsBubble:!1});if(e.contains(n.findDOMNode(this.refs.settings),t.target))return this.setState({shouldShowSettingsBubble:!0})}},handleFilenameClick:function(e){if(!this.props.isTextSelectable)return this.props.maestroListViewFullRowSelect&&this.props.inSelectMode?(e.preventDefault(),void this.toggleSelected(e)):this._openFile(e)},_openFile:function(e){return p.doOpenFile({event:e,user:this.props.user,file:this.props.file,isSearchMode:this.props.isSearchMode,constructorDisplayName:this.constructor.displayName,onFileViewerUnmount:this._onViewerUnmount,source:"list_browse"})},_onViewerUnmount:function(){var e;if(this._isMounted)return null!=(e=n.findDOMNode(this))?e.focus():void 0},handleDoubleClick:function(e){if(this.props.enableDoubleClickTraversal)return this.handleFilenameClick(e)},handleRenameSubmit:function(e){return le.renameFile({file:this.props.file,newName:e})},handleRenameCancel:function(){return le.cancelFileRename({file:this.props.file})},handleDragStart:function(e){return this.props.isSelected?this.props.onDragStart(e):(this.toggleSelected(e),this.props.onDragStart(e,[this.props.file]))},toggleSelected:function(e){return e.stopPropagation(),this.props.onToggleRowSelected(e)},handleCheckboxKeyPress:function(e){var t;if(t=e.which||e.keyCode,t===Y.SPACE)return e.stopPropagation(),this.toggleSelected(e)},_renderSelectionToggleColumn:function(){var e;if(!this.props.disableCheckbox)return e=q.Unchecked,this.props.isSelected&&(e=q.Checked),ue.div({className:r({"file-select-checkbox":!0,"show-boxes":this.props.inSelectMode}),key:"selection_toggle_column",role:"gridcell",onDoubleClick:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},onMouseDown:(function(e){return function(t){return t.stopPropagation(),e.props.onMouseDown(t),ie.sendEvent(e.constructor.displayName,"CheckboxToggled")}})(this),onMouseUp:(function(e){return function(t){return t.stopPropagation(),e.props.onMouseUp(t)}})(this),onKeyPress:this.handleCheckboxKeyPress},0===this.props.rowIndex?de(ne,{containerName:this.constructor.displayName,name:"FirstFileSelectCheckbox",useSpan:!0},de(V,{ariaLabel:ae("Select row"),checkboxState:e,onMouseDown:function(e){return e.target.blur()}})):de(V,{ariaLabel:ae("Select row"),checkboxState:e,onMouseDown:function(e){return e.target.blur()}}))},_renderPlaceholder:function(){return ue.span({"aria-hidden":"true"},"--")},_renderScreenReaderExtraInfo:function(){var e,t;if(e=[],this.props.file.isDeleted&&e.push(ae("Deleted")),this.props.isSelected&&e.push(ae("Selected")),this.props.file.is_dir&&(this.props.file.type===K.SHARED_FOLDER?W.isReadOnlySharedFolder(this.props.file)?e.push(ae("Read-only shared folder")):e.push(ae("Shared folder")):this.props.file.type===K.TEAM_SHARED_FOLDER?W.isReadOnlySharedFolder(this.props.file)?e.push(ae("Read-only team shared folder")):e.push(ae("Team shared folder")):e.push(ae("Folder"))),e.length>0)return t=" "+e.join(" "),ue.span({className:"ax-visually-hidden"},t)},_renderFilename:function(){var e,t,o,s,i,n,a,c,d,u,p,h;return t=this.props.file,o=l.filename(t.fq_path),s=this.props.showFilenameHighlights?T.highlightMatchReact(o,t.filename_highlights):ue.span({},o),c=l.parent_dir(t.fq_path),d=ce(this.props.user,c),p="/"===c?pe(this.props.user):c.slice(1),this.props.renameState===oe.PENDING_INPUT?(a=ae(t.is_dir?"Rename directory…":"Rename file…"),de(Z,{ref:"nameInput",label:a,defaultValue:l.filename(t.fq_path),onSubmit:this.handleRenameSubmit,onCancel:this.handleRenameCancel,className:"browse-file-row__input"})):this.props.renameState===oe.SAVING_INPUT?ue.span({ref:"renameStatus",role:"status"},ae("Renaming…")):(n=null,t.is_unmounted||((null!=(h=this.props.context)?h.isNonUserRelativeContext:void 0)?n=b.getBasePrefix(this.props.user.id)+"/home"+t.fq_path:t.is_unmounted||(n=t.href)),i=W.isNoAccessSharedFolder(t),a=ue.a({ref:"filenameLabel",className:r("filename-link u-ellip",{"browse-file-row__name":!i,"browse-file-row__name--no-access":i},this.props.isArchiveState?"browse-file-row__name-archived":void 0),href:n,onContextMenuCapture:(function(e){return function(){return e._handleContextMenuCapture("filename")}})(this),onClick:this.handleFilenameClick},s,this._renderScreenReaderExtraInfo()),!he()||!this.props.isStarredLoaded||this.props.maestroListViewFullRowSelect&&this.props.inSelectMode||(e=k("modules/clean/react/starred/browse_exports").Star,a=ue.span({className:"browse-file-row__name-with-star"},a,de(e,{id:this.props.file.file_id,idType:J.ENCODED_FILE_OBJ_ID,role:this.props.user.role,ref:"Star"}))),ue.div({className:"browse-file-row__name-location"},0===this.props.rowIndex?de(ne,{containerName:this.constructor.displayName,name:"FirstFileNameLabel",useSpan:!0},a):a,this.props.showColumnDetail?ue.div({className:r({"u-ellip":!0,"browse-file-row__location":!0,"u-font-meta":!0})},t.is_unmounted?ae("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:p}):(u=ae("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:p}),this.props.maestroListViewFullRowSelect&&this.props.inSelectMode?u:ue.a({href:d,className:"browse-file-row-location-link",onClick:(function(e){return function(t){return e._handleLoadFileLocation(t,c)}})(this),onContextMenuCapture:(function(e){return function(){return e._handleContextMenuCapture("location")}})(this)},u))):void 0))},_handleContextMenuCapture:function(e){if(this.props.isSearchMode)return T.logSearchAction(this.props.file,this.props.user,e+"_context_menu")},_handleLoadFileLocation:function(e,t){return e.stopPropagation(),this.props.isSearchMode&&T.logSearchAction(this.props.file,this.props.user,"click_path_link"),le.setUrl({path:t}),e.preventDefault()},_renderFilenameColumn:function(){var e,t,o;return t=de(z,{className:"browse-file-row__accessory",ref:"icon",file:this.props.file,onClick:this.handleFilenameClick,onMouseDown:(function(e){return function(t){if(e.props.file.is_dir)return t.stopPropagation()}})(this)}),W.isTeamMemberFolder(this.props.file)&&(t=de(ne,{containerName:this.constructor.displayName,name:"TMFIcon",useSpan:!0},t)),o=this._renderFilename(),e=this.props.isMultiColumnGroupVisible?6:8,ue.div({ref:"filenameColumn",className:r(""+this.props.columnClasses,"column--filename","o-grid__col--"+e+"-of-12"),key:"filename_column",role:"rowheader"},de(x.FlagWithoutCss,{leftAttachment:t},o))},_renderModifiedColumn:function(){var e,t;return e=this.props.file.last_modified_fname||"",t=this.props.file.ago||this._renderPlaceholder(),ue.div({className:r(this.props.columnClasses,"u-ellip o-grid__col--3-of-12 column--modified"),key:"modified_column",role:"gridcell"},ue.span({className:"browse-file-row__modified-time"},t),e.length?ue.span({className:"browse-file-row__modifier u-font-meta"},"by "+e):void 0)},_renderMultiColumnGroup:function(){var e,t,o;return t=(function(e){return function(t,o){return ue.div({className:"column--multi "+e.props.columnClasses+" column--"+t+" o-grid__col--3-of-12",role:"gridcell",key:t,ref:t},o)}})(this),o=[],!this.props.isSharedWithLoaded||this._isTeamSharedFolderInArchivedMode()||this.props.isArchiveState?o.push(t("sharedwith",null)):(e=k("modules/clean/react/browse/shared_with").SharedWithController,o.push(t("sharedwith",de(e,{file:this.props.file,browseContext:this.props.context,tabIndex:this.props.isTabbable?0:-1,isMaestroDesign:!0,inSelectMode:this.props.maestroListViewFullRowSelect&&this.props.inSelectMode,actionHandlers:this.props.contextFileActionHandlers})))),o.push(t("type",W.getCategoryDescription(this.props.file)),t("extension",W.getExtension(this.props.file)||this._renderPlaceholder()),t("size",this.props.file.size||this._renderPlaceholder())),o},_isTeamSharedFolderArchived:function(){return this.props.file.type===K.TEAM_SHARED_FOLDER&&"archived"===this.props.file.team_folder_status},_isTeamSharedFolderArchivedInProgress:function(){return this.props.file.type===K.TEAM_SHARED_FOLDER&&"archive_in_progress"===this.props.file.team_folder_status},_isTeamSharedFolderInArchivedMode:function(){return this._isTeamSharedFolderArchived()||this._isTeamSharedFolderArchivedInProgress()},_renderActionsColumn:function(){var e,o,s,i,n,a,l,c;if(e=[],this.props.maestroListViewFullRowSelect&&this.props.inSelectMode)l=de(G,{key:"view-file-button",className:"file-list-view-file-button",variant:this.state.isHovered?"secondary":"invisible","aria-label":ae("Preview File"),onClick:this._openFile}),c=de(U,{content:ae("Preview"),position:U.POSITIONS.TOP},l),e.push(c);else{if(i=!0,this.props.selectedFilesCount>0&&(i=!1,this.props.isSelected&&1===this.props.selectedFilesCount&&(i=!0)),!i)return;n=this.props.showOverflowActions,s=this.props.isSearchMode,a=me(this.props.user,this.props.file,this.props.context,this.props.isArchiveState,this._isTeamSharedFolderInArchivedMode()),a&&e.push(de(se,{ref:"shareButton",key:"share_button_column",browseContext:this.props.context,file:this.props.file,user:this.props.user,actionHandlers:this.props.contextFileActionHandlers,isSearchMode:s})),n&&(o=p.getActionsForFileCollection({files:t.Set([this.props.file]),context:this.props.context,user:this.props.user,actionHandlers:this.props.contextFileActionHandlers,isUnityLoaded:this.props.isUnityLoaded,isOverFreeQuota:this.props.isOverFreeQuota,skipSharing:!1,isSearchMode:s}),e.push(de(H,{ref:"overflow_menu",key:"overflow_menu_column",file:this.props.file,actionItems:o,showBorders:this.state.isHovered})))}return ue.div({className:r(this.props.columnClasses,"sharing__actions",{"sharing__actions--overflow-menu":n}),key:"actions_column",role:"gridcell"},e)},_getMenuItemsForFile:function(e,t){var o,r,s,i,n,a,l;for(l=[],s=0,n=t.length;s<n;s++)a=t[s],i=a[0],o=!0,2===a.length&&(r=a[1],r(e)||(o=!1)),o&&l.push(i);return l},_renderSettingsGearColumn:function(){var e;return e=this._getMenuItemsForFile(this.props.file,this.props.settingsGearMenuItems),ue.div({className:"settings-gear-button",key:"settings_gear_column",role:"gridcell"},de(re,{ref:"settings",alt:this.props.settingsGearMenuAlt,isShowing:this.state.shouldShowSettingsBubble,menuItems:e,browseContext:this.props.context,file:this.props.file,isActionDisabled:Q.hasContentManagerActionsDisabled(this.props.user.id)}))},_renderEmptyColumns:function(){return ue.div({className:r(""+this.props.columnClasses,"u-ellip","o-grid__col--3-of-12"),role:"gridcell",key:"empty_column"})},_renderFileRow:function(e){var t;return ue.li(e,this._renderSelectionToggleColumn(),this._renderFilenameColumn(),this.props.isArchiveState?this._renderEmptyColumns():this.props.isModifiedColumnVisible?this._renderModifiedColumn():void 0,this.props.isMultiColumnGroupVisible?function(){var e,o,r,s;for(r=this._renderMultiColumnGroup(),s=[],e=0,o=r.length;e<o;e++)t=r[e],s.push(t);return s}.call(this):void 0,null!=this.props.settingsGearMenuItems?this._renderSettingsGearColumn():this._renderActionsColumn())},render:function(){var e,t,o;return e={"browse-file-row":!0,"browse-file-row--focused-in":this.state.focusedIn,"browse-file-row--is-selected":this.props.isSelected,"browse-file-row--is-archived":this.props.isArchiveState,"browse-file-row--is-deleted":this.props.file.isDeleted,"browse-file-row--is-drop-target":this.props.isAvailableDropTarget,"browse-file-row--file-dragged-over":this.props.isAvailableDropTarget&&this.props.isActiveDropTarget,"o-grid":!0,"o-grid--no-gutter":!0},o={className:r(e),"data-filename":this.props.file.fq_path.split("/").slice(-1),role:"row",tabIndex:this.props.isTabbable?0:-1,draggable:this.props.isSelected&&this.state.wasSelectedBeforeMostRecentMouseDown&&!((t=this.props.renameState)===oe.PENDING_INPUT||t===oe.SAVING_INPUT),onBlur:(function(e){return function(){return e.setState({focusedIn:!1})}})(this),onMouseEnter:this.handleMouseEnter,onMouseDown:(function(e){return function(e){return e.stopPropagation()}})(this),onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseLeave,onClick:this.handleFilenameClick,onDoubleClick:this.handleDoubleClick,onDragStart:this.handleDragStart},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||null==this.props.topOffsetPx||(o.style={position:"absolute",top:this.props.topOffsetPx},o["aria-posinset"]=this.props.rowIndex+1,o["aria-setsize"]=this.props.totalRowCount),this._renderFileRow(o)}}),$=i.createClass({displayName:"PaperItemRow",propTypes:{paper:i.PropTypes.instanceOf(X).isRequired,user:i.PropTypes.object,topOffsetPx:i.PropTypes.number,columnClasses:i.PropTypes.string,rowIndex:i.PropTypes.number,showTitleHighlights:i.PropTypes.bool,totalRowCount:i.PropTypes.number,isSearchMode:i.PropTypes.bool,onMouseEnter:i.PropTypes.func,onMouseDown:i.PropTypes.func,onMouseUp:i.PropTypes.func},getDefaultProps:function(){return{columnClasses:"browse-file-row__column o-grid__col o-grid__col--am",showTitleHighlights:!1,isSearchMode:!1,onMouseEnter:null,onMouseDown:null,onMouseUp:null}},componentWillMount:function(){return te.start(this.constructor.displayName)},componentDidMount:function(){return te.end(this.constructor.displayName)},render:function(){var e,t,o,s,i,n;return o=de(ee,{}),i=this.props.paper.title,n=this.props.showTitleHighlights?T.highlightMatchReact(i,this.props.paper.title_highlights):ue.span({},i),P({scheme:"https",authority:"www.dropbox.com",path:"/paper"}),e=ue.div({className:"browse-file-row__name-location"},ue.a({className:"filename-link u-ellip browse-file-row__name",href:this.props.paper.url,onContextMenuCapture:(function(e){return function(){if(e.props.isSearchMode)return T.logPaperSearchAction(e.props.paper,e.props.user,"paper_context_menu")}})(this),onClick:(function(e){return function(t){if(e.props.isSearchMode)return T.logPaperSearchAction(e.props.paper,e.props.user,"paper_open")}})(this)},n),ue.div({className:"u-ellip browse-file-row__location"},ae("in Paper",{comment:"The Dropbox Paper page"}))),t=this.props.paper.last_modified_date?ae("Modified %(date)s").format({date:this.props.paper.last_modified_date}):"",s={className:r("browse-file-row","o-grid","o-grid--no-gutter"),"data-filename":this.props.paper.title,role:"row",tabIndex:"-1"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||null==this.props.topOffsetPx||(s.style={position:"absolute",top:this.props.topOffsetPx},s["aria-setsize"]=this.props.totalRowCount,s["aria-posinset"]=this.props.rowIndex+1),ue.li(s,ue.div({className:r(""+this.props.columnClasses,"column--filename","o-grid__col--8-of-12"),role:"rowheader"},de(x.FlagWithoutCss,{leftAttachment:o},e)),ue.div({className:r(""+this.props.columnClasses,"u-ellip","o-grid__col--3-of-12"),role:"gridcell"},t,ue.span({className:"browse-file-row__modifier u-font-meta"},this.props.paper.creator_name)))}}),{FileItemRow:j,PaperItemRow:$}})}.call(this),define("modules/clean/react/browse/keyboard_shortcuts",["require","exports","jquery","external/keymaster","external/react","external/react-dom","modules/clean/keycode","modules/clean/react/browse/actions","modules/clean/react/browse/file_jump","modules/clean/react/browse/keyboard_shortcuts_modal","modules/clean/react/modal","modules/clean/undo","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m){"use strict";function f(e){r.clearScope(e),r.setScope(E)}function _(e,t){return function(o){e(o)&&(o.preventDefault(),"function"==typeof t&&t(o))}}function g(e){return function(t){return!document.activeElement||document.activeElement===document.body||i.findDOMNode(e).contains(t.target)}}function w(e){var t=function(t){r.getScope()===e&&l.handleKeyPress(t)},s=function(e){var t=e.which?e.keyCode:void 0;t&&[n.KeyCode.CONTROL,n.KeyCode.ALT].includes(t)&&a.browseActions.setCopyMode({copyMode:!0})},i=function(e){var t=e.which?e.keyCode:void 0;t&&[n.KeyCode.CONTROL,n.KeyCode.ALT].includes(t)&&a.browseActions.setCopyMode({copyMode:!1})};o(document).on("keydown."+e,s).on("keypress."+e,t).on("keyup."+e,i)}function S(e){o(document).off("."+e)}function b(e){f(e),S(e)}function y(e,t,i,n,l,f,g,S,b){w(b),E=r.getScope(),E!==b&&r.setScope(b);var y=function(){if(1===i().size)if(l()){var e=i().first();e.isDeleted?m.error(h._("Deleted files can’t be renamed.")):a.browseActions.showFileRename({file:e})}else m.warning(h._("You don’t have permission to rename files in this folder."))},v=function(){return a.browseActions.copySelectedFilesToClipboard()},C=function(){return a.browseActions.pasteClipboardFilesToCurrentPath()},I=function(){u.performUndo()},N=function(){var e=s.createElement(c.KeyboardShortcutsModal,{shortcuts:n?F:T});d.Modal.showInstance(e)},D=function(){return o(".search-bar__text-input").focus()};r("f2",b,_(t,y)),r("/",b,_(e,D)),r("shift+/",b,_(e,N)),r("escape",b,_(e,g)),p.mac?(r("command+a",b,_(e,f)),r("command+c",b,_(t,v)),r("backspace",b,_(t,S)),r("command+v",b,_(e,C)),r("command+z",b,_(e,I))):(r("ctrl+a",b,_(e,f)),r("ctrl+c",b,_(t,v)),r("delete",b,_(t,S)),r("ctrl+v",b,_(e,C)),r("ctrl+z",b,_(e,I)))}function v(e,t,s,i,n,l,c,d,u,p,h){y(e,t,s,!0,n,c,d,u,h);var m=function(){1===s().size&&a.browseActions.navigateToFileOrFolder({file:s().first(),onFileViewerUnmount:i})},f=function(){1===s().size&&s().first().is_dir&&a.browseActions.navigateToFileOrFolder({file:s().first()})},g=function(){return a.browseActions.navigateToParentFolder()},w=function(e){if("function"==typeof p&&s().size){var t=o(e.target).closest(".browse-file-row--is-selected").first();if(t.length){p(t[0].offsetLeft+200,t[0].offsetTop+5,t.get(0))}}else p(10,10)};r("enter",h,_(t,m)),r("right",h,_(t,f)),r("left",h,_(e,g)),l()&&r("alt+a",h,_(e,w))}Object.defineProperty(t,"__esModule",{value:!0});var T=[{windowsKey:"Enter",macKey:"return",desc:h._("Open file or folder")},{key:"/",desc:h._("Search")},{windowsKey:"Ctrl + a",macKey:"⌘ + a",desc:h._("Select all files")},{windowsKey:"Esc",macKey:"esc",desc:h._("Deselect all files")},{windowsKey:"Ctrl + c",macKey:"⌘ + c",desc:h._("Copy selected file(s)")},{windowsKey:"Ctrl + v",macKey:"⌘ + v",desc:h._("Paste selected file(s) into the current folder")},{key:"F2",desc:h._("Rename selected file")},{windowsKey:"Delete",macKey:"delete",desc:h._("Delete selected file(s)")},{windowsKey:"Ctrl + z",macKey:"⌘ + z",desc:h._("Undo recent move/copy/rename/delete")},{key:"?",desc:h._("Show keyboard shortcuts")}],F=[{key:"↑",desc:h._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:h._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:h._("Go up a folder")},{key:"→",desc:h._("Open folder")}].concat(T),E="";t.generateGetIsGlobalEvent=g,t.setupFileJumpKeyboardShortcuts=w,t.unsetFileJumpKeyboardShortcuts=S,t.resetBrowseKeyboardShortcuts=b,t.setupGeneralBrowseKeyboardShortcuts=y,t.setupItemListKeyboardShortcuts=v}),define("modules/clean/react/browse/keyboard_shortcuts_modal",["require","exports","tslib","jquery","external/react","external/react-dom","modules/clean/keycode","modules/clean/react/flag","modules/clean/react/modal","modules/core/browser","modules/core/i18n"],function(e,t,o,r,s,i,n,a,l,c,d){"use strict";function u(e){return!!e.key}function p(e){return s.createElement("li",{className:"keyboard-shortcuts__item u-mar-bottom-xs"},s.createElement(a.Flag,{leftAttachment:s.createElement("span",{className:"keyboard-shortcuts__key"},u(e)?e.key:c.mac?e.macKey:e.windowsKey),alignment:"top"},s.createElement("span",{className:"keyboard-shortcuts__desc"},e.desc)))}Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleQuestionMarkKeyDown=function(e){e.shiftKey&&e.which===n.KeyCode.FORWARD_SLASH&&(e.stopPropagation(),t.shortcutsModal.close())},t.setModalRef=function(e){t.shortcutsModal=e},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){r(i.findDOMNode(this.shortcutsModal.refs.modal)).on("keydown",this.handleQuestionMarkKeyDown)},t.prototype.componentWillUnmount=function(){r(i.findDOMNode(this.shortcutsModal.refs.modal)).off("keydown",this.handleQuestionMarkKeyDown)},t.prototype.render=function(){return s.createElement(l.Modal,{ref:this.setModalRef,acceptButtonText:"",className:"keyboard-shortcuts",title:d._("Dropbox keyboard shortcuts"),width:750},s.createElement("ul",{className:"keyboard-shortcuts__pane u-unlist u-trim-padding"},this.props.shortcuts.map(p)))},t})(s.Component);t.KeyboardShortcutsModal=h}),define("modules/clean/react/browse/name_input",["require","exports","tslib","external/classnames","external/react","external/react-dom","modules/clean/keycode","modules/core/i18n","modules/core/notify"],function(e,t,o,r,s,i,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){},d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDragStart=function(e){e.stopPropagation()},t.handleSubmit=function(e){e.preventDefault(),t.submitIfChanged()},t.handleKeyDown=function(e){e.keyCode===n.KeyCode.ESC&&(e.preventDefault(),t.props.onCancel())},t.handleBlur=function(e){t.submitIfChanged()},t.handleClick=function(e){t.props.onClick(e)},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=i.findDOMNode(this.refs.input);e.focus(),window.requestAnimationFrame(function(){var t=e.value,o=t.lastIndexOf(".");o===-1&&(o=t.length),e.setSelectionRange(0,o)})},t.prototype.submitIfChanged=function(){var e=i.findDOMNode(this.refs.input).value.trim();e===this.props.defaultValue?(this.props.label===a._("Folder name")&&l.error(a._("Please provide a name for the new folder.")),this.props.onCancel()):this.props.onSubmit(e)},t.prototype.render=function(){return s.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},s.createElement("input",{ref:"input",defaultValue:this.props.defaultValue,className:r("c-input",this.props.className),onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},t})(s.PureComponent);d.defaultProps={className:"",onCancel:c,onClick:c,onSubmit:c},t.NameInput=d}),define("modules/clean/react/browse/nav_actions",["require","exports","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/dispatcher","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/selectable_list","modules/clean/sharing/gating_util","modules/clean/web_timing_logger","modules/core/browser","modules/core/uri"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e){this.dataApi=e}return e.prototype.setUrlPrefix=function(e){var t=e.prefix;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_URL_PREFIX,data:{prefix:t}})},e.prototype.setUrl=function(e){var t=e.path,r=(e.qargs,{});"1"===o.deconstruct_url().qargs.d&&(r.d="1");var s=t?h.encode_parts(t):"";o.push_state(l.browseStore.urlPrefix()+s,r),n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_SELECTION,data:{selection:c.createSelection()}})},e.prototype.setLoadingState=function(e){var t=e.loadingState,o=e.path;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_LOADING_STATE,data:{loadingState:t,path:o}})},e.prototype.setMountPoints=function(e){var t=e.mountPoints;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_MOUNT_POINTS,data:{mountPoints:t}})},e.prototype.setTeamFolders=function(e){var t=e.teamFolders;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_TEAM_FOLDERS,data:{teamFolders:t}})},e.prototype.setPath=function(e){var t=this,o=e.path,s=e.onPathLoaded,c=e.nsId,h=e.logFetchedDataRequiredForTTI,m=void 0!==h&&h;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.SET_PATH,data:{path:o}}),this.setLoadingState({loadingState:i.LoadingStates.LOADING_FIRST_PAGE,path:o});var f=l.browseStore.user(),_=f.id,g=function(e){var n=e.path,c=e.data;m&&u.log_js_modules_fetched_data_required_for_tti(),t.setMountPoints({mountPoints:c.ns_id_to_mount_point}),t.setTeamFolders({teamFolders:c.team_folders_js_info});var p=a.BrowseContext.fromServerObject(c);if(c.paginated){t.setLoadingState({loadingState:i.LoadingStates.LOADING_REMAINING_PAGES,path:o}),t.load({path:n,files:[],context:p});var h=l.browseStore.context().isNonUserRelativeContext,g=h&&!f.is_cdm_member&&!d.GoldenGate.hasContentManagerCdm(_),w=l.browseStore.path(),S="/"!==w&&g?w.split("/")[1]:"";r.PaginationManager.create({firstPage:c.first_page,keyName:"sjid",ajaxURL:"/browse_get_next",userID:_,newDataAvailableCallback:function(e,r){t.add({path:n,files:r}),e.areAllItemsReady()&&(t.setLoadingState({loadingState:i.LoadingStates.LOADED,path:o}),e.stopAutoFetching())},fqPathPrefix:S}).startAutoFetching()}else{var b=c.file_info;t.load({path:n,files:b,context:p}),t.setLoadingState({loadingState:i.LoadingStates.LOADED,path:o})}s&&s()};this.dataApi.loadPath({path:o,userId:_,sortFoldersFirst:!p.mac,includeDeletedFiles:l.browseStore.shouldShowDeletedFiles(),nsId:c,onSuccess:g,onError:function(){"/"!==o&&t.setPath({path:"/",onPathLoaded:s})}})},e.prototype.load=function(e){var t=e.path,o=e.files,r=e.context;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.LOAD_PATH,data:{path:t,files:o,context:r}})},e.prototype.add=function(e){var t=e.path,o=e.files;n.BrowseDispatcher.dispatch({type:i.BrowseActionTypes.ADD_FILES,data:{path:t,files:o}})},e.prototype.setDataApi=function(e){this.dataApi=e},e})();t.BrowseNavActions=m,t.browseNavActions=new m(s)}),define("modules/clean/react/browse/new_folder_icon",["require","exports","external/react","external/classnames","modules/clean/filepath","modules/clean/react/sprite","modules/clean/static_urls"],function(e,t,o,r,s,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFolderIcon=function(e){var t=e.inTeamFolder,a=s.new_folder_icon(t),l=r("sprite","sprite_web","browse-file-row__accessory",a);return o.createElement(i,{group:"web",name:n.static_url("/static/images/icons/icon_spacer-vflN3BYt2.gif"),className:l,alt:""})}}),define("modules/clean/react/browse/overflow_menu",["require","exports","tslib","external/react","modules/clean/react/browse/actions","external/mcl/overflow_button","external/mcl/popover","modules/core/i18n"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(l=t.OverflowMenuSize||(t.OverflowMenuSize={}));var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopPropagation=function(e){return e.stopPropagation()},t.handleSelection=function(e){e.performAction()},t.handleMenuToggle=function(e){e.isOpen&&t.props.file&&s.browseActions.setContextFile({file:t.props.file})},t}return o.__extends(t,e),t.prototype.renderOverflowButton=function(){return r.createElement(i.OverflowButton,{"aria-label":a._("More actions"),className:"browse-overflow-menu-trigger-button",tagName:"span",size:this.props.size===l.Small?"small":"default",variant:this.props.showBorders?"secondary":"borderless"})},t.prototype.render=function(){var e=this.props,t=e.actionItems,o=e.attachment,s=t.map(function(e){return r.createElement(n.PopoverContentItem,{className:e.className,key:e.label,value:e,disabled:e.disabled},e.label)});return r.createElement("div",{className:"browse-overflow-menu",onClick:this.stopPropagation,onDoubleClick:this.stopPropagation},r.createElement(n.Popover,{onSelection:this.handleSelection,closeOnSelection:!0,onMenuToggle:this.handleMenuToggle},r.createElement(n.PopoverTrigger,{className:"browse-overflow-menu-trigger"},this.renderOverflowButton()),r.createElement(n.PopoverContent,{attachment:o,className:"browse-overflow-menu-content"},s)))},t})(r.PureComponent);c.defaultProps={attachment:"right"},t.BrowseOverflowMenu=c}),define("modules/clean/react/browse/paper_row_icon",["require","exports","external/react","modules/clean/react/sprite"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperRowIcon=function(){return o.createElement(r,{group:"web",name:"paper_white_32",className:"browse-file-row__accessory",alt:""})}}),define("modules/clean/react/browse/pinned_team_folder",["require","exports","tslib","external/classnames","external/mcl/vertically_fixed","modules/clean/react/browse/item_list_row","modules/clean/react/browse/file_list_utils","external/react","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react_logger","modules/constants/python","modules/constants/subgrowth_experiments","modules/core/i18n","modules/clean/react/tooltip","modules/clean/user_education/user_education_client"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(t){var o=e.call(this,"PinnedTeamFolderView",t)||this;return o.displayName="PinnedTeamFolder",o.noop=function(){},o.isSubgrowthPinnedExp=function(){return"ON"===p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||["V1","V2"].indexOf(p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)!==-1},o.renderTeamFolderRow=function(e,t){var r=o.props,s=r.activeDropTarget,l=r.context,c=r.dropTargetHighlightMode,d=r.isDraggingInternalFiles,u=r.isDraggingExternalFiles,p=r.isTextSelectable,h=r.selection,m=r.setFileUploaderPath,_=r.user,g=n.shouldFileBeHighlightedDropTarget({file:e,isSelected:h.selected.has(e.fq_path),dropTargetHighlightMode:c}),w=a.createElement(i.FileItemRow,{selectableListId:e.fq_path,key:encodeURI(e.fq_path),file:e,user:_,context:l,shouldFocus:h.selected.last()===e.fq_path,isDraggingInternalFiles:d,isDraggingExternalFiles:u,isAvailableDropTarget:g,isActiveDropTarget:e===s,isTextSelectable:p,isModifiedColumnVisible:!1,disableCheckbox:!0,setFileUploaderPath:m,onDragStart:o.noop,onMouseEnter:o.noop,onMouseDown:o.noop,onMouseUp:o.noop});return 0===t&&(w=a.createElement(f.UserEducationEffect,{containerName:o.displayName,name:"TeamFolder",key:encodeURI(e.fq_path)},w)),w},o}return o.__extends(t,e),t.prototype.componentDidMount=function(){f.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context)),e.prototype.componentDidMount.call(this)},t.prototype.renderFolderHeader=function(e,t){return a.createElement("div",null,a.createElement("span",{className:"pinned-team-folder__header-text"},e),a.createElement("div",{className:"pinned-team-folder__info-button"},a.createElement(m.Tooltip,{position:m.TooltipPosition.RIGHT,tooltip_contents:a.createElement("div",null,t),tooltip_classname:"pinned-team-folder__tooltip"},a.createElement(c,{group:"web",name:"info",alt:h._("File section information")}))))},t.prototype.renderContent=function(){var e=this.props.teamFolders,t=e.map(this.renderTeamFolderRow),o=h.ungettext("Team folder","Team folders",e.size),s={"pinned-team-folder__file-row":!0,"u-pad-top-xs":!0,"exp-pinned-folders":this.isSubgrowthPinnedExp()},i=this.props.expSubgrowthBizTeamHomeContent?this.renderFolderHeader(o,h._("Team folders are the hub of content for a team and contents are           automatically shared with team folder members. %(trademark_business)s           team admins own and manage team folders.").format({trademark_business:u.TRADEMARK_BUSINESS
})):this.renderFolderHeader(o,h._("Everything in a Team folder is automatically shared with your team.           Team folders can also contain shared folders for collaborating with           people outside your team.")),n=this.props.expSubgrowthBizTeamHomeContent?a.createElement("div",null,a.createElement("span",{className:"pinned-team-folder__header-text"},h._("Everything else"))):this.renderFolderHeader(h._("Other folders"),h._("These folders help you organize your private work files."));return a.createElement("div",null,a.createElement("div",{className:"u-pad-top-xs"},i),a.createElement("div",{className:r(s)},t),a.createElement("div",{className:"u-pad-top-m"},n))},t.prototype.render=function(){return this.isSubgrowthPinnedExp()?this.renderContent():a.createElement("div",{className:"pinned-team-folder__shadow"},a.createElement(s.VerticallyFixed,{className:"pinned-team-folder"},a.createElement("div",{className:"pinned-team-folder__wrapper"},this.renderContent())))},t})(d.ReactLogger);t.PinnedTeamFolder=l(_,["/static/css/scooter/scooter-scoped-vflm9UP03.css","/static/css/browse/browse-vflC_4Pg0.css"])}),define("modules/clean/react/browse/professional_collection_actions",["require","exports","modules/clean/ajax","modules/core/browser","modules/core/notify","modules/core/i18n"],function(e,t,o,r,s,i){"use strict";function n(t){e(["modules/clean/react/professional_collection/add_to_collection_modal_controller"],t)}function a(e,t,n){s.success(i._("Creating collection...")),o.WebRequest({url:"/premium_sharing/create",subject_user:n,data:{ns_id:e,path:t},success:function(e){var t=JSON.parse(e);t.error?s.error(t.error):r.redirect(t.collectionUrl)},error:function(){s.error(i._("Error during the creation of the collection."))}})}function l(e,t){n(function(o){return(0,o.showAddToCollectionModal)(e,t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.createProfessionalCollection=a,t.showAddToCollectionModal=l}),define("modules/clean/react/browse/render_partials",["require","exports","tslib","external/classnames","external/react","modules/clean/static_urls"],function(e,t,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasThumbFailed:!1},t.handleError=function(){var e=t.props.file,o=t.state.hasThumbFailed;e.thumbnail_url_tmpl&&!o&&t.setState({hasThumbFailed:!0})},t}return o.__extends(t,e),t.prototype.render=function(){var e,t,o=this.props,n=o.file,a=o.className,l=o.onClick,c=o.onDragStart,d=o.onMouseDown,u=this.state.hasThumbFailed;return n.thumbnail_url_tmpl&&!u?(t=n.thumbnail_url_tmpl,e=r("browse-file-row__accessory",a)):(e=r("sprite","sprite_web","s_web_"+n.icon,"browse-file-row__accessory",a),t=i.static_url("/static/images/icons/icon_spacer-vflN3BYt2.gif")),s.createElement("img",{className:e,src:t,onClick:l,onDragStart:c,onMouseDown:d,onError:this.handleError,alt:""})},t})(s.PureComponent);t.FileIcon=n}),function(){define("modules/clean/react/browse/settings_gear_menu",["external/react","external/underscore","modules/clean/react/browse/models","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,o,r,s){var i,n,a,l,c,d,u;return i=o.BrowseContext,l=o.File,n=r.BubbleMenu,a=r.BubbleMenuItem,u=e.DOM,d=e.createElement,c=e.createClass({displayName:"settingsGearMenuBubble",propTypes:{alt:e.PropTypes.string.isRequired,browseContext:e.PropTypes.instanceOf(i).isRequired,file:e.PropTypes.instanceOf(l).isRequired,isActionDisabled:e.PropTypes.bool,isShowing:e.PropTypes.bool.isRequired,menuItems:e.PropTypes.arrayOf(e.PropTypes.shape({label:e.PropTypes.string,action:e.PropTypes.func})).isRequired},render:function(){var e,o;return e=u.button({className:"sprite-button bubble-button"},d(s,{group:"web",name:"gear",alt:this.props.alt})),d(n,{position:n.POSITIONS.BOTTOM,targetButton:e,ref:"gearBubbleMenu",items:function(){var e,r,s,i;for(s=this.props.menuItems,i=[],e=0,r=s.length;e<r;e++)o=s[e],i.push(d(a,{onClick:t.partial(o.action,this.props.browseContext,this.props.file),disabled:this.props.isActionDisabled},o.label));return i}.call(this)})}}),{SettingsGearMenuBubble:c}})}.call(this),define("modules/clean/react/browse/share_button",["require","exports","tslib","external/mcl/button","external/react","modules/clean/search/search_helpers","modules/clean/sharing/browse_exports","modules/core/i18n"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){var o=t.props,r=o.file,s=o.user,a=o.browseContext;t.props.isSearchMode&&i.logSearchAction(r,s,"share"),n.asyncShowShareModal(s,r,{browseContext:a,origin:"BROWSE_FILE_ROW"}),e.stopPropagation()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.isVisible;return s.createElement(r.Button,{"aria-label":a._("Share"),className:"inline-share-button",onClick:this.handleClick,tabIndex:e?void 0:-1,variant:e?"secondary":"invisible"},a._("Share"))},t})(s.PureComponent);l.defaultProps={isVisible:!0,isSearchMode:!1},t.ShareButton=l}),define("modules/clean/react/browse/sort_helpers",["require","exports"],function(e,t){"use strict";function o(e,t,o){for(var r="=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<Math.max(e.length,t.length);s++){var i=e.charAt(s),n=t.charAt(s);if(!i)return-o;if(!n)return o;var a=r.indexOf(i),l=r.indexOf(n);if(a<l)return-o;if(l<a)return o}return 0}function r(e,t,r){if(Array.isArray(e)&&Array.isArray(t)){for(var s=0;s<Math.max(e.length,t.length);s++){var i=e[s],n=t[s];if(null==i)return-r;if(null==n)return r;if("number"==typeof i&&"string"==typeof n)return-r;if("number"==typeof n&&"string"==typeof i)return r;if("string"==typeof i&&"string"==typeof n){var a=o(i,n,r);if(0!==a)return a}else{if(i<n)return-r;if(n<i)return r}}return 0}return e===t?0:e<t?-r:r}Object.defineProperty(t,"__esModule",{value:!0}),t.compare=r}),define("modules/clean/react/browse/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/columnheader","modules/clean/react/selectable_list","modules/constants/subgrowth_experiments","modules/core/browser","modules/core/exception","modules/constants/browse"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype._init=function(){this._unsortedFiles=r.Map(),this._sortedFiles=r.List(),this._teamFolders=r.List(),this._path="",this._user=null,this._urlPrefix="",this._selection=d.createSelection(),this._loadingState=n.LoadingStates.LOADING_FIRST_PAGE,this._context=new a.BrowseContext,this._mountPoints=null,this._shouldShowDeletedFiles=!1,this._activeDropTarget=null,this._inCopyMode=!1,this._clipboardFiles=r.OrderedMap(),this._currentSort={sortField:n.BrowseSortFields.FILENAME,sortDirection:c.SortDirections.ASCENDING},this._fileRename=null,this._newFolderCreationState=n.NewFolderCreationStates.CREATE_FOLDER_INACTIVE,this._filePathsToSelectOnNextUpdate=r.Set(),this._activeFileJumpFilter="",this._fileJumpIndex=[],this._activeTab=void 0,this._contextFile=null,this._folderSizes={}},t.prototype.isPathEqualsTo=function(e){return!(e&&"/"!==e||this._path&&"/"!==this._path)||e===this._path},t.prototype.contextFile=function(){return this._contextFile},t.prototype.files=function(){if(m.BROWSE_GET_FOLDER_SIZES&&!this.isFolderSizesEmpty()&&this._currentSort.sortField===n.BrowseSortFields.SIZE){var e=this.listWithFolderSizes(this._sortedFiles);return this._currentSort.sortDirection===c.SortDirections.ASCENDING?e.sort(function(e,t){return e.bytes-t.bytes}):e.sort(function(e,t){return t.bytes-e.bytes}),e}return this._sortedFiles},t.prototype.filesMap=function(){return m.BROWSE_GET_FOLDER_SIZES&&!this.isFolderSizesEmpty()?this.filesMapWithFolderSizes():this._unsortedFiles},t.prototype.filesWithoutTeamFolders=function(){return m.BROWSE_GET_FOLDER_SIZES&&!this.isFolderSizesEmpty()?this.listWithFolderSizes(this._sortedFiles).filter(function(e){return e.type!==n.FileTypes.TEAM_SHARED_FOLDER}):this._sortedFiles.filter(function(e){return e.type!==n.FileTypes.TEAM_SHARED_FOLDER})},t.prototype.teamFolders=function(){return"ON"===u.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||["V1","V2"].includes(u.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)?this._sortedFiles.filter(function(e){return e.type===n.FileTypes.TEAM_SHARED_FOLDER}):(m.BROWSE_GET_FOLDER_SIZES&&!this.isFolderSizesEmpty()&&this.listWithFolderSizes(this._teamFolders),this._teamFolders)},t.prototype.path=function(){return this._path},t.prototype.user=function(){return this._user},t.prototype.urlPrefix=function(){return this._urlPrefix},t.prototype.selection=function(){return this._selection},t.prototype.selectedFiles=function(){var e=this,t=this._sortedFiles.filter(function(t){return e._selection.selected.has(t.fq_path)});return r.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype.activeTab=function(){return this._activeTab},t.prototype.loadingState=function(){return this._loadingState},t.prototype.context=function(){return this._context},t.prototype.mountPoints=function(){return this._mountPoints},t.prototype.shouldShowDeletedFiles=function(){return this._shouldShowDeletedFiles},t.prototype.activeDropTarget=function(){return this._activeDropTarget},t.prototype.currentSort=function(){return this._currentSort},t.prototype.getIndexOfFile=function(e){return this._sortedFiles.findIndex(function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id})},t.prototype.getFileByFilename=function(e){return this._sortedFiles.find(function(t){return s.filename(t.fq_path)===e})||null},t.prototype.getFileByFullPath=function(e){return this._sortedFiles.find(function(t){return t.fq_path===e})||null},t.prototype.inCopyMode=function(){return this._inCopyMode},t.prototype.clipboardFiles=function(){return this._clipboardFiles},t.prototype.fileRename=function(){return this._fileRename},t.prototype.newFolderCreationState=function(){return this._newFolderCreationState},t.prototype.isFileJumping=function(){return this._activeFileJumpFilter.length>0},t.prototype.initializeEverything=function(e){var t=e.user,o=e.path,s=e.files,i=e.urlPrefix,a=e.context,l=e.mountPoints,c=e.fqPathsToSelect,d=e.loadingState,u=e.shouldShowDeletedFiles,p=e.teamFolders;this._user=t,this._path=o,this._urlPrefix=i,this.appendFiles({path:o,files:s},!1),this._context=a,this._mountPoints=r.Map(l),this._loadingState=d,this.setTeamFolders({teamFolders:p}),d===n.LoadingStates.LOADED?this.selectFqPaths({fqPathsToSelect:c},!1):this._filePathsToSelectOnNextUpdate=r.Set(c),this._shouldShowDeletedFiles=!!u,this.emit_change()},t.prototype.setUser=function(e){var t=e.user;null==this.user()&&(this._user=t)},t.prototype.setPathData=function(e){var t=e.path,o=e.files,r=e.context;s.paths_are_equal(t,this._path)&&(this._unsortedFiles=this._unsortedFiles.clear(),this._sortedFiles=this._sortedFiles.clear(),this._selection=d.createSelection(),this.appendFiles({path:t,files:o},!1),this._context=r,this.emit_change())},t.prototype.appendFiles=function(e,t){var o=e.path,i=e.files;if(void 0===t&&(t=!0),s.paths_are_equal(o,this._path)){for(var n=[],l=[],c=0,d=i;c<d.length;c++){var u=d[c],p=u instanceof a.File?u:a.File.fromServerObject(u);n.push([u.fq_path,p]),this._unsortedFiles.has(u.fq_path)||l.push(p)}this._unsortedFiles=this._unsortedFiles.merge(r.Map(n)),this._sortedFiles=this._sortedFiles.concat(r.List(l)),h.assert(this._unsortedFiles.size===this._sortedFiles.size,"appendFiles ended up with mismatched data structures"),this.sortFiles(this._currentSort,!1),this._filePathsToSelectOnNextUpdate.count()&&this.selectFqPaths({fqPathsToSelect:this._filePathsToSelectOnNextUpdate.toArray()},!1),this.buildFileJumpIndex(),t&&this.emit_change()}},t.prototype.applyFileDeltas=function(e){var t=e.path,o=e.fileDeltas;if(s.paths_are_equal(t,this._path)){for(var i=0,n=o;i<n.length;i++){var a=n[i],l=a.before,c=a.after;this.applyFileDelta({before:l,after:c,pathForDelta:t})}if(this._filePathsToSelectOnNextUpdate.size){this.selectFqPaths({fqPathsToSelect:this._filePathsToSelectOnNextUpdate.toArray()},!1).size===this._filePathsToSelectOnNextUpdate.size&&(this._filePathsToSelectOnNextUpdate=r.Set())}h.assert(this._unsortedFiles.size===this._sortedFiles.size,"applyFileDeltas ended up with mismatched file collections (map vs. sorted list)"),this.sortFiles(this._currentSort,!1),this.buildFileJumpIndex(),this.emit_change()}},t.prototype.setPath=function(e){var t=e.path;this._path=t,this.emit_change()},t.prototype.setUrlPrefix=function(e){var t=e.prefix;this._urlPrefix=t,this.emit_change()},t.prototype.setLoadingState=function(e){var t=e.path,o=e.loadingState;s.paths_are_equal(t,this._path)&&(this._loadingState=o,o===n.LoadingStates.LOADED&&(this._filePathsToSelectOnNextUpdate=r.Set()),this.emit_change())},t.prototype.setMountPoints=function(e){var t=e.mountPoints;this._mountPoints=r.Map(t)},t.prototype.setTeamFolders=function(e){var t=e.teamFolders;this._teamFolders=r.List((t||[]).map(a.File.fromServerObject))},t.prototype.setSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype.selectFqPaths=function(e,t){var o=e.fqPathsToSelect;void 0===t&&(t=!0);var s=o.map(function(e){return e.toLowerCase()}),i=this._sortedFiles.filter(function(e){return s.includes(e.fq_path.toLowerCase())}),n=i.map(function(e){return e.fq_path}),a=this._selection.set("selected",r.OrderedSet(n)),l=n.size?n.get(0):null;return a=a.set("anchor",l),this._selection=a,t&&this.emit_change(),n},t.prototype.setActiveTab=function(e){var t=e.tabName;this._activeTab=t,this.emit_change()},t.prototype.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;this._shouldShowDeletedFiles=!!t,this.emit_change()},t.prototype.setDropTarget=function(e){var t=e.target;this._activeDropTarget=t,this.emit_change()},t.prototype.setCopyMode=function(e){var t=e.copyMode;this._inCopyMode=t,this.emit_change()},t.prototype.sortFiles=function(e,t){function o(e,t){var o=e.value,r=e.isTMF,s=t.value;return i(r,t.isTMF)||l.compare(o,s,h)}function r(e,t){var o=e.isFolder,r=e.value,s=e.isTMF,n=t.isFolder,a=t.value,c=t.isTMF,d=i(s,c);return d?d:o&&n?l.compare(r,a,h):o?-h:n?h:l.compare(r,a,h)}function s(e,t){var o=e.isFolder,r=e.value,s=e.isTMF,n=t.isFolder,a=t.value,c=t.isTMF,d=i(s,c);return d?d:o&&n?l.compare(r,a,h):o?1:n?-1:""===r?1:""===a?-1:l.compare(r,a,h)}function i(e,t){if(f){if(e)return-1;if(t)return 1}return 0}var d=e.sortField,u=e.sortDirection;void 0===t&&(t=!0);var h=u===c.SortDirections.ASCENDING?1:-1,f=!this._context.isNonUserRelativeContext;if(d===n.BrowseSortFields.FILENAME||d===n.BrowseSortFields.SHARED_WITH){var _=p.mac?o:r;this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:e.sort_key,isTMF:a.File.isTeamMemberFolder(e)}},_)}else d===n.BrowseSortFields.MODIFIED?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:e.ts,isTMF:a.File.isTeamMemberFolder(e)}},s):d===n.BrowseSortFields.CATEGORY?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:a.File.getCategoryDescription(e),isTMF:a.File.isTeamMemberFolder(e)}},s):d===n.BrowseSortFields.EXTENSION?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:a.File.getExtension(e),isTMF:a.File.isTeamMemberFolder(e)}},s):d!==n.BrowseSortFields.SIZE||m.BROWSE_GET_FOLDER_SIZES||(this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:-e.bytes,isTMF:a.File.isTeamMemberFolder(e)}},s));this._currentSort={sortField:d,sortDirection:u},t&&this.emit_change()},t.prototype.setClipboardToSelectedFiles=function(){this._clipboardFiles=this.selectedFiles(),this.emit_change()},t.prototype.updateContextFile=function(e){this._contextFile=e,this.emit_change()},t.prototype.updateRenameState=function(e,t){this._fileRename=t?{file:e,state:t}:null,this.emit_change()},t.prototype.setNewFolderCreationState=function(e){this._newFolderCreationState=e,this.emit_change()},t.prototype.setFilePathsToSelectOnNextUpdate=function(e){var t=e.fqPathsToSelect,o=void 0===t?[]:t;this._filePathsToSelectOnNextUpdate=r.Set(o)},t.prototype.addCommentStatusBatch=function(e){var t=this,o=e.commentStatusByFqPath;Object.keys(o).map(function(e){var r=t._unsortedFiles.get(e);if(null!=r){var s=r.merge(o[e]);t.insertOrUpdateFile({file:s,forceUpdate:!0})}}),this.emit_change()},t.prototype.addFileJumpKeyCode=function(e){var t=e.keyChar;this._activeFileJumpFilter+=t.toLowerCase();for(var o=null,r=0,s=this._fileJumpIndex;r<s.length;r++){var i=s[r],n=i.fqPath;if(i.filename>=this._activeFileJumpFilter){o=n;break}}null!=o&&this.selectFqPaths({fqPathsToSelect:[o]})},t.prototype.resetFileJump=function(){this._activeFileJumpFilter=""},t.prototype.buildFileJumpIndex=function(){this._fileJumpIndex=this._unsortedFiles.keySeq().toArray().map(function(e){return{filename:s.filename(e).toLowerCase(),fqPath:e}}),this._fileJumpIndex.sort(function(e,t){var o=e.filename,r=t.filename;return o<r?-1:o>r?1:0})},t.prototype.applyFileDelta=function(e){var t=e.before,o=e.after,r=e.pathForDelta;if(o&&!s.paths_are_equal(s.parent_dir(o.fq_path),r)&&(o=null),o!==t){var i=o&&this._unsortedFiles.get(o.fq_path);if(!(i&&i.sjid>=o.sjid))return o&&t?this.replaceFile({existingFile:t,newFile:o}):o&&!t?this.insertOrUpdateFile({file:o}):t&&!o?this.removeFile({file:t}):void 0}},t.prototype.insertOrUpdateFile=function(e){function t(e){return e.fq_path.toLowerCase()===i}var o=e.file,r=e.forceUpdate,s=void 0!==r&&r;this._unsortedFiles=this._unsortedFiles.set(o.fq_path,o);var i=o.fq_path.toLowerCase(),n=this._sortedFiles.findEntry(t)||[null,null],a=n[0],l=n[1];l?(s||o.sjid>l.sjid)&&(this._sortedFiles=this._sortedFiles.set(a,o)):this._sortedFiles=this._sortedFiles.push(o)},t.prototype.removeFile=function(e){var t=e.file;h.assert(this._unsortedFiles.has(t.fq_path),"trying to remove a file that doesn't exist in the file map");var o=this._sortedFiles.indexOf(t);h.assert(o!==-1,"tried to remove file that doesn't exist in the sorted file list"),this._unsortedFiles=this._unsortedFiles.delete(t.fq_path),this._sortedFiles=this._sortedFiles.delete(o)},t.prototype.replaceFile=function(e){var t=e.existingFile,o=e.newFile;h.assert(this._unsortedFiles.has(t.fq_path),"tried to replace file, but previous file doesn't exist in map");var r=this._sortedFiles.indexOf(t);h.assert(r!==-1,"tried to update file, but previous file doesn't exist in sorted list"),t.fq_path===o.fq_path?(this._sortedFiles=this._sortedFiles.set(r,o),this._unsortedFiles=this._unsortedFiles.set(t.fq_path,o)):(this._sortedFiles=this._sortedFiles.delete(r),this._unsortedFiles=this._unsortedFiles.delete(t.fq_path),this._unsortedFiles=this._unsortedFiles.set(o.fq_path,o),this._sortedFiles=this._sortedFiles.push(o),this._fileRename&&this._fileRename.state===n.RenameStates.SAVING_INPUT&&(this.updateRenameState(t,null),this.selectFqPaths({fqPathsToSelect:[o.fq_path]})))},t.prototype.isFolderSizesEmpty=function(){for(var e in this._folderSizes)if(this._folderSizes.hasOwnProperty(e))return!1;return!0},t.prototype.filesMapWithFolderSizes=function(){var e=this;return this._unsortedFiles.withMutations(function(t){for(var o in e._folderSizes)if(e._folderSizes.hasOwnProperty(o)){var r=e._folderSizes[o],s=e._unsortedFiles.get(o);if(!s)continue;var i=s.updateSize(r);t.set(o,i)}})},t.prototype.listWithFolderSizes=function(e){var t=this;return e.map(function(e){return e&&t._folderSizes.hasOwnProperty(e.fq_path)?e.updateSize(t._folderSizes[e.fq_path]):e})},t.prototype.setFolderSizes=function(e){for(var t=0,o=e;t<o.length;t++){var r=o[t];this._folderSizes[r.fq_path]=r.size}this.emit_change()},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case n.BrowseActionTypes.INITIALIZE_EVERYTHING:this.initializeEverything(t.data);break;case n.BrowseActionTypes.LOAD_PATH:this.setPathData(t.data);break;case n.BrowseActionTypes.ADD_FILES:this.appendFiles(t.data);break;case n.BrowseActionTypes.ADD_FILES_AND_SET_LOADING_STATE:this.appendFiles(t.data,!1),this.setLoadingState(t.data);break;case n.BrowseActionTypes.SET_PATH:this.setPath(t.data);break;case n.BrowseActionTypes.SET_USER:this.setUser(t.data);break;case n.BrowseActionTypes.SET_URL_PREFIX:this.setUrlPrefix(t.data);break;case n.BrowseActionTypes.CHANGE_FILES:this.applyFileDeltas(t.data);break;case n.BrowseActionTypes.SET_ACTIVE_TAB:this.setActiveTab(t.data);break;case n.BrowseActionTypes.SET_SELECTION:this.setSelection(t.data);break;case n.BrowseActionTypes.SELECT_FILES_BY_FQ_PATH:this.selectFqPaths(t.data);break;case n.BrowseActionTypes.SET_LOADING_STATE:this.setLoadingState(t.data);break;case n.BrowseActionTypes.SET_MOUNT_POINTS:this.setMountPoints(t.data);break;case n.BrowseActionTypes.SET_TEAM_FOLDERS:this.setTeamFolders(t.data);break;case n.BrowseActionTypes.SET_SHOULD_SHOW_DELETED_FILES:this.setShouldShowDeletedFiles(t.data);break;case n.BrowseActionTypes.SET_DROP_TARGET:this.setDropTarget(t.data);break;case n.BrowseActionTypes.SET_COPY_MODE:this.setCopyMode(t.data);break;case n.BrowseActionTypes.COPY_SELECTED_FILES_TO_CLIPBOARD:this.setClipboardToSelectedFiles();break;case n.BrowseActionTypes.SORT_FILES:this.sortFiles(t.data);break;case n.BrowseActionTypes.REQUEST_NEW_FILE_NAME:this.updateRenameState(t.data.file,n.RenameStates.PENDING_INPUT);break;case n.BrowseActionTypes.SET_FILE_RENAME_PENDING:this.updateRenameState(t.data.file,n.RenameStates.SAVING_INPUT);break;case n.BrowseActionTypes.SET_FILE_RENAME_COMPLETE:case n.BrowseActionTypes.CANCEL_FILE_RENAME:this.updateRenameState(t.data.file,null);break;case n.BrowseActionTypes.REQUEST_FOLDER_NAME:this.setNewFolderCreationState(n.NewFolderCreationStates.PENDING_INPUT);break;case n.BrowseActionTypes.CREATE_FOLDER_PENDING:this.setNewFolderCreationState(n.NewFolderCreationStates.SAVING_INPUT);break;case n.BrowseActionTypes.CREATE_FOLDER_COMPLETE:case n.BrowseActionTypes.CANCEL_CREATE_FOLDER:this.setNewFolderCreationState(n.NewFolderCreationStates.CREATE_FOLDER_INACTIVE);break;case n.BrowseActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:this.setFilePathsToSelectOnNextUpdate(t.data);break;case n.BrowseActionTypes.ADD_COMMENT_STATUS_BATCH:this.addCommentStatusBatch(t.data);break;case n.BrowseActionTypes.ADD_FILE_JUMP_KEY_CODE:this.addFileJumpKeyCode(t.data);break;case n.BrowseActionTypes.RESET_FILE_JUMP:this.resetFileJump();break;case n.BrowseActionTypes.SET_CONTEXT_FILE:this.updateContextFile(t.data.file);break;case n.BrowseActionTypes.FETCH_FOLDER_SIZES_COMPLETE:this.setFolderSizes(t.data)}},t})(i);t.BrowseStore=f,t.browseStore=new f}),define("modules/clean/react/browse/tile_label_name_input",["require","exports","tslib","external/classnames","external/react","modules/clean/react/browse/name_input"],function(e,t,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,o=e.defaultValue,n=void 0===o?"":o,a=r("tile-label-input",t);return s.createElement(i.NameInput,{className:a,defaultValue:n,label:this.props.label,onSubmit:this.props.handleSubmit,onCancel:this.props.handleCancel,onClick:this.handleClick})},t})(s.PureComponent);t.TileItemLabelInput=n}),define("modules/clean/react/browse/util",["require","exports","modules/clean/react/browse/models","modules/clean/em_string","modules/clean/filepath","modules/core/i18n"],function(e,t,o,r,s,i){"use strict";function n(e){if(1===e.count()){var t=e.first(),o=s.filename(t.fq_path);return r.em_snippet(o,13.5)}if(e.count()>1){var n=function(e){return e.isDeleted},a=e.some(n)&&!e.every(n),l=e.toArray().filter(function(e){return e.is_dir}),c=e.toArray().filter(function(e){return!e.is_dir});if(a)return i._("No available actions");var d=[];if(c.length){var u=i.ungettext("%(num_files)d file","%(num_files)d files",c.length).format({num_files:c.length});d.push(u)}if(l.length){var u=i.ungettext("%(num_folders)d folder","%(num_folders)d folders",l.length).format({num_folders:l.length});d.push(u)}return 2===d.length?i._("%(x)s and %(y)s",{comment:'\n            The whole string is a phrase like "2 files and 3 folders". \'x\' is\n            a string containing a phrase like "2 files" and \'y\' is a string\n            containing a phrase like "3 folders".\n          '}).format({x:d[0],y:d[1]}):d[0]}return""}function a(e,t){var r=e.count(),s=i._("You only have partial access");return r>0?1!==r||o.File.canViewFileMembers(e.first(),t)?i.ungettext("%(count)d item selected","%(count)d items selected",r).format({count:r}):o.File.isNoAccessSharedFolder(e.first())?i._("You don’t have access to this folder"):s:t&&!t.canViewContainingNSMembers?s:""}Object.defineProperty(t,"__esModule",{value:!0});t.describeFiles=n,t.getSelectedFilesText=a}),function(){define("modules/clean/react/columnheader",["jquery","external/classnames","external/react","external/underscore","modules/clean/react/sprite","modules/core/i18n","modules/clean/css","modules/clean/react/css","modules/clean/react_logger"],function(e,t,o,r,s,i,n,a,l){var c,d,u,p,h,m,f,_,g,w,S,b,y;return f=i._,p=l.ReactLogger,y=o.DOM,b=o.createElement,h={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},u={STATIC:"STATIC",SINGLE:"SINGLE",MULTI:"MULTI"},m=o.PropTypes.shape({label:o.PropTypes.string.isRequired,sortField:o.PropTypes.string,headerClassName:o.PropTypes.string,labelClassName:o.PropTypes.string}),d=o.PropTypes.shape({type:o.PropTypes.oneOf([u.STATIC,u.SINGLE,u.MULTI]).isRequired,label:o.PropTypes.string,headerClassName:o.PropTypes.string,labelClassName:o.PropTypes.string,sortField:o.PropTypes.string,content:o.PropTypes.node,columns:o.PropTypes.arrayOf(m)}).isRequired,S=function(e,t){var o,r,s,i;for(s=0,i=t.length;s<i;s++){if(o=t[s],o.sortField===e)return o;if(o.type===u.MULTI&&(r=S(e,o.columns)))return r}return null},c=o.createClass({displayName:"ColumnHeader",propTypes:{columns:o.PropTypes.arrayOf(d).isRequired,className:o.PropTypes.string,css:o.PropTypes.string,tabbable:o.PropTypes.bool,disabled:o.PropTypes.bool,activeSortField:o.PropTypes.string,activeSortDirection:o.PropTypes.oneOf([h.ASCENDING,h.DESCENDING]),initialMultiColumnSortField:o.PropTypes.string,onSortChange:o.PropTypes.func,onMultiColumnChange:o.PropTypes.func},getDefaultProps:function(){return{tabbable:!0,disabled:!1,activeSortField:void 0,activeSortDirection:h.ASCENDING,onSortChange:r.noop,onMultiColumnChange:r.noop}},getInitialState:function(){return{cssLoaded:!1}},componentWillMount:function(){return p.start(this.constructor.displayName),this.props.css?n.require_css(this.props.css,(function(e){return function(){return e.setState({cssLoaded:!0})}})(this)):this.setState({cssLoaded:!0})},componentDidMount:function(){return p.end(this.constructor.displayName)},_didChangeSort:function(e,t){var o,r;return r=e!==this.props.activeSortField,o=t!==this.props.activeSortDirection,r||o},handleSingleColumnClick:function(e){var t,o,r;if(r=e.sortField,t=this.props.activeSortField===e.sortField,o=t?this.props.activeSortDirection===h.ASCENDING?h.DESCENDING:h.ASCENDING:this.props.activeSortDirection,this._didChangeSort(r,o))return this.props.onSortChange(r,o)},handleSubColumnChange:function(e){var t,o;return o=e.sortField,t=h.ASCENDING,this._didChangeSort(o,t)&&this.props.onSortChange(o,t),this.props.onMultiColumnChange(e)},renderStaticColumnHeader:function(e){return b(w,{key:e.label,label:e.label,labelClassName:e.labelClassName||"",className:e.headerClassName||"",content:e.content,role:e.role})},renderSingleColumnHeader:function(e){return b(_,{key:e.label,label:e.label,isActive:this.props.activeSortField===e.sortField,onClick:(function(t){return function(){return t.handleSingleColumnClick(e)}})(this),sortDirection:this.props.activeSortDirection,canTriggerSortDirection:!0,className:e.headerClassName||"",tabbable:this.props.tabbable,disabled:this.props.disabled})},renderMultiColumnHeader:function(e){return b(g,{key:e.columns[0].label,columns:e.columns,activeSortField:this.props.activeSortField,initialSortField:this.props.initialMultiColumnSortField,onSubColumnChange:this.handleSubColumnChange,tabbable:this.props.tabbable,disabled:this.props.disabled})},render:function(){var e,t,o,r,s,i;if(this.state.cssLoaded){for(t=[],i=this.props.columns,o=0,s=i.length;o<s;o++)r=i[o],r.type===u.STATIC?t.push(this.renderStaticColumnHeader(r)):r.type===u.SINGLE?t.push(this.renderSingleColumnHeader(r)):r.type===u.MULTI&&t.push(this.renderMultiColumnHeader(r));return e="c-column-header "+this.props.className,y.ul({role:"row",className:e},t)}return y.ul(null)}}),w=o.createClass({displayName:"_StaticColumnHeader",propTypes:{label:o.PropTypes.string.isRequired,labelClassName:o.PropTypes.string,className:o.PropTypes.string.isRequired,content:o.PropTypes.node,role:o.PropTypes.string},getDefaultProps:function(){return{role:"columnheader"}},render:function(){return y.li({role:this.props.role,className:"c-column-header__header u-pad-vertical-xs "+this.props.className},null!=this.props.content?this.props.content:void 0,y.span({className:"col-header-contents "+this.props.labelClassName},this.props.label))}}),_=o.createClass({displayName:"_ColumnHeaderView",propTypes:{label:o.PropTypes.string.isRequired,className:o.PropTypes.string,isActive:o.PropTypes.bool,canTriggerSortDirection:o.PropTypes.bool,nextColumnLabel:o.PropTypes.string,tabbable:o.PropTypes.bool,disabled:o.PropTypes.bool,sortDirection:o.PropTypes.oneOf([h.ASCENDING,h.DESCENDING]),onClick:o.PropTypes.func},getDefaultProps:function(){return{className:null,isActive:!1,canTriggerSortDirection:!1,nextColumnLabel:void 0,tabbable:!0,disabled:!1,sortDirection:h.DESCENDING,onClick:r.noop}},renderColumnHeaderLabel:function(){var e,o;return this.props.isActive&&this.props.canTriggerSortDirection?(o=this.props.sortDirection===h.ASCENDING,e=y.span({key:"icon-element",className:t({"c-column-header__sort-arrow":!0,"c-column-header__sort-arrow--up":o,"c-column-header__sort-arrow--down":!o})}),[y.span({key:"label"},this.props.label),e]):[y.span({key:"label"},this.props.label)]},getActionDescription:function(){var e;return this.props.nextColumnLabel?(e=f("Swap column to %(nextlabel)s",{comment:"nextlabel is the name of the column that the current column will be replaced with when this button is clicked."}),e.format({nextlabel:this.props.nextColumnLabel})):this.props.sortDirection===h.DESCENDING?f("Sort in ascending order"):this.props.sortDirection===h.ASCENDING?f(this.props.isActive?"Sort in descending order":"Sort in ascending order"):null},getAriaDirectionName:function(){if(this.props.isActive){if(this.props.sortDirection===h.ASCENDING)return"ascending";if(this.props.sortDirection===h.DESCENDING)return"descending"}return""},render:function(){var e;return e=t("c-column-header__button u-trim-margin u-trim-padding",{"u-font-strong":this.props.isActive}),y.li({role:"columnheader","aria-sort":this.getAriaDirectionName(),className:"c-column-header__header u-pad-vertical-xs "+this.props.className},y.button({className:e,onClick:this.props.onClick,ref:"columnButton",title:this.getActionDescription(),tabIndex:this.props.tabbable?0:-1,disabled:this.props.disabled},this.renderColumnHeaderLabel()))}}),g=o.createClass({displayName:"_MultiColumnHeader",propTypes:{columns:o.PropTypes.arrayOf(m).isRequired,tabbable:o.PropTypes.bool,disabled:o.PropTypes.bool,activeSortField:o.PropTypes.string,initialSortField:o.PropTypes.string,onSubColumnChange:o.PropTypes.func},getDefaultProps:function(){return{tabbable:!0,disabled:!1,activeSortField:void 0,onSubColumnChange:r.noop}},getInitialState:function(){var e,t
;return this.props.initialSortField&&(t=S(this.props.initialSortField,this.props.columns),t&&(e=this.props.columns.indexOf(t))),{currentColumnIndex:e||0}},componentWillMount:function(){return this.updateCurrentColumnIndex(this.props.activeSortField)},componentWillReceiveProps:function(e){if(e.activeSortField!==this.props.activeSortField)return this.updateCurrentColumnIndex(e.activeSortField)},updateCurrentColumnIndex:function(e){var t,o;if(o=S(e,this.props.columns))return t=this.props.columns.indexOf(o),t!==this.state.currentColumnIndex&&this.props.onSubColumnChange(o),this.setState({currentColumnIndex:t})},switchToColumn:function(e){return this.props.onSubColumnChange(e)},render:function(){var e,t,o,r;return e=this.props.columns[this.state.currentColumnIndex],o=this.props.activeSortField&&this.props.activeSortField===e.sortField,t=(this.state.currentColumnIndex+1)%this.props.columns.length,r=this.props.columns[t],b(_,{ref:"singleColumn",key:e.label,className:e.headerClassName||"",canTriggerSortDirection:!1,label:e.label,nextColumnLabel:r.label,tabbable:this.props.tabbable,disabled:this.props.disabled,isActive:o,onClick:(function(e){return function(){return e.switchToColumn(r)}})(this)})}}),{ColumnHeader:a(c,["/static/css/legacy_packages/components-vflRbDbou.css","/static/css/scooter/scooter-scoped-vflm9UP03.css"]),SortDirections:h,ColumnTypes:u}})}.call(this),define("modules/clean/react/content_manager/path_util",["require","exports","modules/clean/sharing/gating_util"],function(e,t,o){"use strict";function r(e){return o.GoldenGate.hasContentManagerCdm(e)?"/team/admin/content":"/team/admin/team_folders"}Object.defineProperty(t,"__esModule",{value:!0});t.getBasePrefix=r}),define("modules/clean/react/file_uploader/constants",["require","exports","modules/core/browser"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploaderActionTypes={SET_PATH:"UPLOADER_SET_PATH",SET_USER:"UPLOADER_SET_USER",SET_NUM_DRAGGING_FILES:"SET_NUM_DRAGGING_FILES",QUEUE_UPLOADS:"QUEUE_UPLOADS",START_UPLOAD:"START_UPLOAD",COMPLETE_UPLOAD:"COMPLETE_UPLOAD",CANCEL_UPLOADS:"CANCEL_UPLOADS",SET_CURRENT_UPLOAD_PROGRESS:"SET_CURRENT_UPLOAD_PROGRESS",UPLOAD_ERROR:"UPLOAD_ERROR",SET_IS_UPLOAD_MODAL_OPEN:"SET_IS_UPLOAD_MODAL_OPEN",SET_IS_INLINE_STATUS_DISMISSED:"SET_IS_INLINE_STATUS_DISMISSED",ADD_NEW_FAILED_FILE:"ADD_NEW_FAILED_FILE"},t.FileStatus={PENDING:"PENDING",UPLOADING:"UPLOADING",COMPLETE:"COMPLETE",CANCELLED:"CANCELLED",FAILED:"FAILED"},t.UploadErrorType={FILE_SIZE_ERROR:"FILE_SIZE_ERROR",HTTP_ERROR:"HTTP_ERROR",CONNECTION_ERROR:"CONNECTION_ERROR",OVER_QUOTA_ERROR:"OVER_QUOTA_ERROR",IGNORED:"IGNORED",EMPTY_OR_FOLDER:"EMPTY_OR_FOLDER",PACKAGE_FILE:"PACKAGE_FILE",GENERIC:"GENERIC"},t.INTERNAL_FILE_DATA_TRANSFER_TYPE=o.msie?"text":"application/x-dropbox-file-list",t.OVER_QUOTA_STATUS={NONE:"NONE",BASIC_OVER_QUOTA:"BASIC_OVER_QUOTA",BASIC_NEAR_QUOTA:"BASIC_NEAR_QUOTA",LIMITED_TEAM_USER_OVER_QUOTA:"LIMITED_TEAM_USER_OVER_QUOTA",LIMITED_TEAM_TSD_OVER_QUOTA:"LIMITED_TEAM_TSD_OVER_QUOTA"}}),function(){var e=function(e,o){function r(){this.constructor=e}for(var s in o)t.call(o,s)&&(e[s]=o[s]);return r.prototype=o.prototype,e.prototype=new r,e.__super__=o.prototype,e},t={}.hasOwnProperty;define("modules/clean/react/file_uploader/store",["external/immutable","modules/clean/base64","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/browse/constants","modules/clean/react/browse/store","modules/core/browser","modules/core/exception"],function(t,o,r,s,i,n,a,l){var c,d,u,p,h,m,assert,f,_,reportStack;return c=i.BrowseActionTypes,f=n.browseStore,assert=l.assert,reportStack=l.reportStack,h={SET_PATH:"UPLOADER_SET_PATH",SET_USER:"UPLOADER_SET_USER",SET_NUM_DRAGGING_FILES:"SET_NUM_DRAGGING_FILES",QUEUE_UPLOADS:"QUEUE_UPLOADS",START_UPLOAD:"START_UPLOAD",COMPLETE_UPLOAD:"COMPLETE_UPLOAD",CANCEL_UPLOADS:"CANCEL_UPLOADS",SET_CURRENT_UPLOAD_PROGRESS:"SET_CURRENT_UPLOAD_PROGRESS",UPLOAD_ERROR:"UPLOAD_ERROR",SET_IS_UPLOAD_MODAL_OPEN:"SET_IS_UPLOAD_MODAL_OPEN",SET_IS_INLINE_STATUS_DISMISSED:"SET_IS_INLINE_STATUS_DISMISSED",ADD_NEW_FAILED_FILE:"ADD_NEW_FAILED_FILE"},d={PENDING:"PENDING",UPLOADING:"UPLOADING",COMPLETE:"COMPLETE",CANCELLED:"CANCELLED",FAILED:"FAILED"},p={FILE_SIZE_ERROR:"FILE_SIZE_ERROR",HTTP_ERROR:"HTTP_ERROR",CONNECTION_ERROR:"CONNECTION_ERROR",OVER_QUOTA_ERROR:"OVER_QUOTA_ERROR",IGNORED:"IGNORED",EMPTY_OR_FOLDER:"EMPTY_OR_FOLDER",PACKAGE_FILE:"PACKAGE_FILE",GENERIC:"GENERIC"},u=t.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:d.PENDING,errorType:p.GENERIC,errorMessage:""}),_=function(){var e,t,r;for(e="",t=0;t<=15;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));return r=o.encode(e),r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_"),r=r.replace(/\=*$/,"")},m=(function(o){function s(){return s.__super__.constructor.apply(this,arguments)}return e(s,o),s.prototype._init=function(){return this._path="/",this._hasPermissionToUploadToFolder=!0,this._user=null,this._fileList=t.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._isInlineStatusDismissed=!1,this._numSecondsLeft=0},s.prototype.fileList=function(){return this._fileList},s.prototype.currentUpload=function(){return this._fileList.get(this._currentUploadId)},s.prototype.currentUploadPercentage=function(){return this.currentUpload().percentUploaded},s.prototype.numSecondsLeft=function(){return this._numSecondsLeft},s.prototype.isUploadCancelled=function(e){var t;return(null!=(t=this._fileList.get(e))?t.status:void 0)===d.CANCELLED},s.prototype.isInlineStatusDismissed=function(){return this._isInlineStatusDismissed},s.prototype.path=function(){return this._path},s.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},s.prototype.user=function(){return this._user},s.prototype.nextUpload=function(){return this._fileList.find(function(e){return e.status===d.PENDING})},s.prototype.numDraggingFiles=function(){return this._numDraggingFiles},s.prototype.isInternalTransfer=function(){return this._isInternalTransfer},s.prototype.totalSizeOfCompletedUploads=function(){return this._fileList.reduce(function(e,t){return t.status===d.COMPLETE?e+t.size:e},0)},s.prototype.totalSize=function(){return this._fileList.reduce(function(e,t){var o;return(o=t.status)===d.COMPLETE||o===d.PENDING||o===d.UPLOADING?e+t.size:e},0)},s.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},s.prototype._setUser=function(e){var t;return t=e.user,this._user=t,this.emit_change()},s.prototype._setPath=function(e){var t,o,r;return o=e.path,t=null==(r=e.hasPermissionToUploadToFolder)||r,this._path=o,this._hasPermissionToUploadToFolder=t,this.emit_change()},s.prototype._initializeEverything=function(e){var t,o,r;return r=e.user,o=e.path,t=e.context,this._user=r,this._path=o,this._hasPermissionToUploadToFolder=t.isCurrentPathWriteable(),this.emit_change()},s.prototype._queueUploads=function(e){var t,o,r,s,i;for(o=e.files,i={},r=0,s=o.length;r<s;r++)t=o[r],i[t.uploadId]=t;return this._fileList=this._fileList.merge(i),this.emit_change()},s.prototype._startUpload=function(e){var t;return t=e.file,assert(null==this._currentUpload),assert(null!=t),assert(this._fileList.get(t.uploadId)===t),this._fileList=this._fileList.update(t.uploadId,function(e){return e.set("status",d.UPLOADING)}),this._currentUploadId=t.uploadId,this.emit_change()},s.prototype._completeUpload=function(e){var t,o,s,i;return s=e.uploadId,i=this._fileList.get(s),s===this._currentUploadId&&i.status===d.UPLOADING||reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:i.toJS(),fileListLength:this._fileList.count(),uploadId:s,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(i.uploadId,function(e){return e.set("status",d.COMPLETE)}),this._currentUploadId=null,o=this._fileList.find(function(e){var t;return(t=e.status)===d.PENDING||t===d.UPLOADING}),o||(t=this._fileList.valueSeq().filter(function(e){return e.status===d.COMPLETE}).map(function(e){return r.normalize(e.dest)+r.normalize(e.name)}),t.every(function(e){return f.filesMap().has(e)})?f.selectFqPaths({fqPathsToSelect:t.toArray()}):f.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:t.toArray()})),this.emit_change()},s.prototype._cancelUploads=function(e){var t,o,r,s;for(o=e.files,r=0,s=o.length;r<s;r++)t=o[r],this._fileList=this._fileList.update(t.uploadId,function(e){var t;return(t=e.status)===d.PENDING||t===d.UPLOADING?e.set("status",d.CANCELLED):e}),t.uploadId===this._currentUploadId&&(this._currentUploadId=null);return this.emit_change()},s.prototype._setCurrentUploadProgress=function(e){var t,o;return o=e.percentComplete,t=e.numSecondsLeft,this._fileList=this._fileList.update(this._currentUploadId,function(e){return e.set("percentUploaded",o)}),this._numSecondsLeft=t,this.emit_change()},s.prototype._handleUploadError=function(e){var t,o,r,s;return s=e.uploadId,o=e.errorType,t=e.errorMessage,r=this._fileList.get(s),r.uploadId!==this._currentUploadId&&reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:r.toJS(),fileListLength:this._fileList.count(),errorType:o,errorMessage:t}}),this._fileList=this._fileList.update(r.uploadId,function(e){return e.set("status",d.FAILED).set("errorType",o).set("errorMessage",t)}),this._currentUploadId=null,this.emit_change()},s.prototype._setNumDraggingFiles=function(e){var t,o,r;return o=e.numDraggingFiles,t=null!=(r=e.isInternalTransfer)&&r,this._numDraggingFiles=o,this._isInternalTransfer=t,this.emit_change()},s.prototype._setIsUploadModalOpen=function(e){var t;return t=e.isUploadModalOpen,this._isUploadModalOpen=t,this.emit_change()},s.prototype._setIsInlineStatusDismissed=function(e){var t;return t=e.isInlineStatusDismissed,this._isInlineStatusDismissed=t,this.emit_change()},s.prototype._addNewFailedFile=function(e){var t,o,r;return r=e.file,o=e.errorType,t=e.errorMessage,null==r.uploadId&&(r=r.set("uploadId",_())),r=r.set("status",d.FAILED).set("errorType",o).set("errorMessage",t),this._fileList=this._fileList.set(r.uploadId,r),this.emit_change()},s.prototype._new_payload=function(e){switch(e.action.type){case c.INITIALIZE_EVERYTHING:return this._initializeEverything(e.action.data);case c.SET_USER:case h.SET_USER:return this._setUser(e.action.data);case c.SET_PATH:case h.SET_PATH:return this._setPath(e.action.data);case h.QUEUE_UPLOADS:return this._queueUploads(e.action.data);case h.START_UPLOAD:return this._startUpload(e.action.data);case h.COMPLETE_UPLOAD:return this._completeUpload(e.action.data);case h.CANCEL_UPLOADS:return this._cancelUploads(e.action.data);case h.SET_CURRENT_UPLOAD_PROGRESS:return this._setCurrentUploadProgress(e.action.data);case h.UPLOAD_ERROR:return this._handleUploadError(e.action.data);case h.SET_NUM_DRAGGING_FILES:return this._setNumDraggingFiles(e.action.data);case h.SET_IS_UPLOAD_MODAL_OPEN:return this._setIsUploadModalOpen(e.action.data);case h.SET_IS_INLINE_STATUS_DISMISSED:return this._setIsInlineStatusDismissed(e.action.data);case h.ADD_NEW_FAILED_FILE:return this._addNewFailedFile(e.action.data)}},s})(s),{UploaderStore:new m,UploaderActionTypes:h,FileUpload:u,FileStatus:d,UploadErrorType:p,generateUploadId:_}})}.call(this),function(){define("modules/clean/react/flag",["external/classnames","external/underscore","external/react","modules/clean/react/css"],function(e,t,o,r){var s,i,n;return n=o.DOM,i=o.createClass({displayName:"Flag",propTypes:{alignment:o.PropTypes.oneOf(["top","middle","bottom"]),leftAttachment:o.PropTypes.oneOfType([o.PropTypes.element,o.PropTypes.node]),rightAttachment:o.PropTypes.oneOfType([o.PropTypes.element,o.PropTypes.node]),spacing:o.PropTypes.oneOf(["xs","s","m","l","xl"]),children:o.PropTypes.oneOfType([o.PropTypes.element,o.PropTypes.node])},getDefaultProps:function(){return{alignment:"middle"}},render:function(){var t,o,r,s,i,a;return s={"o-flag":!0},s["o-flag--"+this.props.alignment]=this.props.alignment,t=s,i={"o-flag__flex":!0},i["u-pad-left-"+this.props.spacing]=this.props.spacing&&this.props.leftAttachment,i["u-pad-right-"+this.props.spacing]=this.props.spacing&&this.props.rightAttachment,o=i,r=this.props.leftAttachment?n.div({className:"o-flag__fix"},this.props.leftAttachment):void 0,a=this.props.rightAttachment?n.div({className:"o-flag__fix"},this.props.rightAttachment):void 0,n.div({className:e(t)},r,n.div({className:e(o)},this.props.children),a)}}),s=r(i,["/static/css/scooter/scooter-scoped-vflm9UP03.css"]),{Flag:s,FlagWithoutCss:i}})}.call(this),define("modules/clean/react/home/home_access/home_access_util",["require","exports","modules/constants/starred"],function(e,t,o){"use strict";function r(){return o.HOME_ENABLED}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeEnabled=r}),define("modules/clean/react/maestro/checkbox",["require","exports","tslib","external/react","external/classnames"],function(e,t,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(i||(i={})),t.CheckboxState=i;var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.checkboxState,t=s({"checkbox-button":!0,"partial-checked":e===i.PartiallyChecked,checked:e===i.Checked});return r.createElement("button",{role:"checkbox","aria-checked":e===i.Checked,"aria-label":this.props.ariaLabel,className:t,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown})},t})(r.PureComponent);t.Checkbox=n}),define("modules/clean/react/maestro/tile_element",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode","modules/clean/react/maestro/checkbox","modules/clean/react/maestro/tile_grid_logger"],function(e,t,o,r,s,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){return null},c=(function(e){function t(t){var o=e.call(this,t)||this;return o.animationRequestIds=[],o.focusTile=function(){if(!o.state.isFocused){var e=o.refs.tileThumbContainer;e&&e.focus()}},o.maybeLogTileInteractive=function(){if(!o.state.isPlaceholderMode){var e=!!o.props.thumbnailUrl,t=o.state.thumbLoaded;if(o.props.onThumbnailLoad){var r=window.requestAnimationFrame(function(){var r=window.requestAnimationFrame(function(){o.props.onThumbnailLoad(o.props.tileIndex,e,t)});o.animationRequestIds.push(r)});o.animationRequestIds.push(r)}}},o.toggleSelect=function(e){e.stopPropagation(),o.props.handleToggleSelect()},o.handleThumbKeyPress=function(e){switch(e.keyCode){case i.KeyCode.SPACE:e.preventDefault();case i.KeyCode.ENTER:o.props.onTileAction(e)}},o.onBlur=function(e){o.setState({isFocused:!1})},o.onFocus=function(e){o.setState({isFocused:!0})},o.state={iconLoaded:!!t.thumbStore.get_thumb(t.iconUrl),thumbLoaded:!(!t.thumbnailUrl||!t.thumbStore.get_thumb(t.thumbnailUrl)),isPlaceholderMode:o.props.delayRenderFullTile},o}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.isPlaceholderMode?this.renderCompleteTileTimeout=setTimeout(function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail(),e.setState({isPlaceholderMode:!1})},100):this.fetchThumbnail()},t.prototype.componentDidUpdate=function(e,t){!e.isFocused&&this.props.isFocused&&this.focusTile(),this.maybeLogTileInteractive()},t.prototype.componentWillUnmount=function(){this.thumbRequestId&&this.props.thumbStore.unbind_url(this.thumbRequestId),this.props.thumbStore.unbind_url(this.iconRequestId),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(function(e){window.cancelAnimationFrame(e)}),this.animationRequestIds=[]},t.prototype.fetchThumbnail=function(){var e=this;if(this.props.thumbnailUrl){var t=Date.now();this.thumbRequestId=this.props.thumbStore.bind_url(this.props.thumbnailUrl,{onSuccess:function(){e.setState({thumbLoaded:!0}),a.InfiniteTileGridLogger.logThumbRTT(Date.now()-t)},onError:function(){e.props.onThumbnailError&&e.props.onThumbnailError(e.props.tileIndex)}})}this.iconRequestId=this.props.thumbStore.bind_url(this.props.iconUrl,{onSuccess:function(){e.state.thumbLoaded||e.setState({iconLoaded:!0})}})},t.prototype.renderCheckbox=function(){var e=this.props.isSelected?n.CheckboxState.Checked:n.CheckboxState.Unchecked;return s.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},s.createElement(n.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect}))},t.prototype.renderActionNode=function(){return s.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},t.prototype.renderThumbnail=function(){var e="tile__preview",t=null;return this.state.thumbLoaded&&(t=this.props.thumbStore.get_thumb(this.props.thumbnailUrl),t&&(e+=" tile__preview--thumb")),!t&&this.state.iconLoaded&&(t=this.props.thumbStore.get_thumb(this.props.iconUrl),t&&(e+=" tile__preview--icon")),t?s.createElement("img",{alt:this.props.altText,className:e,draggable:!1,src:t,style:{maxHeight:this.props.width,maxWidth:this.props.width}}):s.createElement("div",{className:"tile__preview--placeholder"})},t.prototype.render=function(){var e=null;this.props.labelNode&&(e=s.createElement("div",{className:"tile-label"},this.props.labelNode));var t={left:this.props.leftOffset,height:this.props.width+this.props.labelHeight,width:this.props.width},i={height:this.props.width,width:this.props.width};if(this.state.isPlaceholderMode)return s.createElement("div",{className:"tile",style:t},s.createElement("div",{className:"tile__thumb-container",style:i},s.createElement("div",{className:"tile__preview--placeholder"})),e);var n={className:r("tile",{"tile--is-selected":this.props.isSelected,"tile--focused-in":this.state.isFocused}),style:t,draggable:this.props.isDraggable,onBlur:this.onBlur,onClick:this.props.onTileAction,onDragEnter:this.props.onDragEnter,onDragStart:this.props.onDragStart,onFocus:this.onFocus},a=s.createElement("div",{ref:"tileThumbContainer",className:"tile__thumb-container",style:i,tabIndex:0,onKeyDown:this.handleThumbKeyPress},this.renderThumbnail());return s.createElement("div",o.__assign({},n),a,this.props.isSelectable&&this.renderCheckbox(),this.renderActionNode(),e)},t})(s.PureComponent);c.defaultProps={checkboxAriaText:"",delayRenderFullTile:!0,handleToggleSelect:l,isFocused:!1,isSelected:!1,onDragEnter:l,onDragStart:l,onTileAction:l},t.TileElement=c}),define("modules/clean/react/maestro/tile_grid",["require","exports","tslib","external/react","external/react-dom","external/classnames","modules/clean/js_client_stopwatch","external/mcl/culled_list","modules/clean/react/maestro/tile_element","modules/clean/react/maestro/tile_grid_logger","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react_logger"],function(e,t,o,r,s,i,n,a,l,c,d,u){"use strict";function p(e){var t=null;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];if(!t||t.length!==o.length||!t.every(function(e,t){return e===o[t]}))return t=o,e.apply(void 0,o)}}function h(e){var t=e.className,o=e.label;return t=i("tile-label__text",t),r.createElement("div",{className:t},o)}Object.defineProperty(t,"__esModule",{value:!0});t.memoizeCallback=p,t.TileItemLabelText=h;var m=(function(e){function t(t){var o=e.call(this,"InfiniteTileGrid",t)||this;if(o.itemRangeByRow=[],o.scrollTileIntoView=function(e,t){var r=o.props.contentOffset||0,s=document.documentElement.scrollTop||document.body.scrollTop,i=Math.floor(t/o.state.tilesPerRow),n=e-r,a=o.getRowHeight(),l=i*a,c=l+a;s<=l&&c<=n+s||(l<s?window.scrollTo(0,l):window.scrollTo(0,c-n))},o.updateOnResize=function(){window.requestAnimationFrame(function(){o.getAndUpdateTileLayout()})},o.handleTTI=function(){o.setState({ttiReported:!0}),o.props.handleTTI()},o.setLastViewedPage=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,r=Math.round(t/e);if(o.tileLoadLogger.pruneTrackedPages(),o.tileLoadLogger.logCompletedPages(),!o.tileLoadLogger.pagesCompletedLogging.has(r)&&!o.tileLoadLogger.pagesToLog.has(r))if(r!==o.tileLoadLogger.lastViewedPage){if(o.tileLoadLogger.lastViewedPage=r,o.tileLoadLogger.pageChangeTime=o.tileLoadLogger.getTimeNow(),!o.tileLoadLogger.startTimeByPage.get(r)){var s=o.tileLoadLogger.getTimeNow(),i=o.tileLoadLogger.startTimeByPage.set(r,s);o.tileLoadLogger.startTimeByPage=i}}else{var s=o.tileLoadLogger.getTimeNow();if(s-o.tileLoadLogger.pageChangeTime>1e3){var n=o.tileLoadLogger.pagesToLog.add(r);o.tileLoadLogger.pagesToLog=n}}},o.logTileError=function(e){o.tileLoadLogger&&o.tileLoadLogger.recordTileError(e),o.props.logTileLoading&&c.InfiniteTileGridLogger.logThumbLoadError()},o.logTileLoaded=function(e,t,r){o.tileLoadLogger&&o.tileLoadLogger.recordTileLoaded(e,t,r)},o.renderTileElement=function(e,t,s){var i=o.props.getTileItem(e,s);if(!i)return null;var n=o.state.ttiReported&&o.props.delayRenderFullTile,a=i.isSelectable&&!!o.props.selectedIds&&o.props.selectedIds.has(i.id);return r.createElement(l.TileElement,{key:i.id,onTileAction:i.onTileAction,width:o.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:i.labelNode?o.props.labelHeight:0,delayRenderFullTile:n,actionNode:i.actionNode,iconUrl:i.iconUrl,thumbnailUrl:i.thumbnailUrl,labelNode:i.labelNode,altText:i.altText,onThumbnailError:o.props.logTileLoading?o.logTileError:void 0,onThumbnailLoad:o.props.logTileLoading?o.logTileLoaded:void 0,isDraggable:i.isDraggable,onDragEnter:i.onDragEnter,onDragStart:i.onDragStart,isFocused:i.isFocused,isSelectable:i.isSelectable,isSelected:a,handleToggleSelect:i.handleToggleSelect,checkboxAriaText:i.checkboxAriaText,thumbStore:o.thumbStore,scrollTileIntoView:o.scrollTileIntoView})},o.renderRow=function(e,t,s){var i=o.rowHeights?o.rowHeights[t]:o.getRowHeight();if(!e)return r.createElement(a.CulledItem,{className:o.props.rowClass,height:i,key:t,tagName:"li",topOffset:s});if(!Array.isArray(e))return r.createElement(a.CulledItem,{className:o.props.rowClass,height:i,key:t,tagName:"li",topOffset:s},e);for(var n=e,l=n[0],c=n[1],d=o.state.tileWidth+o.props.tilePadding,u=[],p=4,h=l;h<c;h++)u.push(o.renderTileElement(h,p,u.length)),p+=d;return r.createElement(a.CulledItem,{className:o.props.rowClass,height:i,key:t,tagName:"li",topOffset:s},u)},o.handleRangeInView=p(function(e,t){var r=o.props.onRangeInView;if(r){var s=o.translateRowRangeToItemRange(e,t);r(s[0],s[1])}}),o.props.sectionLabels||o.props.sectionStartIndices){if(!o.props.sectionLabels||!o.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(o.props.sectionLabels.count()!==o.props.sectionStartIndices.count())throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return o.state={tilesPerRow:3,tileWidth:o.props.maxTileWidth,ttiReported:!1},o.props.thumbStore?o.thumbStore=o.props.thumbStore:o.thumbStore=new d.GenericThumbStore,n.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),o}return o.__extends(t,e),t.prototype.componentDidMount=function(){var t=this;window.addEventListener("resize",this.updateOnResize),this.animationFrameRequestId=window.requestAnimationFrame(function(){var e=t.getAndUpdateTileLayout();t.props.logTileLoading&&t.setupTileLogging(t.getRowHeight(),e.tilesPerRow)}),e.prototype.componentDidMount.call(this)},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.totalNumItems)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateOnResize),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),delete this.tileLoadLogger)},t.prototype.getRowHeight=function(){var e=this.props.tileHeight+this.props.tilePadding;return this.props.showLabels&&(e+=this.props.labelHeight+4),e},t.prototype.getPageHeight=function(){var e=document.documentElement.clientHeight||window.outerHeight,t=this.props.contentOffset||0,o=e-t,r=this.getRowHeight(),s=r*Math.ceil(o/r);return Math.max(s,r)},t.prototype.getAndUpdateTileLayout=function(){var e=this.props.maxTileWidth+this.props.tilePadding,t=s.findDOMNode(this);if(!t)return{tileWidth:this.props.maxTileWidth,tilesPerRow:1};var o=t.clientWidth,r=Math.max(1,Math.floor(o/e)),i=this.props.maxTileWidth;return o%e>1&&(r++,i=o/r-this.props.tilePadding),this.state.tileWidth===i&&this.state.tilesPerRow===r||this.setState({tileWidth:i,tilesPerRow:r}),{tileWidth:i,tilesPerRow:r}},t.prototype.setupTileLogging=function(e,t){var o=this.getPageHeight(),r=t*Math.ceil(o/e);this.tileLoadLogger=new c.InfiniteTileGridLogger(this.props.totalNumItems,r,t,this.handleTTI);var s=this.tileLoadLogger.pagesToLog.add(0);this.tileLoadLogger.pagesToLog=s;var i=this.tileLoadLogger.getTimeNow(),n=this.tileLoadLogger.startTimeByPage.set(0,i);this.tileLoadLogger.startTimeByPage=n,this.logTrackingInterval=setInterval(this.setLastViewedPage,200,o)},t.prototype.translateRowRangeToItemRange=function(e,t){var o=this.itemRangeByRow;return[o[e][0],o[t][1]]},t.prototype.render=function(){var e=this,t=this.itemRangeByRow;t.length=0;var o=[],s=this.getRowHeight(),i=this.props,n=i.containerClass,l=i.enableMaxHeightGrouping,c=i.numThresholdRows,d=i.scrollDeltaThreshold,u=i.sectionStartIndices,p=i.sectionLabels,h=i.totalNumItems;if(u&&u.count()>0)return this.rowHeights=[],u.forEach(function(i,n){var a=h;n!==u.count()-1&&(a=u.get(n+1)),e.rowHeights.push(32);var l=a-i,c=Math.ceil(l/e.state.tilesPerRow),d=p.get(n),m=r.createElement("div",{className:"tile-section-header"},d);o.push(m),t.push([i,i]);for(var f=0;f<c;f++){var _=i+f*e.state.tilesPerRow,g=Math.min(_+e.state.tilesPerRow,a),w=[_,g];o.push(w),t.push(w),e.rowHeights.push(s)}}),r.createElement(a.CulledList,{enableMaxHeightGrouping:l,items:o,listItemHeight:this.rowHeights,itemBuffer:c,className:n,renderRow:this.renderRow,scrollThreshold:d,onRangeInView:this.handleRangeInView});for(var m=Math.ceil(h/this.state.tilesPerRow),f=0;f<m;f++){var _=f*this.state.tilesPerRow,g=Math.min(_+this.state.tilesPerRow,h),w=[_,g];o.push(w),t.push(w)}return r.createElement(a.CulledList,{enableMaxHeightGrouping:l,items:o,listItemHeight:s,itemBuffer:c,className:n,renderRow:this.renderRow,scrollThreshold:d,onRangeInView:this.handleRangeInView})},t})(u.ReactPureLogger);m.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:function(e,t){return null},handleTTI:function(){}},t.InfiniteTileGrid=m}),define("modules/clean/react/maestro/tile_grid_logger",["require","exports","external/immutable","modules/clean/js_client_stopwatch","modules/core/browser"],function(e,t,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,r,s){var i=this;this.recordTileError=function(e){var t=Math.floor(e/i.numTilesPerPage);i.pagesWithThumbErrors.has(t)||(i.pagesWithThumbErrors=i.pagesWithThumbErrors.add(t))},this.recordTileLoaded=function(e,t,o){if(o){if(i.thumbsLoaded.has(e))return;i.thumbsLoaded=i.thumbsLoaded.add(e)}else{if(i.iconsLoaded.has(e))return;i.iconsLoaded=i.iconsLoaded.add(e)}var r=!1;r=i.numTiles%i.numTilesPerPage===0?e>=i.numTiles-i.numTilesPerPage:e>=i.numTiles-i.numTiles%i.numTilesPerPage;var s=i.numTilesPerPage;if(r){var n=i.numTiles%i.numTilesPerPage;0!==n&&(s=n)}var a=Math.floor(e/i.numTilesPerPage);if(o||!t){var l=i.numTilesFinalizedByPage,c=l.get(a)||0;i.numTilesFinalizedByPage=l.set(a,c+1)}if(0===a&&i.handleTTI){!(i.iconsLoaded.has(e)&&i.thumbsLoaded.has(e))&&(i.numTilesLoadedOnFirstPage++,i.numTilesLoadedOnFirstPage===s&&i.handleTTI())}o&&(i.pagesWithThumbs.has(a)||(i.pagesWithThumbs=i.pagesWithThumbs.add(a)),i.anyThumbLoadedTimeByPage.get(a)||(i.anyThumbLoadedTimeByPage=i.anyThumbLoadedTimeByPage.set(a,i.getTimeNow())),i.numTilesFinalizedByPage.get(a)===s&&(i.allThumbsLoadedTimeByPage=i.allThumbsLoadedTimeByPage.set(a,i.getTimeNow())))},this.pruneTrackedPages=function(){i.startTimeByPage.entrySeq().forEach(function(e){var t=e[0],o=e[1];!i.pagesToLog.has(t)&&!i.pagesCompletedLogging.has(t)&&i.getTimeNow()-o>2e3&&(i.startTimeByPage=i.startTimeByPage.delete(t))})},this.logCompletedPages=function(){i.pagesToLog.forEach(function(e){var t=i.startTimeByPage.get(e),o=Math.max(i.allThumbsLoadedTimeByPage.get(e),t),r=Math.max(i.anyThumbLoadedTimeByPage.get(e),t);return o&&!i.pagesWithThumbs.has(e)?void i.handlePageCompletedLogging(e):i.pagesWithThumbErrors.has(e)?void i.handlePageCompletedLogging(e):void(t&&o&&r&&(i.logPerfStats(e,t,r,o),i.handlePageCompletedLogging(e)))})},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=o.List(),this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=o.Set(),this.thumbsLoaded=o.Set(),this.startTimeByPage=o.Map(),this.allThumbsLoadedTimeByPage=o.Map(),this.anyThumbLoadedTimeByPage=o.Map(),this.pagesWithThumbErrors=o.Set(),this.pagesWithThumbs=o.Set(),this.pagesCompletedLogging=o.Set(),this.pagesToLog=o.Set(),this.handleTTI=s}return e.prototype.getTimeNow=function(){var e=s.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging=this.pagesCompletedLogging.add(e),this.pagesToLog=this.pagesToLog.delete(e),this.startTimeByPage=this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage=this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage=this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){r.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){r.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,o,s){r.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:o-t}),r.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:s-t})},e})();t.InfiniteTileGridLogger=i}),define("modules/clean/search/search_results",["require","exports","tslib","external/react","external/react-dom","external/underscore","modules/clean/react/async_file_modal_controller","modules/clean/react/css","modules/clean/search/actions","modules/clean/search/store","modules/clean/search/search_results_view","modules/clean/react_logger"],function(e,t,o,r,s,i,n,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t){var o=e.call(this,"SearchResultsController",t)||this;return o._onSearchStoreChanged=function(){o.setState(o._get_state_from_store())},o._handleScroll=function(){s.findDOMNode(o).getBoundingClientRect().bottom<=window.innerHeight&&l.searchActions.loadMoreResults({path:o.props.path,user:o.props.user})},o._handleSelectionChange=function(e){l.searchActions.setSearchSelection({selection:e})},o._handleDelete=function(){var e=o.state.selectedFiles.toArray();n.showDelete(o.props.user,e,o.state.context,function(){})},o._handleRestoreMulti=function(){var e=o.state.selectedFiles.toArray();n.showRestore(o.props.user,e,function(){})},o._handlePermanentDelete=function(){var e=o.state.selectedFiles,t=function(){l.searchActions.removeSearchResults({fq_paths:e.map(function(e){return e.fq_path}).toOrderedMap()})};n.showPermanentlyDelete(o.props.user,e.toArray(),t)},o._actionHandlers={onDelete:o._handleDelete,onRestoreMulti:o._handleRestoreMulti,onPermanentDelete:o._handlePermanentDelete},o}return o.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),this.state=this._get_state_from_store()},t.prototype.componentDidMount=function(){
c.searchStore.add_change_listener(this._onSearchStoreChanged),this.setState(this._get_state_from_store()),e.prototype.componentDidMount.call(this)},t.prototype.componentWillUnmount=function(){c.searchStore.remove_change_listener(this._onSearchStoreChanged)},t.prototype._get_state_from_store=function(){return{context:c.searchStore.browseContext(),hasMoreResults:c.searchStore.hasMoreResults(),loadingState:c.searchStore.loadingState(),latestQuery:c.searchStore.latestQuery(),searchSessionId:c.searchStore.searchSessionID(),searchResults:c.searchStore.searchResults(),selection:c.searchStore.selection(),selectedFiles:c.searchStore.selectedFiles()}},t.prototype.render=function(){return r.createElement(d.SearchResultsView,o.__assign({},this.state,{maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,maestroSearchBarProps:this.props.maestroSearchBarProps,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,onFullSearch:this.props.onFullSearch,onScroll:i.throttle(this._handleScroll,200),setFileUploaderPath:this.props.setFileUploaderPath,onSelectionChange:this._handleSelectionChange,path:this.props.path,trademarkBusiness:this.props.trademarkBusiness,user:this.props.user,contextFileActionHandlers:this.props.contextFileActionHandlers,actionHandlers:this._actionHandlers,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown,isMclListViewEnabled:this.props.isMclListViewEnabled}))},t})(u.ReactLogger);t.SearchResultsController=a(p,["/static/css/browse/browse-vflC_4Pg0.css","/static/css/scooter/scooter-scoped-vflm9UP03.css"])}),define("modules/clean/search/search_results_view",["require","exports","tslib","jquery","external/underscore","external/mcl/vertically_fixed","external/react","modules/clean/analytics","modules/clean/browse_interface","modules/clean/history","modules/clean/react/browse/util","modules/clean/react/image","modules/clean/react/maestro/header","modules/clean/react/maestro/layout","modules/clean/react/sprite","modules/clean/static_urls","modules/clean/teams/team_promo_banner","modules/core/browser","modules/clean/filepath","modules/core/i18n","modules/core/uri","modules/clean/react/browse/constants","modules/clean/react/browse/files_view/controller","modules/clean/react/browse/item_list","modules/clean/react/app_actions_view","modules/clean/react/browse/file_actions","modules/clean/search/constants","modules/clean/react_logger"],function(e,t,o,r,s,i,n,a,l,c,d,u,p,h,m,f,_,g,w,S,b,y,v,T,F,E,C,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){function t(t){var o=e.call(this,"SearchResultsView",t)||this;return o._banner_view_logged=!1,o._ensureFileViewerClosedIfNotPreviewing=function(){var e=c.deconstruct_url().qargs;o.props.ensureFileViewerClosedIfNotPreviewing(e)},o._handleFullSearchOnClick=function(e){e.preventDefault(),o.props.onFullSearch(o.props.latestQuery,o.props.searchSessionId)},o._renderEmptyFolderView=function(){return n.createElement("div",{className:"empty-folder-placeholder u-font-center u-pad-top-xl"},n.createElement(u,{src:f.static_url("/static/images/empty_states/search-vfl6DaX2I.png"),srcHiRes:f.static_url("/static/images/empty_states/search@2x-vflBsUhDE.png"),alt:""}),n.createElement("h2",{className:"u-pad-top-l"},S._("No results found")),n.createElement("div",null,w.paths_are_equal(o.props.path,"/")?S._("Please update your search and try again"):o._renderFullSearchLink()))},o.state={},o}return o.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),c.add_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype.componentDidMount=function(){r(window).on("scroll.SearchResults",this.props.onScroll),e.prototype.componentDidMount.call(this)},t.prototype.componentWillUnmount=function(){r(window).off("scroll.SearchResults"),c.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype._renderFullSearchLink=function(){var e="work"===this.props.user.role?l.WORK_ROOT:l.PERSONAL_ROOT,t=b.parse("/search"+e).setQuery({path:"/",query:this.props.latestQuery,qsid:this.props.searchSessionId}).toString();return n.createElement("a",{className:"empty-folder-placeholder-link",href:t,onClick:this._handleFullSearchOnClick},S._("Search all of my Dropbox instead"))},t.prototype._maybeRenderUpsellPromoBanner=function(){if(this.props.limitedTeamBannerUpsell)return this._getLoadingState()!==y.LoadingStates.LOADED||this.props.hasMoreResults||this._banner_view_logged||(this._banner_view_logged=!0,a.TeamsWebActionsLogger.log("banner_search_displayed",{location:"search_results",item_count:this.props.searchResults.size})),n.createElement("div",{className:"team-promo-banner-wrapper__shadow"},n.createElement("div",{className:"team-promo-banner-wrapper"},this._renderUpsellPromoBannerContent()))},t.prototype._renderUpsellPromoBannerContent=function(){return n.createElement(_,{description:[S._("Search through file contents in addition to file names with %(trademark_business)s").format({trademark_business:this.props.trademarkBusiness}),n.createElement("a",{className:"upsell_info u-pad-xxs",href:"/help/6635",target:"_blank",rel:"noopener noreferrer",key:"info-link"},n.createElement(m,{group:"web",name:"info",alt:S._("more info")}))],buttons:[{text:S._("Upgrade"),handler:function(){g.redirect(new b({path:"/team/upgrade",query:{tk:"search_upsell_results",camp:"web"}}).toString())}}]})},t.prototype._maybeRenderSearchResultsHeader=function(){return this._getLoadingState()!==y.LoadingStates.LOADING_FIRST_PAGE&&this.props.searchResults.size?n.createElement("div",{className:"search-results__info-shadow"},this._maybeRenderSearchResultsHeaderContent()):null},t.prototype._maybeRenderSearchResultsHeaderContent=function(){var e;e=w.paths_are_equal(this.props.path,"/")?S.ungettext("%(num_results)d result in files, folders, Paper docs, and content.","%(num_results)d results in files, folders, Paper docs, and content.",this.props.searchResults.size).format({num_results:this.props.searchResults.size}):S.ungettext("%(num_results)d result in files, folders, and content.","%(num_results)d results in files, folders, and content.",this.props.searchResults.size).format({num_results:this.props.searchResults.size});var t=n.createElement("div",{className:"search-results__info o-grid--no-gutter"},this.props.hasMoreResults?n.createElement("span",{className:"o-grid__col o-grid__col--12-of-12 columnheader--filename"},e):[n.createElement("span",{className:"o-grid__col o-grid__col--8-of-12 columnheader--filename",key:"summary"},e),n.createElement("span",{className:"o-grid__col o-grid__col--4-of-12 columnheader--modified",key:"modified"},S._("Modified"))]);return n.createElement(i.VerticallyFixed,null,t)},t.prototype._getLoadingState=function(){return this.props.loadingState===C.SearchLoadingStates.LOADING_FIRST_PAGE?y.LoadingStates.LOADING_FIRST_PAGE:this.props.loadingState===C.SearchLoadingStates.LOADING_ADDITIONAL_PAGE?y.LoadingStates.LOADING_REMAINING_PAGES:y.LoadingStates.LOADED},t.prototype._maybeRenderMaestroActionMenu=function(){if(this.props.selectedFiles.size){var e=E.getActionsForFileCollection({files:this.props.selectedFiles,context:this.props.context,user:this.props.user,actionHandlers:this.props.actionHandlers,isSearchMode:!0});if(e.length>0){var t={displayName:e[0].label,handleClick:e[0].performAction,iconName:e[0].iconName,className:e[0].className},o=e.slice(1).map(function(e){return{displayName:e.label,handleClick:e.performAction,iconName:e.iconName,className:e.className}}),r=d.getSelectedFilesText(this.props.selectedFiles,this.props.context);return n.createElement(F.AppActionsView,{headerText:r,popoverTriggerLabel:S._("Actions"),primaryMenuItem:t,secondaryMenuItems:o})}}return n.createElement("div",null)},t.prototype._renderSearchResultItems=function(){var e={context:this.props.context,items:this.props.searchResults,loadingState:this._getLoadingState(),isMaestroDesign:!0,isSearchMode:!0,isColumnHeaderVisible:!1,isMultiColumnGroupVisible:!1,showFileViewerModal:this.props.showFileViewerModal,isFileViewerShown:this.props.isFileViewerShown,isPaginating:!1,setFileUploaderPath:this.props.setFileUploaderPath,isTextSelectable:!1,isDragAndDropEnabled:!1,shouldShowDeletedFiles:!1,showContainingPaths:!0,showFilenameHighlights:!0,user:this.props.user,path:this.props.path,viewType:y.ViewTypes.List,selection:this.props.selection,selectedFiles:this.props.selectedFiles,onSelectionChange:this.props.onSelectionChange,onSortChange:s.noop,onSwitchViewType:s.noop,customEmptyFolderView:this._renderEmptyFolderView,contextFileActionHandlers:this.props.contextFileActionHandlers,actionHandlers:this.props.actionHandlers,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,onOutsideMouseUp:s.noop,handleComponentTTI:this.props.handleComponentTTI};if(this.props.isMclListViewEnabled){var t={createNewFolderState:y.NewFolderCreationStates.CREATE_FOLDER_INACTIVE,files:e.items,onComponentTTI:e.handleComponentTTI,showFileUploaderModal:s.noop,totalNumFiles:e.items.size};return n.createElement(v.FilesViewController,o.__assign({},e,t))}return n.createElement(T.ItemListController,o.__assign({},e))},t.prototype._renderMaestroAppContent=function(){return n.createElement("div",{className:"search-results"},this._maybeRenderUpsellPromoBanner(),this._maybeRenderSearchResultsHeader(),this._renderSearchResultItems())},t.prototype.render=function(){var e=this.props,t=e.user,o=e.maestroSearchBarProps;return n.createElement(h.MaestroChrome,{user:t,titleRegion:n.createElement(p.MaestroHeaderTitle,null,S._("Search results")),embeddedAppRegion:this._renderMaestroAppContent(),actionSidebarRegion:this._maybeRenderMaestroActionMenu(),searchBarProps:o})},t})(I.ReactLogger);t.SearchResultsView=N}),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/core/browser","modules/clean/sharing/gating_util","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],function(e,t,o,r,s,i,n,a){"use strict";function l(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/shared_content_link_sync_utils"],function(e){return e.mountSharedFolder.apply(e,t)})}function c(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(o){return[2,new Promise(function(o,r){e(["modules/clean/sharing/ui_util"],function(e){o(e.genContentManagerBridgeUri.apply(void 0,t))},r)})]})})}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(o){switch(o.label){case 0:return[4,c.apply(void 0,e)];case 1:return t=o.sent(),r.open_tab(t.toString()),[2]}})})}function u(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/cdm_new_folder_modal"],function(e){e.showCdmNewFolderModal.apply(e,t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMountSharedFolder=l,t.asyncGoToContentManagerForPath=d,t.asyncShowCdmNewFolderModal=u,t.GoldenGate=s.GoldenGate,t.asyncShowShareModal=i.asyncShowShareModal,t.asyncShowNewFolderShareModal=i.asyncShowNewFolderShareModal,t.asyncShowPrefilledShareModal=i.asyncShowPrefilledShareModal,t.asyncShowSharedContentLinkSyncModal=i.asyncShowSharedContentLinkSyncModal,t.makePublicFolderLink=n.makePublicFolderLink,t.shouldUsePublicFolderSharing=n.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=n.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=a.asyncShowShareAFolderWizardModal}),define("modules/clean/sharing/gating_util",["require","exports","modules/clean/sharing/constants"],function(e,t,o){"use strict";function r(e){return o.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?o.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.GoldenGate={canSetFolderConfidential:function(e){return Boolean(o.GOLDEN_GATE.CAN_SET_FOLDER_CONFIDENTIAL[e])},hasNewInheritedMembersUI:function(e){return Boolean(o.GOLDEN_GATE.CDM_HAS_NEW_INHERITED_MEMBERS_UI[e])},hasNewOwnershipModel:function(e){return Boolean(o.GOLDEN_GATE.HAS_NEW_OWNERSHIP_MODEL[e])},hasContentManagerAndSuperAdmin:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e])},hasContentManagerActionsDisabled:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_ACTIONS_DISABLED[e])},hasContentManagerCdm:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e])},hasContentManagerTSDSwitch:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_TSD_SWITCH[e])},SHARING_TOTAL_LIMIT:o.GOLDEN_GATE.SHARING_TOTAL_LIMIT},t.isUserNoCommentEnabled=r}),define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri","modules/constants/public_folder_constants"],function(e,t,o,r){"use strict";function s(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var o=(e.publicFolderFqPath||"/public").toLowerCase(),r=t.toLowerCase();return r===o?"/":r.startsWith(o+"/")?t.substring(o.length):null}function i(e,t){return null!=s(e,t)}function n(e,t,i,n){if(n)return null;var a,l=s(t,i);if(a=r.SHOULD_REDIRECT_URL?"u"+e+".dl.dropboxusercontent.com":"dl.dropboxusercontent.com",null!=l){var c=new o({scheme:"https",authority:a});return t.publicAppToken?(c.setPath("/spa/"+t.publicAppToken+l+"/data"),c.toString()):(c.setPath("/u/"+e+l),c.toString())}return null}function a(t){return new Promise(function(o,r){e(["external/react","modules/clean/react/modal","modules/clean/sharing/public_folder/modal"],function(e,r,s){var i=r.Modal,n=s.CopyPublicLinkModal;i.showInstance(e.createElement(n,{publicLink:t})),o()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUsePublicFolderSharing=i,t.makePublicFolderLink=n,t.showPublicFolderLinkModal=a}),function(){define("modules/clean/teams/team_promo_banner",["external/classnames","external/react","modules/clean/react/button"],function(e,t,o){var r,s,i;return s=t.DOM,r=t.createElement,i=t.PropTypes,t.createClass({displayName:"TeamPromoBanner",propTypes:{className:i.string,title:i.string,description:i.node,buttons:i.arrayOf(i.shape({text:i.string,handler:i.func}))},render:function(){var t,i;return s.div({className:e("team-promo-banner",this.props.className)},s.div({className:"team-promo-banner-contents"},s.div({className:"team-promo-banner-body"},s.div({className:"team-promo-banner-title"},this.props.title),s.div({className:"team-promo-banner-description"},this.props.description)),s.div({className:"team-promo-banner-buttons"},function(){var e,n,a,l;for(a=this.props.buttons,l=[],i=e=0,n=a.length;e<n;i=++e)t=a[i],l.push(s.span({className:"team-promo-banner-button",key:"button-"+i},r(o.button,{importance:"tertiary",onClick:t.handler},t.text)));return l}.call(this))))}})})}.call(this),define("modules/core/framework_args",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAMEWORK_ARGS=["country_override","cProfile","public_mode_override","stormcrow_override","stormcrow_override_data_field","stormcrow_override_population","stormcrow_override_ttl","stormcrow_panel","uncompressed_js","use_packages"]});
//# sourceMappingURL=pkg-browse.min.js-vfl-JBgEd.map